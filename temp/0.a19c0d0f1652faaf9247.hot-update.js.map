{"version":3,"file":"0.a19c0d0f1652faaf9247.hot-update.js","sources":["webpack:///./src/lib/toolbar/sysbar.js?d836"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _bar = require('./base/bar');\n\nvar _bar2 = _interopRequireDefault(_bar);\n\nvar _lang = require('../util/lang');\n\nvar _index = require('./navbar/index');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * 系统工具栏\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * 主场景工具栏\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar sysBar = function (_Bar) {\n    _inherits(sysBar, _Bar);\n\n    function sysBar() {\n        var _ref = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n        var controlBar = _ref.controlBar;\n        var container = _ref.container;\n        var pageMode = _ref.pageMode;\n        var pageTotal = _ref.pageTotal;\n        var currentPage = _ref.currentPage;\n\n        _classCallCheck(this, sysBar);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(sysBar).call(this));\n\n        _this.arrows = (0, _lang.hash)();\n        _this.curTips = null; //当前页码对象\n        _this.Lock = false; //操作锁\n        _this.delay = 50; //动画延时\n        _this.hasTopBar = true; //有顶部工具条\n        _this.controlBar = controlBar;\n        _this.container = container;\n        _this.pageMode = pageMode;\n        _this.pageTotal = pageTotal;\n        _this.currentPage = currentPage;\n\n        //配置属性\n        _this.initConfig();\n\n        _this._initTool();\n        return _this;\n    }\n\n    /**\r\n     * init tool\r\n     * @return {[type]} [description]\r\n     */\n\n\n    _createClass(sysBar, [{\n        key: '_initTool',\n        value: function _initTool() {\n\n            var bar = this.controlBar;\n            var setting = this.settings;\n\n            //工具栏的显示状态\n            this.barStatus = bar.css('display') === 'none' ? false : true;\n\n            //工具栏摆放位置\n            this.toolbarPostion(bar, setting.ToolbarPos);\n\n            //首页按钮\n            setting.HomeBut && this.createHomeIcon(bar);\n\n            //目录按钮\n            setting.ContentBut && this.createDirIcon(bar);\n\n            //添加标题\n            this.createTitle(bar);\n\n            //关闭子文档\n            setting.CloseBut && this.createCloseIcon(bar);\n\n            //页码数\n            setting.PageBut && this.createPageNum(bar);\n\n            //工具栏隐藏按钮\n            this.createHideToolbar(bar);\n\n            //翻页按钮\n            if (this.pageMode == 2) {\n                this.createArrows();\n            }\n\n            //邦定事件\n            this.bindButtonsEvent(bar);\n        }\n\n        /**\r\n         * 工具条的位置\r\n         * @param  {[type]} bar      [description]\r\n         * @param  {[type]} position [description]\r\n         * @return {[type]}          [description]\r\n         */\n\n    }, {\n        key: 'toolbarPostion',\n        value: function toolbarPostion(bar, position) {\n            var height = this.iconHeight,\n                TOP = this.barHeight;\n            if (position == 1) {\n                //在底部\n                bar.css({\n                    bottom: 0,\n                    height: height + 'px'\n                });\n            } else {\n                //在顶部\n                bar.css({\n                    top: 0,\n                    height: height + 'px',\n                    paddingTop: TOP + 'px'\n                });\n            }\n        }\n\n        /**\r\n         * 创建主页按钮\r\n         * @param  {[type]} bar [description]\r\n         * @return {[type]}     [description]\r\n         */\n\n    }, {\n        key: 'createHomeIcon',\n        value: function createHomeIcon(bar) {\n            var str = '<div id=\"xut-nav-backhome\" style=\"float:left;text-indent:0.25em;height:{0}px;line-height:{1}px;color:#007aff\">主页</div>',\n                height = this.iconHeight,\n                html = $(String.format(str, height, height));\n            bar.append(html);\n        }\n\n        /**\r\n         * 创建目录按钮\r\n         * @param  {[type]} bar [description]\r\n         * @return {[type]}     [description]\r\n         */\n\n    }, {\n        key: 'createDirIcon',\n        value: function createDirIcon(bar) {\n            var str = '<div id=\"xut-nav-backdir\" class=\"xut-nav-backdir\" style=\"float:left;margin-left:4px;width:{0}px;height:{1}px;background-size:cover\"></div>',\n                height = this.iconHeight,\n                html = $(String.format(str, height, height));\n            bar.append(html);\n        }\n\n        /**\r\n         * 创建页码数\r\n         * @param  {[type]} bar [description]\r\n         * @return {[type]}     [description]\r\n         */\n\n    }, {\n        key: 'createPageNum',\n        value: function createPageNum(bar) {\n            var height = this.iconHeight,\n                marginTop = height * 0.25,\n                iconH = height * 0.5,\n                str,\n                html;\n            str = '<div class=\"xut-nav-page\" style=\"float:right;margin:{0}px 4px;padding:0 0.25em;height:{1}px;line-height:{2}px;border-radius:0.5em\"><span>{3}</span>/<span>{4}</span></div>';\n            html = $(String.format(str, marginTop, iconH, iconH, this.currentPage, this.pageTotal));\n            this.curTips = html.children().first();\n            bar.append(html);\n        }\n\n        /**\r\n         * 工具栏隐藏按钮\r\n         * @param  {[type]} bar [description]\r\n         * @return {[type]}     [description]\r\n         */\n\n    }, {\n        key: 'createHideToolbar',\n        value: function createHideToolbar(bar) {\n            var html,\n                style,\n                height = this.iconHeight;\n            style = 'float:right;width:' + height + 'px;height:' + height + 'px;background-size:cover';\n            html = '<div id=\"xut-nav-hidebar\" class=\"xut-nav-hide\" style=\"' + style + '\"></div>';\n            bar.append(html);\n        }\n\n        //关闭子文档按钮\n\n    }, {\n        key: 'createCloseIcon',\n        value: function createCloseIcon(bar) {\n            var style,\n                html,\n                height = this.iconHeight;\n            style = 'float:right;margin-right:4px;width:' + height + 'px;height:' + height + 'px';\n            html = '<div class=\"si-icon\" data-icon-name=\"close\" style=\"' + style + '\"></div>';\n            html = $(html);\n            this.createSVGIcon(html[0], function () {\n                if (window.SUbDOCCONTEXT) {\n                    window.SUbDOCCONTEXT.Xut.publish('subdoc:dropApp');\n                } else {\n                    Xut.publish('magazine:dropApp');\n                }\n            });\n            bar.append(html);\n        }\n\n        //应用标题\n\n    }, {\n        key: 'createTitle',\n        value: function createTitle(bar) {\n            var style,\n                html,\n                appName = this.appName,\n                height = this.iconHeight;\n            style = 'width:100%;position:absolute;line-height:' + height + 'px;pointer-events:none';\n            html = '<div class=\"xut-nav-title\" style=\"z-index:-99;' + style + '\">' + appName + '</div>';\n            bar.append(html);\n        }\n\n        /**\r\n         * [ 返回按钮]\r\n         * @return {[type]} [description]\r\n         */\n\n    }, {\n        key: 'createBackIcon',\n        value: function createBackIcon(container) {\n            var style,\n                html,\n                height = this.iconHeight;\n            style = 'float:left;width:' + height + 'px;height:' + height + 'px';\n            html = '<div class=\"si-icon\" data-icon-name=\"back\" style=\"' + style + '\"></div>';\n            html = $(html);\n            this.createSVGIcon(html[0], function () {\n                Xut.Application.Suspend({\n                    dispose: function dispose() {\n                        //停止热点动作\n                        Xut.Application.DropApp(); //退出应用\n                    },\n                    processed: function processed() {\n                        Xut.Application.DropApp(); //退出应用\n                    }\n                });\n            });\n            container.append(html);\n        }\n\n        /**\r\n         * 更新页码指示\r\n         * @return {[type]} [description]\r\n         */\n\n    }, {\n        key: 'updatePointer',\n        value: function updatePointer(pageIndex) {\n            this.curTips && this.curTips.html(pageIndex + 1);\n        }\n    }, {\n        key: 'bindButtonsEvent',\n        value: function bindButtonsEvent(bar) {\n            var that = this;\n            bar.on(\"touchend mouseup\", function (e) {\n                var type = Xut.plat.evtTarget(e).id;\n                switch (type) {\n                    case \"xut-nav-backhome\":\n                        that.homeControl();\n                        break;\n                    case \"xut-nav-backdir\":\n                        that.navigationBar();\n                        break;\n                    case 'xut-nav-hidebar':\n                        that.hideTopBar();\n                        break;\n                }\n            });\n        }\n\n        /**\r\n         * [ 跳转处理]\r\n         * @return {[type]} [description]\r\n         */\n\n    }, {\n        key: 'homeControl',\n        value: function homeControl() {\n            if (window.DUKUCONFIG) {\n                Xut.Application.Suspend({\n                    dispose: function dispose() {\n                        Xut.Application.DropApp(); //退出应用\n                    },\n                    processed: function processed() {\n                        Xut.Application.DropApp(); //退出应用\n                    }\n                });\n                return;\n            }\n\n            Xut.Application.Suspend({\n                dispose: function dispose(promptMessage) {\n                    //停止热点动作\n                    //promptMessage('再按一次将跳至首页！')\n                },\n                processed: function processed() {\n                    Xut.View.GotoSlide(1); //调整到首页\n                }\n            });\n        }\n\n        /**\r\n         * [ 打开目录关闭当前页面活动热点]\r\n         * @return {[type]} [description]\r\n         */\n\n    }, {\n        key: 'navigationBar',\n        value: function navigationBar() {\n            (0, _index.createNavbar)(Xut.Presentation.GetPageIndex());\n        }\n\n        /**\r\n         * [ 显示顶部工具栏]\r\n         * @return {[type]} [description]\r\n         */\n\n    }, {\n        key: 'showTopBar',\n        value: function showTopBar() {\n            var that = this;\n\n            if (this.barStatus) {\n                this.Lock = false;\n                return;\n            }\n            this.controlBar.css({\n                'display': 'block',\n                'opacity': 0\n            });\n\n            setTimeout(function () {\n                that.controlBar && that.controlBar.animate({\n                    'opacity': 1\n                }, that.delay, 'linear', function () {\n                    (0, _index.closeNavbar)();\n                    that.showSystemBar();\n                    that.barStatus = true;\n                    that.Lock = false;\n                });\n            });\n        }\n\n        /**\r\n         * [ 隐藏顶部工具栏]\r\n         * @return {[type]} [description]\r\n         */\n\n    }, {\n        key: 'hideTopBar',\n        value: function hideTopBar() {\n            var that = this;\n\n            if (!this.barStatus) {\n                this.Lock = false;\n                return;\n            }\n\n            this.controlBar.animate({\n                'opacity': 0\n            }, that.delay, 'linear', function () {\n                (0, _index.closeNavbar)();\n                that.controlBar.hide();\n                that.hideSystemBar();\n                that.barStatus = false;\n                that.Lock = false;\n            });\n        }\n\n        //销毁 \n\n    }, {\n        key: 'destroy',\n        value: function destroy() {\n            this.controlBar.off();\n            this.controlBar = null;\n            this.arrows = null;\n            this.curTips = null;\n            this.barStatus = false;\n        }\n    }]);\n\n    return sysBar;\n}(_bar2.default);\n\nexports.default = sysBar;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/lib/toolbar/sysbar.js\n ** module id = 151\n ** module chunks = 0\n **/"],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;","sourceRoot":""}