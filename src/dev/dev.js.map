{"version":3,"sources":["webpack:///webpack/bootstrap 68820e0ab4ea4f1e7e93","webpack:///./src/lib/app.js","webpack:///./src/lib/init/index.js","webpack:///./src/lib/component/audio/manager.js","webpack:///./src/lib/util/index.js","webpack:///./src/lib/util/lang.js","webpack:///./src/lib/util/dom.js","webpack:///./src/lib/util/loader.js","webpack:///./src/lib/util/stroage.js","webpack:///./src/lib/util/option.js","webpack:///./src/lib/util/notice.js","webpack:///./src/lib/util/buffer.js","webpack:///./src/lib/util/execute.js","webpack:///./src/lib/component/audio/audio.js","webpack:///./src/lib/component/audio/action.js","webpack:///./src/lib/component/audio/subtitle.js","webpack:///./src/lib/component/video/manager.js","webpack:///./src/lib/component/video/video.js","webpack:///./src/lib/init/data.js","webpack:///./src/lib/init/cursor.js","webpack:///./src/lib/external.js","webpack:///./src/lib/scenario/controller.js","webpack:///./src/lib/scheduler/index.js","webpack:///./src/lib/scheduler/auto.js","webpack:///./src/lib/pagebase/thread/dispenser/bind.js","webpack:///./src/lib/pagebase/thread/dispenser/action.js","webpack:///./src/lib/component/action.js","webpack:///./src/lib/pagebase/thread/dispenser/content.js","webpack:///./src/lib/pagebase/thread/dispenser/media.js","webpack:///./src/lib/pagebase/thread/dispenser/widget.js","webpack:///./src/lib/component/widget/adapter.js","webpack:///./src/lib/component/widget/iframe.js","webpack:///./src/lib/component/widget/page/core.js","webpack:///./src/lib/component/widget/page/loader.js","webpack:///./src/lib/component/widget/page/data.js","webpack:///./src/lib/component/pixi/spiritesenior/manage.js","webpack:///./src/lib/component/pixi/spiritesenior/spirite.js","webpack:///./src/lib/pagebase/thread/dispenser/shownote.js","webpack:///./src/lib/component/ShowNote.js","webpack:///./src/lib/component/content/iscroll.js","webpack:///./src/lib/scheduler/trigger.js","webpack:///./src/lib/scheduler/suspend.js","webpack:///./src/lib/scheduler/original.js","webpack:///./src/lib/scheduler/recovery.js","webpack:///./src/lib/dispatcher.js","webpack:///./src/lib/toolbar/navbar.js","webpack:///./src/lib/init/scene.js","webpack:///./src/lib/scenario/factory.js","webpack:///./src/lib/scenario/layout.js","webpack:///./src/lib/toolbar/sysbar.js","webpack:///./src/lib/toolbar/base/toolBar.js","webpack:///./src/lib/toolbar/base/svgicon.js","webpack:///./src/lib/toolbar/base/iconconfig.js","webpack:///./src/lib/toolbar/fnbar.js","webpack:///./src/lib/toolbar/bookbar.js","webpack:///./src/lib/toolbar/bookmark.js","webpack:///./src/lib/manager/core.js","webpack:///./src/lib/observer/observe.js","webpack:///./src/lib/manager/globalevent.js","webpack:///./src/lib/manager/overrideapi.js","webpack:///./src/lib/manager/schedule.js","webpack:///./src/lib/manager/page.js","webpack:///./src/lib/manager/abstract.js","webpack:///./src/lib/pagebase/constor.js","webpack:///./src/lib/pagebase/pagebase.js","webpack:///./src/lib/pagebase/collection.js","webpack:///./src/lib/pagebase/translation.js","webpack:///./src/lib/pagebase/multievent.js","webpack:///./src/lib/component/content/event.js","webpack:///./src/lib/pagebase/threadtask.js","webpack:///./src/lib/manager/parser.js","webpack:///./src/lib/pagebase/thread/index.js","webpack:///./src/lib/pagebase/thread/container.js","webpack:///./src/lib/pagebase/thread/background.js","webpack:///./src/lib/pagebase/thread/contents.js","webpack:///./src/lib/pagebase/thread/content/data.js","webpack:///./src/lib/pagebase/thread/content/structure.js","webpack:///./src/lib/component/pixi/Container.js","webpack:///./src/lib/component/pixi/queue.js","webpack:///./src/lib/component/content/activity.js","webpack:///./src/lib/component/content/mix.js","webpack:///./src/lib/component/content/child.js","webpack:///./src/lib/component/content/animation.js","webpack:///./src/lib/component/content/plug/sprite.js","webpack:///./src/lib/component/pixi/sprite.js","webpack:///./src/lib/component/pixi/factory.js","webpack:///./src/lib/component/content/dep.js","webpack:///./src/lib/component/content/parallax.js","webpack:///./src/lib/component/content/searchbar.js","webpack:///./src/lib/component/content/bookmark.js","webpack:///./src/lib/component/content/htmlbox.js","webpack:///./src/lib/component/pixi/event.js","webpack:///./src/lib/component/content/nexttask.js","webpack:///./src/lib/pagebase/thread/components.js","webpack:///./src/lib/pagebase/canvasrelated.js","webpack:///./src/lib/util/edge.js","webpack:///./src/lib/manager/master.js","webpack:///./src/lib/data/index.js","webpack:///./src/lib/data/store.js","webpack:///./src/lib/manager/switch.js","webpack:///./src/lib/component/content/filter.js","webpack:///./src/lib/init/initprocess.js"],"names":[],"mappings":"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","file":"dev.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 68820e0ab4ea4f1e7e93\n **/","import { init } from './init/index'\r\n\r\n\r\n/**\r\n * 应用入口\r\n * @return {[type]} [description]\r\n */\r\nlet App = function() {\r\n    \r\n\r\n    //更新版本号记录\r\n    Xut.Version = 782;\r\n\r\n    /**\r\n     * 动态html文件挂载点\r\n     * 用于content动态加载js文件\r\n     * 目前暂时给epub使用，文本框\r\n     * @type {Object}\r\n     */\r\n    window.HTMLCONFIG = {}\r\n\r\n    /**\r\n     * \r\n     * 2015.10.19新增\r\n     * ibooks处理\r\n     * epub ibooks模式的配置文件\r\n     * 这个是在index.html中会传入几个值\r\n     * \r\n     *   window.IBOOKSCONFIG = {\r\n     *       compiled: true,\r\n     *       pageIndex: 1,\r\n     *       existSvg: true,\r\n     *       screenSize: {\r\n     *           \"width\": 718,\r\n     *           \"height\": 958\r\n     *       }\r\n     *   }\r\n     */\r\n    var IBOOKSCONFIG = window.IBOOKSCONFIG;\r\n   \r\n    //如果是IBOOS模式处理\r\n    //注入保持与数据库H5查询一致\r\n    if (IBOOKSCONFIG && IBOOKSCONFIG.data) {\r\n        _.each(IBOOKSCONFIG.data, function(data, tabName) {\r\n                data.item = function(index) {\r\n                    return this[index];\r\n                }\r\n            })\r\n            //ios上的ibooks模式\r\n            //直接修改改isBrowser模式\r\n        Xut.plat.isBrowser = true;\r\n        Xut.plat.isIOS = false;\r\n    }\r\n\r\n    //配置ibooks参数\r\n    Xut.IBooks = {\r\n\r\n        /**\r\n         * 当前页面编号\r\n         * @return {[type]} [description]\r\n         */\r\n        pageIndex: function() {\r\n            if (IBOOKSCONFIG) {\r\n                //当期页面索引1开始\r\n                return IBOOKSCONFIG.pageIndex + 1;\r\n            }\r\n        }(),\r\n\r\n        /**\r\n         * 是否存在svg\r\n         * @type {[type]}\r\n         */\r\n        existSvg: IBOOKSCONFIG ? IBOOKSCONFIG.existSvg : false,\r\n\r\n        /**\r\n         * 是否启动了ibooks模式\r\n         * @return {[type]} [description]\r\n         */\r\n        Enabled: function() {\r\n            return IBOOKSCONFIG ? true : false;\r\n        }(),\r\n\r\n        /**\r\n         * 全部对象\r\n         * @type {[type]}\r\n         */\r\n        CONFIG: IBOOKSCONFIG,\r\n\r\n        /**\r\n         * 运行期间\r\n         * @return {[type]} [description]\r\n         */\r\n        runMode: function() {\r\n            //确定为ibooks的运行状态\r\n            //而非预编译状态\r\n            if (IBOOKSCONFIG && !IBOOKSCONFIG.compiled) {\r\n                return true;\r\n            }\r\n            return false;\r\n        },\r\n        /**\r\n         * 编译期间\r\n         * @return {[type]} [description]\r\n         */\r\n        compileMode: function() {\r\n            //确定为ibooks的编译状态\r\n            //而非预编译状态\r\n            if (IBOOKSCONFIG && IBOOKSCONFIG.compiled) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n    }\r\n\r\n\r\n    //修复ios 安卓浏览器不能自动播放音频的问题 \r\n    //在加载时创建新的audio.video 用的时候更换\r\n    Xut.fix = Xut.fix || {};\r\n\r\n    //移动端浏览器平台\r\n    if (Xut.plat.isBrowser && (Xut.plat.isIOS || Xut.plat.isAndroid)) {\r\n        var fixaudio = function() {\r\n            if (!Xut.fix.audio) {\r\n                Xut.fix.audio = new Audio();\r\n                Xut.fix.video = document.createElement(\"Video\");\r\n                document.removeEventListener('touchstart', fixaudio, false);\r\n            }\r\n        };\r\n        document.addEventListener('touchstart', fixaudio, false);\r\n    }\r\n\r\n    init();\r\n}\r\n\r\n\r\n$(function() {\r\n    App()\r\n})\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/app.js\n **/","//预初始化\r\nimport { AudioManager } from '../component/audio/manager'\r\nimport { VideoManager } from '../component/video/manager'\r\nimport { loader, setRootfont } from '../util/index'\r\nimport { nextTask } from './data'\r\nimport {\r\n    loadVideo,\r\n    html5Video,\r\n    bindEvent\r\n}\r\nfrom './initprocess'\r\n \r\n\r\nexport function init() {\r\n\r\n    var config = Xut.config;\r\n    var isBrowser = config.isBrowser;\r\n\r\n    //绑定键盘事件\r\n    bindEvent(config)\r\n\r\n    //如果不是读库模式\r\n    //播放HTML5视频\r\n    //在IOS\r\n    if (!DUKUCONFIG && !GLOBALIFRAME && Xut.plat.isIOS) {\r\n        html5Video();\r\n    }\r\n \r\n    //Ifarme嵌套处理\r\n    //1 新阅读\r\n    //2 子文档\r\n    //=======\r\n    //3 pc\r\n    //4 ios/android\r\n    if (GLOBALIFRAME) {\r\n        creatDatabase(config);\r\n    } else {\r\n        //PC还是移动\r\n        if (isBrowser) {\r\n            loadApp(config);\r\n        } else {\r\n            //如果不是iframe加载,则创建空数据库\r\n            window.openDatabase(config.dbName, \"1.0\", \"Xxtebook Database\", config.dbSize);\r\n            //等待硬件加载完毕\r\n            document.addEventListener(\"deviceready\", creatDatabase, false);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * 如果是安卓桌面端\r\n * 绑定事件\r\n * 创建数据库\r\n * @return {[type]} [description]\r\n */\r\nfunction creatDatabase(config) {\r\n\r\n    //安卓上\r\n    if (Xut.plat.isAndroid) {\r\n\r\n        //预加载处理视频\r\n        //妙妙学不加载视频\r\n        //读库不加载视频\r\n        if (!MMXCONFIG && !DUKUCONFIG) {\r\n            loadVideo();\r\n        }\r\n\r\n        //不是子文档指定绑定按键\r\n        if (!SUbCONFIGT) {\r\n            Xut.Application.AddEventListener = function() {\r\n                GLOBALCONTEXT.document.addEventListener(\"backbutton\", config._event.back, false);\r\n                GLOBALCONTEXT.document.addEventListener(\"pause\", config._event.pause, false);\r\n            }\r\n        }\r\n    }\r\n\r\n    if (DUKUCONFIG) {\r\n        var PMS = PMS || require(\"PMS\");\r\n        PMS.bind(\"MagazineExit\", function() {\r\n            PMS.unbind();\r\n            Xut.Application.DropApp();\r\n        }, \"*\")\r\n    }\r\n\r\n\r\n\r\n    //拷贝数据库\r\n    Xut.Plugin.XXTEbookInit.startup(config.dbName, loadApp, function() {});\r\n};\r\n\r\n\r\n/**\r\n * 加载app应用\r\n * @param  {[type]} config [description]\r\n * @return {[type]}        [description]\r\n */\r\nfunction loadApp(config) {\r\n\r\n\r\n    //修正API接口\r\n    //iframe要要Xut.config\r\n    Xut.config.revised();\r\n\r\n    //加载横版或者竖版css\r\n    var baseCss = './css/' + (Xut.config.layoutMode) + '.css';\r\n    var svgsheet = './content/gallery/svgsheet.css';\r\n\r\n    var cssArr = [baseCss, svgsheet];\r\n    //是否需要加载svg\r\n    //如果是ibooks模式\r\n    //并且没有svg\r\n    //兼容安卓2.x\r\n    if (Xut.IBooks.Enabled && !Xut.IBooks.existSvg) {\r\n        cssArr = [baseCss]\r\n    }\r\n\r\n    //动态加载脚本\r\n    loader.load(cssArr, function() {\r\n        //修正全局字体\r\n        setRootfont();\r\n        nextTask();\r\n    }, null, true);\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/init/index.js\n **/","/**\r\n * 音频说明：\r\n *  一个音频播放有2种情况：\r\n *       1、自动播放该音频（autoPlay == true）\r\n *       2、手动播放该音频（点击触发点）\r\n *\r\n *   一个音频被停止有3种情况：\r\n *       1、手动暂停（点击触发点）\r\n *       2、同轨道的其他音频开始播放\r\n *       3、0轨道的音频开始播放\r\n *   特殊情况：\r\n *       0轨道的音频播放时，可以停止所有其他轨道的音频\r\n *       其他轨道的音频播放时，可以停止0轨道的音频\r\n *\r\n *   基于上面的条件，补充提示：\r\n *       同轨道只允许有一个自动播放的音频\r\n *       如果0轨道音频为自动播放，则其他轨道不允许有自动播放音频\r\n *       反之亦然，其他轨道有自动播放音频，则0轨道不允许有自动播放音频\r\n *\r\n *    ===================================================================================================\r\n *   该版本说明：\r\n *   一个音频被打断之后，就被销毁，不会在后续恢复播放，而只会重头开始播放\r\n *\r\n *  2014.12.1 版本升级\r\n *  原来只有热点音频，现在多了动画音频和节音频，所以音频管理需要调整,\r\n *  有两个要注意的地方：\r\n *  1. 由于在IOS上,new Audio操作会产生新的进程，且不释放，所以同一个音轨只新建一个音频实例\r\n *     为了防止交互点击时音频播放混乱，要先清除同音轨的上一个音频\r\n *  2. 节音频可以跨节共用，如,1,2,3节共用一个音频，那么在这些节之间跳转时不打断\r\n *\r\n */\r\n\r\nimport {\r\n    parseJSON,hash\r\n}\r\nfrom '../../util/index'\r\n\r\nimport {html5Audio} from './audio'\r\n\r\nfunction AudioManager() {\r\n\r\n    //动作标示\r\n    var ACTIVIT = 'hot'; //热点音频\r\n    var ANIMATE = 'content'; //动画音频\r\n    var SEASON = 'season'; //节音频\r\n\r\n    /**\r\n     * 容器合集\r\n     * 1 pageBox 当前待播放的热点音频\r\n     * 2 playBox 播放中的热点音频集合\r\n     */\r\n    //[type][pageId][queryId]\r\n    var pageBox, playBox;\r\n\r\n    function initBox() {\r\n        pageBox = hash();\r\n        //[type][pageId][queryId]\r\n        playBox = hash();\r\n    }\r\n\r\n    initBox();\r\n\r\n\r\n    //===============================================\r\n    //\r\n    //              预装配数据\r\n    //\r\n    //===============================================\r\n\r\n\r\n    /**\r\n     * 解析数据\r\n     * @param  {[type]} type    [description]\r\n     * @param  {[type]} queryId [description]\r\n     * @return {[type]}         [description]\r\n     */\r\n    function parseData(type, queryId) {\r\n        var data;\r\n        switch (type) {\r\n            case ANIMATE:\r\n                data = Xut.data.query('Video', queryId, true);\r\n                break;\r\n            case SEASON:\r\n                data = Xut.data.query('Video', queryId, true);\r\n                break;\r\n            default:\r\n                data = Xut.data.query('Video', queryId);\r\n                break;\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * 获取父容器\r\n     * @return {[type]} [description]\r\n     */\r\n    function getParentDom(subtitles, pageId, queryId) {\r\n        //字幕数据\r\n        var parentDoms = hash();\r\n        var ancestorDoms = hash();\r\n        var contentsFragment;\r\n        var dom;\r\n        var pageIndex = (pageId - 1);\r\n        if (subtitles) {\r\n            //获取文档节点\r\n            contentsFragment = Xut.Contents.contentsFragment[pageId];\r\n\r\n            //如果maskId大于9000默认为处理\r\n            var isMask = pageId > 9000;\r\n            if (isMask) {\r\n                //指定页码编号\r\n                pageIndex = Xut.Presentation.GetPageIndex();\r\n            }\r\n\r\n            //找到对应的节点\r\n            _.each(subtitles, function(data) {\r\n                //'Content_0_1' 规则 类型_页码（0开始）_id\r\n                if (!parentDoms[data.id]) {\r\n                    dom = contentsFragment['Content_' + pageIndex + '_' + data.id];\r\n                    ancestorDoms[data.id] = dom;\r\n                    var $dom = $(dom);\r\n                    if ($dom.length) {\r\n                        var _div = $dom.find('div').last();\r\n                        if (_div.length) {\r\n                            parentDoms[data.id] = _div[0]\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        }\r\n\r\n        return {\r\n            parents: parentDoms,\r\n            ancestors: ancestorDoms\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 检测数据是否存在\r\n     * @return {[type]}         [description]\r\n     */\r\n    function checkRepeat(pageId, queryId, type) {\r\n        var pBox = pageBox[type];\r\n        if (pBox && pBox[pageId] && pBox[pageId][queryId]) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * 组合热点音频数据结构\r\n     * data, pageId, queryId, type\r\n     * 数据，页码编号，videoId, 查询的类型\r\n     * @return {[type]}         [description]\r\n     */\r\n    function combination(data, pageId, queryId, type, eleName) {\r\n        var tempDoms;\r\n        if (!pageBox[type]) {\r\n            pageBox[type] = hash();\r\n        }\r\n        if (!pageBox[type][pageId]) {\r\n            pageBox[type][pageId] = hash();\r\n        }\r\n        //有字幕处理\r\n        if (data.theTitle) {\r\n            var subtitles = parseJSON(data.theTitle);\r\n        }\r\n        //配置音频结构\r\n        return pageBox[type][pageId][queryId] = {\r\n            'trackId': data.track, //音轨\r\n            'url': data.md5, //音频名字\r\n            'subtitles': subtitles,\r\n            'audioId': queryId,\r\n            'data': data\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 装配音频数据\r\n     * @param  {int} pageId    页面id或节的分组id\r\n     * @param  {int} queryId   查询id,支持activityId,audioId\r\n     * @param  {string} type   音频来源类型[动画音频,节音频,热点音频]\r\n     */\r\n    function deployAudio(pageId, queryId, type, actionData) {\r\n        //避免复重查询\r\n        if (checkRepeat(pageId, queryId, type)) {\r\n            return false;\r\n        }\r\n        //解析合集数据\r\n        var data = parseData(type, queryId);\r\n        //存在音频文件\r\n        if (data && data.md5) {\r\n            //新的查询\r\n            var ret = combination(data, pageId, queryId, type, actionData);\r\n            //混入新的动作数据\r\n            //2015.9.24\r\n            //音频替换图片\r\n            //触发动画\r\n            if (actionData) {\r\n                _.extend(ret, actionData, {\r\n                    action: true //快速判断存在动作数据\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    //===============================================\r\n    //\r\n    //              初始化加载音频\r\n    //\r\n    //===============================================\r\n\r\n\r\n    /**\r\n     * 检查要打断的音频\r\n     * @param  {[type]} type    音频类型\r\n     * @param  {[type]} pageId  [description]\r\n     * @param  {[type]} queryId [description]\r\n     * @param  {[type]} pageBox [description]\r\n     * @return {boolen}         不打断返回true,否则返回false\r\n     */\r\n    function checkBreakAudio(type, pageId, queryId, pageBox) {\r\n        var playObj = playBox[type][pageId][queryId],\r\n            trackId = pageBox.trackId,\r\n            _trackId = playObj.trackId;\r\n\r\n        //如果是节音频，且地址相同，则不打断\r\n        if (type == SEASON && playObj.url == pageBox.url) {\r\n            return true;\r\n        }\r\n\r\n        //如果要用零音轨||零音轨有音乐在播||两音轨相同\r\n        //则打断\r\n        if (trackId == 0 || _trackId == 0 || trackId == _trackId) {\r\n            playObj.end();\r\n            delete playBox[type][pageId][queryId];\r\n        }\r\n        return false;\r\n    }\r\n\r\n\r\n    /**\r\n     * 播放音频之前检查\r\n     * @param  {int} pageId    [description]\r\n     * @param  {int} queryId    查询id\r\n     * @param  {string} type    决定video表按哪个字段查询\r\n     * @return {object}         音频对象/不存在为null\r\n     */\r\n    function preCheck(pageId, queryId, type) {\r\n        var t, p, q,\r\n            playObj = pageBox[type][pageId][queryId],\r\n            seasonAudio = null;\r\n        for (t in playBox) {\r\n            for (p in playBox[t]) {\r\n                for (q in playBox[t][p]) {\r\n                    if (checkBreakAudio(t, p, q, playObj)) {\r\n                        seasonAudio = playBox[t][p][q];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return seasonAudio;\r\n    }\r\n\r\n\r\n    /**\r\n     * 加载音频对象\r\n     * @return {[type]}         [description]\r\n     */\r\n    function loadAudio(pageId, queryId, type) {\r\n        //找到页面对应的音频\r\n        //类型=》页面=》指定音频Id\r\n        var pageObj = pageBox[type][pageId][queryId];\r\n        //检测\r\n        var seAudio = preCheck(pageId, queryId, type);\r\n\r\n        //播放音频时关掉视频\r\n        Xut.VideoManager.clearVideo();\r\n\r\n        //构建播放列表\r\n        if (!playBox[type]) {\r\n            playBox[type] = hash();\r\n        }\r\n        if (!playBox[type][pageId]) {\r\n            playBox[type][pageId] = hash();\r\n        }\r\n        //假如有字幕信息\r\n        //找到对应的文档对象\r\n        if (pageObj.subtitles) {\r\n            var tempDoms = getParentDom(pageObj.subtitles, pageId, queryId);\r\n        }\r\n\r\n        //播放完成处理\r\n        pageObj.innerCallback = function(audio) {\r\n            if (playBox[type] && playBox[type][pageId] && playBox[type][pageId][queryId]) {\r\n                audio.end();\r\n                delete playBox[type][pageId][queryId];\r\n            }\r\n        }\r\n\r\n\r\n        //new播放对象\r\n        var newObj = seAudio || new html5Audio(pageObj, tempDoms);\r\n        newObj.play();\r\n\r\n        //存入播放对象池\r\n        playBox[type][pageId][queryId] = newObj;\r\n    }\r\n\r\n\r\n    /**\r\n     * 交互点击\r\n     * @param  {int} pageId     [description]\r\n     * @param  {int} queryId    [description]\r\n     * @param  {string} type    ACTIVIT\r\n     * @return {[type]}         [description]\r\n     */\r\n    function loadTiggerAudio(pageId, queryId, type) {\r\n        var playObj, status;\r\n        if (playBox[type] && playBox[type][pageId] && playBox[type][pageId][queryId]) {\r\n            playObj = playBox[type][pageId][queryId];\r\n            status = playObj.audio ? playObj.status : null;\r\n        }\r\n        switch (status) {\r\n            case 'playing':\r\n                playObj.pause();\r\n                break;\r\n            case 'paused':\r\n                playObj.play();\r\n                break;\r\n            default:\r\n                loadAudio(pageId, queryId, type);\r\n                break;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 清理全部音频\r\n     * @return {[type]} [description]\r\n     */\r\n    function removeAudio() {\r\n        var flag = false,\r\n            t, p, a;\r\n        for (t in playBox) {\r\n            for (p in playBox[t]) {\r\n                for (a in playBox[t][p]) {\r\n                    playBox[t][p][a].end();\r\n                    flag = true;\r\n                }\r\n            }\r\n        }\r\n        initBox();\r\n        return flag;\r\n    }\r\n\r\n    var out = {\r\n\r\n        ///////////////////\r\n        //1 独立音频处理, 音轨/跨页面 //\r\n        //2 动画音频,跟动画一起播放与销毁\r\n        ///////////////////\r\n\r\n        //自动播放触发接口\r\n        autoPlay: function(pageId, activityId, actionData) {\r\n            deployAudio(pageId, activityId, ACTIVIT, actionData);\r\n            loadAudio(pageId, activityId, ACTIVIT);\r\n        },\r\n\r\n        //手动触发\r\n        trigger: function(pageId, activityId, actionData) {\r\n            deployAudio(pageId, activityId, ACTIVIT, actionData);\r\n            loadTiggerAudio(pageId, activityId, ACTIVIT);\r\n        },\r\n\r\n\r\n        //动画音频触发接口\r\n        contentAudio: function(pageId, audioId) {\r\n            deployAudio(pageId, audioId, ANIMATE);\r\n            loadAudio(pageId, audioId, ANIMATE);\r\n        },\r\n\r\n        //节音频触发接口\r\n        seasonAudio: function(seasonAudioId, audioId) {\r\n            deployAudio(seasonAudioId, audioId, SEASON);\r\n            loadAudio(seasonAudioId, audioId, SEASON);\r\n        },\r\n\r\n        //挂起音频\r\n        hangUpAudio: function() {\r\n            var t, p, a;\r\n            for (t in playBox) {\r\n                for (p in playBox[t]) {\r\n                    for (a in playBox[t][p]) {\r\n                        playBox[t][p][a].pause();\r\n                    }\r\n                }\r\n            }\r\n        },\r\n\r\n        //销毁动画音频\r\n        clearContentAudio: function(pageId) {\r\n            if (!playBox[ANIMATE] || !playBox[ANIMATE][pageId]) {\r\n                return false;\r\n            }\r\n            var playObj = playBox[ANIMATE][pageId];\r\n            if (playObj) {\r\n                for (var i in playObj) {\r\n                    playObj[i].end();\r\n                    delete playBox[ANIMATE][pageId][i];\r\n                }\r\n            }\r\n        },\r\n\r\n        //清理音频\r\n        clearAudio: function(pageId) {\r\n            if (pageId) { //如果只跳槽关闭动画音频\r\n                out.clearContentAudio(pageId);\r\n            } else {\r\n                removeAudio(); //多场景模式,不处理跨页面\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n    return out;\r\n};\r\n\r\n\r\nXut.AudioManager = AudioManager();\r\n\r\nexport {\r\n    AudioManager\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/audio/manager.js\n **/","export * from './lang'\r\nexport * from './dom'\r\nexport * from './loader'\r\nexport * from './stroage'\r\nexport * from './option'\r\nexport * from './buffer'\r\nexport * from './execute'\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/index.js\n **/","//定义属性\r\nvar def = Object.defineProperty;\r\n\r\n/**\r\n * 定义一个新的对象\r\n * 重写属性\r\n */\r\nexport function defProtected(obj, key, val, enumerable, writable) {\r\n    def(obj, key, {\r\n        value: val,\r\n        enumerable: enumerable,\r\n        writable: writable,\r\n        configurable: true\r\n    })\r\n}\r\n\r\n/**\r\n * 定义访问控制器\r\n * @return {[type]} [description]\r\n */\r\nexport function defAccess(obj, key, access) {\r\n    def(obj, key, {\r\n        get: access.get,\r\n        set: access.set\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 转化数组\r\n * @param  {[type]} o [description]\r\n * @return {[type]}   [description]\r\n */\r\nexport function toNumber(o) {\r\n    return Number(o) || null;\r\n};\r\n\r\n/**\r\n * 保证有效值\r\n * @return {[type]} [description]\r\n */\r\nexport function toEmpty(val) {\r\n    return Number(val);\r\n}\r\n\r\n/**\r\n * 简单继承\r\n * @return {[type]} [description]\r\n */\r\nexport function extend(subClass, superClass) {\r\n    var F = function() {};\r\n    // 只继承了superClass超级类中的方法并不包括属性（如果是定义在构造函数中，不在prototype里）\r\n    F.prototype = superClass.prototype;　\r\n    // 因为F()函数只继承了超级类中prototype中的方法并没有其相关属性，所以subClass.prototype也只有superClass中的方法。　 \r\n    var fProto = new F();\r\n    for (var k in fProto) {\r\n        if (subClass.prototype[k]) {\r\n            console.log('子类与超类的方法名重叠了！')\r\n        } else {\r\n            subClass.prototype[k] = fProto[k]\r\n        }\r\n    }\r\n    subClass.prototype.constructor = subClass;\r\n    superClass = null;\r\n}\r\n\r\n\r\n/**\r\n * 迷你版的deferred\r\n */\r\nexport function deferred(func, context) {\r\n    if (this instanceof Deferred === false) {\r\n        return new Deferred(func)\r\n    }\r\n    var tuple = [];\r\n    var promise = {\r\n        resolve: function() {\r\n            var t = tuple.shift(),\r\n                n;\r\n            t && (n = t.apply(null, arguments), n instanceof Deferred && (n.tuple = tuple));\r\n        },\r\n        then: function(n) {\r\n            return tuple.push(n), this;\r\n        }\r\n    }\r\n    if (func) {\r\n        func.call(context || promise, promise.resolve);\r\n    }\r\n    return promise;\r\n};\r\n\r\n\r\n/**\r\n * 缩放比\r\n * @param  {[type]} width  [description]\r\n * @param  {[type]} height [description]\r\n * @param  {[type]} left   [description]\r\n * @param  {[type]} top    [description]\r\n * @return {[type]}        [description]\r\n */\r\nfunction fiexdProportion(width, height, left, top) {\r\n    var proportion = Xut.config.proportion;\r\n    return {\r\n        width: width * proportion.width,\r\n        height: height * proportion.height,\r\n        left: left * proportion.left,\r\n        top: top * proportion.top\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 修正元素尺寸\r\n * @param  {[type]} results [description]\r\n * @return {[type]}         [description]\r\n */\r\nexport function revisesize(results) {\r\n    //不同设备下缩放比计算\r\n    var layerSize = fiexdProportion(results.width, results.height, results.left, results.top);\r\n    //新的背景图尺寸\r\n    var backSize = fiexdProportion(results.backwidth, results.backheight, results.backleft, results.backtop);\r\n\r\n    //赋值新的坐标\r\n    results.scaleWidth = Math.ceil(layerSize.width);\r\n    results.scaleHeight = Math.ceil(layerSize.height);\r\n    results.scaleLeft = Math.floor(layerSize.left);\r\n    results.scaleTop = Math.floor(layerSize.top);\r\n\r\n    //背景坐标\r\n    results.scaleBackWidth = Math.ceil(backSize.width);\r\n    results.scaleBackHeight = Math.ceil(backSize.height);\r\n    results.scaleBackLeft = Math.floor(backSize.left);\r\n    results.scaleBackTop = Math.floor(backSize.top);\r\n\r\n    return results;\r\n}\r\n\r\n\r\n/**\r\n * 全局字体修复\r\n * @return {[type]} [description]\r\n */\r\nexport function setRootfont() {\r\n    var rootSize = 16;\r\n    switch (window.innerWidth + window.innerHeight) {\r\n        case 3000: //1920+1080\r\n            //samsumg galaxy s4\r\n            rootSize = 32;\r\n            break;\r\n        case 2000: //1280+720\r\n            //HD Android phone\r\n            rootSize = 26;\r\n            break;\r\n        case 2048: //1280+768\r\n            rootSize = Xut.plat.isIpad ? 16 : 26;\r\n            break;\r\n        case 1624: //1024+600\r\n            rootSize = 18;\r\n            break;\r\n        case 888: //568+320\r\n            rootSize = 12;\r\n            break;\r\n        case 800: //480+320\r\n            rootSize = 14;\r\n            break;\r\n        case 560: //320+240\r\n            rootSize = 12;\r\n            break;\r\n        default:\r\n            //其他分辨率 取默认值\r\n            break;\r\n    }\r\n    16 != rootSize && $(\"html\").css(\"font-size\", rootSize + \"px\");\r\n}\r\n\r\n\r\n\r\nexport function portExtend(object, config) {\r\n    for (var i in config) {\r\n        if (i) {\r\n            if (object[i]) {\r\n                console.log('接口方法重复', 'Key->' + i, 'Value->' + object[i])\r\n            } else {\r\n                object[i] = config[i];\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n\r\n\r\n/**\r\n * 修正判断是否存在处理\r\n * @param  {[type]} arr [description]\r\n * @return {[type]}     [description]\r\n */\r\nexport function arrayUnique(arr) { //去重\r\n    if (arr && arr.length) {\r\n        var length = arr.length;\r\n        while (--length) {\r\n            //如果在前面已经出现，则将该位置的元素删除\r\n            if (arr.lastIndexOf(arr[length], length - 1) > -1) {\r\n                arr.splice(length, 1);\r\n            }\r\n        }\r\n        return arr;\r\n    } else {\r\n        return arr\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/lang.js\n **/","\r\n/**\r\n * /解析json字符串\r\n * @param  {[type]} itemArray [description]\r\n * @return {[type]}           [description]\r\n */\r\nexport function parseJSON(itemArray) {\r\n    var anminJson;\r\n    try {\r\n        anminJson = JSON.parse(itemArray);\r\n    } catch (error) {\r\n        console.log('parseJSON失败')\r\n        // anminJson = (new Function(\"return \" + itemArray))();\r\n    }\r\n    return anminJson;\r\n}\r\n\r\n\r\nexport function execJson(itemArray) {\r\n    var json;\r\n    try {\r\n        json = (new Function(\"return \" + itemArray))();\r\n    } catch (error) {\r\n        console.log('解析json出错'+ itemArray)\r\n    }\r\n    return json;\r\n}\r\n\r\n\r\n/**\r\n * 创建一个纯存的hash对象\r\n */\r\nexport function hash() {\r\n    return Object.create(null)\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/dom.js\n **/","/**\r\n * 资源加载\r\n * @return {[type]} [description]\r\n */\r\nvar loader = function() {\r\n    return {\r\n        /**入口函数,动态脚本加载\r\n         * @param fileList:           需要动态加载的资源列表\r\n         * @param callback:           所有资源都加载完后调用的回调函数,通常是页面上需要onload就执行的函数\r\n         * @param scope:              作用范围\r\n         * @param preserveOrder:      是否保持脚本顺序\r\n         */\r\n        load: function(fileList, callback, scope, preserveOrder) {\r\n            //过来数组元素\r\n            if (fileList.length && preserveOrder) {\r\n                var temp = [];\r\n                fileList.forEach(function(val, index) {\r\n                    if (val) {\r\n                        temp.push(val);\r\n                    }\r\n                })\r\n                fileList = temp.reverse();\r\n                temp = null;\r\n            }\r\n\r\n            var scope = scope || this,\r\n                //var scope =this,//默认作用范围是当前页面\r\n                head = document.getElementsByTagName(\"head\")[0],\r\n                fragment = document.createDocumentFragment(),\r\n                numFiles = fileList.length,\r\n                loadedFiles = 0;\r\n\r\n            //加载一个特定的文件从fileList通过索引\r\n            var loadFileIndex = function(index) {\r\n                head.appendChild(scope.buildScriptTag(fileList[index], onFileLoaded));\r\n            };\r\n\r\n            /**\r\n             * 调用回调函数,当所有文件都加载完后调用\r\n             */\r\n            var onFileLoaded = function() {\r\n                loadedFiles++;\r\n                //如果当前文件是最后一个要加载的文件，则调用回调函数，否则加载下一个文件\r\n                if (numFiles == loadedFiles && typeof callback == 'function') {\r\n                    callback.call(scope);\r\n                } else {\r\n                    if (preserveOrder === true) {\r\n                        loadFileIndex(loadedFiles);\r\n                    }\r\n                }\r\n            };\r\n\r\n            if (preserveOrder === true) {\r\n                loadFileIndex.call(this, 0);\r\n            } else {\r\n                for (var i = 0, len = fileList.length; i < len; i++) {\r\n                    fragment.appendChild(this.buildScriptTag(fileList[i], onFileLoaded));\r\n                }\r\n                head.appendChild(fragment);\r\n            }\r\n        },\r\n\r\n        //构造javascript和link 标签\r\n        buildScriptTag: function(filename, callback) {\r\n            var exten = filename.substr(filename.lastIndexOf('.') + 1);\r\n            if (exten == 'js') {\r\n                var script = document.createElement('script');\r\n                script.type = \"text/javascript\";\r\n                script.src = filename;\r\n                script.onload = callback;\r\n                return script;\r\n            }\r\n            if (exten == 'css') {\r\n                var style = document.createElement('link');\r\n                style.rel = 'stylesheet';\r\n                style.type = 'text/css';\r\n                style.href = filename;\r\n                callback();\r\n                return style;\r\n            }\r\n        }\r\n    };\r\n}();\r\n\r\n\r\n\r\nfunction pollCss(node, callback) {\r\n    var sheet = node.sheet,\r\n        isLoaded;\r\n    var isOldWebKit = +navigator.userAgent\r\n        .replace(/.*AppleWebKit\\/(\\d+)\\..*/, \"$1\") < 536\r\n        // for WebKit < 536\r\n    if (isOldWebKit) {\r\n        if (sheet) {\r\n            isLoaded = true\r\n        }\r\n    }\r\n    // for Firefox < 9.0\r\n    else if (sheet) {\r\n        try {\r\n            if (sheet.cssRules) {\r\n                isLoaded = true\r\n            }\r\n        } catch (ex) {\r\n            // The value of `ex.name` is changed from \"NS_ERROR_DOM_SECURITY_ERR\"\r\n            // to \"SecurityError\" since Firefox 13.0. But Firefox is less than 9.0\r\n            // in here, So it is ok to just rely on \"NS_ERROR_DOM_SECURITY_ERR\"\r\n            if (ex.name === \"NS_ERROR_DOM_SECURITY_ERR\") {\r\n                isLoaded = true\r\n            }\r\n        }\r\n    }\r\n\r\n    setTimeout(function() {\r\n        if (isLoaded) {\r\n            // Place callback here to give time for style rendering\r\n            callback()\r\n        } else {\r\n            pollCss(node, callback)\r\n        }\r\n    }, 20)\r\n}\r\n\r\n\r\nfunction addOnload(node, callback, isCSS, url) {\r\n    var supportOnload = \"onload\" in node;\r\n    var isOldWebKit = +navigator.userAgent\r\n        .replace(/.*AppleWebKit\\/(\\d+)\\..*/, \"$1\") < 536\r\n        // for Old WebKit and Old Firefox\r\n    if (isCSS) {\r\n        setTimeout(function() {\r\n                pollCss(node, callback)\r\n            }, 1) // Begin after node insertion\r\n        return\r\n    }\r\n\r\n    if (supportOnload) {\r\n        node.onload = onload\r\n        node.onerror = function() {\r\n            onload()\r\n        }\r\n    } else {\r\n        node.onreadystatechange = function() {\r\n            if (/loaded|complete/.test(node.readyState)) {\r\n                onload()\r\n            }\r\n        }\r\n    }\r\n\r\n    function onload() {\r\n        // Ensure only run once and handle memory leak in IE\r\n        node.onload = node.onerror = node.onreadystatechange = null\r\n            // Remove the script to reduce memory leak\r\n        if (!isCSS) {\r\n            var head = document.getElementsByTagName(\"head\")[0] || document.documentElement;\r\n            head.removeChild(node)\r\n        }\r\n        // Dereference the node\r\n        node = null\r\n        callback()\r\n    }\r\n}\r\n\r\nfunction request(url, callback, charset) {\r\n    var IS_CSS_RE = /\\.css(?:\\?|$)/i,\r\n        isCSS = IS_CSS_RE.test(url),\r\n        node = document.createElement(isCSS ? \"link\" : \"script\");\r\n\r\n    if (charset) {\r\n        var cs = isFunction(charset) ? charset(url) : charset\r\n        if (cs) {\r\n            node.charset = cs\r\n        }\r\n    }\r\n    addOnload(node, callback, isCSS, url)\r\n    if (isCSS) {\r\n        node.rel = \"stylesheet\"\r\n        node.href = url\r\n    } else {\r\n        node.async = true\r\n        node.src = url\r\n    }\r\n    // For some cache cases in IE 6-8, the script executes IMMEDIATELY after\r\n    // the end of the insert execution, so use `currentlyAddingScript` to\r\n    // hold current node, for deriving url in `define` call\r\n    //currentlyAddingScript = node\r\n    var head = document.getElementsByTagName(\"head\")[0] || document.documentElement;\r\n    var baseElement = head.getElementsByTagName(\"base\")[0];\r\n    // ref: #185 & http://dev.jquery.com/ticket/2709\r\n    baseElement ?\r\n        head.insertBefore(node, baseElement) :\r\n        head.appendChild(node)\r\n        //currentlyAddingScript = null\r\n}\r\n\r\nlet loadfile = request\r\n\r\nexport {\r\n    loader,\r\n    request,\r\n    loadfile\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/loader.js\n **/","var dbId,\r\n    onlyId,\r\n    storage = window.localStorage;\r\n\r\nconst TAG = 'aaron'\r\n\r\n\r\n//如果数据库为写入appid ,则创建\r\nvar createAppid = function() {\r\n    //添加UUID\r\n    var appId = 'aaron-' + new Date().getDate();\r\n    //写入数据库\r\n    Xut.config.db && Xut.config.db.transaction(function(tx) {\r\n        tx.executeSql(\"UPDATE Setting SET 'value' = \" + appId + \" WHERE [name] = 'appId'\", function() {}, function() {});\r\n    }, function() {\r\n        //  callback && callback();\r\n    }, function() {\r\n        //  callback && callback();\r\n    });\r\n    return appId;\r\n}\r\n\r\n//过滤\r\nvar filter = function(key) {\r\n    //添加头部标示\r\n    if (onlyId) {\r\n        return key + onlyId;\r\n    } else {\r\n        if (!Xut.config.appUUID) {\r\n            Xut.config.appUUID = createAppid();\r\n        }\r\n        //子文档标记\r\n        if (SUbCONFIGT && SUbCONFIGT.dbId) {\r\n            onlyId = \"-\" + Xut.config.appUUID + \"-\" + SUbCONFIGT.dbId;\r\n        } else {\r\n            onlyId = \"-\" + Xut.config.appUUID;\r\n        }\r\n    }\r\n    return key + onlyId;\r\n};\r\n\r\n/**\r\n * *按索引值获取存储项的key\r\n * @param  {[type]} index [description]\r\n * @return {[type]}       [description]\r\n */\r\nexport function _key(index) { //本地方法\r\n    return storage.key(index);\r\n};\r\n\r\n/**\r\n * 设置localStorage\r\n * @param {[type]} key [description]\r\n * @param {[type]} val [description]\r\n */\r\nexport function _set(key, val) {\r\n    var setkey;\r\n\r\n    //ipad ios8.3setItem出问题\r\n    function set(key, val) {\r\n        try {\r\n            storage.setItem(key, val);\r\n        } catch (e) {\r\n            console.log('storage.setItem(setkey, key[i]);')\r\n        }\r\n    }\r\n\r\n    if (typeof key === 'object') {\r\n        for (var i in key) {\r\n            if (key.hasOwnProperty(i)) {\r\n                setkey = filter(i);\r\n                set(setkey, key[i])\r\n            }\r\n        }\r\n    } else {\r\n        key = filter(key);\r\n        set(key, val);\r\n    }\r\n};\r\n\r\n/**\r\n * 获取localstorage中的值\r\n * @param  {[type]} key [description]\r\n * @return {[type]}     [description]\r\n */\r\nexport function _get(key) {\r\n    key = filter(key);\r\n    return storage.getItem(key);\r\n};\r\n\r\n/**\r\n * 删除localStorage中指定项\r\n * @param  {[type]} key [description]\r\n * @return {[type]}     [description]\r\n */\r\nexport function _remove(key) {\r\n    key = filter(key);\r\n    storage.removeItem(key);\r\n};\r\n\r\n/**\r\n * 序列化\r\n * @return {[type]} [description]\r\n */\r\nexport function _fetch() {\r\n    return JSON.parse(get(name || TAG) || '[]');\r\n}\r\n\r\n\r\nexport function _save(name, val) {\r\n    set(name || TAG, JSON.stringify(val));\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/stroage.js\n **/","import {\r\n    messageBox as box\r\n}\r\nfrom './notice'\r\n\r\nimport { request } from './loader'\r\n\r\n\r\n/**\r\n * 执行脚本注入\r\n */\r\nexport function injectScript(code, type) {\r\n    //过滤回车符号\r\n    var enterReplace = function(str) {\r\n        return str.replace(/\\r\\n/ig, '').replace(/\\r/ig, '').replace(/\\n/ig, '');\r\n    }\r\n    try {\r\n        (new Function(\"return \" + enterReplace(code)))();\r\n    } catch (e) {\r\n        console.log('加载脚本错误', type)\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * [ 消息框]\r\n * @param  {[type]} message [description]\r\n * @return {[type]}         [description]\r\n */\r\nexport function messageBox(message) {\r\n    box(message);\r\n}\r\n\r\n\r\n\r\n//缩放比\r\nfunction fiexdProportion(width, height, left, top) {\r\n    var proportion = Xut.config.proportion;\r\n    return {\r\n        width: width * proportion.width,\r\n        height: height * proportion.height,\r\n        left: left * proportion.left,\r\n        top: top * proportion.top\r\n    }\r\n}\r\n\r\n/*\r\n * 修复元素的尺寸\r\n * @type {[type]}\r\n */\r\n\r\nexport function reviseSize(results) {\r\n    //不同设备下缩放比计算\r\n    var layerSize = fiexdProportion(results.width, results.height, results.left, results.top);\r\n    //新的背景图尺寸\r\n    var backSize = fiexdProportion(results.backwidth, results.backheight, results.backleft, results.backtop);\r\n\r\n    //赋值新的坐标\r\n    results.scaleWidth = Math.ceil(layerSize.width);\r\n    results.scaleHeight = Math.ceil(layerSize.height);\r\n    results.scaleLeft = Math.floor(layerSize.left);\r\n    results.scaleTop = Math.floor(layerSize.top);\r\n\r\n    //背景坐标\r\n    results.scaleBackWidth = Math.ceil(backSize.width);\r\n    results.scaleBackHeight = Math.ceil(backSize.height);\r\n    results.scaleBackLeft = Math.floor(backSize.left);\r\n    results.scaleBackTop = Math.floor(backSize.top);\r\n\r\n    return results;\r\n}\r\n\r\n\r\n/**\r\n *  读取SVG内容\r\n *  @return {[type]} [string]\r\n */\r\nexport function readFile(path, callback, type) {\r\n\r\n    var paths, name, data;\r\n    var config = Xut.config;\r\n\r\n    /**\r\n     * ibooks模式 单独处理svg转化策划给你js,加载js文件\r\n     * @param  {[type]} IBOOKSCONFIG [description]\r\n     * @return {[type]}              [description]\r\n     */\r\n    if (Xut.IBooks.CONFIG) {\r\n\r\n        //如果是.svg结尾\r\n        //把svg替换成js\r\n        if (/.svg$/.test(path)) {\r\n            path = path.replace(\".svg\", '.js')\r\n        }\r\n\r\n        //全路径\r\n        paths = Config.svgPath().replace(\"svg\", 'js') + path;\r\n        //文件名\r\n        name = path.replace(\".js\", '')\r\n\r\n        //加载脚本\r\n        request(paths, function() {\r\n            data = HTMLCONFIG[name] || IBOOKSCONFIG[name]\r\n            if (data) {\r\n                callback(data)\r\n                delete HTMLCONFIG[name];\r\n                delete IBOOKSCONFIG[name]\r\n            } else {\r\n                callback('编译:脚本加载失败,文件名:' + name);\r\n            }\r\n        })\r\n\r\n        return\r\n    }\r\n\r\n    //con str\r\n    //externalFile使用\r\n    //如果是js动态文件\r\n    //content的html结构\r\n    if (type === \"js\") {\r\n        paths = Config.svgPath() + path;\r\n        name = path.replace(\".js\", '')\r\n        request(paths, function() {\r\n            data = window.HTMLCONFIG[name];\r\n            if (data) {\r\n                callback(data)\r\n                delete window.HTMLCONFIG[name];\r\n            } else {\r\n                callback('运行：脚本加载失败,文件名:' + path);\r\n            }\r\n        })\r\n        return\r\n    }\r\n\r\n    //svg文件\r\n    //游览器模式\r\n    if (Xut.plat.isBrowser) {\r\n        $.ajax({\r\n            type: 'get',\r\n            dataType: 'html',\r\n            url: config.svgPath().replace(\"www/\", \"\") + path,\r\n            success: function(svgContent) {\r\n                callback(svgContent);\r\n            },\r\n            error: function(xhr, type) {\r\n                callback('ReadFile数据加载失败');\r\n                console.log('SVG' + path + '解析出错!');\r\n            }\r\n        })\r\n\r\n    } else {\r\n        //手机模式\r\n        Xut.Plugin.ReadAssetsFile.readAssetsFileAction(config.svgPath() + path, function(svgContent) {\r\n            callback(svgContent);\r\n        }, function(err) {\r\n            callback('数据加载失败');\r\n        });\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/option.js\n **/","/**\r\n * 提示信息\r\n * @param  {[type]} require [description]\r\n * @param  {[type]} exports [description]\r\n * @param  {[type]} module  [description]\r\n * @return {[type]}         [description]\r\n */\r\n\r\n\r\nlet msgBox\r\nlet toolTip\r\nlet config\r\n\r\n\r\n/**\r\n * 显示提示信息\r\n */\r\nfunction show(opts) {\r\n\r\n    var prop = config.proportion,\r\n        prefix = Xut.plat.prefixStyle,\r\n        fontsize = (prop.width + prop.height) * 0.5 + 'em',\r\n        content = opts.content,\r\n        time = opts.time || 3000,\r\n        css = {\r\n\t\t\t'font-size'        : fontsize,\r\n\t\t\t'background-image' : 'url(images/icons/nodeBig.png)',\r\n\t\t\t'z-index'          : 99999,\r\n\t\t\t'bottom'           : '1%',\r\n\t\t\t'left'             : '5%',\r\n\t\t\t'padding'          : '0.2em 0.5em',\r\n\t\t\t'color'            : 'white',\r\n\t\t\t'position'         : 'absolute'\r\n        };\r\n\r\n    if (!toolTip) {\r\n        toolTip = $('#toolTip');\r\n        toolTip.css(css);\r\n        toolTip.css(prefix('border-radius'), '5px');\r\n    } else {\r\n        toolTip.empty().show();\r\n    }\r\n\r\n    Xut.nextTick({\r\n        'container': toolTip,\r\n        'content': content\r\n    }, hide);\r\n}\r\n\r\n\r\n/**\r\n * [模拟alert提示框]\r\n * @param  {[type]} message [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction messageBox(message) {\r\n\r\n    config = Xut.config;\r\n\r\n    var size = config.screenSize,\r\n        width = size.width * 0.25,\r\n        Box = msgBox || $('#message'),\r\n        html = '<div class=\"messageBox\" style=\"width:' + width + 'px;\">' +\r\n        '<div class=\"messageTex\" style=\"line-height:2\">' + message + '</div>' +\r\n        '<div class=\"messageBtn\" style=\"line-height:1.5\">OK</div>' +\r\n        '</div>';\r\n\r\n    //remove the node when user click\r\n    Box.html(html).show().on(\"touchend mouseup\", function(e) {\r\n        if (e.target.className === 'messageBtn') {\r\n            this.innerHTML = '';\r\n            this.style.display = 'none';\r\n        }\r\n    });\r\n}\r\n\r\n\r\nfunction hide() {\r\n    setTimeout(function() {\r\n        toolTip.hide(1000)\r\n    }, 1500)\r\n}\r\n\r\nfunction destroy() {\r\n    msgBox = null;\r\n}\r\n\r\nexport {\r\n    messageBox,\r\n    show,\r\n    destroy\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/notice.js\n **/","/****************************************************\r\n *\r\n *         \t缓存池\r\n *\r\n * ***************************************************/\r\n//创建缓存\r\nfunction createCache() {\r\n    var keys = [];\r\n\r\n    function cache(key, value) {\r\n        if (keys.push(key) > 20) {\r\n            delete cache[keys.shift()];\r\n        }\r\n        return (cache[key] = value);\r\n    }\r\n    return cache;\r\n}\r\nvar contentCache = createCache()\r\n\r\nexport {contentCache}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/buffer.js\n **/","/**\r\n * 创建执行方法\r\n * @return {[type]} [description]\r\n */\r\nfunction createfactory(sql, fn) {\r\n    var key;\r\n    if (typeof sql === 'string') {\r\n        fn(key, sql);\r\n    } else {\r\n        for (key in sql) {\r\n            fn(key, sql[key]);\r\n        }\r\n    }\r\n}\r\n\r\n//模拟database获取数据\r\nfunction executeDB(sql, callback, errorCB, tName) {\r\n    //如果存在生成好的数据文件则直接取\r\n    if (window.SQLResult) {\r\n        if (window.SQLResult[tName]) {\r\n            var data = window.SQLResult[tName],\r\n                SQLResultSetRowList = {};\r\n\r\n            SQLResultSetRowList = {\r\n                length: Object.keys(data).length,\r\n                item: function(num) {\r\n                    return data[num];\r\n                }\r\n            };\r\n            callback(SQLResultSetRowList);\r\n        } else {\r\n            errorCB({\r\n                tName: ':table not exist!!'\r\n            });\r\n        }\r\n    } else { //否则分次查询数据\r\n        $.ajax({\r\n            url: Xut.config.onlineModeUrl,\r\n            dataType: 'json',\r\n            data: {\r\n                xxtsql: sql\r\n            },\r\n            success: function(rs) {\r\n                var data = rs,\r\n                    SQLResultSetRowList = {};\r\n                SQLResultSetRowList = {\r\n                    length: rs.length,\r\n                    item: function(num) {\r\n                        return data[num];\r\n                    }\r\n                };\r\n                callback(SQLResultSetRowList);\r\n            },\r\n            error: errorCB\r\n        })\r\n    }\r\n}\r\n\r\n//建立sql查询,\r\nexport function execute(selectSql, callback) {\r\n\r\n    var database = Xut.config.db,\r\n        tableName, //表名\r\n        successResults = {}, //成功的数据\r\n        tempClosure = [], //临时收集器\r\n        collectError = [], //收集错误查询\r\n        buildTotal = function() {\r\n            //如果只有一条\r\n            if (typeof selectSql === 'string') {\r\n                return 1;\r\n            } else {\r\n                return Object.keys(selectSql).length;\r\n            }\r\n        }();\r\n\r\n\r\n    createfactory(selectSql, function(key, value) {\r\n        //开始执行查询\r\n        createSelect(key || 'results', value);\r\n    })\r\n\r\n\r\n    /**\r\n     * 创建查询\r\n     */\r\n    function createSelect(key, value) {\r\n        buildTotal--;\r\n        tempClosure.push(executeTemplate(key, value));\r\n        0 === buildTotal && executeBuild();\r\n    }\r\n\r\n\r\n    /**\r\n     * 执行查询\r\n     * @return {[type]} [description]\r\n     */\r\n    function executeBuild() {\r\n        if (tempClosure.length) {\r\n            var temp = tempClosure.shift();\r\n            tableName = temp.tableName;\r\n            temp.execute();\r\n        } else {\r\n            //successResults['results'] 成功表数据\r\n            //collectError 失败表\r\n            callback(successResults['results'] ?\r\n                successResults['results'] : successResults, collectError);\r\n        }\r\n    }\r\n\r\n\r\n    //成功后方法\r\n    function success() {\r\n        executeBuild();\r\n    }\r\n\r\n    //失败\r\n    function errorCB(error) {\r\n        collectError.push(tableName);\r\n        console.log(\"数据查询错误 \" + error.message, '类型', tableName);\r\n        executeBuild();\r\n    }\r\n\r\n    /**\r\n     * 构建执行作用域\r\n     */\r\n    function executeTemplate(tName, sql) {\r\n        return {\r\n            tableName: tName,\r\n            execute: function() {\r\n                //查询\r\n                if (database) {\r\n                    database.transaction(function(tx) {\r\n                        tx.executeSql(sql, [], function(tx, result) {\r\n                            successResults[tName] = result.rows\r\n                        });\r\n                    }, errorCB, success);\r\n                } else {\r\n                    executeDB(sql, function(result) {\r\n                        successResults[tName] = result;\r\n                        success();\r\n                    }, errorCB, tName)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/execute.js\n **/","/**\r\n * 音频播放\r\n * @param  {[type]} global [description]\r\n * @return {[type]}        [description]\r\n */\r\nimport { Action } from './action'\r\nimport { Subtitle } from './subtitle'\r\nimport { hash } from '../../util/dom'\r\n\r\nlet Player = null\r\nlet noop = function() {}\r\nlet instance = hash() //存放不同音轨的一个实例\r\nlet html5Audio\r\n\r\n/**\r\n * 音频工厂类\r\n * @param {[type]} options [description]\r\n */\r\nvar AudioFactory = Xut.CoreObject.extend({\r\n\r\n    //构建之前关数据\r\n    preRelated: function(trackId, options) {\r\n        //完成end后 外部回调删除这个对象\r\n        //单独调用引用对象\r\n        //传递一个 options.complete\r\n        this.innerCallback = options.innerCallback;\r\n        //仅运行一次\r\n        //外部调用\r\n        this.outerCallback = trackId == 9999 ? options.complete : null;\r\n    },\r\n\r\n    //构建之后关数据\r\n    afterRelated: function(audio, options, controlDoms) {\r\n        //音频重复播放次数\r\n        if (options.data && options.data.repeat) {\r\n            this.repeat = Number(options.data.repeat); //需要重复\r\n        }\r\n        //音频动作\r\n        if (options.action) {\r\n            this.acitonObj = Action(options);\r\n        }\r\n        //字幕对象\r\n        if (options.subtitles && options.subtitles.length > 0) {\r\n            //创建字幕对象\r\n            this.subtitleObject = new Subtitle(audio, options, controlDoms);\r\n        }\r\n\r\n        //如果有外部回调处理\r\n        if (this.outerCallback) {\r\n            this.outerCallback.call(this);\r\n        }\r\n\r\n    },\r\n    //运行成功失败后处理方法\r\n    //phoengap会调用callbackProcess\r\n    //导致乱了\r\n    callbackProcess: function(sysCommand) {\r\n        if (this.outerCallback) { //外部调用结束\r\n            this.end();\r\n        } else {\r\n            //安卓没有重复播放\r\n            //phonegap未处理\r\n            if (!Xut.plat.isAndroid && this.repeat) {\r\n                //如果需要重复\r\n                this.repeatProcess();\r\n            } else {\r\n                //外部清理对象\r\n                //audioManager中直接删当前对象\r\n                this.innerCallback(this);\r\n            }\r\n        }\r\n    },\r\n\r\n    //重复处理\r\n    repeatProcess: function() {\r\n        --this.repeat;\r\n        this.play()\r\n    },\r\n\r\n    //播放\r\n    play: function() {\r\n        //flash模式不执行\r\n        if (this.audio && !this.isFlash) {\r\n            this.status = 'playing';\r\n            this.audio.play();\r\n        }\r\n        this.acitonObj && this.acitonObj.play();\r\n    },\r\n\r\n    //停止\r\n    pause: function() {\r\n        this.status = 'paused';\r\n        this.audio.pause();\r\n        this.acitonObj && this.acitonObj.pause();\r\n    },\r\n\r\n    //销毁\r\n    end: function() {\r\n        this.status = 'ended';\r\n        this.audio.end();\r\n        this.audio = null;\r\n        this.acitonObj && this.acitonObj.destroy();\r\n    },\r\n\r\n    //相关\r\n    destroyRelated: function() {\r\n        //销毁字幕\r\n        if (this.subtitleObject) {\r\n            this.subtitleObject.destroy()\r\n            this.subtitleObject = null;\r\n        }\r\n        //动作\r\n        if (this.acitonObj) {\r\n            this.acitonObj.destroy();\r\n            this.acitonObj = null;\r\n        }\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * 使用PhoneGap的Media播放\r\n * @param  {string} url 路径\r\n * @return {[type]}      [description]\r\n */\r\nvar _Media = AudioFactory.extend({\r\n\r\n    init: function(options, controlDoms) {\r\n\r\n        var url = Xut.config.audioPath() + options.url,\r\n            trackId = options.trackId,\r\n            self = this,\r\n            audio;\r\n\r\n        //构建之前处理\r\n        this.preRelated(trackId, options);\r\n\r\n        //音频成功与失败调用\r\n        audio = new GLOBALCONTEXT.Media(url, function() {\r\n            self.callbackProcess(true);\r\n        }, function() {\r\n            self.callbackProcess(true);\r\n        });\r\n\r\n        //autoplay\r\n        this.audio = audio;\r\n        this.trackId = trackId;\r\n        this.options = options;\r\n\r\n        //相关数据\r\n        this.afterRelated(audio, options, controlDoms);\r\n    },\r\n    //取反\r\n    end: function() {\r\n        if (this.audio) {\r\n            this.audio.release();\r\n            this.audio = null;\r\n        }\r\n        this.status = 'ended';\r\n        this.destroyRelated();\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * 采用Falsh播放\r\n * @type {[type]}\r\n */\r\nvar _Flash = AudioFactory.extend({\r\n    init: function(options, controlDoms) {\r\n        var trackId = options.trackId,\r\n            url = Xut.config.audioPath() + options.url,\r\n            self = this,\r\n            audio;\r\n\r\n        //构建之前处理\r\n        this.preRelated(trackId, options);\r\n\r\n        audio = new Audio5js({\r\n            swf_path: './lib/data/audio5js.swf',\r\n            throw_errors: true,\r\n            format_time: true,\r\n            ready: function(player) {\r\n                this.load(url);\r\n                //如果调用了播放\r\n                this.play()\r\n                self.status = \"playing\"\r\n            }\r\n        });\r\n\r\n        this.audio = audio;\r\n        this.trackId = trackId;\r\n        this.status = 'playing';\r\n        this.options = options;\r\n\r\n        this.isFlash = true;\r\n\r\n        //相关数据\r\n        this.afterRelated(audio, options, controlDoms);\r\n    },\r\n\r\n    end: function() {\r\n        if (this.audio) {\r\n            this.audio.destroy();\r\n            this.audio = null;\r\n        }\r\n        this.status = 'ended';\r\n        this.destroyRelated();\r\n    }\r\n})\r\n\r\n\r\n/**\r\n * 使用html5的audio播放\r\n * @param  {string} url    音频路径\r\n * @param  {object} options 可选参数\r\n * @return {object}         [description]\r\n */\r\nvar _Audio = AudioFactory.extend({\r\n    init: function(options, controlDoms) {\r\n        var trackId = options.trackId,\r\n            url = Xut.config.audioPath() + options.url,\r\n            self = this,\r\n            audio;\r\n\r\n        //构建之前处理\r\n        this.preRelated(trackId, options);\r\n\r\n        if (instance[trackId]) {\r\n            audio = Xut.fix.audio ? Xut.fix.audio : instance[trackId];\r\n            audio.src = url;\r\n        } else {\r\n            //create a new Audio instance\r\n            //如果为ios browser 用Xut.fix.audio 指定src 初始化见app.js\r\n            if (Xut.fix.audio) {\r\n                audio = Xut.fix.audio;\r\n                audio.src = url;\r\n            } else {\r\n                audio = new Audio(url);\r\n            }\r\n\r\n            //更新音轨\r\n            //妙妙学方式不要音轨处理\r\n            if (!Xut.fix.audio) {\r\n                instance[trackId] = audio;\r\n            }\r\n\r\n            audio.addEventListener('ended', function() {\r\n                self.callbackProcess()\r\n            }, false);\r\n\r\n            audio.addEventListener('error', function() {\r\n                self.callbackProcess()\r\n            }, false);\r\n        }\r\n\r\n        this.audio = audio;\r\n        this.trackId = trackId;\r\n        this.status = 'playing';\r\n        this.options = options;\r\n\r\n        //相关数据\r\n        this.afterRelated(audio, options, controlDoms);\r\n    },\r\n\r\n    end: function() {\r\n        if (this.audio) {\r\n            this.audio.pause();\r\n            this.audio.removeEventListener('ended', this.callbackProcess, false)\r\n            this.audio.removeEventListener('error', this.callbackProcess, false)\r\n            this.audio = null;\r\n        }\r\n        this.status = 'ended';\r\n        this.destroyRelated();\r\n    }\r\n})\r\n\r\n\r\n\r\nvar createUUID = function() {\r\n    return UUIDcreatePart(4) + '-' +\r\n        UUIDcreatePart(2) + '-' +\r\n        UUIDcreatePart(2) + '-' +\r\n        UUIDcreatePart(2) + '-' +\r\n        UUIDcreatePart(6);\r\n};\r\n\r\nfunction UUIDcreatePart(length) {\r\n    var uuidpart = \"\";\r\n    for (var i = 0; i < length; i++) {\r\n        var uuidchar = parseInt((Math.random() * 256), 10).toString(16);\r\n        if (uuidchar.length == 1) {\r\n            uuidchar = \"0\" + uuidchar;\r\n        }\r\n        uuidpart += uuidchar;\r\n    }\r\n    return uuidpart;\r\n}\r\n\r\n\r\n/**\r\n * 使用PhoneGap的 js直接调用 cordova Media播放\r\n * @param  {string} url 路径\r\n * @return {[type]}      [description]\r\n */\r\nvar _cordovaMedia = AudioFactory.extend({\r\n\r\n    init: function(options, controlDoms) {\r\n\r\n        var url = Xut.config.audioPath() + options.url,\r\n            trackId = options.trackId,\r\n            self = this,\r\n            audio;\r\n\r\n        this.id = createUUID();\r\n\r\n        //构建之前处理\r\n        this.preRelated(trackId, options);\r\n\r\n        var audio = {\r\n            startPlayingAudio: function() {\r\n                audioHandler.startPlayingAudio(self.id, url)\r\n            },\r\n            pausePlayingAudio: function() {\r\n                audioHandler.pausePlayingAudio(self.id)\r\n            },\r\n            release: function() {\r\n                audioHandler.release(self.id)\r\n            },\r\n            /**\r\n             * 扩充，获取位置\r\n             * @return {[type]} [description]\r\n             */\r\n            expansionCurrentPosition: function() {\r\n                return getCurrentPosition(self.id)\r\n            }\r\n        }\r\n\r\n        //autoplay\r\n        this.audio = audio;\r\n        this.trackId = trackId;\r\n        this.options = options;\r\n\r\n        //相关数据\r\n        this.afterRelated(audio, options, controlDoms);\r\n    },\r\n\r\n    //播放\r\n    play: function() {\r\n        if (this.audio) {\r\n            this.status = 'playing';\r\n            this.audio.startPlayingAudio();\r\n        }\r\n        this.acitonObj && this.acitonObj.play();\r\n    },\r\n\r\n    //停止\r\n    pause: function() {\r\n        this.status = 'paused';\r\n        this.audio && this.audio.pausePlayingAudio();\r\n        this.acitonObj && this.acitonObj.pause();\r\n    },\r\n\r\n\r\n    //结束\r\n    end: function() {\r\n        if (this.audio) {\r\n            this.audio.release();\r\n            this.audio = null;\r\n        }\r\n        this.status = 'ended';\r\n        this.destroyRelated();\r\n    }\r\n});\r\n\r\n\r\n\r\n/**\r\n * 检测是否支持HTML5的audio播放\r\n * @param  {[type]} success [description]\r\n * @param  {[type]} fail    [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction supportAudio(fail) {\r\n    try {\r\n        var audio = new Audio(\"lib/data/support.mp3\");\r\n        //如果错误\r\n        audio.addEventListener('error', function(e) {\r\n            audio = null;\r\n            fail()\r\n        }, false);\r\n    } catch (er) {}\r\n};\r\n\r\n\r\n//apk的情况下\r\nif (Xut.plat.isAndroid && !Xut.plat.isBrowser) {\r\n   html5Audio = _Media;\r\n} else {\r\n\r\n    //妙妙学的 客户端浏览器模式\r\n    if (MMXCONFIG && audioHandler) {\r\n       html5Audio = _cordovaMedia;\r\n    } else {\r\n        //pc\r\n       html5Audio = _Audio;\r\n    }\r\n\r\n    //2015.12.23\r\n    //如果不支持audio改用flash\r\n    // supportAudio(function() {\r\n    //     Xut.Audio = _Flash;\r\n    // });\r\n}\r\n\r\nXut.Audio =html5Audio\r\n\r\n\r\n\r\nexport {\r\n   html5Audio\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/audio/audio.js\n **/","/**\r\n * 音频动作\r\n * @param  {[type]} global [description]\r\n * @return {[type]}        [description]\r\n */\r\n\r\n//音频动作\r\n//替换背景图\r\n//指定动画\r\nexport function Action(options) {\r\n\r\n    var element = document.querySelector('#Audio_' + options.audioId)\r\n\r\n    //页面从属\r\n    var pageType = element.getAttribute('data-belong')\r\n\r\n    //切换背景\r\n    function toggle(linker) {\r\n        element.style.backgroundImage = 'url(' + Xut.conifg.pathAddress + linker + ')'\r\n    }\r\n\r\n    function run(ids) {\r\n        ids = ids.split(',');\r\n        Xut.Assist.Run(pageType, ids)\r\n    }\r\n\r\n    function stop(ids) {\r\n        ids = ids.split(',');\r\n        Xut.Assist.Stop(pageType, ids)\r\n    }\r\n    return {\r\n        play: function() {\r\n            options.startImg && toggle(options.startImg)\r\n            options.startScript && run(options.startScript);\r\n        },\r\n        pause: function() {\r\n            options.stopImg && toggle(options.stopImg)\r\n            options.stopScript && stop(options.startScript);\r\n        },\r\n        destroy: function() {\r\n            element = null;\r\n        }\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/audio/action.js\n **/","/**\r\n * 音频字幕\r\n * @param  {[type]} global [description]\r\n * @return {[type]}        [description]\r\n */\r\n//字幕检测时间\r\nvar Interval = 50;\r\n\r\nvar getStyles = function(elem, name) {\r\n    var styles = elem.ownerDocument.defaultView.getComputedStyle(elem, null);\r\n    return styles.getPropertyValue(name);\r\n};\r\n\r\n/**\r\n * 字幕类\r\n * audio  音频实例\r\n * options 参数\r\n */\r\nfunction Subtitle(audio, options, controlDoms) {\r\n\r\n    var visibility;\r\n    this.audio = audio;\r\n    this.options = options;\r\n    this.parents = controlDoms.parents;\r\n    this.ancestors = controlDoms.ancestors;\r\n\r\n    this.timer = 0;\r\n    //缓存创建的div节点\r\n    this.cacheCreateDivs = {};\r\n\r\n    //保存原始的属性\r\n    var orgAncestorVisibility = this.orgAncestorVisibility = {};\r\n    _.each(this.ancestors, function(node, cid) {\r\n        visibility = getStyles(node, 'visibility');\r\n        if (visibility) {\r\n            orgAncestorVisibility[cid] = visibility;\r\n        }\r\n    })\r\n\r\n    //去重记录\r\n    this.recordRepart = {};\r\n    //phonegap getCurrentPosition得到的音频播放位置不从0开始 记录起始位置\r\n    this.changeValue = 0;\r\n\r\n    //快速处理匹配数据\r\n    var checkData = {};\r\n    _.each(options.subtitles, function(data) {\r\n        checkData[data.start + '-start'] = data;\r\n        checkData[data.end + '-end'] = data;\r\n    })\r\n    this.createSubtitle(checkData);\r\n}\r\n\r\nSubtitle.prototype = {\r\n    /**\r\n     * 运行字幕\r\n     * @return {[type]}\r\n     */\r\n    createSubtitle: function(checkData) {\r\n        var self = this,\r\n            audio = this.audio,\r\n            options = this.options;\r\n\r\n        //准备创建字幕\r\n        function createAction(audioTime) {\r\n            _.each(checkData, function(data, key) {\r\n                var match = key.split('-');\r\n                //创建动作\r\n                self.action(match[0], audioTime, match[1], data);\r\n            })\r\n            self.createSubtitle(checkData);\r\n        }\r\n\r\n        function JudgePlat() {\r\n            var audioTime;\r\n            //phonegap\r\n            if (audio.getCurrentPosition) {\r\n                audio.getCurrentPosition(function(position) {\r\n                        position = position * 1000;\r\n                        if (!self.changeValue) {\r\n                            self.changeValue = position\r\n                        }\r\n                        position -= self.changeValue;\r\n                        if (position > -1) {\r\n                            audioTime = Math.round(position);\r\n                        }\r\n                        createAction(audioTime)\r\n                    },\r\n                    function(e) {\r\n                        console.log(\"error:\" + e);\r\n                        //出错继续检测\r\n                        self.createSubtitle(checkData);\r\n                    });\r\n            } else if (audio.expansionCurrentPosition) {\r\n                //扩充的对象\r\n                audioTime = Math.round(audio.expansionCurrentPosition() * 1000);\r\n                createAction(audioTime);\r\n            } else {\r\n                //html5\r\n                audioTime = Math.round(audio.currentTime * 1000);\r\n                createAction(audioTime);\r\n            }\r\n        }\r\n\r\n        self.timer = setTimeout(function() {\r\n            JudgePlat();\r\n        }, Interval);\r\n    },\r\n\r\n    //执行动作\r\n    //创建文本框\r\n    //显示/隐藏\r\n    action: function(currentTime, audioTime, action, data) {\r\n        if (audioTime > currentTime - Interval && audioTime < currentTime + Interval) {\r\n            //创建\r\n            if (!this.recordRepart[data.start] && action === 'start') {\r\n                this.recordRepart[data.start] = true;\r\n                //创建字幕dom\r\n                this.createDom(data);\r\n\r\n                //如果是一段字幕结束处理\r\n            } else if (!this.recordRepart[data.end] && action === 'end') {\r\n                this.recordRepart[data.end] = true;\r\n                // //隐藏\r\n                var ancestorNode = this.ancestors[data.id];\r\n                if (ancestorNode) {\r\n                    ancestorNode.style.visibility = \"hidden\"\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    createDom: function(data) {\r\n\r\n        //屏幕分辨率\r\n        var proportion = Xut.config.proportion;\r\n        var proportionWidth = proportion.width;\r\n        var proportionHeight = proportion.height;\r\n        var screenWidth = Xut.config.screenSize.width;\r\n        var screenHeight = Xut.config.screenSize.height;\r\n\r\n        var cid = data.id;\r\n        var parentNode = this.parents[cid];\r\n        var ancestorNode = this.ancestors[cid];\r\n        var preDiv = this.cacheCreateDivs[cid];\r\n        var preP = preDiv && preDiv.children[0];\r\n\r\n        //缩放\r\n        var sTop = data.top * proportion.top;\r\n        var sLeft = data.left * proportion.left;\r\n        var sHeight = data.height * proportion.height;\r\n        var sWidth = data.width * proportion.width;\r\n\r\n        //转换行高\r\n        var sLineHeight = data.lineHeight ? data.lineHeight : '100%';\r\n\r\n        //公用同一个contengid,已经存在\r\n        if (preDiv) {\r\n            createContent(preDiv, preP, data);\r\n        } else {\r\n            //创建父元素与子元素\r\n            var createDiv = document.createElement('div');\r\n            var createP = document.createElement('p');\r\n            //设置样式\r\n            createContent(createDiv, createP, data);\r\n            createDiv.appendChild(createP) //添加到指定的父元素  \r\n\r\n            parentNode.appendChild(createDiv);\r\n\r\n            //保存引用\r\n            this.cacheCreateDivs[cid] = createDiv;\r\n        }\r\n\r\n        //创建内容\r\n        function createContent(parent, p, data) {\r\n            createDivStyle(parent, data) //设置div\r\n            createPStyle(p, data)\r\n        }\r\n\r\n        //设置父容器div 字体颜色，大小，类型，位置，文本水平、垂直居中\r\n        function createDivStyle(parent, data) {\r\n            var cssText =\r\n                'position       :absolute; ' +\r\n                'display        :table;' +\r\n                'vertical-align :center;' +\r\n                'top            :{0}px;' +\r\n                'left           :{1}px;' +\r\n                'height         :{2}px;' +\r\n                'width          :{3}px;'\r\n\r\n            parent.style.cssText = String.format(cssText,\r\n                sTop,\r\n                sLeft,\r\n                sHeight,\r\n                sWidth\r\n            )\r\n        }\r\n\r\n        //内容元素的样式\r\n        function createPStyle(p, data) {\r\n\r\n            var cssText =\r\n                ' text-align     :center;' +\r\n                ' display        :table-cell;' +\r\n                ' vertical-align :middle;' +\r\n                ' color          :{0};' +\r\n                ' font-family    :{1};' +\r\n                ' font-bold      :{2};' +\r\n                ' font-size      :{3}px;' +\r\n                ' line-height    :{4}%';\r\n\r\n            //设置字体间距\r\n            p.style.cssText = String.format(\r\n                    cssText,\r\n                    data.fontColor,\r\n                    data.fontName,\r\n                    data.fontBold,\r\n                    data.fontSize * proportionWidth,\r\n                    sLineHeight\r\n                )\r\n                //设置文字内容\r\n            p.innerHTML = data.title;\r\n        }\r\n\r\n\r\n        //操作最外层的content节点\r\n        if (ancestorNode) {\r\n            var ancestorNodeValue = getStyles(ancestorNode, 'visibility')\r\n            if (ancestorNodeValue != 'visible') {\r\n                ancestorNode.style.visibility = 'visible';\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 清理音频\r\n     * @return {[type]}\r\n     */\r\n    destroy: function() {\r\n        var self = this;\r\n        _.each(this.cacheCreateDivs, function(node) {\r\n                node.parentNode.removeChild(node)\r\n            })\r\n            //恢复初始状态\r\n        _.each(this.ancestors, function(node, id) {\r\n            var orgValue = self.orgAncestorVisibility[id];\r\n            var currValue = getStyles(node, 'visibility')\r\n            if (currValue != orgValue) {\r\n                node.style.visibility = orgValue;\r\n            }\r\n        })\r\n        this.ancestors = null;\r\n        this.cacheCreateDivs = null;\r\n        this.changeValue = 0;\r\n        this.parents = null;\r\n        if (this.timer) {\r\n            clearTimeout(this.timer)\r\n            this.timer = 0;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport {\r\n    Subtitle\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/audio/subtitle.js\n **/","import {Html5Video} from './video'\r\n\r\n/*\r\n    视频和远程网页管理模块\r\n*/\r\n\r\n//综合管理video, webpage\r\nfunction VideoManager() {\r\n    this.pageBox = {}; //当前页面包含的视频数据\r\n    this.playBox = {}; //播放过的视频数据 （播放集合）\r\n}\r\n\r\n/**\r\n *  参数:\r\n *    pageId    就是chapterId,对应每一个页面\r\n *    videoId   对应每一个视频热点的ID\r\n *    container 容器\r\n */\r\n\r\nVideoManager.prototype = {\r\n\r\n    //=============消息接口================\r\n    //\r\n\r\n    //自动播放\r\n    autoPlay: function(pageId, activityId, container) {\r\n        this.initVideo.apply(this, arguments);\r\n    },\r\n\r\n    //手动播放\r\n    trigger: function(pageId, activityId, container) {\r\n        this.initVideo.apply(this, arguments);\r\n    },\r\n\r\n    //=================视频调用===========================\r\n\r\n    //触发视频\r\n    initVideo: function(pageId, activityId, container) {\r\n        //解析数据\r\n        this.parseVideo(pageId, activityId);\r\n        //调用播放\r\n        this.loadVideo(pageId, activityId, container);\r\n    },\r\n\r\n    //=================视频数据处理===========================\r\n\r\n    //处理重复数据\r\n    // 1:pageBox能找到对应的 videoId\r\n    // 2:重新查询数据\r\n    parseVideo: function(pageId, activityId) {\r\n        //复重\r\n        if (this.checkRepeat(pageId, activityId)) {\r\n            return;\r\n        }\r\n        var data = Xut.data.query('Video', activityId);\r\n        //新的查询\r\n        this.deployVideo(data, pageId, activityId);\r\n    },\r\n\r\n    //检测数据是否存在\r\n    checkRepeat: function(pageId, activityId) {\r\n        var chapterData = this.pageBox[pageId];\r\n        //如果能在pageBox找到对应的数据\r\n        if (chapterData && chapterData[activityId]) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    //配置视频结构\r\n    deployVideo: function(data, pageId, activityId) {\r\n        var proportion = Xut.config.proportion,\r\n            screenSize = Xut.config.screenSize,\r\n            videoInfo = {\r\n                'pageId': pageId,\r\n                'videoId': activityId,\r\n                'url': data.md5,\r\n                'pageUrl': data.url,\r\n                'left': data.left * proportion.left || 0,\r\n                'top': data.top * proportion.top || 0,\r\n                'width': data.width * proportion.width || screenSize.width,\r\n                'height': data.height * proportion.height || screenSize.height,\r\n                'padding': data.padding * proportion.left || 0,\r\n                'zIndex': data.zIndex || 2147483647,\r\n                'background': data.background,\r\n                'category': data.category,\r\n                'hyperlink': data.hyperlink\r\n            };\r\n\r\n        if (typeof this.pageBox[pageId] != 'object') {\r\n            this.pageBox[pageId] = {};\r\n        }\r\n\r\n        this.pageBox[pageId][activityId] = videoInfo;\r\n    },\r\n\r\n    //=================视频动作处理============================\r\n\r\n    //加载视频\r\n    loadVideo: function(pageId, activityId, container) {\r\n        var playBox = this.playBox,\r\n            data = this.pageBox[pageId][activityId];\r\n\r\n        //播放视频时停止所有的音频\r\n        //视频的同时肯能存在音频\r\n        // Xut.AudioManager.clearAudio();\r\n\r\n        //this.beforePlayVideo(pageId,videoId)\r\n        //search video cache\r\n        if (playBox[pageId] && playBox[pageId][activityId]) {\r\n            //console.log('*********cache*********');\r\n            playBox[pageId][activityId].play();\r\n        } else {\r\n            //console.log('=========new=============');\r\n            if (typeof playBox[pageId] !== 'object') {\r\n                playBox[pageId] = {};\r\n            }\r\n            //cache video object\r\n            playBox[pageId][activityId] = new Html5Video(data, container);\r\n\r\n        }\r\n\r\n    },\r\n\r\n    //播放视频之前检查要停的视频\r\n    beforePlayVideo: function(pageId, activityId) {\r\n\r\n    },\r\n\r\n    //清理移除页的视频\r\n    removeVideo: function(pageId) {\r\n        var playBox = this.playBox,\r\n            pageBox = this.pageBox;\r\n\r\n        //清理视频\r\n        if (playBox && playBox[pageId]) {\r\n            for (var activityId in playBox[pageId]) {\r\n                playBox[pageId][activityId].close();\r\n            }\r\n            delete this.playBox[pageId];\r\n        }\r\n        //清理数据\r\n        if (pageBox && pageBox[pageId]) {\r\n            delete this.pageBox[pageId];\r\n        }\r\n    },\r\n\r\n    //清理全部视频\r\n    clearVideo: function() {\r\n        var playBox = this.playBox,\r\n            flag = false; //记录是否处理过销毁状态\r\n\r\n        for (var pageId in playBox) {\r\n            for (var activityId in playBox[pageId]) {\r\n                playBox[pageId][activityId].close();\r\n                flag = true;\r\n            }\r\n        }\r\n\r\n        this.playBox = {};\r\n        this.pageBox = {};\r\n        return flag;\r\n    },\r\n\r\n\r\n    //离开页面\r\n    leavePage: function(pageId) {\r\n        var playBox = this.playBox;\r\n        if (playBox && playBox[pageId]) {\r\n            for (var activityId in playBox[pageId]) {\r\n                playBox[pageId][activityId].stop();\r\n            }\r\n        }\r\n    },\r\n\r\n    //显示按钮\r\n    showIconFlag: function(activityId) {\r\n\r\n    },\r\n\r\n    //隐藏按钮\r\n    hideIconFlag: function(activityId) {\r\n\r\n    }\r\n};\r\n\r\nXut.VideoManager = new VideoManager;\r\n\r\n\r\nexport {\r\n    VideoManager\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/video/manager.js\n **/","/**\r\n * 视频和网页模块（统一整合到VideoClass里面了）\r\n * 这里有四种播放器:\r\n *    1：基于html5原生实现的video标签 for ios\r\n *    2：基于phoneGap插件实现的media  for android\r\n *    3: 基于videoJS用flash实现的播放 for pc\r\n *    4: 用于插入一个网页的webview\r\n */\r\n\r\nvar VideoPlayer = null,\r\n    noop = function() {},\r\n\r\n    //检测是否支持HTML5的video播放\r\n    supportVideo = function() {\r\n        var video = document.createElement('video'),\r\n            type = 'video/mp4; codecs=\"avc1.42E01E, mp4a.40.2\"';\r\n        return !!video.canPlayType && \"probably\" == video.canPlayType(type);\r\n    }(),\r\n\r\n    //检测是否安装了flash插件\r\n    supportFlash = function() {\r\n        var i_flash = false;\r\n\r\n        if (navigator.plugins) {\r\n            for (var i = 0; i < navigator.plugins.length; i++) {\r\n                if (navigator.plugins[i].name.toLowerCase().indexOf(\"shockwave flash\") != -1) {\r\n                    i_flash = true;\r\n                }\r\n            }\r\n        }\r\n        return i_flash;\r\n    }();\r\n\r\n\r\n//移动端浏览器平台\r\nif (Xut.plat.isBrowser) {\r\n    VideoPlayer = Video5\r\n} else {\r\n    //检测平台\r\n    if (Xut.plat.isIOS || top.EduStoreClient) {\r\n        //如果是ibooks模式\r\n        if (Xut.IBooks.Enabled) {\r\n            VideoPlayer = VideoJS\r\n        } else {\r\n            //如果是ios或读酷pc版则使用html5播放\r\n            VideoPlayer = Video5;\r\n        }\r\n    } else if (Xut.plat.isAndroid) {\r\n        //android平台\r\n        VideoPlayer = _Media;\r\n    }\r\n}\r\n\r\n/**\r\n * @param {[type]} options   [description]\r\n *   options.videoId;\r\n *   options.pageId;\r\n *   options.pageUrl;\r\n *   options.left;\r\n *   options.top;\r\n *   options.width;\r\n *   options.height;\r\n *   options.padding;\r\n *   options.category;\r\n * @param {[type]} container 视频元素容器\r\n */\r\n\r\nfunction VideoClass(options, container) {\r\n    options.container = container;\r\n    if ('video' == options.category) {\r\n        this.video = VideoPlayer(options);\r\n    } else if ('webpage' == options.category) {\r\n        this.video = WebPage(options);\r\n    } else {\r\n        console.log('options.category must be video or webPage ')\r\n    }\r\n}\r\n\r\nVideoClass.prototype = {\r\n    play: function() {\r\n        //隐藏工具栏\r\n        Xut.View.Toolbar(\"hide\");\r\n        this.video.play();\r\n    },\r\n    stop: function() {\r\n        //显示工具栏\r\n        Xut.View.Toolbar(\"show\");\r\n        this.video.stop();\r\n    },\r\n    close: function() {\r\n        this.video.close();\r\n    }\r\n}\r\n\r\n\r\n// 网页\r\nfunction WebPage(options) {\r\n\r\n    var pageUrl = options.pageUrl;\r\n\r\n    //跳转app市场\r\n    //普通网页是1  \r\n    //跳转app市场就是2\r\n    if (options.hyperlink == 2) {\r\n        //跳转到app市场\r\n        window.open(pageUrl)\r\n            //数据统计\r\n        $.get('http://www.appcarrier.cn/index.php/adplugin/recordads?aid=16&esbId=ios')\r\n    } else {\r\n\r\n        var padding = options.padding || 0,\r\n            width = options.width,\r\n            height = options.height,\r\n            videoId = options.videoId,\r\n            left = options.left,\r\n            top = options.top,\r\n            $videoNode, eleWidth, eleHeight;\r\n\r\n        if (padding) {\r\n            eleWidth = width - 2 * padding;\r\n            eleHeight = height - 2 * padding;\r\n        } else {\r\n            eleWidth = width;\r\n            eleHeight = height\r\n        }\r\n\r\n\r\n        $videoNode = $('<div id=\"videoWrap_' + videoId + '\" style=\"position:absolute;left:' + left + 'px;top:' + top + 'px;width:' + width + 'px;height:' + height + 'px;z-index:' + Xut.zIndexlevel() + '\">' +\r\n            '<div style=\"position:absolute;left:' + padding + 'px;top:' + padding + 'px;width:' + eleWidth + 'px;height:' + eleHeight + 'px;\">' +\r\n            '<iframe src=\"' + pageUrl + '\" style=\"position:absolute;left:0;top:0;width:100%;height:100%;\"></iframe>' +\r\n            '</div>' +\r\n            '</div>');\r\n\r\n        options.container.append($videoNode);\r\n    }\r\n\r\n\r\n\r\n    function play() {\r\n        $videoNode && $videoNode.show();\r\n    }\r\n\r\n    function stop() {\r\n        $videoNode && $videoNode.hide();\r\n    }\r\n\r\n    function close() {\r\n        if ($videoNode) {\r\n            $videoNode.remove();\r\n            $videoNode = null;\r\n        }\r\n    }\r\n\r\n    return {\r\n        play: play,\r\n        stop: stop,\r\n        close: close\r\n    }\r\n}\r\n\r\n\r\nfunction webView(options) {\r\n    var width = options.width,\r\n        height = options.height,\r\n        pageUrl = options.pageUrl,\r\n        left = options.left,\r\n        top = options.top;\r\n\r\n    function play() {\r\n        //打开一个网页的时候，需要关闭其他已经打开过的网页\r\n        Xut.Plugin.WebView.close();\r\n        Xut.VideoManager.openWebView = false;\r\n        setTimeout(function() {\r\n            Xut.Plugin.WebView.open(pageUrl, left, top, height, width, 1);\r\n            Xut.VideoManager.openWebView = true;\r\n        }, 500);\r\n    }\r\n\r\n    function close() {\r\n        Xut.Plugin.WebView.close();\r\n        Xut.VideoManager.openWebView = false;\r\n    }\r\n\r\n    return {\r\n        play: play,\r\n        stop: close,\r\n        close: close\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * ios窗口化canvas播放器\r\n */\r\nfunction VideoCanvas(options) {\r\n\r\n    var container = options.container || $('body'),\r\n        url = Xut.config.videoPath() + options.url,\r\n        width = options.width,\r\n        height = options.height,\r\n        top = options.top,\r\n        left = options.left,\r\n        zIndex = options.zIndex;\r\n\r\n    var video = new InlineVideo(container, {\r\n        'loop': false,\r\n        'autoplay': true,\r\n        'src': url,\r\n        'width': width,\r\n        'height': height,\r\n        'top': top,\r\n        'left': left,\r\n        'zIndex': zIndex\r\n    })\r\n\r\n    return {\r\n        play: function() {\r\n            video.play()\r\n        },\r\n        stop: function() {\r\n            video.pause()\r\n        },\r\n        close: function() {\r\n            video.destroy()\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 安卓phonegap播放器\r\n * @param  {[type]} options [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction _Media(options) {\r\n    var url = MMXCONFIG ? options.url : options.url.substring(0, options.url.lastIndexOf('.')),\r\n        width = options.width,\r\n        height = options.height,\r\n        top = options.top || 0,\r\n        left = options.left || 0;\r\n\r\n    function play() {\r\n        //var calculate = Xut.config.proportion.calculateContainer();\r\n        //top += Math.ceil(calculate.top);\r\n        //left += Math.ceil(calculate.left);\r\n        Xut.Plugin.VideoPlayer.play(function() {\r\n            //成功回调\r\n        }, function() {\r\n            //失败回调\r\n        }, Xut.config.videoPath() + url, 1, left, top, height, width);\r\n    }\r\n\r\n    function close() {\r\n        Xut.Plugin.VideoPlayer.close();\r\n    }\r\n\r\n    play();\r\n\r\n    return {\r\n        play: play,\r\n        stop: close,\r\n        close: close\r\n    }\r\n}\r\n\r\n/**\r\n *   html5的video播放器\r\n *   API :\r\n *   play();播放\r\n *   stop();    //停止播放并隐藏界面\r\n *   destroy(); //清除元素节点及事件绑定\r\n *  demo :\r\n *  var video = new Video({url:'1.mp4',width:'320',...});\r\n *  video.play();\r\n */\r\n\r\nfunction Video5(options) {\r\n\r\n    var container = options.container || $('body'),\r\n        url = Xut.config.videoPath() + options.url,\r\n        width = options.width,\r\n        height = options.height,\r\n        top = options.top,\r\n        left = options.left,\r\n        zIndex = options.zIndex,\r\n        /*创建播放器*/\r\n        $videoWrap = $('<div></div>');\r\n\r\n    var $video = $(document.createElement('video'));\r\n\r\n    //音频对象\r\n    var video = $video[0];\r\n\r\n    video.play();\r\n\r\n    $video.css({\r\n        width: width,\r\n        height: height\r\n    }).attr({\r\n        'src': url,\r\n        'controls': 'controls',\r\n        'autoplay': 'autoplay'\r\n    });\r\n\r\n    $videoWrap.append($video).css({\r\n        position: 'absolute',\r\n        'z-index': -1,\r\n        top: top,\r\n        left: left,\r\n        width: 0,\r\n        height: 0\r\n    });\r\n\r\n    //播放\r\n    function play() {\r\n        $videoWrap.show();\r\n        video.play();\r\n    }\r\n\r\n    //停止\r\n    function stop() {\r\n        video.pause();\r\n        //复位视频\r\n        if (video.duration) {\r\n            video.currentTime = 0.01;\r\n        }\r\n        //在全屏时无法隐藏元素,须先退出\r\n        //this.video.webkitExitFullScreen();\r\n        $videoWrap.hide();\r\n\r\n        //用于启动视频\r\n        if (options.startBoot) {\r\n            options.startBoot();\r\n            destroy();\r\n        }\r\n    }\r\n\r\n    function error() {\r\n        //用于启动视频\r\n        if (options.startBoot) {\r\n            options.startBoot();\r\n            destroy();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 防止播放错误时播放界面闪现\r\n     * @return {[type]} [description]\r\n     */\r\n    function start() {\r\n        $videoWrap.css({\r\n            width: width + 'px',\r\n            height: height + 'px',\r\n            zIndex: zIndex\r\n        });\r\n    }\r\n\r\n    //销毁\r\n    function destroy() {\r\n        video.removeEventListener('ended', stop, false);\r\n        video.removeEventListener('error', error, false);\r\n        video.removeEventListener('loadeddata', start, false);\r\n        video.removeEventListener('webkitendfullscreen', stop, false);\r\n        $videoWrap.hide().remove();\r\n    }\r\n\r\n    container.append($videoWrap);\r\n\r\n    video.addEventListener('ended', stop, false);\r\n    video.addEventListener('error', error, false);\r\n    video.addEventListener('loadeddata', start, false);\r\n    video.addEventListener('webkitendfullscreen', stop, false);\r\n\r\n    return {\r\n        play: play,\r\n        stop: stop,\r\n        close: destroy\r\n    }\r\n};\r\n\r\n/**\r\n * https://github.com/videojs/video.js/blob/master/docs/guides/setup.md\r\n * 基于video.js的web播放器,在pc端flash优先\r\n * @param {[type]} options [description]\r\n */\r\n\r\nfunction VideoJS(options) {\r\n    var container = options.container || $('body'),\r\n        videoId = options.videoId,\r\n        url = Xut.config.videoPath() + options.url,\r\n        width = options.width,\r\n        height = options.height,\r\n        zIndex = options.zIndex,\r\n        top = options.top,\r\n        left = options.left,\r\n        video, source, player, api;\r\n\r\n    video = document.createElement('video');\r\n    source = document.createElement('source');\r\n    source.setAttribute('src', url);\r\n    source.setAttribute('type', 'video/mp4');\r\n    video.id = 'video_' + videoId;\r\n    video.className = \"video-js vjs-sublime-skin\";\r\n    video.appendChild(source);\r\n    container.append(video);\r\n    //指定本地的swf地址取代网络地址\r\n    videojs.options.flash.swf = \"lib/data/video-js.swf\";\r\n\r\n\r\n    var clear = function() {\r\n        //结束后清理自己\r\n        Xut.VideoManager.removeVideo(options.pageId);\r\n    }\r\n\r\n\r\n    //videojs是videojs定义的全局函数\r\n    player = videojs(video, {\r\n        //视频引擎顺序,位置排前面的优先级越高\r\n        \"techOrder\": [\"html5\", \"flash\"],\r\n        //预加载\r\n        \"preload\": \"auto\",\r\n        //是否有控制条\r\n        \"controls\": true,\r\n        \"autoplay\": true,\r\n        \"width\": width,\r\n        \"height\": height,\r\n        //播放元素相关设置\r\n        children: {\r\n            //暂停时是否显示大大的播放按钮\r\n            bigPlayButton: false,\r\n            //是否显示错误提示\r\n            errorDisplay: false,\r\n            //是否显示视频快照\r\n            posterImage: false,\r\n            //是否显示字幕\r\n            textTrackDisplay: false\r\n        },\r\n        //控制条相关设置\r\n        controlBar: {\r\n            //是否显示字幕按钮\r\n            captionsButton: false,\r\n            chaptersButton: false,\r\n            liveDisplay: false,\r\n            //是否显示剩余时间\r\n            remainingTimeDisplay: false,\r\n            //是否显示子标题按钮\r\n            subtitlesButton: false,\r\n            //是否显示回放菜单按钮\r\n            playbackRateMenuButton: false,\r\n            //是否显示时间分隔符\"/\"\r\n            timeDivider: false,\r\n            //是否显示当前视频的当前时间值\r\n            currentTimeDisplay: false,\r\n            //是否显示视频时长\r\n            durationDisplay: false\r\n        }\r\n    }, function() {\r\n        //可以播放时提升层级，防止闪现\r\n        this.on('canplay', function() {\r\n            wrap.style.zIndex = zIndex;\r\n        });\r\n\r\n        //播放完毕后自动关闭\r\n        this.on('ended', function() {\r\n            //结束后清理自己\r\n            clear()\r\n        });\r\n\r\n        this.on('error', function() {\r\n            clear()\r\n        });\r\n\r\n        //因为没有关闭按钮,又不想自己做,就把全屏变成关闭好了.\r\n        this.on(\"touchend mouseup\", function(e) {\r\n            var className = e.target.className.toLowerCase();\r\n            if (-1 != className.indexOf('vjs-fullscreen-control')) {\r\n                clear()\r\n            }\r\n        })\r\n    });\r\n\r\n    //修正视频样式\r\n    var wrap = player.el(),\r\n        videoElement = wrap.children[0];\r\n    wrap.style.left = left + 'px';\r\n    wrap.style.top = top + 'px';\r\n    wrap.style.zIndex = -1;\r\n\r\n    api = {\r\n        play: noop,\r\n\r\n        stop: function() {\r\n            player.stop();\r\n        },\r\n\r\n        close: function() {\r\n            player && player.dispose();\r\n            player = null;\r\n        }\r\n    }\r\n\r\n    return api;\r\n}\r\n\r\nXut.Video5 = Video5;\r\n\r\nXut.Video = VideoClass;\r\n\r\n\r\nexport {\r\n    VideoClass as Html5Video\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/video/video.js\n **/","import {\r\n    _set,\r\n    _get,\r\n    parseJSON\r\n}\r\nfrom '../util/index'\r\n\r\nimport { cursor } from './cursor'\r\nimport { external } from '../external'\r\nimport { createStore } from '../data/index'\r\nimport { contentFilter } from '../component/content/filter'\r\nimport { loadScene } from './scene'\r\n\r\n\r\nlet config;\r\n\r\n\r\nfunction getCache(name) {\r\n    return parseInt(_get(name));\r\n}\r\n\r\n\r\n/**\r\n * 进入主页面\r\n * @return {[type]} [description]\r\n */\r\nfunction initMain(novelData) {\r\n\r\n    var novelId,\r\n        parameter,\r\n        pageIndex = getCache('pageIndex'),\r\n        pageFlip = getCache('pageFlip') || 0;\r\n\r\n    /**\r\n     * IBOOS模式\r\n     */\r\n    if (Xut.IBooks.Enabled) {\r\n        //删除背景图\r\n        $(\"#removelayer\").remove();\r\n        LoadScene({\r\n            \"pageIndex\": Xut.IBooks.CONFIG.pageIndex\r\n        });\r\n        return\r\n    }\r\n\r\n    /**\r\n     * 多模式判断\r\n     * 全局翻页模式\r\n     * 0 滑动翻页\r\n     * 1 直接换\r\n     * 所以pageFlip只有在左面的情况下\r\n     */\r\n    if (parameter = novelData.parameter) {\r\n        //拿出pageflip的值\r\n        parameter = parseJSON(parameter);\r\n        //获取pageflip的值得\r\n        //pageflip用来标\r\n        //不能翻页\r\n        //直接切换模式\r\n        pageFlip = parameter.pageflip\r\n        if (pageFlip !== undefined) {\r\n            //设置缓存\r\n            _set({\r\n                'pageFlip': pageFlip\r\n            });\r\n        }\r\n    }\r\n\r\n    //缓存加载\r\n    //如果启动recordHistory记录\r\n    if (config.recordHistory && pageIndex !== undefined) {\r\n        //加强判断\r\n        if (novelId = getCache(\"novelId\")) {\r\n            return loadScene({\r\n                'pageFlip': pageFlip,\r\n                \"novelId\": novelId,\r\n                \"pageIndex\": pageIndex,\r\n                'history': _get('history')\r\n            });\r\n        }\r\n    }\r\n\r\n    //第一次加载\r\n    //没有缓存\r\n    loadScene({\r\n        \"novelId\": novelData._id,\r\n        \"pageIndex\": 0,\r\n        'pageFlip': pageFlip\r\n    });\r\n};\r\n\r\n\r\n/**\r\n * 根据set表初始化数据\r\n * @return {[type]} [description]\r\n */\r\nfunction initValue() {\r\n    createStore()\r\n        .done(function(setData, novelData) {\r\n            initDefaults(setData);\r\n            fixedSize(novelData);\r\n            initMain(novelData);\r\n        });\r\n};\r\n\r\n\r\n/**\r\n * 配置默认数据\r\n * @return {[type]} [description]\r\n */\r\nfunction initDefaults(setData) {\r\n    var rs,\r\n        data = {},\r\n        cfg = {},\r\n        //工具栏默认参数\r\n        defaults = {\r\n            ToolbarPos: 0, //工具栏[0顶部,1底部]\r\n            NavbarPos: 1, //左右翻页按钮[0顶部, 1中间, 2底部]\r\n            HomeBut: 1, //主页按钮[0不显示,1显示]\r\n            ContentBut: 1, //目录按钮[0不显示,1显示]\r\n            PageBut: 1, //页码按钮[0不显示,1显示]\r\n            NavLeft: 1, //左翻页按钮[0不显示,1显示]\r\n            NavRight: 1, //右翻页按钮[0不显示,1显示]\r\n            customButton: 0, //自定义翻页按钮\r\n            CloseBut: SUbDOCCONTEXT ? 1 : 0 //关闭按钮[0不显示,1显示]\r\n        };\r\n\r\n    for (var i = 0, len = setData.length; i < len; i++) {\r\n        rs = setData.item(i);\r\n        data[rs.name] = rs.value;\r\n    }\r\n\r\n    _.defaults(data, defaults);\r\n\r\n    for (i in defaults) {\r\n        cfg[i] = Number(data[i]);\r\n    }\r\n\r\n    config.settings = cfg;\r\n    config.appId = data.appId; //应用配置唯一标示符\r\n    config.shortName = data.shortName;\r\n    config.Inapp = data.Inapp; //是否为应用内购买\r\n\r\n    //应用的唯一标识符\r\n    //生成时间+appid\r\n    config.appUUID = data.adUpdateTime ? data.appId + '-' + /\\S*/.exec(data.adUpdateTime)[0] : data.adUpdateTime;\r\n\r\n    //检查是否解锁\r\n    Xut.Application.CheckOut();\r\n\r\n    //资源路径配置\r\n    config.initResourcesPath();\r\n\r\n    //缓存应用ID\r\n    _set({\r\n        'appId': data.appId\r\n    });\r\n\r\n    //新增模式,用于记录浏览器退出记录\r\n    cfgHistory(data);\r\n\r\n    //广告Id\r\n    //2014.9.2\r\n    Xut.Presentation.AdsId = data.adsId;\r\n\r\n    //2015.2.26\r\n    //启动画轴模式\r\n    //防止是布尔0成立\r\n    if (data.scrollPaintingMode && data.scrollPaintingMode == 1) {\r\n        config.scrollPaintingMode = true;\r\n    }\r\n\r\n    //假如启用了画轴模式，看看是不是竖版的情况，需要切半模版virtualMode\r\n    if (config.scrollPaintingMode) {\r\n        if (config.screenSize.width < config.screenSize.height) {\r\n            config.virtualMode = true\r\n        }\r\n    }\r\n\r\n    //创建过滤器\r\n    Xut.CreateFilter = contentFilter('createFilter');\r\n    Xut.TransformFilter = contentFilter('transformFilter');\r\n}\r\n\r\n\r\n\r\n//新增模式,用于记录浏览器退出记录\r\n//默认启动\r\n//是否回到退出的页面\r\n//set表中写一个recordHistory\r\n//是   1\r\n//否   0\r\nfunction cfgHistory(data) {\r\n\r\n    var recordHistory = 1; //默认启动\r\n    if (data.recordHistory !== undefined) {\r\n        recordHistory = Number(data.recordHistory);\r\n    }\r\n\r\n    //如果启动桌面调试模式\r\n    //自动打开缓存加载\r\n    if (!recordHistory && config.isBrowser && config.debugMode) {\r\n        recordHistory = 1;\r\n    }\r\n\r\n    config.recordHistory = recordHistory;\r\n}\r\n\r\n\r\n/**\r\n * 修正尺寸\r\n * 修正实际分辨率\r\n * @return {[type]} [description]\r\n */\r\nfunction fixedSize(novelData) {\r\n    if (novelData) {\r\n        if (novelData.pptWidth || novelData.pptHeight) {\r\n            config.setProportion(novelData.pptWidth, novelData.pptHeight);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 数据库检测\r\n * @return {[type]} [description]\r\n */\r\nfunction checkTestDB() {\r\n    var database = config.db,\r\n        sql = 'SELECT * FROM Novel';\r\n    if (database) {\r\n        database.transaction(function(tx) {\r\n            tx.executeSql(sql, [], function(tx, rs) {\r\n                initValue();\r\n            }, function() {\r\n                Xut.config.db = null;\r\n                initValue();\r\n            })\r\n        })\r\n    } else {\r\n        initValue();\r\n    }\r\n}\r\n\r\n/**\r\n * 初始化\r\n * 数据结构\r\n */\r\nexport function nextTask() {\r\n\r\n    config = Xut.config\r\n\r\n    //加载忙碌光标 \r\n    if (!Xut.IBooks.Enabled) {\r\n        cursor();\r\n    }\r\n\r\n    if (window.openDatabase) {\r\n        try {\r\n            //数据库链接对象\r\n            config.db = window.openDatabase(config.dbName, \"1.0\", \"Xxtebook Database\", config.dbSize);\r\n        } catch (err) {\r\n            console.log('window.openDatabase出错')\r\n        }\r\n    }\r\n\r\n    //检查数据库\r\n    checkTestDB();\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/init/data.js\n **/","/**\r\n * 用css3实现的忙碌光标\r\n * @return {[type]} [description]\r\n */\r\nexport function cursor() {\r\n    var sWidth = window.innerWidth,\r\n        sHeight = window.innerHeight,\r\n        width = Math.min(sWidth, sHeight) / 4,\r\n        space = Math.round((sHeight - width) / 2),\r\n        delay = [0, 0.9167, 0.833, 0.75, 0.667, 0.5833, 0.5, 0.41667, 0.333, 0.25, 0.1667, 0.0833],\r\n        deg = [0, 30, 60, 90, 120, 150, 180, 210, 240, 270, 300, 330],\r\n        i = 12,\r\n        prefix = Xut.plat.prefixStyle,\r\n        html;\r\n\r\n    html = '<div style=\"width:' + width + \"px;height:\" + width + 'px;margin:' + space + 'px auto;\">';\r\n    html += '<div style=\"height:30%;\"></div><div class=\"xut-busy-middle\">';\r\n\r\n    while (i--) {\r\n        html += '<div class=\"xut-busy-spinner\" style=\"' + prefix('transform') + ':rotate(' + deg[i] + 'deg) translate(0,-142%);' + prefix('animation-delay') + ':-' + delay[i] + 's;\"></div>';\r\n    }\r\n\r\n    html += '</div><div class=\"xut-busy-text\"></div></div>';\r\n\r\n    Xut.View.busyIcon = $('#busyIcon').html(html);\r\n\r\n} \n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/init/cursor.js\n **/","/**\r\n *\r\n * 杂志全局API\r\n *\r\n *  *** 有方法体的是全局接口，不会被重载***\r\n *  *** 无方法体的是场景接口，总会切换到当前可视区域场景***\r\n *\r\n * 1.   Xut.Application\r\n *          a)  整个应用程序的接口，执行应用级别的操作，例如退出应用之类。\r\n * 2.   Xut.DocumentWindow\r\n *          a)  窗口的接口。窗口就是电子杂志的展示区域，可以操作诸如宽度、高度、长宽比之类。\r\n * 3.   Xut.View\r\n *          a)  视图接口。视图是窗口的展示方式，和页面相关的接口，都在这里。\r\n * 4.   Xut.Presentation\r\n *          a)  数据接口。和电子杂志的数据相关的接口，都在这里。\r\n * 5.   Xut.Slides\r\n *          a)  所有页面的集合\r\n * 6.   Xut.Slide\r\n *          a)  单个页面\r\n * 7.   Xut.Master\r\n *          a)  页面的母版\r\n *\r\n *\r\n * @return {[type]} [description]\r\n */\r\n\r\n//ProcessControl\r\n\r\nimport {\r\n    _set,\r\n    _get,\r\n    _remove,\r\n    toNumber,\r\n    portExtend,\r\n    messageBox\r\n}\r\nfrom './util/index'\r\n\r\n//场景管理器\r\nimport {\r\n    controll\r\n}\r\nfrom './scenario/controller'\r\n\r\n//调度器\r\nimport {\r\n    autoRun, original, suspend\r\n}\r\nfrom './scheduler/index'\r\n\r\nimport {\r\n    suspendHandles, promptMessage\r\n}\r\nfrom './dispatcher'\r\n\r\nimport {\r\n    loadScene\r\n}\r\nfrom './init/scene'\r\n\r\n//主场景工厂方法\r\nimport {\r\n    sceneFactory\r\n}\r\nfrom './scenario/factory'\r\n\r\n\r\nvar config = Xut.config,\r\n    plat = Xut.plat,\r\n    LOCK = 1, //锁定\r\n    UNLOCK = 2, //解除锁定\r\n    IsPay = false; //\r\n\r\n/**\r\n * 代码注入空间\r\n * @type {Object}\r\n */\r\nvar external = {};\r\n\r\n/**\r\n * 桌面绑定鼠标控制\r\n */\r\nif (plat.isBrowser) {\r\n    $(document).keyup(function(event) {\r\n        switch (event.keyCode) {\r\n            case 37:\r\n                Xut.View.GotoPrevSlide()\r\n                break;\r\n            case 39:\r\n                Xut.View.GotoNextSlide()\r\n                break;\r\n        }\r\n    })\r\n}\r\n\r\n\r\n//================================================\r\n//\r\n//              电子杂志所有接口\r\n//\r\n//=================================================\r\nXut.Assist = {}\r\nvar Presentation = Xut.Presentation = {};\r\nvar View = Xut.View = {};\r\nvar Contents = Xut.Contents = {};\r\nvar Application = Xut.Application = {};\r\n\r\n\r\n/**\r\n * 忙碌光标\r\n * */\r\nportExtend(View, {\r\n\r\n    busyBarState: false,\r\n\r\n    //忙碌光标的引用\r\n    busyIcon: null,\r\n\r\n    ShowBusy: function() {\r\n        if (Xut.IBooks.Enabled) return;\r\n        View.busyBarState = true;\r\n        View.busyIcon.show();\r\n    },\r\n\r\n    HideBusy: function() {\r\n        if (Xut.IBooks.Enabled) return;\r\n        var busyIcon = View.busyIcon;\r\n        if (View.ShowBusy.lock) return; //显示忙碌加锁，用于不处理hideBusy\r\n        View.busyBarState = false;\r\n        busyIcon.hide();\r\n        IsPay && busyIcon.css('pointer-events', '').find('.xut-busy-text').html('')\r\n    },\r\n\r\n    ShowTextBusy: function(txt) {\r\n        if (Xut.IBooks.Enabled) return;\r\n        View.busyIcon.css('pointer-events', 'none').find('.xut-busy-text').html(txt);\r\n        View.ShowBusy();\r\n    }\r\n})\r\n\r\n\r\n\r\n/**\r\n * [检查是否购买]\r\n **/\r\nfunction CheckBuyGood(seasonId, chapterId, createMode, pageIndex) {\r\n    //已付费\r\n    if (IsPay) {\r\n        return false;\r\n    }\r\n\r\n    try {\r\n        var data = Xut.data.query('sectionRelated', seasonId).toolbar,\r\n            item = [];\r\n        data = JSON.parse(data);\r\n        //判断是否免费章节\r\n        if (!data.Inapp) {\r\n            return false;\r\n        }\r\n        //判断是否交费\r\n        if (UNLOCK == data.Inapp || UNLOCK == _get(inAppId)) {\r\n            setUnlock();\r\n            return false;\r\n        }\r\n        //判断是否收费章节\r\n        if (LOCK == data.Inapp && data.inappInfo) {\r\n            item = _.map(data.inappInfo.split('-'), function(num) {\r\n                return Number(num);\r\n            });\r\n            //收费提示页\r\n            if (item[0] == chapterId && item[1] == seasonId) {\r\n                return false;\r\n            } else {\r\n                View.LoadScenario({\r\n                    'scenarioId': item[1],\r\n                    'chapterId': item[0],\r\n                    'createMode': createMode,\r\n                    'pageIndex': pageIndex,\r\n                    'isInApp': 'isInApp'\r\n                })\r\n            }\r\n        }\r\n    } catch (e) {\r\n        console.log('Data error:', e);\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\n\r\n//重复点击\r\nvar repeatClick = false;\r\n\r\n/**\r\n * 场景\r\n * */\r\nportExtend(View, {\r\n\r\n    /**\r\n     * 关闭场景\r\n     */\r\n    CloseScenario: function() {\r\n        if (repeatClick) return;\r\n        repeatClick = true;\r\n        var serial = controll.takeOutPrevChainId();\r\n        View.LoadScenario({\r\n            'scenarioId': serial.scenarioId,\r\n            'chapterId': serial.chapterId,\r\n            'createMode': 'sysClose'\r\n        }, function() {\r\n            repeatClick = false;\r\n        })\r\n    },\r\n\r\n    /**\r\n     * 加载一个新的场景\r\n     * 1 节与节跳\r\n     *    单场景情况\r\n     *    多场景情况\r\n     * 2 章与章跳\r\n     * useUnlockCallBack 用来解锁回调,重复判断\r\n     * isInApp 是否跳转到提示页面\r\n     */\r\n    LoadScenario: function(options, useUnlockCallBack) {\r\n\r\n        var seasonId = toNumber(options.scenarioId),\r\n            chapterId = toNumber(options.chapterId),\r\n            pageIndex = toNumber(options.pageIndex),\r\n            createMode = options.createMode,\r\n            isInApp = options.isInApp;\r\n\r\n\r\n        //ibooks模式下的跳转\r\n        //全部转化成超链接\r\n        if (!options.main && Xut.IBooks.Enabled && Xut.IBooks.runMode()) {\r\n            location.href = chapterId + \".xhtml\";\r\n            return\r\n        }\r\n\r\n\r\n        //检查应用内是否收费\r\n        if (current && CheckBuyGood(seasonId, chapterId, createMode, pageIndex)) {\r\n            //未交费\r\n            return false;\r\n        }\r\n\r\n        //处理场景跳转\r\n        var sceneController = controll,\r\n            //用户指定的跳转入口，而不是通过内部关闭按钮处理的\r\n            userAssign = createMode === 'sysClose' ? false : true,\r\n            //当前活动场景容器对象\r\n            current = sceneController.containerObj('current');\r\n\r\n        //获取到当前的页面对象\r\n        //用于跳转去重复\r\n        if (current && current.vm) {\r\n            var curVmPage;\r\n            if (curVmPage = current.vm.$curVmPage) {\r\n                if (curVmPage.scenarioId == seasonId && curVmPage.chapterId == chapterId) {\r\n                    console.log('无效的重复触发')\r\n                    return\r\n                }\r\n            }\r\n        }\r\n\r\n        //==================场景内部跳转===============================\r\n        //\r\n        //  节相同，章与章的跳转\r\n        //  用户指定跳转模式,如果目标对象是当前应用页面，按内部跳转处理\r\n        //\r\n        //=============================================================\r\n        if (userAssign && current && current.scenarioId === seasonId) {\r\n            View.GotoSlide(seasonId, chapterId)\r\n            return\r\n        }\r\n\r\n        //==================场景外部跳转===============================\r\n        //\r\n        //  节与节的跳转,需要对场景的处理\r\n        //\r\n        //=============================================================\r\n\r\n        //清理热点动作\r\n        current && current.vm.$suspend();\r\n\r\n        //通过内部关闭按钮加载新场景处理\r\n        if (current && userAssign) {\r\n            //检测是不是往回跳转,重复处理\r\n            sceneController.checkToRepeat(seasonId);\r\n        }\r\n\r\n\r\n        //================加载新的场景=================\r\n\r\n        //读酷启动时不需要忙碌光标\r\n        if (DUKUCONFIG && options.main) {\r\n            Xut.View.HideBusy();\r\n        } else {\r\n            Xut.View.ShowBusy();\r\n        }\r\n\r\n\r\n        /**\r\n         * 跳出去\r\n         * $multiScenario\r\n         * 场景模式\r\n         * $multiScenario\r\n         *      true  多场景\r\n         *      false 单场景模式\r\n         * 如果当前是从主场景加载副场景\r\n         * 关闭系统工具栏\r\n         */\r\n        if (current && !current.vm.$multiScenario) {\r\n            View.HideToolbar();\r\n        }\r\n\r\n\r\n        /**\r\n         * 重写场景的顺序编号\r\n         * 用于记录场景最后记录\r\n         */\r\n        var pageId;\r\n        if (current && (pageId = Xut.Presentation.GetPageId())) {\r\n            sceneController.rewrite(current.scenarioId, pageId);\r\n        }\r\n\r\n\r\n        /**\r\n         * 场景信息\r\n         * @type {[type]}\r\n         */\r\n        var sectionRang = Xut.data.query('sectionRelated', seasonId);\r\n        var barInfo = sectionRang.toolbar, //场景工具栏配置信息\r\n            pageTotal = sectionRang.length,\r\n            //通过chapterId转化为实际页码指标\r\n            //season 2\r\n            //       {\r\n            //          chapterId : 1  => 0\r\n            //          chpaterId : 2  => 1\r\n            //       }\r\n            //\r\n            parseInitIndex = function() {\r\n                return chapterId ? (function() {\r\n                    //如果节点内部跳转方式加载,无需转化页码\r\n                    if (createMode === 'GotoSlide') {\r\n                        return chapterId;\r\n                    }\r\n                    //初始页从0开始，减去下标1\r\n                    return chapterId - sectionRang.start - 1;\r\n                })() : 0;\r\n            };\r\n\r\n\r\n        //如果启动了虚拟模式\r\n        if (config.virtualMode) {\r\n            pageTotal = pageTotal * 2;\r\n        }\r\n\r\n\r\n        /**\r\n         * 传递的参数\r\n         * seasonId    节ID\r\n         * chapterId   页面ID\r\n         * pageIndex   指定页码\r\n         * isInApp     是否跳到收费提示页\r\n         * pageTotal   页面总数\r\n         * barInfo     工具栏配置文件\r\n         * history     历史记录\r\n         * sectionRang 节信息\r\n         * complete    构件完毕回调\r\n         * @type {Object}\r\n         */\r\n        var data = {\r\n            seasonId: seasonId,\r\n            chapterId: chapterId,\r\n            pageIndex: pageIndex || parseInitIndex(),\r\n            isInApp: isInApp,\r\n            pageTotal: pageTotal,\r\n            barInfo: barInfo,\r\n            history: options.history,\r\n            sectionRang: sectionRang,\r\n            //制作场景切换后处理\r\n            complete: function(nextBack) {\r\n                //销毁多余场景\r\n                current && current.destroy();\r\n                //下一个任务存在,执行切换回调后,在执行页面任务\r\n                nextBack && nextBack();\r\n                //去掉忙碌\r\n                View.HideBusy();\r\n                //解锁回调\r\n                useUnlockCallBack && useUnlockCallBack();\r\n            }\r\n        }\r\n\r\n\r\n        //主场景判断（第一个节,因为工具栏的配置不同）\r\n        if (options.main || sceneController.mianId === seasonId) {\r\n            //清理缓存\r\n            _remove(\"history\");\r\n            //确定主场景\r\n            sceneController.mianId = seasonId;\r\n            //是否主场景\r\n            data.isMain = true;\r\n        }\r\n        new sceneFactory(data);\r\n\r\n    }\r\n})\r\n\r\n\r\n/**\r\n * 行为\r\n * */\r\nportExtend(View, {\r\n    /**\r\n     * 通过插件打开一个新view窗口\r\n     */\r\n    Open: function(pageUrl, width, height, left, top) {\r\n        Xut.Plugin.WebView.open(pageUrl, left, top, height, width, 1);\r\n    },\r\n\r\n    //关闭view窗口\r\n    Close: function() {\r\n        Xut.Plugin.WebView.close();\r\n    }\r\n})\r\n\r\n\r\n/**\r\n * content\r\n * */\r\nportExtend(Contents, {\r\n\r\n    //存在文档碎片\r\n    //针对音频字幕增加的快捷查找\r\n    contentsFragment: {},\r\n\r\n    /**\r\n     * 是否为canvas元素\r\n     * 用来判断事件冒泡\r\n     * 判断当前元素是否支持滑动\r\n     * 默认任何元素都支持滑动\r\n     * @type {Boolean}\r\n     */\r\n    Canvas: {\r\n\r\n        /**\r\n         * 是否允许滑动\r\n         * @type {Boolean}\r\n         */\r\n        SupportSwipe: true,\r\n\r\n        /**\r\n         * 对象是否滑动\r\n         * @type {Boolean}\r\n         */\r\n        isSwipe: false,\r\n\r\n        /**\r\n         * 对象是否点击\r\n         */\r\n        isTap: false,\r\n\r\n        /**\r\n         * 复位标记\r\n         */\r\n        Reset: function() {\r\n            Contents.Canvas.SupportSwipe = true;\r\n            Contents.Canvas.isSwipe = false;\r\n        },\r\n\r\n        /**\r\n         * 判断是否可以滑动\r\n         * @return {[type]} [description]\r\n         */\r\n        getSupportState: function() {\r\n            var state;\r\n            if (Contents.Canvas.SupportSwipe) {\r\n                state = true;\r\n            } else {\r\n                state = false;\r\n            }\r\n            //清空状态\r\n            Contents.Canvas.Reset();\r\n            return state\r\n        },\r\n\r\n        /**\r\n         * 判断是否绑定了滑动事件\r\n         * @return {Boolean} [description]\r\n         */\r\n        getIsSwipe: function() {\r\n            var state;\r\n            if (Contents.Canvas.isSwipe) {\r\n                state = true;\r\n            } else {\r\n                state = false;\r\n            }\r\n            //清空状态\r\n            Contents.Canvas.Reset();\r\n            return state;\r\n        },\r\n\r\n        /**\r\n         * 是否绑定了点击事件\r\n         */\r\n        getIsTap: function() {\r\n            var state = Contents.Canvas.isTap;\r\n            Contents.Canvas.isTap = false;\r\n            return state;\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * 恢复节点的默认控制\r\n     * 默认是系统接管\r\n     * 如果'drag', 'dragTag', 'swipeleft', 'swiperight', 'swipeup', 'swipedown'等事件会重写\r\n     * 还需要考虑第三方调用，所以需要给一个重写的接口\r\n     * @return {[type]} [description]\r\n     * Content_1_3\r\n     * [Content_1_3,Content_1_4,Content_1_5]\r\n     */\r\n    ResetDefaultControl: function(pageType, id, value) {\r\n        if (!id) return;\r\n        var elements,\r\n            handle = function(ele) {\r\n                if (value) {\r\n                    ele.attr('data-behavior', value);\r\n                } else {\r\n                    ele.attr('data-behavior', 'disable');\r\n                }\r\n            };\r\n        if ((elements = Contents.Get(pageType, id)) && elements.$contentProcess) {\r\n            handle(elements.$contentProcess)\r\n        } else {\r\n            elements = $(\"#\" + id);\r\n            elements.length && handle(elements)\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 针对SVG无节点操作\r\n     * 关闭控制\r\n     */\r\n    DisableControl: function(callback) {\r\n        return {\r\n            behavior: 'data-behavior',\r\n            value: 'disable'\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 针对SVG无节点操作\r\n     * 启动控制\r\n     */\r\n    EnableControl: function(Value) {\r\n        return {\r\n            behavior: 'data-behavior',\r\n            value: Value || 'click-swipe'\r\n        }\r\n    }\r\n})\r\n\r\n\r\n\r\nfunction getStorage(name) {\r\n    return parseInt(_get(name));\r\n}\r\n\r\n/**\r\n * [ 执行解锁]\r\n * @return {[type]} [description]\r\n */\r\nfunction setUnlock() {\r\n    IsPay = true;\r\n}\r\n\r\n\r\n//购买成功\r\nfunction pass() {\r\n    //如果提前关闭了忙碌光标说明被用户中止\r\n    if (!View.busyBarState) return;\r\n    //将购买记录存入数据库\r\n    var db = config.db,\r\n        sql = 'UPDATE Setting SET value=? WHERE name=?';\r\n\r\n    db.transaction(function(tx) {\r\n        tx.executeSql(sql, [null, 'Inapp']);\r\n    }, function(e) {\r\n        _set(inAppId, UNLOCK);\r\n    })\r\n\r\n    setUnlock();\r\n    View.CloseScenario();\r\n    View.HideBusy();\r\n}\r\n\r\n\r\n//购买失败\r\nfunction failed() {\r\n    if (!View.busyBarState) return;\r\n    messageBox('购买失败');\r\n    View.HideBusy();\r\n}\r\n\r\n\r\nportExtend(Application, {\r\n\r\n    /**\r\n     * 应用平台\r\n     * @type {[type]}\r\n     */\r\n    Platform: (function() {\r\n        //平台缩写\r\n        var platformName = ['duku', 'pc', 'ios', 'android'];\r\n        if (GLOBALIFRAME) {\r\n            //嵌套iframe平台\r\n            return platformName[0]\r\n        } else {\r\n            if (config.isBrowser) {\r\n                return platformName[1];\r\n            } else if (Xut.plat.isIOS) {\r\n                return platformName[2];\r\n            } else if (Xut.plat.isAndroid) {\r\n                return platformName[3];\r\n            }\r\n        }\r\n    })(),\r\n\r\n\r\n    /**\r\n     * [ 锁状态]\r\n     * @return {[type]} [description]\r\n     */\r\n    Unlock: function() {\r\n        return IsPay;\r\n    },\r\n\r\n    /**\r\n     * [ 检查是否解锁]\r\n     * @return {[type]}       [description]\r\n     */\r\n    CheckOut: function() {\r\n        var Inapp = config.Inapp;\r\n        if (!Inapp || _get(Inapp) === UNLOCK || Xut.plat.isAndroid) {\r\n            setUnlock();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * [ 付费接口]\r\n     * @param  {[type]} seasonId   [description]\r\n     * @param  {[type]} chapterId  [description]\r\n     * @param  {[type]} createMode [description]\r\n     * @param  {[type]} pageIndex  [description]\r\n     * @return {[type]}            [description]\r\n     */\r\n    BuyGood: function() {\r\n        var inAppId = config.Inapp;\r\n        if (View.busyBarState) return;\r\n        View.ShowTextBusy('请稍候...');\r\n        //调式模式\r\n        if (plat.isBrowser) {\r\n            setTimeout(function() {\r\n                pass();\r\n            }, 3000)\r\n            return;\r\n        }\r\n        //从AppStore查询是否交费\r\n        Xut.Plugin.iapPlugin.selectInfo(function() {\r\n            pass(); //查询成功则表明已购买\r\n        }, function() {\r\n            //否则提示购买\r\n            Xut.Plugin.iapPlugin.buyGood(function() {\r\n                pass();\r\n            }, function(e) {\r\n                failed();\r\n            }, inAppId);\r\n        }, inAppId);\r\n    },\r\n\r\n    /**\r\n     * 已付费接口\r\n     * @return {[type]} [description]\r\n     */\r\n    HasBuyGood: function() {\r\n        var inAppId = config.Inapp;\r\n        if (View.busyBarState) return;\r\n        View.ShowTextBusy('请稍候...');\r\n        //调式模式\r\n        if (plat.isBrowser) {\r\n            setTimeout(function() {\r\n                pass();\r\n            }, 3000)\r\n            return;\r\n        }\r\n\r\n        Xut.Plugin.iapPlugin.restore(function() {\r\n            pass(); //查询成功则表明已购买\r\n        }, function() {\r\n            failed();\r\n        }, inAppId);\r\n    },\r\n\r\n    /**\r\n     * 刷新页面\r\n     */\r\n    Resize: function() {\r\n\r\n        //清理对象\r\n        controll.destroyAllScene()\r\n\r\n        //清理节点\r\n        $(\"#sceneContainer\").empty();\r\n\r\n        //加载新的页面\r\n        var novelId,\r\n            pageIndex = getStorage('pageIndex');\r\n\r\n        //缓存加载\r\n        if (pageIndex !== void 0) {\r\n            novelId = getStorage(\"novelId\");\r\n            //加强判断\r\n            if (novelId) {\r\n                loadScene({\r\n                    \"novelId\": novelId,\r\n                    \"pageIndex\": pageIndex,\r\n                    'history': _get('history')\r\n                });\r\n            };\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * home隐藏\r\n     * 后台运行的时候,恢复到初始化状态\r\n     * 用于进来的时候激活Activate\r\n     */\r\n    Original: function() {\r\n        suspend();\r\n        original();\r\n    },\r\n\r\n    /**\r\n     * home显示\r\n     * 后台弹回来\r\n     * 激活应用行为\r\n     */\r\n    Activate: function() {\r\n        autoRun()\r\n    },\r\n\r\n    /**\r\n     * 销毁应用\r\n     */\r\n    Destroy: function() {\r\n        if (plat.isBrowser) {\r\n            //销毁桌面控制\r\n            $(document).off()\r\n        }\r\n        //销毁所有场景\r\n        controll.destroyAllScene();\r\n    },\r\n\r\n    /**\r\n     * 退出app\r\n     */\r\n    DropApp: function() {\r\n        //如果读酷\r\n        if (DUKUCONFIG) {\r\n            //外部回调通知\r\n            if (DUKUCONFIG.iframeDrop) {\r\n                var appId = _get('appId');\r\n                DUKUCONFIG.iframeDrop(['appId-' + appId, 'novelId-' + appId, 'pageIndex-' + appId]);\r\n            }\r\n            DUKUCONFIG = null;\r\n            unEvent();\r\n            destroy();\r\n            return;\r\n        }\r\n\r\n        //客户端模式\r\n        if (CLIENTCONFIGT) {\r\n            //外部回调通知\r\n            if (CLIENTCONFIGT.iframeDrop) {\r\n                CLIENTCONFIGT.iframeDrop();\r\n            }\r\n            CLIENTCONFIGT = null;\r\n            unEvent();\r\n            destroy();\r\n            return;\r\n        }\r\n\r\n        //妙妙学客户端\r\n        if (MMXCONFIG) {\r\n            //外部回调通知\r\n            if (MMXCONFIG.iframeDrop) {\r\n                MMXCONFIG.iframeDrop();\r\n            }\r\n            MMXCONFIG = null;\r\n            destroy();\r\n            return;\r\n        }\r\n\r\n        function unEvent() {\r\n            //并且是安卓情况下\r\n            //安卓销毁按键事件\r\n            if (Xut.plat.isAndroid) {\r\n                GLOBALCONTEXT.document.removeEventListener(\"backbutton\", config._event.back, false);\r\n                GLOBALCONTEXT.document.removeEventListener(\"pause\", config._event.pause, false);\r\n            }\r\n        }\r\n\r\n        //iframe模式,退出处理\r\n        function destroy() {\r\n            //销毁内存对象\r\n            Application.Destroy();\r\n            GLOBALCONTEXT = null;\r\n        }\r\n\r\n        //单应用dialogs\r\n        if (!plat.isBrowser) {\r\n            GLOBALCONTEXT.navigator.notification.confirm('您确认要退出吗？',\r\n                function(button) {\r\n                    if (1 == button) {\r\n                        GLOBALCONTEXT.navigator.app.exitApp();\r\n                    }\r\n                },\r\n                '退出', ['确定', '取消']\r\n            );\r\n        }\r\n    },\r\n\r\n\r\n    /**\r\n     * 暂停应用\r\n     * skipMedia 跳过音频你处理(跨页面)\r\n     * dispose   成功处理回调\r\n     * processed 处理完毕回调\r\n     */\r\n    Suspend: function(opts) {\r\n        if (suspendHandles(opts.skipMedia)) { //停止热点动作\r\n            if (opts.dispose) {\r\n                opts.dispose(promptMessage);\r\n            }\r\n        } else {\r\n            opts.processed && opts.processed();\r\n        }\r\n    },\r\n\r\n\r\n    //============================================================\r\n    //\r\n    //  注册所有组件对象\r\n    //\r\n    //  2 widget 包括 视频 音频 Action 子文档 弹出口 类型\r\n    //    这种类型是冒泡处理，无法传递钩子，直接用这个接口与场景对接\r\n    //\r\n    injectionComponent: function(regData) {\r\n        var sceneObj = controll.containerObj('current');\r\n        sceneObj.vm.$injectionComponent = regData;\r\n    }\r\n})\r\n\r\n\r\n\r\nportExtend(Application, {\r\n\r\n    /**\r\n     * 应用加载状态\r\n     * false未加载\r\n     * true 已加载\r\n     * @type {Boolean}\r\n     */\r\n    appState: false,\r\n\r\n    setAppState: function() {\r\n        Application.appState = true;\r\n    },\r\n\r\n    delAppState: function() {\r\n        Application.appState = false;\r\n    },\r\n\r\n    /**\r\n     * 获取应用加载状态\r\n     * @return {[type]} [description]\r\n     */\r\n    getAppState: function() {\r\n        return Application.appState;\r\n    },\r\n\r\n    /**\r\n     * 延时APP运用\r\n     * 一般是在等待视频先加载完毕\r\n     * @return {[type]} [description]\r\n     */\r\n    delayAppRun: function() {\r\n        Application.setAppState();\r\n    },\r\n\r\n    /**\r\n     * 启动app\r\n     * 重载启动方法\r\n     * 如果调用在重载之前，就删除，\r\n     * 否则被启动方法重载\r\n     * @type {[type]}\r\n     */\r\n    LaunchApp: function() {\r\n        Application.delAppState();\r\n    },\r\n\r\n    /**\r\n     * 应用加载完毕\r\n     */\r\n    AddEventListener: function() {}\r\n})\r\n\r\n\r\n//========================================================\r\n//\r\n//          脚本注入接口\r\n//\r\n//========================================================\r\n\r\nexternal = {\r\n\r\n    /**\r\n           读取系统中保存的变量的值。\r\n           如果变量不存在，则新建这个全局变量\r\n           如果系统中没有保存的值，用默认值进行赋值\r\n           这个函数，将是创建全局变量的默认函数。\r\n         */\r\n    ReadVar: function(variable, defaultValue) {\r\n        var temp;\r\n        if (temp = _get(variable)) {\r\n            return temp;\r\n        } else {\r\n            _set(variable, defaultValue);\r\n            return defaultValue;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 将变量的值保存起来\r\n     */\r\n    SaveVar: function(variable, value) {\r\n        _set(variable, value)\r\n    },\r\n\r\n    /*\r\n           对变量赋值，然后保存变量的值\r\n           对于全局变量，这个函数将是主要使用的，替代简单的“=”赋值\r\n         */\r\n    SetVar: function(variable, value) {\r\n        _set(variable, value)\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * u3d接口\r\n */\r\nXut.U3d = {\r\n    /**\r\n     * 跳转接口\r\n     * @param {[type]} seasonId  [description]\r\n     * @param {[type]} chapterId [description]\r\n     */\r\n    View: function(seasonId, chapterId) {\r\n        View.LoadScenario({\r\n            'scenarioId': serial.scenarioId,\r\n            'chapterId': serial.chapterId\r\n        })\r\n    }\r\n}\r\n\r\n\r\n//导出注入接口\r\nwindow.XXTAPI = external;\r\n\r\nexport {\r\n    external\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/external.js\n **/","/**\r\n * 场景控制器\r\n * 场景对象之间的顺序处理\r\n * @return {[type]} [description]\r\n */\r\n\r\n\r\n//场景层级控制\r\nlet zIndex = 999999\r\n\r\n//去重复标记，可以复用场景\r\nlet toRepeat = 0\r\n\r\n//场景合集\r\n//主场景\r\n//副场景\r\nlet sceneCollection = {\r\n    //场景顺序\r\n    scenarioStack: [],\r\n    //场景链表\r\n    scenarioChain: []\r\n}\r\n\r\nvar controll = {\r\n\r\n\r\n    //场景层级控制\r\n    createIndex: function() {\r\n        return --zIndex;\r\n    },\r\n\r\n\r\n    //设置一个新场景\r\n    add: function(scenarioId, relevant, sceneObj) {\r\n        sceneCollection.scenarioStack.push(scenarioId);\r\n        sceneCollection['scenarioId->' + scenarioId] = sceneObj;\r\n        //场景链表,拥挤记录场景的加载上一页\r\n        sceneCollection.scenarioChain.push({\r\n            'scenarioId': scenarioId,\r\n            'chapterId': relevant\r\n        })\r\n        return sceneObj;\r\n    },\r\n\r\n\r\n    //=============== 场景链相关方法 ==========================\r\n\r\n    //取出上一个场景链\r\n    takeOutPrevChainId: function() {\r\n        var pre = sceneCollection.scenarioChain.pop();\r\n        if (sceneCollection.scenarioChain.length > 1) {\r\n            return sceneCollection.scenarioChain.pop()\r\n        } else {\r\n            return sceneCollection.scenarioChain[0];\r\n        }\r\n    },\r\n\r\n    //检测重复\r\n    checkToRepeat: function(seasonId) {\r\n        var last,\r\n            len = sceneCollection.scenarioChain.length;\r\n        if (len > 1) {\r\n            last = sceneCollection.scenarioChain[len - 2];\r\n        } else {\r\n            last = sceneCollection.scenarioChain[len - 1];\r\n        }\r\n\r\n        //往回跳一级\r\n        if (last['scenarioId'] == seasonId) {\r\n            this.takeOutPrevChainId();\r\n        }\r\n\r\n        //直接会跳到主场景\r\n        if (sceneCollection.scenarioStack[0] == seasonId) {\r\n            var scenarioChain = sceneCollection.scenarioChain.shift();\r\n            sceneCollection.scenarioChain.length = 0\r\n            sceneCollection.scenarioChain.push(scenarioChain);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 返回活动对象\r\n     * @return {[type]} [description]\r\n     */\r\n    containerObj: function(scenarioId) {\r\n        if (scenarioId === 'current') {\r\n            var scenarioStack = sceneCollection.scenarioStack;\r\n            scenarioId = scenarioStack[scenarioStack.length - 1];\r\n        }\r\n        return sceneCollection['scenarioId->' + scenarioId];\r\n    },\r\n\r\n\r\n    /**\r\n     * 找到索引位置的Id\r\n     * @param  {[type]} scenarioId [description]\r\n     * @return {[type]}            [description]\r\n     */\r\n    findIndexOfId: function(scenarioId) {\r\n        return sceneCollection.scenarioStack.lastIndexOf(scenarioId);\r\n    },\r\n\r\n    //删除指定场景引用\r\n    remove: function(scenarioId) {\r\n        var indexOf = this.findIndexOfId(scenarioId)\r\n            //删除索引\r\n        sceneCollection.scenarioStack.splice(indexOf, 1)\r\n            //删除场景对象区域\r\n        delete sceneCollection['scenarioId->' + scenarioId];\r\n    },\r\n\r\n    //销毁所有场景\r\n    destroyAllScene: function() {\r\n        var cache = _.clone(sceneCollection.scenarioStack);\r\n        _.each(cache, function(scenarioId) {\r\n            sceneCollection['scenarioId->' + scenarioId].destroy();\r\n        });\r\n        sceneCollection.scenarioChain = [];\r\n    },\r\n\r\n    /**\r\n     * 重写场景的顺序编号\r\n     * 用于记录最后一次跳转的问题\r\n     * @return {[type]} [description]\r\n     */\r\n    rewrite: function(scenarioId, chapterId) {\r\n        _.each(sceneCollection.scenarioChain, function(scenarioChain) {\r\n            if (scenarioChain.scenarioId == scenarioId) {\r\n                scenarioChain.chapterId = chapterId;\r\n            }\r\n        });\r\n    },\r\n\r\n\r\n    //暴露接口\r\n    expose: function() {\r\n        return sceneCollection;\r\n    },\r\n\r\n\r\n    //===============================================\r\n    //\r\n    //\t\t\t记录历史缓存\r\n    //\r\n    //===============================================\r\n\r\n    //解析序列\r\n    sequence: function(scenarioId, currPageIndex) {\r\n        var chains = sceneCollection.scenarioChain;\r\n        //有多个场景关系,需要记录\r\n        if (chains.length > 1) {\r\n            var history = [];\r\n            //只刷新当前场景的页面\r\n            _.each(chains, function(chain) {\r\n                if (chain.scenarioId == scenarioId) {\r\n                    history.push(chain.scenarioId + '-' + chain.chapterId + '-' + currPageIndex)\r\n                } else {\r\n                    history.push(chain.scenarioId + '-' + chain.chapterId)\r\n                }\r\n            })\r\n            return history;\r\n        }\r\n    },\r\n\r\n    //反解析\r\n    seqReverse: function(chains) {\r\n        var chains = chains.split(\",\")\r\n        var chainsNum = chains.length;\r\n\r\n        if (chainsNum === 1) {\r\n            return false;\r\n        }\r\n\r\n        //如果只有2层\r\n        if (chainsNum === 2) {\r\n            return chains[1];\r\n        }\r\n\r\n        //拼接作用域链\r\n        //排除首页(已存在)\r\n        //尾页(新创建)\r\n        _.each(chains, function(chain, index) {\r\n            if (index >= 1 && (index < chainsNum - 1)) { //从1开始吸入,排除最后一个\r\n                var chain = chain.split('-')\r\n                sceneCollection.scenarioChain.push({\r\n                    'scenarioId': chain[0],\r\n                    'chapterId': chain[1],\r\n                    'pageIndex': chain[2]\r\n                })\r\n            }\r\n        })\r\n        return chains[chainsNum - 1];\r\n    }\r\n}\r\n\r\nXut.sceneController = controll;\r\n\r\n\r\nexport {controll}\r\n\r\n\r\n// Xut.test = function() {\r\n//     console.log('场景对象', Xut.sceneController.containerObj('current')),\r\n//         console.log('vm对象', Xut.sceneController.containerObj('current').vm),\r\n//         console.log('页面对象', Xut.sceneController.containerObj('current').vm.$scheduler)\r\n// }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scenario/controller.js\n **/","export * from './auto'\r\nexport * from './trigger'\r\nexport * from './suspend'\r\nexport * from './original'\r\nexport * from './recovery'\r\n\r\n\r\n/**\r\n * 获取访问对象参数\r\n *\r\n * 如果pageObj 不存在，则取当前页面的\r\n * \r\n * @return {[type]} [description]\r\n */\r\nXut.accessControl = function(pageObj, callback) {\r\n    var flag, pageObj = pageObj || Xut.Presentation.GetPageObj();\r\n    if (pageObj) {\r\n        var contents = pageObj.baseGetContent();\r\n        var components = pageObj.baseGetComponent();\r\n        var pageType = pageObj.pageType || 'page';\r\n        flag = callback(pageObj, contents.length && contents, components.length && components, pageType)\r\n    }\r\n    return flag;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scheduler/index.js\n **/","/**\r\n * 自动触发控制\r\n * @return {[type]} [description]\r\n */\r\n\r\n\r\nimport {Bind} from '../pagebase/thread/dispenser/bind'\r\n\r\n\r\n//content任务超时Id\r\nvar contentTaskOutId, markComplete;\r\n\r\n/**\r\n * 运行自动的content对象\r\n * 延时500毫秒执行\r\n * @return {[type]} [description]\r\n */\r\nfunction runContent(contentObjs, taskAnimCallback) {\r\n\r\n        var contentTaskOutId = setTimeout(function() {\r\n\r\n            clearTimeout(contentTaskOutId);\r\n\r\n            //完成通知\r\n            var markComplete = function() {\r\n                var completeStatistics = contentObjs.length; //动画完成统计\r\n                return function() {\r\n                    if (completeStatistics === 1) {\r\n                        taskAnimCallback && taskAnimCallback();\r\n                        markComplete = null;\r\n                    }\r\n                    completeStatistics--;\r\n                }\r\n            }();\r\n\r\n            _.each(contentObjs, function(obj, index) {\r\n                if (!Xut.CreateFilter.has(obj.pageId, obj.id)) {\r\n                    obj.autoPlay(markComplete)\r\n                } else {\r\n                    markComplete();\r\n                }\r\n            });\r\n        }, 500);\r\n    }\r\n    /**\r\n     * 运行自动的静态类型\r\n     * @return {[type]} [description]\r\n     */\r\nfunction runComponent(pageObj, pageIndex, autoRunComponents, pageType) {\r\n\r\n    var chapterId = pageObj.baseGetPageId(pageIndex);\r\n\r\n    if (pageIndex === undefined) {\r\n        pageIndex = Xut.Presentation.GetPageIndex();\r\n    }\r\n    _.each(autoRunComponents, function(data, index) {\r\n        var dir = Bind[data.type];\r\n        if (dir && dir.autoPlay) {\r\n            dir.autoPlay({\r\n                'id': data.id,\r\n                'key': data.key,\r\n                'type': data.type,\r\n                'pageType': pageType,\r\n                'rootNode': pageObj.element,\r\n                'chapterId': chapterId,\r\n                'category': data.category,\r\n                'autoPlay': data.autoPlay,\r\n                'pageIndex': pageIndex\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\nexport function autoRun(pageObj, pageIndex, taskAnimCallback) {\r\n\r\n    /**\r\n     * 编译IBOOKSCONFIG的时候过滤自动运行的调用\r\n     * @return {[type]}              [description]\r\n     */\r\n    if (Xut.IBooks.compileMode()) {\r\n        return;\r\n    }\r\n\r\n    //pageType\r\n    //用于区别触发类型\r\n    //页面还是母版\r\n    Xut.accessControl(pageObj, function(pageObj, ContentObjs, ComponentObjs, pageType) {\r\n\r\n        //如果是母版对象，一次生命周期种只激活一次\r\n        if (pageObj.pageType === 'master') {\r\n            if (pageObj.onceMaster) {\r\n                return\r\n            }\r\n            pageObj.onceMaster = true;\r\n        }\r\n\r\n        taskAnimCallback = taskAnimCallback || function() {};\r\n\r\n        //自动运行的组件\r\n        var autoRunComponents;\r\n        if (autoRunComponents = pageObj.baseAutoRun()) {\r\n            runComponent(pageObj, pageIndex, autoRunComponents, pageType)\r\n        }\r\n\r\n        //自动运行content\r\n        clearTimeout(contentTaskOutId);\r\n\r\n        if (ContentObjs) {\r\n            runContent(ContentObjs, taskAnimCallback);\r\n        } else {\r\n            taskAnimCallback(); //无动画\r\n        }\r\n\r\n        Xut.log('debug', pageType + '层，第' + (pageIndex + 1) + '页开始,本页面Id为' + pageObj.chapterId)\r\n    })\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scheduler/auto.js\n **/","import { Action } from './action'\r\nimport { Content } from './content'\r\nimport { Media } from './media'\r\nimport { Widget } from './widget'\r\nimport { ShowNote } from './shownote'\r\n\r\nlet Webpage = Media\r\nlet Video   = Media\r\nlet Audio   = Media\r\n\r\n\r\nlet Bind = {\r\n    Video,\r\n    Audio,\r\n    Action,\r\n    Content,\r\n    Webpage,\r\n    Widget,\r\n    ShowNote\t\r\n}\r\n\r\nexport {Bind}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/dispenser/bind.js\n **/","//============动作热点==================\r\n//\r\n// 1. 跳转页面\r\n// 2. 打开系统应用程序\r\n//\r\n\r\nimport { ActionClass } from '../../../component/action'\r\n\r\n\r\nlet Action = {\r\n\r\n    createDom: function(activityData, chpaterData, chapterId, pageIndex, zIndex, pageType) {\r\n        var backgroundImage = '',\r\n            //等比缩放\r\n            width = activityData.scaleWidth,\r\n            height = activityData.scaleHeight,\r\n            top = activityData.scaleTop,\r\n            left = activityData.scaleLeft;\r\n            \r\n        var md5\r\n\r\n        //热点背景图\r\n        if (md5 = activityData.md5) {\r\n            backgroundImage = \"background-image: url(\" + Xut.onfig.pathAddress + md5 + \");\";\r\n        }\r\n\r\n        //==============创建触发点结构=============\r\n        return String.format(\r\n            '<div id=\"{0}\"' + ' data-belong = \"{1}\"' + ' data-delegate=\"Action\"'\r\n            // +' autoplay=\"{2}\" ' svg打包不可以属性\r\n            + ' style=\"cursor: pointer;width:{3}px;height:{4}px;left:{5}px;top:{6}px;background-size:100% 100%;position:absolute;z-index:{7};{8}\"></div>',\r\n            activityData.actType + \"_\" + activityData._id,\r\n            pageType,\r\n            activityData.autoPlay,\r\n            width,\r\n            height,\r\n            left,\r\n            top,\r\n            zIndex,\r\n            backgroundImage\r\n        );\r\n    },\r\n\r\n    /**\r\n     * 是否阻止全局事件派发\r\n     * @type {Boolean}\r\n     *   false 事件由全局接管派发\r\n     *   false 事件由hotspot处理触发\r\n     *   全局提供的事件接口\r\n     *   {\r\n     *       globalTouchStart\r\n     *       globalTouchMove\r\n     *       globalTouchEnd\r\n     *   }\r\n     */\r\n    stopDelegate: false,\r\n\r\n    /**\r\n     * touchEnd 全局派发的点击事件\r\n     * 如果stopGlobalEvent == ture 事件由全局派发\r\n     */\r\n    eventDelegate: function(data) {\r\n        new ActionClass(data)\r\n    },\r\n\r\n    //========复位对象==========\r\n    //\r\n    //  通过按物理键，关闭当前热点\r\n    //\r\n    //  @return 如果当前没有需要处理的Action,\r\n    //  需要返回一个状态标示告诉当前是否应该退出应用\r\n    //\r\n    recovery: function(opts) {\r\n        if (this.state) {\r\n            this.state = false;\r\n            return true;\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport {Action}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/dispenser/action.js\n **/","/**\r\n *\r\n *  动作对象\r\n *      1 跳转页面\r\n *      2 打开系统程序\r\n *      3 加载子文档\r\n *\r\n */\r\n\r\n\r\nfunction Action(data) {\r\n\r\n    _.extend(this, data);\r\n\r\n    this.id = parseInt(this.id);\r\n\r\n    this.actType = this.type;\r\n\r\n    //加载数据\r\n    this.setup(Xut.data.query('Action', this.id, 'activityId'));\r\n}\r\n\r\nAction.prototype = {\r\n\r\n    setup: function(results) {\r\n        var para1 = results.para1, //跳转参数\r\n            para2 = results.para2, //ppt\r\n            dbId = results._id;\r\n\r\n\r\n        var actionType = parseInt(results.actionType);\r\n \r\n        //跳转或打开本地程序\r\n        switch (actionType) {\r\n            case 0:\r\n                this.toPage(para1);\r\n                break;\r\n            case 1:\r\n                if (Xut.plat.isBrowser) return;\r\n                //打开插件\r\n                Xut.Plugin.OpenApp.openAppAction(para1, function(r) {}, function(e) {});\r\n                break;\r\n            case 2:\r\n                //子文档处理\r\n                this.loadSubdoc(para1, dbId);\r\n                break;\r\n        }\r\n\r\n        this.state = true;\r\n    },\r\n\r\n\r\n    open: function() {\r\n        this.state = true;\r\n        //打开插件\r\n        Xut.Plugin.OpenApp.openAppAction(para1, function(r) {}, function(e) {});\r\n    },\r\n\r\n\r\n    //跳转页面\r\n    toPage: function(para1) {\r\n        para1 = JSON.parse(para1);\r\n        if (para1.seasonId) {\r\n            Xut.View.GotoSlide(para1.seasonId, para1.chapterId);\r\n        } else {\r\n            //向下兼容\r\n            Xut.View.GotoSlide(para1);\r\n        }\r\n    },\r\n\r\n    /***********************************************************\r\n     *\r\n     *                   子文档处理\r\n     *\r\n     * **********************************************************/\r\n\r\n    //加载子文档\r\n    loadSubdoc: function(path, dbId) {\r\n        var self = this,\r\n            wapper,\r\n            configPath = 'www/content/subdoc/' + path + '/content/gallery/';\r\n\r\n        //配置子文档加载路径\r\n        window.XXTSUbDOC = {\r\n            'path': path,\r\n            'dbId': dbId\r\n        }\r\n\r\n        this.subPath = path;\r\n\r\n        //构建子文档的容器\r\n        wapper = this.$wapper = this.createWapper();\r\n\r\n        Xut.nextTick({\r\n            'container': $(this.rootNode),\r\n            'content': wapper\r\n        }, function() {\r\n            self.destroyCache();\r\n        });\r\n    },\r\n\r\n    //iframe加载完毕\r\n    iframeComplete: function() {\r\n        var self = this;\r\n        //关闭事件\r\n        Xut.one('subdoc:dropApp', function() {\r\n            self.destroyCache('iframe', self.iframe[0].contentWindow);\r\n        });\r\n        //隐藏全局工具栏\r\n        Xut.View.HideToolbar();\r\n        Xut.isRunSubDoc = true;\r\n        self.$wapper.css({\r\n            'opacity': '1'\r\n        });\r\n    },\r\n\r\n    //获取iframe颞部window上下文\r\n    destroyCache: function(contentWindow) {\r\n        var self = this,\r\n            iframe;\r\n\r\n        if (contentWindow) {\r\n            iframe = true;\r\n        } else {\r\n            contentWindow = window\r\n        }\r\n\r\n        function clear() {\r\n            Xut.View.ShowToolbar()\r\n            self.$wapper.remove();\r\n            self.$wapper = null;\r\n            self.iframe = null;\r\n            self.rootNode = null;\r\n            Xut.isRunSubDoc = false;\r\n        }\r\n\r\n        try {\r\n            contentWindow.require(\"Dispatcher\", function(c) {\r\n                if (iframe) {\r\n                    //子文档操作\r\n                    if (c.stopHandles()) {\r\n                        c.promptMessage('再按一次将退出子目录！')\r\n                    } else {\r\n                        clear();\r\n                    }\r\n                } else {\r\n                    //父级操作\r\n                    c.stopHandles()\r\n                }\r\n            })\r\n        } catch (err) {\r\n            clear();\r\n        }\r\n    },\r\n\r\n    createWapper: function() {\r\n        var zIndex,\r\n            str,\r\n            dom,\r\n            ifr;\r\n\r\n        //层级设定\r\n        if (this.zIndex === 0) {\r\n            zIndex = this.zIndex;\r\n        } else {\r\n            zIndex = this.zIndex || Xut.zIndexlevel();\r\n        }\r\n\r\n        this.zIndex = zIndex;\r\n\r\n        str = '<div id=\"Subdoc_{0}\" style=\"z-index:{1};width:{2}px;height:{3}px;top:{4}px;left:{5}px;position:absolute;opacity:0\" >' +\r\n            '</div>';\r\n\r\n        dom = String.format(str,\r\n            this.id, zIndex, this.screenSize.width, this.screenSize.height, 0, 0\r\n        );\r\n\r\n        ifr = this.iframe = this.createIframe();\r\n\r\n        return $(dom).append(ifr);\r\n    },\r\n\r\n    /**\r\n     * 加载iframe\r\n     * @return {[type]} [description]\r\n     */\r\n    createIframe: function() {\r\n        var me = this,\r\n            path = 'content/subdoc/' + this.subPath + '/index.html?xxtParaIn=' + this.key,\r\n            ifr = document.createElement('iframe');\r\n\r\n        ifr.id = 'iframe_' + this.id;\r\n        ifr.src = path;\r\n        ifr.style.width = '100%';\r\n        ifr.style.height = '100%';\r\n        ifr.sandbox = \"allow-scripts allow-same-origin\";\r\n        ifr.frameborder = 0;\r\n        if (ifr.attachEvent) {\r\n            ifr.attachEvent('onload', function() {\r\n                me.iframeComplete();\r\n            });\r\n        } else {\r\n            ifr.onload = function() {\r\n                me.iframeComplete();\r\n            };\r\n        }\r\n\r\n        return $(ifr);\r\n    }\r\n}\r\n\r\n\r\nexport {\r\n    Action as ActionClass\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/action.js\n **/","/**\r\n * 文本类型\r\n */\r\n\r\nlet Content = {\r\n\r\n    //==========创建热点元素结构（用于布局可触发点）===============\r\n    //\r\n    //   预创建\r\n    //\r\n    createDom: function(opts) {\r\n        var sqlRet = opts.sqlRet,\r\n            pageIndex = opts.pageIndex;\r\n        return function(rootEle, pageIndex) {\r\n            sqlRet['container'] = rootEle || opts.rootEle;\r\n            return sqlRet;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 绑定热点事件\r\n     * 用户交互动作产生Action或者widget对象\r\n     */\r\n    bindEvent: function() {},\r\n\r\n    /**\r\n     * 在当前页面自动触发的通知\r\n     *\r\n     * 作用：\r\n     *   生成Action或者widget触发点对象\r\n     *\r\n     * 有一种情况，如果当前Action对象，已存在必须要做重复处理\r\n     *\r\n     * Xut.ActionMgr.getOne(key) 接口，是获取当前是否有实例对象的引用\r\n     *\r\n     */\r\n    autoPlay: function(scopeComplete) {\r\n        return this.autoPlay && this.autoPlay(scopeComplete);\r\n    },\r\n\r\n\r\n    /**\r\n     * 开始翻页\r\n     *\r\n     * 滑动页面的时候触发\r\n     *\r\n     * 处理要关闭的对象\r\n     *\r\n     * 比如（音频，视频），不能停留到下一个页面,滑动必须立刻关闭或者清理销毁\r\n     *\r\n     * @param  {[type]} this  当前活动对象\r\n     *\r\n     */\r\n    flipOver: function() {\r\n        return this.flipOver();\r\n    },\r\n\r\n    /**\r\n     * 翻页完成\r\n     * @return {[type]} [description]\r\n     */\r\n    flipComplete: function() {\r\n        return this.flipComplete();\r\n    },\r\n\r\n\r\n    /**\r\n     * 销毁接口\r\n     *\r\n     * 1 销毁页面绑定的事件\r\n     *   A hotspotBind 接口绑定的的热点触发事件\r\n     *   B autoPlay 等接口 产生的具体Action对象事件\r\n     *\r\n     * 2 销毁热点元素的在控制器中的引用\r\n     *\r\n     * 3 清理页面结构\r\n     *\r\n     * 注：\r\n     *   2,3操作暂时由控制器已经内部统一完成了,暂时只需要处理1销毁绑定的事件\r\n     *\r\n     * @param  {[type]} pageIndex    [页码标示]\r\n     * @param  {[type]} rootEle      [根元素]\r\n     * @return {[type]}              [description]\r\n     */\r\n    destroy: function() {\r\n        return this.destroy();\r\n    },\r\n\r\n\r\n    /**\r\n     *  复位状态通知\r\n     *\r\n     *  作用：用户按页面右上角返回，或者pad手机上的物理返回键\r\n     *\r\n     *  那么：\r\n     *      1 按一次， 如果当前页面有活动热点，并且热点对象还在可视活动状态（比如文本，是显示，音频正在播放）\r\n     *        那么则调用此方法，做复位处理，即文本隐藏，音频关闭\r\n     *        然后返回true, 用于反馈给控制器,停止下一步调用\r\n     *        按第二次,则退出页面\r\n     *\r\n     *     2 按一次，如果没有活动的对象，return false,这直接退出页面\r\n     *\r\n     * @param  {[type]} activeObejct [description]\r\n     * @return {[type]}              [description]\r\n     */\r\n    recovery: function(opts) {\r\n        return this.recovery && this.recovery();\r\n    }\r\n\r\n}\r\n\r\nexport {Content}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/dispenser/content.js\n **/","import { parseJSON } from '../../../util/index'\r\n\r\n//临时音频动作数据\r\nlet tempData = {};\r\n\r\nlet Media = {\r\n\r\n    createDom: function(activityData, chpaterData, chapterId, pageIndex, zIndex, pageType) {\r\n            var width = activityData.scaleWidth,\r\n            height = activityData.scaleHeight,\r\n            top = activityData.scaleTop,\r\n            left = activityData.scaleLeft,\r\n            actType = activityData.actType,\r\n            id = activityData._id;\r\n\r\n        //如果没有宽高则不创建绑定节点\r\n        if (!width || !height) return '';\r\n\r\n        var category = activityData.category;\r\n        var mediaIcon,\r\n            mediaIconSize,\r\n            posX,\r\n            posY,\r\n            start,\r\n            stop,\r\n            itemArray,\r\n            startImage = \"\";\r\n\r\n        var screenSize = Xut.config.screenSize\r\n\r\n        //只针对网页插件增加单独的点击界面\r\n        if (category == 'webpage' && (width > 200) && (height > 100) && (width <= screenSize.width) && (height <= screenSize.height)) {\r\n            mediaIcon = 'background-image:url(images/icons/web_hotspot.png)';\r\n        }\r\n\r\n        //解析音乐动作\r\n        //冒泡动作靠节点传递数据\r\n        if (itemArray = activityData.itemArray) {\r\n            itemArray = parseJSON(itemArray);\r\n            start = itemArray[0];\r\n            stop = itemArray[1];\r\n            tempData[id] = {};\r\n            if (start) {\r\n                if (start.startImg) {\r\n                    startImage = start.startImg;\r\n                    tempData[id]['startImg'] = startImage;\r\n                    startImage = 'background-image:url(' + startImage + ');';\r\n                }\r\n                if (start.script) {\r\n                    tempData[id]['startScript'] = start.script;\r\n                }\r\n            }\r\n            if (stop) {\r\n                if (stop.stopImg) {\r\n                    tempData[id]['stopImg'] = stop.stopImg;\r\n                }\r\n                if (stop.script) {\r\n                    tempData[id]['stopScript'] = stop.script\r\n                }\r\n            }\r\n        }\r\n\r\n        //首字母大写\r\n        var mediaType = category.replace(/(\\w)/, function(v) {\r\n            return v.toUpperCase()\r\n        })\r\n\r\n\r\n        //创建音频对象\r\n        //Webpage_1\r\n        //Audio_1\r\n        //Video_1\r\n        var tpl = String.format(\r\n            '<div id=\"{0}\"' + ' data-belong=\"{1}\"' + ' data-delegate=\"{2}\"' + ' style=\"width:{3}px;height:{4}px;left:{5}px;top:{6}px;z-index:{7};{8}background-size:100% 100%;position:absolute;\">',\r\n            mediaType + \"_\" + id,\r\n            pageType,\r\n            category,\r\n            width,\r\n            height,\r\n            left,\r\n            top,\r\n            zIndex,\r\n            startImage\r\n        );\r\n\r\n        //如果有视频图标\r\n        if (mediaIcon) {\r\n            mediaIconSize = 74;\r\n            posX = (width - mediaIconSize) / 2;\r\n            posY = (height - mediaIconSize) / 2;\r\n\r\n            tpl += String.format(\r\n                '<div id=\"icon_{0}\"' + ' type=\"icon\"' + ' style=\"position:absolute;top:{1}px;left:{2}px;width:{3}px;height:{4}px;{5};\">' + ' </div>',\r\n                id,\r\n                posY,\r\n                posX,\r\n                mediaIconSize,\r\n                mediaIconSize,\r\n                mediaIcon\r\n            )\r\n        }\r\n\r\n        tpl += '</div>';\r\n\r\n        return tpl;\r\n    },\r\n\r\n\r\n    //仅创建一次\r\n    //data传递参数问题\r\n    onlyCreateOnce: function(id) {\r\n        var data;\r\n        if (data = tempData[id]) {\r\n            delete tempData[id]\r\n            return data;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * touchEnd 全局派发的点击事件\r\n     * 如果stopGlobalEvent == ture 事件由全局派发\r\n     */\r\n    eventDelegate: function(data) {\r\n        var category, chapterId;\r\n        if (category = data.target.getAttribute('data-delegate')) { //触发类型\r\n            chapterId = Xut.Presentation.GetPageId(data.pageIndex);\r\n            /**\r\n             * 传入chapterId 页面ID\r\n             * activityId    视频ID\r\n             * eleName       节点名  //切换控制\r\n             * 根节点\r\n             */\r\n            if (category == 'audio') {\r\n                Xut.AudioManager.trigger(chapterId, data.activityId, this.onlyCreateOnce(data.id));\r\n            } else {\r\n                Xut.VideoManager.trigger(chapterId, data.activityId, $(data.rootNode));\r\n            }\r\n        }\r\n    },\r\n\r\n\r\n    //自动运行\r\n    autoPlay: function(data) {\r\n        var category = data.category;\r\n        if (!category) return;\r\n        var rootNode = data.rootNode,\r\n            pageIndex = data.pageIndex,\r\n            chapterId = data.chapterId,\r\n            activityId = data.id,\r\n            triggerType = category == 'audio' ? 'audioManager' : 'videoManager';\r\n\r\n        //数据库视频音频不规则问题导致\r\n        //首字母大写\r\n        var mediaType = category.replace(/(\\w)/, function(v) {\r\n            return v.toUpperCase()\r\n        })\r\n\r\n        //自动音频\r\n        if (category == 'audio') {\r\n            Xut.AudioManager.autoPlay(chapterId, activityId, this.onlyCreateOnce(data.id));\r\n        } else {\r\n            //自动视频\r\n            Xut.VideoManager.autoPlay(chapterId, activityId, rootNode);\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport {Media}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/dispenser/media.js\n **/","import {Adapter} from  '../../../component/widget/adapter'\r\n\r\nlet Widget = {\r\n    //==========创建热点元素结构（用于布局可触发点）===============\r\n    //\r\n    // 根据数据创建自己的热点元素结构（用于拼接结构字符串）\r\n    //\r\n    // 要retrun返回这个结构，主要是多人操作时,保证只有最终的dom渲染只有一次\r\n    //\r\n    // sqlRet    具体动作对象的数据\r\n    // pageData  当前页面数据\r\n    // chaperId  当前页面的chapterId\r\n    // pageIndex 当前页面索引号\r\n    // zIndex    热点元素的层级\r\n    //\r\n    createDom: function(activityData, chpaterData, chapterId, pageIndex, zIndex, pageType) {\r\n        var retStr = '',\r\n            layerId,\r\n            cssStyle,\r\n            autoPlay = activityData.autoPlay;\r\n\r\n        //如果是自动播放,则不创建结构\r\n        if (autoPlay) {\r\n            return retStr;\r\n        }\r\n\r\n        var backgroundImage = '',\r\n            width = activityData.scaleWidth,\r\n            height = activityData.scaleHeight,\r\n            top = activityData.scaleTop,\r\n            left = activityData.scaleLeft,\r\n            actType = activityData.actType,\r\n            md5 = activityData.md5;\r\n\r\n        //热点背景图\r\n        if (md5) {\r\n            backgroundImage = \"background-image: url(\" + Xut.config.pathAddress + md5 + \");\";\r\n        }\r\n\r\n        //创建触发点结构\r\n        layerId = actType + \"_\" + activityData._id;\r\n        cssStyle = 'cursor: pointer;width:' + width + 'px;height:' + height + 'px;left:' + left + 'px;top:' + top + 'px;background-size:100% 100%;position:absolute;z-index:' + zIndex + ';' + backgroundImage + '';\r\n\r\n        return String.format(\r\n            '<div id=\"{0}\"' + ' data-belong =\"{1}\"' + ' data-delegate=\"{2}\"'\r\n            // +' autoplay=\"{3}\"' svg打包不可以属性\r\n            + ' style=\"{4}\">' + ' </div>',\r\n            layerId,\r\n            pageType,\r\n            actType,\r\n            autoPlay,\r\n            cssStyle\r\n        );\r\n    },\r\n\r\n    //事件委托\r\n    //通过点击触发\r\n    eventDelegate: function(data) {\r\n        return Adapter(data)\r\n    },\r\n\r\n    //在当前页面自动触发的通知\r\n    autoPlay: function(data) {\r\n        Adapter({\r\n            'rootNode'   : data.rootNode,\r\n            \"type\"       : data.type,\r\n            \"pageType\"   : data.pageType,\r\n            \"activityId\" : data.id,\r\n            \"pageIndex\"  : data.pageIndex,\r\n            \"isAutoPlay\" : true\r\n        })\r\n    },\r\n\r\n    /**\r\n     *  复位状态通知\r\n     *\r\n     *  作用：用户按页面右上角返回，或者pad手机上的物理返回键\r\n     *\r\n     *  那么：\r\n     *      1 按一次， 如果当前页面有活动热点，并且热点对象还在可视活动状态（比如文本，是显示，音频正在播放）\r\n     *        那么则调用此方法，做复位处理，即文本隐藏，音频关闭\r\n     *        然后返回true, 用于反馈给控制器,停止下一步调用\r\n     *        按第二次,则退出页面\r\n     *\r\n     *     2 按一次，如果没有活动的对象，return false,这直接退出页面\r\n     *\r\n     * @param  {[type]} activeObejct [description]\r\n     * @return {[type]}              [description]\r\n     */\r\n    recovery: function(opts) {\r\n        return this.recovery();\r\n    }\r\n}\r\n\r\n\r\nexport {Widget}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/dispenser/widget.js\n **/","/********************************************************************\r\n *\r\n *                   零件适配器\r\n *\r\n * \t\t\t\t1 数据过滤\r\n * \t\t\t\t构件5种类型\r\n *\r\n * *******************************************************************/\r\n\r\n\r\nimport { iframeWidget } from './iframe'\r\nimport { pageWidget } from './page/core'\r\n\r\n\r\nlet proportion\r\nlet screenSize\r\nlet appId\r\n\r\n \r\nfunction loadWidget(type, data, widgetClass) {\r\n\r\n\r\n    Xut.Application.injectionComponent({\r\n        'pageType'  : data.pageType, //标记类型区分\r\n        'pageIndex' : data.pageIndex,\r\n        'widget'    : new widgetClass(data)\r\n    });\r\n\r\n\r\n    // var widgetObj = new widgetClass(data);\r\n\r\n    // //特殊的零件，也是只加载脚本\r\n    // if (data.widgetName != \"bones\") {\r\n    //     //保存引用\r\n    //     //特殊的2个个零件不保存\r\n    //     Xut.Application.injectionComponent({\r\n    //         'pageType'  : data.pageType, //标记类型区分\r\n    //         'pageIndex' : data.pageIndex,\r\n    //         'widget'    : widgetObj\r\n    //     });\r\n    // }\r\n}\r\n\r\n/**\r\n * 构建5中零件类型\r\n * \t1、iframe零件\r\n *\t2、页面零件\r\n *\t3、SVG零件\r\n *\t4、canvas零件\r\n *\t5、webGL零件\r\n * @type {Object}\r\n */\r\nvar adapterType = {\r\n\r\n    /**\r\n     * iframe零件类型\r\n     * @param  {[type]} data [description]\r\n     * @return {[type]}      [description]\r\n     */\r\n    'iframe': function(data) {\r\n        loadWidget('widget', data, iframeWidget);\r\n    },\r\n    'widget': function(data) {\r\n        loadWidget('widget', data, iframeWidget);\r\n    },\r\n\r\n    /**\r\n     * js零件类型处理\r\n     * @param  {[type]} data [description]\r\n     * @return {[type]}      [description]\r\n     */\r\n    'js': function(data) {\r\n        loadWidget('js', data, pageWidget);\r\n    },\r\n    'page': function(data) {\r\n        loadWidget('page', data, pageWidget);\r\n    },\r\n    'svg': function(data) {\r\n        loadWidget('svg', data, pageWidget);\r\n    },\r\n    'canvas': function(data) {\r\n        loadWidget('canvas', data, pageWidget);\r\n    },\r\n    'webgL': function(data) {\r\n        loadWidget('webgL', data, pageWidget);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 获取widget数据\r\n * @return {[type]} [description]\r\n */\r\nfunction filtrateDas(data) {\r\n    data = filterData(data);\r\n    return proportion.calculateElement(data)\r\n}\r\n\r\n/**\r\n * 过滤出数据\r\n * @return {[type]} [description]\r\n */\r\nfunction filterData(data) {\r\n    //直接通过id查询数据\t\r\n    if (data.widgetId) {\r\n        _.extend(data, Xut.data.query('Widget', data.widgetId))\r\n    } else {\r\n        //直接通过activityId查询数据\t\r\n        _.extend(data, Xut.data.query('Widget', data.activityId, 'activityId'));\r\n    }\r\n    return data;\r\n}\r\n\r\n/**\r\n * 解析json数据\r\n * @param  {[type]} itemArray [description]\r\n * @return {[type]}           [description]\r\n */\r\nfunction ParseJSON(itemArray) {\r\n    var anminJson;\r\n    try {\r\n        anminJson = JSON.parse(itemArray);\r\n    } catch (error) {\r\n        anminJson = (new Function(\"return \" + itemArray))();\r\n    }\r\n    return anminJson;\r\n}\r\n\r\n\r\n/**\r\n * ifarme内部，请求返回数据\r\n * @return {[type]} [description]\r\n */\r\nfunction parsePara(data) {\r\n    var inputPara, //输入数据\r\n        outputPara; //输出数据\r\n    if (inputPara = data.inputPara) {\r\n        outputPara = ParseJSON(inputPara)\r\n    }\r\n    return outputPara;\r\n}\r\n\r\n\r\nexport function Adapter(para) {\r\n\r\n    var  config = Xut.config;\r\n    \r\n    proportion = config.proportion;\r\n    screenSize = config.screenSize;\r\n    appId      = config.appId;\r\n\r\n    //获取数据\r\n    var data = filtrateDas(para);\r\n\r\n    para = null;\r\n\r\n    data.id = data.activityId;\r\n\r\n    //解析数据\r\n    data.inputPara = parsePara(data);\r\n\r\n    if (!data.inputPara) {\r\n        data.inputPara = {};\r\n    }\r\n\r\n    //增加属性参数\r\n    if (data.widgetType === 'page') {\r\n        data.inputPara.container = data.rootNode;\r\n    }\r\n\r\n    data.inputPara.uuid = appId + '-' + data.activityId; //唯一ID标示\r\n    data.inputPara.id = data.activityId;\r\n    data.inputPara.screenSize = screenSize;\r\n    //content的命名前缀\r\n    data.inputPara.contentPrefix = Xut.Presentation.MakeContentPrefix(data.pageIndex, data.pageType)\r\n\r\n    //画轴模式\r\n    data.scrollPaintingMode = config.scrollPaintingMode;\r\n    data.calculate = config.proportion.calculateContainer();\r\n\r\n\r\n    //执行类构建\r\n    adapterType[(data.widgetType || 'widget').toLowerCase()](data);\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/widget/adapter.js\n **/","/**\r\n * 创建iframe零件包装器\r\n */\r\n\r\nfunction iframeWidget(data) {\r\n\r\n    var self = this;\r\n\r\n    //获取数据\r\n    _.extend(this, data)\r\n\r\n    //创建页面零件包装器\r\n    this.$wapper = this.createWapper();\r\n\r\n    Xut.nextTick({\r\n        'container': self.rootNode,\r\n        'content': this.$wapper\r\n    }, function() {\r\n        self.rootNode = null;\r\n        self.bindPMS();\r\n    });\r\n\r\n    return this;\r\n}\r\n\r\niframeWidget.prototype = {\r\n\r\n    /**\r\n     * 创建包含容器\r\n     * @return {[type]} [description]\r\n     */\r\n    createWapper: function() {\r\n        var zIndex, str, dom, ifr;\r\n\r\n        //层级设定\r\n        if (this.zIndex === 0) {\r\n            zIndex = this.zIndex;\r\n        } else {\r\n            zIndex = this.zIndex || Xut.zIndexlevel();\r\n        }\r\n\r\n        this.zIndex = zIndex;\r\n\r\n        str = '<div id=\"iframeWidget_{0}\" style=\"z-index:{1};width:{2}px;height:{3}px;top:{4}px;left:{5}px;position:absolute;\" ></div>';\r\n\r\n        dom = String.format(str,\r\n            this.id, zIndex, this.width, this.height, this.top, this.left\r\n        );\r\n\r\n        ifr = this.createIframe();\r\n\r\n        this._iframe = ifr;\r\n\r\n        return $(dom).append(ifr)\r\n    },\r\n\r\n\r\n    /**\r\n     * 加载iframe\r\n     * @return {[type]} [description]\r\n     */\r\n    createIframe: function() {\r\n        var me = this,\r\n            path = 'content/widget/' + this.widgetId + '/index.html?xxtParaIn=' + this.key,\r\n            ifr = document.createElement('iframe');\r\n\r\n        ifr.id = 'iframe_' + this.id;\r\n        ifr.src = path;\r\n        ifr.style.width = '100%';\r\n        ifr.style.height = '100%';\r\n        ifr.sandbox = \"allow-scripts allow-same-origin\";\r\n        ifr.frameborder = 0;\r\n        if (ifr.attachEvent) {\r\n            ifr.attachEvent('onload', function() {\r\n                me.iframeComplete();\r\n            });\r\n        } else {\r\n            ifr.onload = function() {\r\n                me.iframeComplete();\r\n            };\r\n        }\r\n        return ifr;\r\n    },\r\n\r\n\r\n    /**\r\n     * iframe加载完毕回调\r\n     * @return {[type]} [description]\r\n     */\r\n    iframeComplete: function() {\r\n        var me = this;\r\n        var dataSource = this.loadData();\r\n        var width = me._iframe.offsetWidth;\r\n        var height = me._iframe.offsetHeight;\r\n\r\n        if (dataSource.screenSize.width * 0.98 <= width && dataSource.screenSize.height * 0.98 <= height) {\r\n            Xut.View.Toolbar({\r\n                show: 'button',\r\n                hide: 'controlBar'\r\n            });\r\n        } else if (dataSource.screenSize.width * 0.7 <= width && dataSource.screenSize.height * 0.7 <= height) {\r\n            Xut.View.Toolbar({\r\n                show: 'button'\r\n            });\r\n        }\r\n\r\n        this.PMS.send({\r\n            target: me._iframe.contentWindow,\r\n            origin: '*',\r\n            type: 'loadData',\r\n            data: dataSource,\r\n            //消息传递完毕后的回调\r\n            success: success,\r\n            error: function() {}\r\n        });\r\n\r\n        function success() {\r\n            // console.log('完毕')\r\n        }\r\n\r\n        //iframe加载的状态\r\n        me.state = true;\r\n    },\r\n\r\n    /**\r\n     * ifarme内部，请求返回数据\r\n     * @return {[type]} [description]\r\n     */\r\n    loadData: function() {\r\n        var item,\r\n            field,\r\n            source_export = [],\r\n            images = Xut.data['Image'],\r\n            token = null,\r\n            outputPara = this.inputPara,\r\n            items = outputPara.source;\r\n\r\n        for (item in items) {\r\n            if (items.hasOwnProperty(item)) {\r\n                field = {};\r\n                token = images.item((parseInt(items[item]) || 1) - 1);\r\n                field['img'] = '../gallery/' + token.md5;\r\n                field['thumb'] = '';\r\n                field['title'] = token.imageTitle;\r\n                source_export.push(field);\r\n            }\r\n        }\r\n\r\n        outputPara.source = source_export;\r\n\r\n        return outputPara;\r\n    },\r\n\r\n\r\n    /********************************************************************\r\n     *\r\n     *                   与iframe通讯接口\r\n     *\r\n     * ********************************************************************/\r\n\r\n    /**\r\n     * 与iframe通讯接口\r\n     * @return {[type]} [description]\r\n     */\r\n    bindPMS: function() {\r\n        var me = this,\r\n            markId = this.id;\r\n\r\n        this.PMS = PMS;\r\n        //隐藏widget\r\n        PMS.bind(\"onHideWapper\" + markId, function(e) {\r\n            var $wapper = me.$wapper;\r\n            $wapper.hide();\r\n            me.state = false;\r\n\r\n        }, '*')\r\n\r\n        //全屏操作\r\n        PMS.bind(\"onFullscreen\" + markId, function(e) {\r\n            var $wapper = me.$wapper,\r\n                $iframe = $(me._iframe);\r\n\r\n            if (!$iframe.length) return;\r\n            //关闭视频\r\n            Xut.VideoManager.clearVideo();\r\n\r\n            $wapper.css({\r\n                width: '100%',\r\n                height: '100%',\r\n                zIndex: Xut.zIndexlevel(),\r\n                top: 0,\r\n                left: 0\r\n            })\r\n\r\n            //Widget全屏尺寸自动调整\r\n            if (e.full == false) {\r\n                var body = document.body,\r\n                    width = parseInt(body.clientWidth),\r\n                    height = parseInt(body.clientHeight),\r\n                    rote = me.width / me.height,\r\n                    getRote = function(width, height, rote) {\r\n                        var w = width,\r\n                            h = width / rote;\r\n                        if (h > height) {\r\n                            h = height;\r\n                            w = h * rote;\r\n                        }\r\n                        return {\r\n                            w: parseInt(w),\r\n                            h: parseInt(h)\r\n                        };\r\n                    },\r\n                    size = getRote(width, height, rote),\r\n                    left = (width - size.w) / 2,\r\n                    top = (height - size.h) / 2;\r\n\r\n                $iframe.css({\r\n                    width: size.w,\r\n                    height: size.h,\r\n                    position: 'absolute',\r\n                    top: top,\r\n                    left: left\r\n                });\r\n            }\r\n            //隐藏工作条\r\n            Xut.View.Toolbar(\"hide\")\r\n\r\n        }, '*');\r\n\r\n        //还原初始窗口操作\r\n        PMS.bind(\"onReset\" + markId, function(e) {\r\n            var $wapper = me.$wapper,\r\n                $iframe = $(me._iframe);\r\n\r\n            if (!$iframe.length) return;\r\n\r\n            $wapper.css({\r\n                zIndex: me.zIndex,\r\n                width: me.width + 'px',\r\n                height: me.height + 'px',\r\n                top: me.top + 'px',\r\n                left: me.left + 'px'\r\n            });\r\n\r\n            //还原iframe样式\r\n            $iframe.css({\r\n                width: '100%',\r\n                height: '100%',\r\n                position: '',\r\n                top: '0',\r\n                left: '0'\r\n            })\r\n\r\n            Xut.View.Toolbar(\"show\");\r\n\r\n        }, '*');\r\n\r\n        //显示工作条\r\n        PMS.bind(\"onShowToolbar\" + markId, function(e) {\r\n            // Xut.View.ShowToolbar();\r\n        }, '*');\r\n\r\n        //隐藏工作条\r\n        PMS.bind(\"onHideToolbar\" + markId, function(e) {\r\n            Xut.View.HideToolbar();\r\n        }, '*');\r\n\r\n        //跳转页面\r\n        PMS.bind('scrollToPage' + markId, function(data) {\r\n            Xut.View.GotoSlide(data['ppts'], data['pageIndex'])\r\n        }, '*');\r\n    },\r\n\r\n\r\n    //=============外部调用接口===================\r\n\r\n    /**\r\n     * 外部调用接口\r\n     * 显示隐藏\r\n     * @return {[type]} [description]\r\n     */\r\n    dispatchProcess: function() {\r\n        if (this.state) {\r\n            this.stop();\r\n        } else {\r\n            this.start();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 开始\r\n     * @return {[type]} [description]\r\n     */\r\n    start: function() {\r\n        var me = this;\r\n        me.domWapper();\r\n        this.PMS.send({\r\n            target: me._iframe.contentWindow,\r\n            url: me._iframe.src,\r\n            origin: '*',\r\n            type: 'onShow',\r\n            success: function() {\r\n                // alert(123)\r\n            }\r\n        });\r\n        setTimeout(function() {\r\n            me.state = true;\r\n        }, 0)\r\n    },\r\n\r\n    /**\r\n     * 暂停\r\n     * @return {[type]} [description]\r\n     */\r\n    stop: function() {\r\n        var me = this;\r\n        me.domWapper();\r\n        this.PMS.send({\r\n            target: me._iframe.contentWindow,\r\n            url: me._iframe.src,\r\n            origin: '*',\r\n            type: 'onHide',\r\n            success: function() {}\r\n        });\r\n        setTimeout(function() {\r\n            me.state = false;\r\n        }, 0)\r\n    },\r\n\r\n\r\n    /**\r\n     * 处理包装容器的状态\r\n     * @return {[type]} [description]\r\n     */\r\n    domWapper: function() {\r\n        if (this.state) {\r\n            this.$wapper.hide();\r\n        } else {\r\n            this.$wapper.show();\r\n        }\r\n    },\r\n\r\n\r\n    //复位\r\n    recovery: function() {\r\n        var me = this;\r\n        if (me.state) {\r\n            me.PMS.send({\r\n                target: me._iframe.contentWindow,\r\n                url: me._iframe.src,\r\n                origin: '*',\r\n                type: 'onHide',\r\n                success: function() {}\r\n            });\r\n            me.domWapper();\r\n            me.state = false;\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    //销毁接口\r\n    destroy: function() {\r\n\r\n        var me = this,\r\n            iframe = this._iframe,\r\n            PMS = this.PMS;\r\n\r\n        //销毁内部事件\r\n        PMS.send({\r\n            target: iframe.contentWindow,\r\n            url: iframe.src,\r\n            origin: '*',\r\n            type: 'onDestory',\r\n            success: function() {}\r\n        });\r\n\r\n        //销毁事件绑定\r\n        PMS.unbind();\r\n\r\n        //销魂节点\r\n        setTimeout(function() {\r\n            me._iframe = null;\r\n            me.$wapper.remove();\r\n            me.$wapper = null;\r\n        }, 0)\r\n    }\r\n\r\n}\r\n\r\n\r\nexport { iframeWidget }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/widget/iframe.js\n **/","/********************************************************************\r\n *\r\n *                  创建所有的JS页面零件类\r\n *                  1 js\r\n *                  2 page\r\n *                  3 svg\r\n *                  4 canvas\r\n *                  5 webgL\r\n *\r\n * *******************************************************************/\r\n\r\nimport { loader } from './loader'\r\nimport { createData } from './data'\r\nimport { spiritSenior } from '../../pixi/spiritesenior/manage'\r\n\r\n/**\r\n * 解析数据,获取content对象\r\n * @return {[type]} [description]\r\n */\r\nlet parseContentObjs = function(pageType, inputPara) {\r\n    var contentIds = [];\r\n    inputPara.content && _.each(inputPara.content, function(contentId) {\r\n        contentIds.push(contentId);\r\n    });\r\n    return Xut.Contents.GetPageWidgetData(pageType, contentIds)\r\n}\r\n\r\n\r\n/**\r\n * 页面零件\r\n * @param {[type]} data [description]\r\n */\r\nfunction pageWidget(data) {\r\n\r\n    //获取数据\r\n    _.extend(this, data)\r\n\r\n    this.pageObj = null;\r\n    this.widgetName + \"Widget\"\r\n    this._init()\r\n\r\n}\r\n\r\npageWidget.prototype = {\r\n\r\n    /**\r\n     * 获取参数\r\n     * 得到content对象与数据\r\n     * @return {[type]} [description]\r\n     */\r\n    _getArg: function() {\r\n        var data = createData(this.inputPara, this.scrollPaintingMode, this.calculate);\r\n        var contentObjs = parseContentObjs(this.pageType, this.inputPara);\r\n        return [data, contentObjs]\r\n    },\r\n\r\n\r\n    /**\r\n     * 初始化,加载文件\r\n     * @return {[type]} [description]\r\n     */\r\n    _init: function() {\r\n\r\n        //pixi webgl模式\r\n        //2016.4.14\r\n        //高级精灵动画\r\n        //如果是canvas模式\r\n        //那么意味着所有的高级精灵动画统一转化pixi模式\r\n        var pageObj = Xut.Presentation.GetPageObj(this.pageType, this.pageIndex)\r\n        if (pageObj) {\r\n            if (pageObj.canvasRelated.enable) {\r\n                //高级精灵动画不处理\r\n                //已经改成本地化pixi=>content调用了\r\n                if (this.widgetName === \"spirit\") {\r\n                    //高级精灵动画创建器\r\n                    //管理器内部在创建子高级动画\r\n                    var arg = this._getArg()\r\n                    this.pageObj = new seniorManage(arg[0], arg[1])\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        //加载文件\r\n        if (typeof window[this.widgetName + \"Widget\"] != \"function\") {\r\n            loader(this._executive, this);\r\n        } else {\r\n            this._executive();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 执行函数\r\n     * @return {[type]} [description]\r\n     */\r\n    _executive: function() {\r\n        //普通dom模式\r\n        if (typeof(window[this.widgetName + \"Widget\"]) == \"function\") {\r\n            var arg = this._getArg()\r\n            this.pageObj = new window[this.widgetName + \"Widget\"](arg[0], arg[1]);\r\n        } else {\r\n            console.error(\"Function [\" + this.widgetName + \"Widget] does not exist.\");\r\n        }\r\n    },\r\n\r\n\r\n    play: function() {\r\n        // console.log('widget')\r\n        return this.pageObj.play();\r\n    },\r\n\r\n    getIdName: function() {\r\n        return this.pageObj.getIdName();\r\n    },\r\n\r\n    /**\r\n     * 外部调用接口\r\n     * @return {[type]} [description]\r\n     */\r\n    dispatchProcess: function() {\r\n        this.pageObj.toggle();\r\n    },\r\n\r\n    /**\r\n     * 处理包装容器的状态\r\n     * @return {[type]} [description]\r\n     */\r\n    domWapper: function() {\r\n        if (!this.wapper) return;\r\n        if (this.state) {\r\n            this.$wapper.hide();\r\n        } else {\r\n            this.$wapper.show();\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 销毁页面零件\r\n     * @return {[type]} [description]\r\n     */\r\n    destroy: function() {\r\n        if (this.pageObj && this.pageObj.destroy) {\r\n            this.pageObj.destroy();\r\n        }\r\n    }\r\n}\r\n\r\n\r\nexport { pageWidget }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/widget/page/core.js\n **/","import { loadfile } from '../../../util/loader'\r\n\r\n\r\n\r\n/**\r\n * 路径地址\r\n * @param  {[type]} name [description]\r\n * @return {[type]}      [description]\r\n */\r\nfunction path(fileName,widgetId) {\r\n    return 'content/widget/' + widgetId + '/' + fileName\r\n}\r\n\r\n\r\n/**\r\n * 加载js,css文件\r\n * @return {[type]} [description]\r\n */\r\nexport function loader(callback, base) {\r\n    var jsPath, cssPath, completeCount,\r\n        widgetId = base.widgetId,\r\n        //定义css,js的命名\r\n        jsName   = base.widgetName + '.min.js',\r\n        cssName  = (base.widgetType == 'page' || base.widgetType == 'js') ? 'style.min.css' : 0;\r\n\r\n    //需要等待完成\r\n    var completeCount = function() {\r\n        var count = 0;\r\n        jsName && count++;\r\n        cssName && count++;\r\n        return function() {\r\n            if (count === 1) {\r\n                return callback && callback.call(base);\r\n            }\r\n            count--;\r\n        }\r\n    }();\r\n\r\n    //加载css\r\n    if (cssName) {\r\n        cssPath = path(cssName,widgetId);\r\n        loadfile(cssPath, function() {\r\n            completeCount();\r\n        })\r\n    }\r\n\r\n    //加载js\r\n    if (jsName) {\r\n        jsPath = path(jsName,widgetId);\r\n        loadfile(jsPath, function() {\r\n            completeCount();\r\n        });\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/widget/page/loader.js\n **/","/**\r\n * 创建数据\r\n * @return {[type]} [description]\r\n */\r\nexport function createData(outputPara,scrollPaintingMode,calculate) {\r\n    var item,\r\n        field,\r\n        source = [],\r\n        images = Xut.data['Image'],\r\n        token  = null,\r\n        items  = outputPara.source;\r\n\r\n    for (item in items) {\r\n        if (items.hasOwnProperty(item)) {\r\n            field = {};\r\n            token = images.item((parseInt(items[item]) || 1) - 1);\r\n            field['img'] = token.md5;\r\n            field['thumb'] = '';\r\n            field['title'] = token.imageTitle;\r\n            source.push(field);\r\n        }\r\n    }\r\n\r\n    outputPara.source             = source;\r\n    outputPara.scrollPaintingMode = scrollPaintingMode;\r\n    outputPara.calculate          = calculate;\r\n\r\n    return outputPara;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/widget/page/data.js\n **/","import { execJson } from '../../../util/dom'\r\nimport { spiritAni } from './spirite'\r\n\r\n\r\n/**\r\n * 精灵动画合集\r\n * @type {Object}\r\n */\r\nlet spiritObjs = {}\r\n\r\n\r\n/**\r\n * 获取对象id\r\n * @param  {[type]} inputPara     [description]\r\n * @param  {[type]} contentPrefix [description]\r\n * @return {[type]}               [description]\r\n */\r\nlet getId = function(inputPara, contentPrefix) {\r\n    var id = '';\r\n    if (typeof inputPara == \"object\") {\r\n        id = contentPrefix + inputPara.framId;\r\n    } else {\r\n        id = inputPara;\r\n    }\r\n    return id\r\n}\r\n\r\n\r\n//初始化\r\nlet createSpirit = function(id, inputPara, contentPrefix, path) {\r\n    if (!spiritObjs[id]) {\r\n        spiritObjs[id] = new spiritAni(inputPara, contentPrefix, path)\r\n    } else {\r\n        console.log('创建高级精灵已存在')\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 高级精灵动画\r\n * @param  {[type]} data        [description]\r\n * @param  {[type]} contentObjs [description]\r\n * @return {[type]}             [description]\r\n */\r\nexport function seniorManage(inputPara, contents) {\r\n\r\n    var id, para, i, contentPrefix, xhr;\r\n\r\n    //合集对象\r\n    //拿到对象的引用\r\n    this.combineId = []\r\n\r\n    this.inputPara = inputPara;\r\n    this.resourcePath = \"content/widget/gallery/\" + inputPara.id + \"/\"\r\n\r\n    contentPrefix = inputPara.contentPrefix\r\n\r\n    xhr = new XMLHttpRequest();\r\n    xhr.open('GET', this.resourcePath + 'app.json', false);\r\n    xhr.send(null);\r\n\r\n    //解析零件数据\r\n    this.option = execJson(xhr.responseText);\r\n\r\n    //生成零件对象爱\r\n    for (i = 0; i < this.option.spiritList.length; i++) {\r\n        para = this.option.spiritList[i]\r\n        id = getId(para, contentPrefix)\r\n        this.combineId.push(id)\r\n        createSpirit(id, para, contentPrefix, this.ResourcePath);\r\n    }\r\n\r\n}\r\n\r\n\r\nseniorManage.prototype = {\r\n    //销毁\r\n    destroy: function() {\r\n        var obj\r\n        this.combineId.forEach(function(id) {\r\n            obj = spiritObjs[id];\r\n            if (obj) {\r\n                obj.destroy()\r\n                spiritObjs[id] = null;\r\n                delete spiritObjs[id]\r\n            } else {\r\n                console.log('精灵动画销毁错误')\r\n            }\r\n        })\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/spiritesenior/manage.js\n **/","/**\r\n * 高级精灵动画\r\n */\r\n\r\nvar spiritAni = function(data, contentPrefix, path) {\r\n    this.resType = 1;\r\n    this.data = data;\r\n    this.contentPrefix = contentPrefix;\r\n    this.curFPS = 0;\r\n    this.timer = null;\r\n    this.loop = 1;\r\n    this.curLoop = 1;\r\n    if (this.playerType == \"loop\") {\r\n        this.loop = 0\r\n    }\r\n    this.action       = this.data.params[\"actList\"].split(\",\")[0];\r\n    this.fps          = parseInt(this.data.params[this.action].fps);\r\n    this.playerType   = (this.data.params[this.action].playerType);\r\n    this.isSports     = parseInt(this.data.params[this.action].isSports);\r\n    this.imageList    = this.data.params[this.action].ImageList;\r\n    this.obj          = $(\"#\" + this.contentPrefix + this.data.framId);\r\n    this.FPSCount     = this.imageList.length;\r\n    this.resourcePath = path;\r\n    this.imgArray     = []\r\n\r\n}\r\n\r\nvar p = spiritAni.prototype;\r\n\r\n\r\np.init = function() {\r\n    if (this.isSports) {\r\n        this.cutInit();\r\n    } else {\r\n        this.switchInit();\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 停止动画\r\n * @return {[type]} [description]\r\n */\r\np.stop = function() {\r\n    clearTimeout(this.timer);\r\n}\r\n\r\n\r\n/**\r\n * 销毁动画\r\n * @return {[type]} [description]\r\n */\r\np.destroy = function() {\r\n    console.log('销毁')\r\n}\r\n\r\n\r\nexport { spiritAni }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/spiritesenior/spirite.js\n **/","\r\nimport { ShowNote as ShowNoteClass } from '../../../component/ShowNote'\r\n\r\nlet ShowNote = {\r\n\r\n    //==========创建热点元素结构（用于布局可触发点）===============\r\n    //\r\n    // 根据数据创建自己的热点元素结构（用于拼接结构字符串）\r\n    //\r\n    // 要retrun返回这个结构，主要是多人操作时,保证只有最终的dom渲染只有一次\r\n    //actType + \"_\" + _id\r\n    createDom: function(activityData, chpaterData, chapterId, pageIndex, zIndex, pageType) {\r\n        var retStr = \"\",\r\n            newWidth,\r\n            id = activityData['_id'],\r\n            width = activityData.scaleWidth,\r\n            height = activityData.scaleHeight,\r\n            newWidth = (width + height) / 2 * Xut.config.iconHeight;\r\n\r\n        retStr += '<div id=\"ShowNote_' + id + '\" class=\"xut-showNote\" data-belong =' + pageType + ' data-delegate=\"ShowNote\" style=\"width:' + newWidth + 'px;height:' + newWidth + 'px\"></div>';\r\n        return retStr;\r\n    },\r\n\r\n    /**\r\n     * touchEnd 全局派发的点击事件\r\n     * 如果stopGlobalEvent == ture 事件由全局派发\r\n     */\r\n    eventDelegate: function(data) {\r\n        data.data = Xut.Presentation.GetPageData(data.pageIndex);\r\n        new ShowNoteClass(data)\r\n    },\r\n\r\n    //自动运行生成Action或者widget触发点对象\r\n    autoPlay: function(opts) {},\r\n\r\n    /**\r\n     * 翻页后处理页面中活动热点的状态\r\n     * @param  {[type]} activeObejct [需要处理的活动对象]\r\n     *\r\n     * 比如音频,视频 翻页需要暂停，也可以销毁\r\n     */\r\n    flipOver: function(opts) {\r\n        //console.log('翻页处理活动对象', activeObejct ,pageIndex);\r\n    },\r\n\r\n\r\n    /**\r\n     * 销毁页面hotspot事件与Action或widget事件\r\n     * @param  {[type]} activeObejct [需要处理的活动对象]\r\n     * @param  {[type]} pageIndex    [页码标示]\r\n     * @param  {[type]} rootEle      [根元素]\r\n     * @return {[type]}              [description]\r\n     */\r\n    destroy: function(opts) {\r\n        this && this.destroy();\r\n    },\r\n\r\n    //========复位对象==========\r\n    //\r\n    //  通过按物理键，关闭当前热点\r\n    //\r\n    //  @return 如果当前没有需要处理的Action,\r\n    //  需要返回一个状态标示告诉当前是否应该退出应用\r\n    //\r\n    recovery: function(opts) {\r\n        if (this.state) {\r\n            this.dispatchProcess();\r\n            return true;\r\n        }\r\n        return false\r\n    }\r\n}\r\n\r\n\r\nexport { ShowNote }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/dispenser/shownote.js\n **/","import { Iscroll } from './content/iscroll'\r\n\r\nfunction ShowNote(data) {\r\n    data.id = parseInt(data.id);\r\n    data.actType = data.type;\r\n    _.extend(this, data)\r\n    this.setup();\r\n}\r\n\r\nShowNote.prototype = {\r\n    setup: function() {\r\n        var that = this,\r\n            note = this.data.note,\r\n            prop = Xut.config.proportion,\r\n            width = Math.round((prop.width + prop.height) / 2 * Xut.config.iconHeight),\r\n            space = Math.round(width / 2);\r\n        retStr = '<div class=\"xut-shownote-box\" style=\"z-index:' + Xut.zIndexlevel() + '\">' +\r\n            '<div class=\"close\" style=\"width:' + width + 'px;height:' + width + 'px;top:-' + space + 'px;right:-' + space + 'px\"></div>' +\r\n            '<div class=\"content\">' + note + '</div>' +\r\n            '</div>';\r\n\r\n        this._dom = $(retStr);\r\n        this._dom.find('.close').on(\"touchend mouseup\", function() {\r\n            that.dispatchProcess();\r\n        });\r\n        $(this.rootNode).append(this._dom);\r\n\r\n        this.show();\r\n        this.iscroll = Iscroll(this._dom.find('.content')[0]);\r\n        return true;\r\n    },\r\n\r\n    //外部调用接口\r\n    dispatchProcess: function() {\r\n        //自动热点 取消关闭\r\n        if (this.isAutoPlay) return;\r\n        //当前对象状态\r\n        this.state ? this.hide() : this.show();\r\n    },\r\n\r\n    recovery: function() {\r\n        if (this.state) {\r\n            this.dispatchProcess();\r\n            return true;\r\n        }\r\n        return false\r\n    },\r\n\r\n    hide: function() {\r\n        this.state = false;\r\n        $(\"#ShowNote_\" + this.id).css('background-image', 'url(images/icons/hideNote.png)');\r\n        this._dom.hide()\r\n    },\r\n\r\n\r\n    show: function() {\r\n        this.state = true;\r\n        $(\"#ShowNote_\" + this.id).css('background-image', 'url(images/icons/showNote.png)');\r\n        this._dom.show();\r\n    },\r\n\r\n    destroy: function() {\r\n        if (this._dom) {\r\n            this._dom.find('.close').off();\r\n            this._dom && this._dom.hide().remove();\r\n        }\r\n\r\n        //iscroll销毁\r\n        if (this.iscroll) {\r\n            this.iscroll.destroy();\r\n            this.iscroll = null;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport { ShowNote }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/ShowNote.js\n **/"," // *  iscroll 控制\r\n // *    传入dom ID\r\n // *     [onIscroll description]\r\n // * @param  {[type]} contentWrapperDomId [description]\r\n // * @return {[type]}                     [description]\r\n\r\n export function Iscroll(element) {\r\n     //是否移动，中途停止了动画\r\n     var distX = 0,\r\n         distY = 0,\r\n         startX,\r\n         startY,\r\n         absDistY,\r\n         absDistX,\r\n         iscroll,\r\n         that = this,\r\n         screenWidth = Xut.config.screenSize.width,\r\n         useswipeleft = function() {\r\n             Xut.View.GotoPrevSlide()\r\n         },\r\n         useswiperight = function() {\r\n             Xut.View.GotoNextSlide()\r\n         };\r\n\r\n     return new iScroll(element, {\r\n         scrollbars: true,\r\n         fadeScrollbars: true\r\n             //click          : true,\r\n             //tap            : true,\r\n             //probeType      : 2\r\n     });\r\n\r\n\r\n     // this.iscroll.on('scrollStart', function() {\r\n     //     iscroll.initDirection = false; //初始化一次滑动方向\r\n     // });\r\n     // this.iscroll.on('scrollEnd', function(e) {\r\n     //     //如果是Y轴滑动者不作处理跳过\r\n     //     if (iscroll.initDirection) {\r\n     //          startY= startX=distX = distY = 0;\r\n     //         iscroll.startTime = 0;\r\n     //         iscroll.initDirection = false;\r\n     //         return;\r\n     //     }\r\n\r\n     //     var duration, deltaX, validSlide, distance;\r\n     //     //滑动的距离、\r\n\r\n     //     deltaX = distX || 0;\r\n     //     duration = +new Date - iscroll.startTime;\r\n     //     distance = Math.abs(deltaX);\r\n     //     //反弹的边界值\r\n     //     validSlide = Math.ceil(screenWidth / 5);\r\n     //     if (distance < validSlide) {\r\n     //         //快速滑动允许翻页\r\n     //         if (duration < 200 && distance > 20) {\r\n     //             iscroll.swipe = true;\r\n     //             deltaX > 0 ? useswipeleft() : useswiperight();\r\n     //         } else {\r\n     //             //反弹\r\n     //             Xut.View.MovePage(0, 300, deltaX > 0 ? 'prev' : 'next', 'flipRebound')\r\n     //         }\r\n     //     } else {\r\n     //         iscroll.swipe = true;\r\n     //         deltaX > 0 ? useswipeleft() : useswiperight();\r\n     //     }\r\n     //    startY= startX=distX = distY = 0;\r\n     //     iscroll.startTime = 0;\r\n     //     iscroll.initDirection = false;\r\n     // });\r\n     // this.iscroll.on('scroll', function(e) {\r\n     //     startX=startX||e.pageX;\r\n     //     startY=startY||e.pageY;\r\n\r\n     //     distX =e.pageX-startX;\r\n     //     distY = e.pageY-startY;\r\n\r\n     //     absDistX = Math.abs(distX);\r\n     //     absDistY = Math.abs(distY);\r\n\r\n\r\n     //     iscroll.startTime = iscroll.startTime || e.timeStamp;\r\n     //     if (absDistY * 1.5 > absDistX) {\r\n     //           //如果是Y轴滑动则做标记不作处理\r\n     //         iscroll.initDirection = true;\r\n     //     } else {\r\n     //         Xut.View.MovePage(distX, 0, distX > 0 ? 'prev' : 'next', 'flipMove');\r\n     //         iscroll.initDirection = false\r\n     //     }\r\n     // });\r\n\r\n }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/iscroll.js\n **/","/**\r\n * 手动触发控制\r\n * @return {[type]} [description]\r\n */\r\n\r\nimport {\r\n    Bind\r\n}\r\nfrom '../pagebase/thread/dispenser/bind'\r\n\r\nexport function trigger(target, attribute, rootNode, pageIndex) {\r\n\r\n    var key,\r\n        tag,\r\n        type,\r\n        id,\r\n        dir,\r\n        data,\r\n        pageType,\r\n        instance;\r\n\r\n    if (key = target.id) {\r\n\r\n        tag = key.split('_');\r\n        type = tag[0];\r\n        id = tag[1];\r\n        dir = Bind[type];\r\n\r\n        if (dir && dir.eventDelegate) {\r\n\r\n            //获取页面类型\r\n            pageType = function() {\r\n                if (rootNode && rootNode.id) {\r\n                    return /page/.test(rootNode.id) ? 'page' : 'master';\r\n                } else {\r\n                    return 'page';\r\n                }\r\n            }();\r\n\r\n            data = {\r\n                \"id\": id,\r\n                \"activityId\": id,\r\n                \"key\": key,\r\n                \"type\": type,\r\n                \"rootNode\": rootNode,\r\n                \"target\": target,\r\n                \"pageIndex\": pageIndex,\r\n                'pageType': pageType\r\n            };\r\n\r\n            //如果是重复点击\r\n            if (instance = Xut.Application.GetSpecifiedObject(pageType, data)) {\r\n                if (instance.dispatchProcess) {\r\n                    //如果有对应的处理方法\r\n                    return instance.dispatchProcess();\r\n                }\r\n            }\r\n\r\n            //委派新的任务\r\n            dir.eventDelegate(data)\r\n        }\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scheduler/trigger.js\n **/","/**\r\n * 暂停控制\r\n * @return {[type]} [description]\r\n */\r\n\r\n//翻页时,暂停滑动页面的所有热点动作\r\n//翻页停止content动作\r\nexport function suspend(pageObj, pageId) {\r\n\r\n    Xut.accessControl(pageObj, function(pageObj, ContentObjs, ComponentObjs) {\r\n        //多媒体处理\r\n        if (pageId !== undefined) {\r\n            //离开页面销毁视频\r\n            Xut.VideoManager.removeVideo(pageId);\r\n            //翻页停止母板音频\r\n            if (pageObj.pageType === 'master') {\r\n                Xut.AudioManager.hangUpAudio()\r\n            }\r\n        }\r\n\r\n        //content类型\r\n        if (ContentObjs) {\r\n            _.each(ContentObjs, function(obj) {\r\n                obj.flipOver && obj.flipOver();\r\n            })\r\n        }\r\n    })\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scheduler/suspend.js\n **/","/**\r\n * 复位到初始化的状态\r\n * @return {[type]} [description]\r\n */\r\n\r\n/////////\r\n//优化检测 //\r\n/////////\r\nfunction checkOptimize(fn) {\r\n    if (!Xut.config.scrollPaintingMode) {\r\n        fn && fn()\r\n    }\r\n}\r\n\r\n//===============================================================\r\n//      \r\n//           翻一页处理： 翻页完毕触发\r\n//\r\n//  大量操作DOM结构，所以先隐藏根节点\r\n//  1 删除所有widget节点\r\n//  2 复位所有content节点\r\n//  \r\n//==============================================================\r\nexport function original(pageObj) {\r\n\r\n    Xut.accessControl(pageObj, function(pageObj, ContentObjs, ComponentObjs) {\r\n\r\n        //母版对象不还原\r\n        if (pageObj.pageType === 'master') return;\r\n\r\n        var element;\r\n\r\n        if (element = pageObj.element) {\r\n            checkOptimize(function() {\r\n                element.hide();\r\n            })\r\n\r\n\r\n            //销毁所有widget类型的节点\r\n            if (ComponentObjs) {\r\n                _.each(ComponentObjs, function(obj) {\r\n                    obj && obj.destroy();\r\n                });\r\n                //销毁widget对象管理\r\n                pageObj.baseRemoveComponent();\r\n            }\r\n\r\n            //停止动作\r\n            ContentObjs && _.each(ContentObjs, function(obj) {\r\n                if (!Xut.CreateFilter.has(obj.pageId, obj.id)) {\r\n                    obj.resetAnimation && obj.resetAnimation();\r\n                }\r\n            })\r\n\r\n            checkOptimize(function() {\r\n                setTimeout(function() {\r\n                    element.show();\r\n                    element = null;\r\n                }, 0);\r\n            })\r\n        }\r\n\r\n    })\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scheduler/original.js\n **/","/**\r\n * 动作复位状态\r\n * @return {[type]} [description]\r\n */\r\n\r\n\r\n//========================================================\r\n//          复位状态\r\n//          状态控制\r\n//  如果返回false证明有热点,\r\n//  第一次只能关闭热点不能退出页面\r\n//=========================================================\r\nexport function recovery(pageObj) {\r\n    return Xut.accessControl(pageObj, function(pageObj, ContentObjs, ComponentObjs) {\r\n        var falg = false;\r\n        _.each([ContentObjs, ComponentObjs], function(collectionObj) {\r\n            collectionObj && _.each(collectionObj, function(obj) {\r\n                //如果返回值是false,则是算热点处理行为\r\n                if (obj.recovery && obj.recovery()) {\r\n                    falg = true;\r\n                }\r\n            })\r\n        })\r\n        return falg;\r\n    })\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scheduler/recovery.js\n **/","//调度器\r\nimport {\r\n    recovery\r\n}\r\nfrom './scheduler/index'\r\n\r\nimport {\r\n    show\r\n}\r\nfrom './util/notice'\r\n\r\n\r\nimport {\r\n    close\r\n}\r\nfrom './toolbar/navbar'\r\n\r\n\r\n/***********************************************\r\n *\t      热点动作控制器模块\r\n *         1 所有content热点停止\r\n *         2 所有content热点销毁\r\n *         3 app应用销毁\r\n * **********************************************/\r\n\r\n//消息提示框\r\nexport function promptMessage(info) {\r\n    show({\r\n        hindex: Xut.Presentation.GetPageIndex(),\r\n        content: info || \"再按一次将退回到主页\",\r\n        time: 3000\r\n    });\r\n};\r\n\r\n\r\n/************************************************************\r\n *\r\n * \t\t\t检测媒体的播放状态\r\n * \t\t\t1 视频\r\n * \t\t\t2 音频\r\n *\r\n * ***********************************************************/\r\nfunction checkMedia(pageId) {\r\n    var flag = false; //音频 视频 是否有处理\r\n\r\n    if (Xut.AudioManager.clearAudio(pageId)) {\r\n        flag = true;\r\n    }\r\n\r\n    if (Xut.VideoManager.clearVideo()) {\r\n        flag = true;\r\n    }\r\n\r\n    return flag;\r\n}\r\n\r\n\r\n/************************************************************\r\n *\r\n * \t\t\t检测热点的运行状态\r\n *\r\n * ***********************************************************/\r\nfunction checkWidgets(context, pageIndex) {\r\n    return recovery()\r\n}\r\n\r\n\r\n/************************************************************\r\n * \t\t\t停止所有热点动作,并返回状态\r\n * \t\t\t1 content\r\n * \t\t\t2 widget\r\n * \t\t\t动画,视频,音频...........................\r\n * \t\t\t增加场景模式判断\r\n * ***********************************************************/\r\nexport function suspendHandles(context, pageIndex, skipMedia) {\r\n\r\n    //是否存在运行中\r\n    var stateRun = false;\r\n\r\n    //处理音频\r\n    if (checkMedia(skipMedia)) {\r\n        stateRun = true;\r\n    }\r\n\r\n    //正在运行的热点\r\n    ///content,Action', 'Widget', 'ShowNote'\r\n    if (checkWidgets(context, pageIndex)) {\r\n        stateRun = true;\r\n    }\r\n\r\n    //处理导航\r\n    close(function() {\r\n        stateRun = true;\r\n    });\r\n\r\n    return stateRun;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/dispatcher.js\n **/"," /**\r\n  * 目录列表\r\n  * @param  {[type]} hindex    [description]\r\n  * @param  {[type]} pageArray [description]\r\n  * @param  {[type]} modules   [description]\r\n  * @return {[type]}           [description]\r\n  *\r\n  */\r\n\r\n let config = Xut.config\r\n let pageIndex = 0\r\n let prefix = Xut.plat.prefixStyle\r\n let _layoutMode = config.layoutMode\r\n let initializeBusy = false\r\n let sectionInstance = null\r\n let directory = 'images/icons/directory.png'\r\n let directory_act = 'images/icons/directory_act.png'\r\n let lockAnimation //动画加锁\r\n\r\n /*********************************************************************\r\n  *                 下拉章节列表                                      *\r\n  **********************************************************************/\r\n\r\n function SectionList(artControl) {\r\n     var me = this,\r\n         pageArray = [];\r\n\r\n     Xut.data.query('Chapter', Xut.data.novelId, 'seasonId', function(item) {\r\n         pageArray.push(item);\r\n     })\r\n\r\n     this.pageArray = pageArray;\r\n\r\n     // //显示下拉菜单\r\n     Xut.nextTick({\r\n         'container': artControl,\r\n         'content': SceneLayout.nav(pageArray)\r\n     }, function() {\r\n         me.userIscroll();\r\n         sectionInstance = me;\r\n         initialize();\r\n     });\r\n };\r\n\r\n\r\n SectionList.prototype = {\r\n     userIscroll: function() {\r\n         var me = this,\r\n             hBox = this.hBox,\r\n             H = !!(_layoutMode === 'horizontal'),\r\n             //滑动到指定章节\r\n             list = this.list = $('#SectionThelist li'),\r\n             ele = list.eq(pageIndex)[0];\r\n\r\n         if (hBox) {\r\n             if (H) {\r\n                 hBox.goToPage(pageIndex, 0, 0);\r\n             } else {\r\n                 hBox.goToPage(0, pageIndex, 0);\r\n             }\r\n         } else {\r\n             hBox = new iScroll('#SectionWrapper', {\r\n                 snap: 'li',\r\n                 tap: true,\r\n                 scrollX: H,\r\n                 scrollY: !H,\r\n                 scrollbars: true,\r\n                 fadeScrollbars: true,\r\n                 stopPropagation: true\r\n             });\r\n             hBox.on('scrollEnd', function(e) {\r\n                 me.createThumb();\r\n                 me.removeThumb();\r\n             });\r\n\r\n             $('#SectionThelist').on('tap', this.clickElement);\r\n             this.hBox = hBox;\r\n         }\r\n     },\r\n     /**\r\n      * [ 创建缩略图]\r\n      * @return {[type]} [description]\r\n      */\r\n     createThumb: function() {\r\n         var index = this.getPageIndex(), //最左边的索引\r\n             count = this.getViewLen(), //允许显示的页数\r\n             createBak = this.createBak || [], //已创建的页码索引\r\n             createNew = [], //新建的页码索引\r\n             pageArray = this.pageArray,\r\n             list = this.list,\r\n             maxLen = pageArray.length,\r\n             path = config.pathAddress;\r\n\r\n         //确保不会溢出\r\n         count = count > maxLen ? maxLen : count;\r\n         //尽可能地填满\r\n         index = index + count > maxLen ? maxLen - count : index;\r\n\r\n         for (var i = 0; i < count; i++) {\r\n             var j = index + i,\r\n                 page = pageArray[j];\r\n\r\n             createNew.push(j);\r\n\r\n             if (_.contains(createBak, j)) continue;\r\n\r\n             createBak.push(j);\r\n\r\n             //如果是分层母板了,此时用icon代替\r\n             if (page.iconImage) {\r\n                 list.eq(j).css({\r\n                     'background-image': 'url(' + path + page.iconImage + ')'\r\n                 });\r\n             } else {\r\n                 list.eq(j).css({\r\n                     'background-image': 'url(' + path + page.md5 + ')',\r\n                     'background-color': 'white'\r\n                 });\r\n             }\r\n         }\r\n\r\n         this.createNew = createNew;\r\n         this.createBak = createBak;\r\n     },\r\n     /**\r\n      * [ 清理隐藏的缩略图]\r\n      * @return {[type]} [description]\r\n      */\r\n     removeThumb: function() {\r\n         var list = this.list,\r\n             createNew = this.createNew,\r\n             createBak = this.createBak;\r\n\r\n         _.each(createBak, function(val, i) {\r\n             if (!_.contains(createNew, val)) {\r\n                 //标记要清理的索引\r\n                 createBak[i] = -1;\r\n                 list.eq(val).css({\r\n                     'background': ''\r\n                 });\r\n             }\r\n         });\r\n\r\n         //执行清理\r\n         this.createBak = _.without(createBak, -1);\r\n     },\r\n\r\n     /**\r\n      * [ 得到滑动列表中最左侧的索引]\r\n      * @return {[type]} [description]\r\n      */\r\n     getPageIndex: function() {\r\n         if (this.hBox.options.scrollX) {\r\n             return this.hBox.currentPage.pageX;\r\n         } else {\r\n             return this.hBox.currentPage.pageY;\r\n         }\r\n\r\n     },\r\n\r\n     /**\r\n      * [ 获取待创建的缩略图的个数]\r\n      * @return {[type]} [description]\r\n      */\r\n     getViewLen: function() {\r\n         var hBox = this.hBox,\r\n             eleSize = 1, //单个li的高度,\r\n             count = 1,\r\n             len = this.pageArray.length; //li的总数\r\n\r\n         if (_layoutMode === 'horizontal') {\r\n             eleSize = hBox.scrollerWidth / len;\r\n             count = hBox.wrapperWidth / eleSize;\r\n         } else {\r\n             eleSize = hBox.scrollerHeight / len;\r\n             count = hBox.wrapperHeight / eleSize;\r\n         }\r\n         //多创建一个\r\n         return Math.ceil(count) + 1;\r\n     },\r\n\r\n     touchCallback: function(env) {\r\n         var absDistX = this.hBox.absDistX;\r\n         if (!absDistX) {\r\n             this.hBox.swipe = true;\r\n             this.clickElement(env);\r\n         }\r\n\r\n     },\r\n\r\n     clickElement: function(env) {\r\n         var target = env.target,\r\n             xxtlink;\r\n\r\n         if (target) {\r\n             initializeBusy = true;\r\n             initialize();\r\n             if (xxtlink = target.getAttribute('data-xxtlink')) {\r\n                 xxtlink = xxtlink.split('-');\r\n                 Xut.View.GotoSlide(xxtlink[0], xxtlink[1]);\r\n             }\r\n         }\r\n     },\r\n\r\n     resetList: function() {\r\n         return initialize();\r\n     },\r\n\r\n     scrollTo: function() {\r\n         this.userIscroll();\r\n     },\r\n\r\n     refresh: function() {\r\n         this.hBox && this.hBox.refresh();\r\n     },\r\n\r\n     destroy: function() {\r\n         if (this.hBox) {\r\n             $('#SectionThelist').off('tap', this.clickElement);\r\n             this.hBox.destroy();\r\n             this.hBox = null;\r\n         }\r\n         this.pageArray = null;\r\n     }\r\n\r\n }\r\n\r\n //执行动画\r\n function toAnimation(navControlBar, navhandle, action) {\r\n     var end = function() {\r\n         navControlBar.css(prefix('transition'), '');\r\n         Xut.View.HideBusy();\r\n         lockAnimation = false;\r\n     };\r\n\r\n     if (action == 'in') {\r\n         sectionInstance.refresh();\r\n         sectionInstance.scrollTo();\r\n         navControlBar.animate({\r\n             'z-index': Xut.zIndexlevel(),\r\n             'opacity': 1\r\n         }, 'fast', 'linear', function() {\r\n             navhandle.attr('fly', 'out');\r\n             end();\r\n         });\r\n     } else {\r\n         navhandle.attr('fly', 'in');\r\n         navControlBar.hide();\r\n         end();\r\n     }\r\n }\r\n\r\n\r\n //控制按钮改变\r\n function navControl(action, navhandle) {\r\n     navhandle.css('opacity', action === \"in\" ? 0.5 : 1);\r\n }\r\n\r\n\r\n function initialize() {\r\n     //动画状态\r\n     if (lockAnimation) {\r\n         return false;\r\n     }\r\n\r\n     lockAnimation = true;\r\n     Xut.View.ShowBusy();\r\n     startpocess();\r\n };\r\n\r\n\r\n function startpocess() {\r\n     //控制按钮\r\n     var navhandle = $(\"#backDir\"),\r\n         action = navhandle.attr('fly') || 'in',\r\n         navControlBar = $(\"#navBar\");\r\n\r\n     //初始化样式\r\n     initStyle(navControlBar, action, function() {\r\n         //触发控制条\r\n         navControl(action, navhandle);\r\n         //执行动画\r\n         toAnimation(navControlBar, navhandle, action);\r\n     })\r\n };\r\n\r\n\r\n function initStyle(navControlBar, action, fn) {\r\n     sectionInstance.state = false;\r\n     if (action == 'in') {\r\n         sectionInstance.state = true;\r\n         navControlBar.css({\r\n             'z-index': 0,\r\n             'opacity': 0,\r\n             'display': 'block'\r\n         });\r\n     }\r\n     fn && fn();\r\n }\r\n\r\n /**\r\n  * 销毁对象\r\n  * @return {[type]} [description]\r\n  */\r\n function destroy() {\r\n     if (sectionInstance) {\r\n         sectionInstance.destroy();\r\n         sectionInstance = null;\r\n     }\r\n };\r\n\r\n\r\n /**\r\n  * 预先缓存加载\r\n  * @return {[type]} [description]\r\n  */\r\n function load() {\r\n     new SectionList($(\"#navBar\"));\r\n };\r\n \r\n\r\n //关闭\r\n function close(callback) {\r\n     if (sectionInstance && sectionInstance.state) {\r\n         callback && callback();\r\n         initialize();\r\n     }\r\n }\r\n\r\n function init(index) {\r\n     pageIndex = index;\r\n     if (sectionInstance) {\r\n         initialize();\r\n     } else {\r\n         load();\r\n     }\r\n }\r\n\r\n\r\n export {\r\n     load,\r\n     init,\r\n     close,\r\n     destroy\r\n };\r\n  \n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/navbar.js\n **/","import {\r\n    _set,\r\n    _get,\r\n    injectScript,\r\n    toEmpty\r\n}\r\nfrom '../util/index'\r\n\r\nlet config\r\n\r\n\r\n/**\r\n * 设置缓存\r\n * @param {[type]} parameter [description]\r\n */\r\nfunction setDataToStorage(parameter) {\r\n    config.pageIndex = parameter.pageIndex;\r\n    config.novelId = parameter.novelId;\r\n    _set({\r\n        \"pageIndex\": parameter.pageIndex,\r\n        \"novelId\": parameter.novelId\r\n    });\r\n};\r\n \r\n\r\n/**\r\n * 初始化值\r\n * @param {[type]} options [description]\r\n */\r\nfunction initDefaultValues(options) {\r\n    var pageFlip = options.pageFlip;\r\n    //配置全局翻页模式\r\n    //pageflip可以为0\r\n    //兼容pageFlip错误,强制转化成数字类型\r\n    if (pageFlip !== undefined) {\r\n        config.pageFlip = toEmpty(pageFlip);\r\n    }\r\n    return {\r\n        'novelId'   : toEmpty(options.novelId),\r\n        'pageIndex' : toEmpty(options.pageIndex),\r\n        'history'   : options.history\r\n    }\r\n};\r\n\r\n\r\n/**\r\n * 检测脚本注入\r\n * @return {[type]} [description]\r\n */\r\nfunction checkInjectScript() {\r\n    var preCode,\r\n        novels = Xut.data.query('Novel');\r\n    if (preCode = novels.preCode) {\r\n        injectScript(preCode, 'novelpre脚本')\r\n    }\r\n}\r\n\r\nexport function loadScene(options) {\r\n \r\n    config = Xut.config\r\n\r\n    //获取默认参数\r\n    var parameter = initDefaultValues(options || {});\r\n\r\n    //设置缓存\r\n    setDataToStorage(parameter);\r\n\r\n    //应用脚本注入\r\n    checkInjectScript();\r\n\r\n    //检测下scenarioId的正确性\r\n    //scenarioId = 1 找不到chapter数据\r\n    //通过sectionRelated递归检测下一条数据\r\n    var scenarioId, seasondata, i;\r\n    for (i = 0; i < Xut.data.Season.length; i++) {\r\n        seasondata = Xut.data.Season.item(i)\r\n        if (Xut.data.query('sectionRelated', seasondata._id)) {\r\n            scenarioId = seasondata._id\r\n            break;\r\n        }\r\n    }\r\n\r\n    //加载新的场景\r\n    Xut.View.LoadScenario({\r\n        'main'       : true, //主场景入口\r\n        'scenarioId' : scenarioId,\r\n        'pageIndex'  : parameter.pageIndex,\r\n        'history'    : parameter.history\r\n    });\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/init/scene.js\n **/","//布局\r\nimport {\r\n\thome, scene\r\n}\r\nfrom './layout'\r\nimport {\r\n\tparseJSON\r\n}\r\nfrom '../util/index'\r\n//场景控制器\r\nimport {controll as sceneControll} from './controller'\r\n//工具栏\r\nimport {sToolbar as MainBar} from '../toolbar/sysbar'\r\nimport {fToolbar as DeputyBar} from '../toolbar/fnbar'\r\nimport {Bar as BookToolBar} from '../toolbar/bookbar'\r\n\r\n//vm\r\nimport {Manager} from '../manager/core'\r\n \r\nlet config\r\n\r\n//========================场景容器,工具栏创建相关================================\r\n\r\n/**\r\n * 分解工具栏配置文件\r\n * @return {[type]}          [description]\r\n */\r\nfunction parseTooBar(toolbar, tbType, pageMode) {\r\n\tif (toolbar = parseJSON(toolbar)) {\r\n\t\t//兼容数据库中未指定的情况\r\n\t\tvar n = Number(toolbar.pageMode);\r\n\t\tpageMode = _.isFinite(n) ? n : pageMode;\r\n\t\tif (_.isString(toolbar.tbType)) {\r\n\t\t\ttbType = _.map(toolbar.tbType.split(','), function(num) {\r\n\t\t\t\treturn Number(num);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t} \r\n\treturn {\r\n\t\t'tbType': tbType,\r\n\t\t'pageMode': pageMode\r\n\t}\r\n}\r\n\r\n\r\n/**\r\n * 主场景工具栏配置\r\n * pageMode:默认2 允许滑动,带翻页按钮\r\n * \r\n * @param  {[type]} scenarioId [description]\r\n * @return {[type]}            [description]\r\n */\r\nfunction pMainBar(scenarioId) {\r\n\tvar sectionRang = Xut.data.query('sectionRelated', scenarioId),\r\n\t\ttoolbar = sectionRang.toolbar, //场景工具栏配置信息\r\n\t\tpagetotal = sectionRang.length,\r\n\t\ttbType = [1], //默认显示系统工具栏\r\n\t\tpageMode = pagetotal > 1 ? 2 : 0; //默认2 允许滑动,带翻页按钮\r\n\treturn parseTooBar(toolbar, tbType, pageMode)\r\n}\r\n\r\n\r\n/**\r\n * 副场景工具栏配置\r\n * pageMode 是否支持滑动翻页  0禁止滑动 1允许滑动\r\n * tbType   工具栏显示的类型 [0-5]\r\n */\r\nfunction pDeputyBar(toolbar, pagetotal) {\r\n\tvar tbType = [0],\r\n\t\tpageMode = pagetotal > 1 ? 1 : 0;\r\n\treturn parseTooBar(toolbar, tbType, pageMode)\r\n}\r\n\r\n\r\n/**\r\n * 找到对应容器\r\n * @return {[type]}            [description]\r\n */\r\nfunction findContainer(elements, scenarioId, isMain) {\r\n\treturn function(pane, parallax) {\r\n\t\tvar node;\r\n\t\tif (isMain) {\r\n\t\t\tnode = '#' + pane;\r\n\t\t} else {\r\n\t\t\tnode = '#' + parallax + scenarioId;\r\n\t\t}\r\n\t\treturn elements.find(node)[0];\r\n\t}\r\n}\r\n\r\n \r\n/**\r\n * 如果启动了缓存记录\r\n * 加载新的场景\r\n * @return {[type]} [description]\r\n */\r\nfunction checkHistory(history) {\r\n\r\n\t//直接启用快捷调试模式\r\n\tif (config.deBugHistory) {\r\n\t\tXut.View.LoadScenario(config.deBugHistory)\r\n\t\treturn true;\r\n\t}\r\n\r\n\t//如果有历史记录\r\n\tif (history) {\r\n\t\tvar scenarioInfo = sceneControll.seqReverse(history)\r\n\t\tif (scenarioInfo) {\r\n\t\t\tscenarioInfo = scenarioInfo.split('-');\r\n\t\t\tXut.View.LoadScenario({\r\n\t\t\t\t'scenarioId': scenarioInfo[0],\r\n\t\t\t\t'chapterId': scenarioInfo[1],\r\n\t\t\t\t'pageIndex': scenarioInfo[2]\r\n\t\t\t})\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\n/**\r\n * 场景创建类\r\n * @param  {[type]} seasonId               [description]\r\n * @param  {[type]} chapterId              [description]\r\n * @param  {[type]} createCompleteCallback [创建完毕通知回调]\r\n * @param  {[type]} createMode             [创建模式]\r\n * @param  {[type]} sceneChainId           [场景ID链,用于后退按钮加载前一个场景]\r\n * @return {[type]}                        [description]\r\n */\r\nfunction SceneFactory(data) {\r\n\r\n\tconfig = Xut.config\r\n\r\n\t//基本配置信息\r\n\tvar seasonId = data.seasonId;\r\n\tvar chapterId = data.chapterId;\r\n\r\n\tvar options = _.extend(this, data, {\r\n\t\t'scenarioId': seasonId,\r\n\t\t'chapterId': chapterId,\r\n\t\t'container': $('#sceneContainer')\r\n\t})\r\n\r\n\t//////////////\r\n\t// 创建场景容器 //\r\n\t//////////////\r\n\tvar complete = function() {\r\n\t\t//配置工具栏行为\r\n\t\tif (!Xut.IBooks.Enabled) {\r\n\t\t\t_.extend(this, this.initToolBar());\r\n\t\t}\r\n\r\n\t\t//构件vm对象\r\n\t\tthis.createViewModel();\r\n\r\n\t\t//注入场景管理\r\n\t\tsceneControll.add(seasonId, chapterId, this);\r\n\t}\r\n\tthis.createScenario(complete, options);\r\n}\r\n\r\n\r\nvar sceneProto = SceneFactory.prototype;\r\n\r\n\r\n/**\r\n * 创建场景\r\n * @return {[type]} [description]\r\n */\r\nsceneProto.createScenario = function(callback, options) {\r\n\r\n\t//如果是静态文件执行期\r\n\t//支持Xut.IBooks模式\r\n\t//都不需要创建节点\r\n\tif (Xut.IBooks.runMode()) {\r\n\t\tthis.elements = $('#sceneHome');\r\n\t\tcallback.call(this);\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar elements, str, self = this;\r\n\tif (options.isMain) {\r\n\t\tstr = home();\r\n\t} else {\r\n\t\tstr = scene(this.scenarioId);\r\n\t}\r\n\r\n\t//创建场景容器\r\n\telements = this.elements = $(str);\r\n\tXut.nextTick({\r\n\t\t'container': self.container,\r\n\t\t'content': elements\r\n\t}, function() {\r\n\t\tcallback.call(self);\r\n\t});\r\n}\r\n\r\n\r\n/**\r\n * \r\n * 配置工具栏行为\r\n *\t1.\t工具栏类型 \r\n *\ttbType：(如果用户没有选择任何工具栏信息处理，tbType字段就为空)\r\n *\t 0\t禁止工具栏\r\n *\t 1\t系统工具栏   - 显示IOS系统工具栏\r\n *\t 2\t场景工具栏   - 显示关闭按钮\r\n *\t 3\t场景工具栏   - 显示返回按钮\r\n *\t 4\t场景工具栏   - 显示顶部小圆点式标示\r\n *\r\n *\t2.\t翻页模式\r\n *\tpageMode：(如果用户没有选择任何处理，pageMode字段就为空)\r\n *\t 0禁止滑动\r\n *\t 1 允许滑动无翻页按钮\r\n *\t 2 允许滑动带翻页按钮\r\n *\r\n * @return {[type]} [description]\r\n */\r\nsceneProto.initToolBar = function() {\r\n\tvar scenarioId = this.scenarioId;\r\n\tvar pageTotal = this.pageTotal;\r\n\tvar pageIndex = this.pageIndex;\r\n\tvar elements = this.elements;\r\n\tvar bar;\r\n\tvar findControlBar = function() {\r\n\t\treturn elements.find('#controlBar')\r\n\t};\r\n\r\n\t/**\r\n\t * 主场景工具栏设置\r\n\t */\r\n\tif (this.isMain) {\r\n\t\tbar = pMainBar(scenarioId, pageTotal);\r\n\t\tif (config.scrollPaintingMode) {\r\n\t\t\t//word模式,自动启动工具条\r\n\t\t\tthis.sToolbar = new BookToolBar({\r\n\t\t\t\tcontainer: elements,\r\n\t\t\t\tcontrolBar: findControlBar(),\r\n\t\t\t\tpageMode: bar.pageMode\r\n\t\t\t});\r\n\t\t} else if (_.some(bar.tbType)) {\r\n\t\t\t//普通模式\r\n\t\t\tthis.sToolbar = new MainBar({\r\n\t\t\t\tcontainer: elements,\r\n\t\t\t\tcontrolBar: findControlBar(),\r\n\t\t\t\tpageTotal: pageTotal,\r\n\t\t\t\tcurrentPage: pageIndex + 1,\r\n\t\t\t\tpageMode: bar.pageMode\r\n\t\t\t});\r\n\t\t}\r\n\t} else {\r\n\t\t/**\r\n\t\t * 副场景\r\n\t\t * @type {[type]}\r\n\t\t */\r\n\t\tbar = pDeputyBar(this.barInfo, pageTotal);\r\n\t\t//创建工具栏\r\n\t\tif (bar) {\r\n\t\t\tthis.cToolbar = new DeputyBar({\r\n\t\t\t\tid          : scenarioId,\r\n\t\t\t\tcontainer   : elements,\r\n\t\t\t\ttbType      : bar.tbType,\r\n\t\t\t\tpageTotal   : pageTotal,\r\n\t\t\t\tcurrentPage : pageIndex,\r\n\t\t\t\tpageMode    : bar.pageMode\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\treturn bar;\r\n}\r\n\r\n\r\n/**\r\n * 构建创建对象\r\n * @return {[type]} [description]\r\n */\r\nsceneProto.createViewModel = function() {\r\n\r\n\tvar self = this;\r\n\tvar scenarioId = this.scenarioId;\r\n\tvar pageTotal = this.pageTotal;\r\n\tvar pageIndex = this.pageIndex;\r\n\tvar elements = this.elements;\r\n\tvar pageMode = this.pageMode;\r\n\tvar isMain = this.isMain;\r\n\tvar tempfind = findContainer(elements, scenarioId, isMain)\r\n\t\t//页面容器\r\n\tvar scenarioPage = tempfind('pageContainer', 'scenarioPage-');\r\n\t//视差容器\r\n\tvar scenarioMaster = tempfind('masterContainer', 'scenarioMaster-');\r\n\r\n\t//场景容器对象\r\n\tvar vm = this.vm = new Manager({\r\n\t\t'container': this.elements[0],\r\n\t\t'pageMode': pageMode,\r\n\t\t'multiScenario': !isMain,\r\n\t\t'rootPage': scenarioPage,\r\n\t\t'rootMaster': scenarioMaster,\r\n\t\t'initIndex': pageIndex, //保存索引从0开始\r\n\t\t'pagetotal': pageTotal,\r\n\t\t'sectionRang': this.sectionRang,\r\n\t\t'scenarioId': scenarioId,\r\n\t\t'chapterId': this.chapterId,\r\n\t\t'isInApp': this.isInApp //提示页面\r\n\t});\r\n\r\n\t/**\r\n\t * 配置选项\r\n\t * @type {[type]}\r\n\t */\r\n\tvar isToolbar = this.isToolbar = this.cToolbar ? this.cToolbar : this.sToolbar;\r\n\r\n\r\n\t/**\r\n\t * 监听翻页\r\n\t * 用于更新页码\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('pageUpdate', function(pageIndex) {\r\n\t\tisToolbar && isToolbar.updatePointer(pageIndex);\r\n\t})\r\n\r\n\r\n\t/**\r\n\t * 显示下一页按钮\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('showNext', function() {\r\n\t\tisToolbar && isToolbar.showNext();\r\n\t})\r\n\r\n\r\n\t/**\r\n\t * 隐藏下一页按钮\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('hideNext', function() {\r\n\t\tisToolbar && isToolbar.hideNext();\r\n\t})\r\n\r\n\t/**\r\n\t * 显示上一页按钮\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('showPrev', function() {\r\n\t\tisToolbar && isToolbar.showPrev();\r\n\t})\r\n\r\n\r\n\t/**\r\n\t * 隐藏上一页按钮\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('hidePrev', function() {\r\n\t\tisToolbar && isToolbar.hidePrev();\r\n\t})\r\n\r\n\t/**\r\n\t * 切换工具栏\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('toggleToolbar', function(state, pointer) {\r\n\t\tisToolbar && isToolbar.toggle(state, pointer);\r\n\t})\r\n\r\n\r\n\t/**\r\n\t * 复位工具栏\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('resetToolbar', function() {\r\n\t\tself.sToolbar && self.sToolbar.reset();\r\n\t})\r\n\r\n\r\n\t/**\r\n\t * 监听创建完成\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tvm.$bind('createComplete', function(nextAction) {\r\n\t\tself.complete && setTimeout(function() {\r\n\t\t\tif (isMain) {\r\n\t\t\t\tself.complete(function() {\r\n\t\t\t\t\tXut.View.HideBusy()\r\n\t\t\t\t\t\t//检测是不是有缓存加载\r\n\t\t\t\t\tif (!checkHistory(self.history)) {\r\n\t\t\t\t\t\t//指定自动运行的动作\r\n\t\t\t\t\t\tnextAction && nextAction();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//全局接口,应用加载完毕\r\n\t\t\t\t\tXut.Application.AddEventListener();\r\n\t\t\t\t})\r\n\t\t\t} else {\r\n\t\t\t\tself.complete(nextAction)\r\n\t\t\t}\r\n\t\t}, 200);\r\n\t})\r\n\r\n\r\n\t//如果是读酷端加载\r\n\tif (DUKUCONFIG && isMain && DUKUCONFIG.success) {\r\n\t\tDUKUCONFIG.success();\r\n\t\tvm.$init();\r\n\t\t//如果是客户端加载\r\n\t} else if (CLIENTCONFIGT && isMain && CLIENTCONFIGT.success) {\r\n\t\tCLIENTCONFIGT.success();\r\n\t\tvm.$init();\r\n\t} else {\r\n\t\t//正常加载\r\n\t\tvm.$init();\r\n\t}\r\n\r\n\t/**\r\n\t * 绑定桌面调试\r\n\t */\r\n\tconfig.debugMode && Xut.plat.isBrowser && this.bindWatch();\r\n}\r\n\r\n\r\n\r\n/**\r\n * 为桌面测试\r\n * 绑定调试\r\n * @return {[type]} [description]\r\n */\r\nsceneProto.bindWatch = function() {\r\n\t// for test\r\n\tif (Xut.plat.isBrowser) {\r\n\t\tvar vm = this.vm;\r\n\t\tthis.testWatch = $(\".xut-controlBar-pageNum\").click(function() {\r\n\t\t\tconsole.log('主场景', vm)\r\n\t\t\tconsole.log('主场景容器', vm.$scheduler.pageMgr.Collections)\r\n\t\t\tconsole.log('主场景视觉差容器', vm.$scheduler.parallaxMgr && vm.$scheduler.parallaxMgr.Collections)\r\n\t\t\tconsole.log('多场景', sceneControll.expose())\r\n\t\t\tconsole.log('音频', Xut.AudioManager);\r\n\t\t\tconsole.log('视频', Xut.VideoManager);\r\n\t\t\tconsole.log('数据库', Xut.data);\r\n\t\t})\r\n\t}\r\n}\r\n\r\n\r\n\r\n//=============================退出处理,销毁=============================================\r\n\r\n\r\n/**\r\n * 销毁场景对象\r\n * @return {[type]} [description]\r\n */\r\nsceneProto.destroy = function() {\r\n\t/**\r\n\t * 桌面调试\r\n\t */\r\n\tif (this.testWatch) {\r\n\t\tthis.testWatch.off();\r\n\t\tthis.testWatch = null;\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁当前场景\r\n\t */\r\n\tthis.vm.$destroy();\r\n\r\n\t/**\r\n\t * 销毁工具栏\r\n\t */\r\n\tif (this.isToolbar) {\r\n\t\tthis.isToolbar.destroy();\r\n\t\tthis.isToolbar = null;\r\n\t}\r\n\r\n\tthis.container = null;\r\n\r\n\t//销毁节点\r\n\tthis.elements.off();\r\n\tthis.elements.remove();\r\n\tthis.elements = null;\r\n\r\n\t//销毁引用\r\n\tsceneControll.remove(this.scenarioId)\r\n}\r\n\r\n\r\n\r\nexport {\r\n\tSceneFactory as sceneFactory\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scenario/factory.js\n **/","\r\n/**\r\n * 布局文件\r\n * 1 控制条\r\n * 2 导航栏\r\n * @param  {[type]} config [description]\r\n * @return {[type]}        [description]\r\n */\r\nlet config\r\nlet round\r\nlet ratio\r\nlet isIOS\r\nlet iconHeight\r\nlet proportion\r\nlet calculate\r\nlet TOP\r\nlet sWidth\r\nlet sHeight\r\nlet navHeight //菜单的高度\r\nlet navWidth //菜单的宽度\r\n\r\nfunction setOption() {\r\n    config = Xut.config\r\n    round = Math.round\r\n    ratio = 6\r\n    isIOS = Xut.plat.isIOS\r\n    iconHeight = config.iconHeight\r\n    proportion = config.proportion\r\n    calculate = proportion.calculateContainer()\r\n    TOP = isIOS ? 20 : 0\r\n    sWidth = calculate.width\r\n    sHeight = calculate.height\r\n    proportion = config.layoutMode == \"horizontal\" ? proportion.width : proportion.height\r\n    iconHeight = isIOS ? iconHeight : round(proportion * iconHeight)\r\n}\r\n\r\n/**\r\n * 首页布局\r\n * @return {[type]} [description]\r\n */\r\nexport function home() {\r\n\r\n    setOption()\r\n\r\n    let retStr = ''\r\n    let style\r\n\r\n    if (config.scrollPaintingMode) {\r\n        retStr = '<div id=\"sceneHome\" style =\"width:' + (config.virtualMode ? sWidth / 2 : sWidth) + 'px;height:' + sHeight + 'px;top:' + calculate.top + 'px;left:' + calculate.left + 'px;z-index:' + Xut.sceneController.createIndex() + '\" class=\"xut-chapter\">';\r\n    } else {\r\n        //overflow:hidden;\r\n        retStr = '<div id=\"sceneHome\" style =\"width:' + (config.virtualMode ? sWidth / 2 : sWidth) + 'px;height:' + sHeight + 'px;top:' + calculate.top + 'px;left:' + calculate.left + 'px;overflow:hidden;z-index:' + Xut.sceneController.createIndex() + '\" class=\"xut-chapter\">';\r\n    }\r\n    retStr += '<div id=\"controlBar\" class=\"xut-controlBar hide\"></div>';\r\n    retStr += '<ul id=\"pageContainer\" class=\"xut-flip\"></ul>'; //页面节点\r\n    retStr += '<ul id=\"masterContainer\" class=\"xut-master xut-flip\"></ul>'; //视觉差包装容器\r\n\r\n    //滑动菜单\r\n    if (config.layoutMode == 'horizontal') {\r\n        navHeight = round(sHeight / ratio); //菜单的高度\r\n        style = 'overflow:hidden;width:100%;height:' + navHeight + 'px;background-color:white;bottom:4px;border-top:1px solid rgba(0,0,0,0.1)';\r\n    } else {\r\n        navWidth = Math.min(sWidth, sHeight) / (isIOS ? 8 : 3); //菜单宽度\r\n        navHeight = round((sHeight - iconHeight - TOP) * 0.96);\r\n        style = 'width:' + navWidth + 'px;height:' + navHeight + 'px;background-color:white;top:' + (iconHeight + TOP + 2) + 'px;left:' + iconHeight + 'px;border-top:1px solid rgba(0,0,0,0.1)';\r\n    }\r\n\r\n    retStr += '<div id=\"navBar\" class=\"xut-navBar\" style=\"' + style + '\"></div>';\r\n    //消息提示框\r\n    retStr += '<div id=\"toolTip\"></div>';\r\n    retStr += '</div>';\r\n    return retStr;\r\n}\r\n\r\n\r\n/**\r\n * [scene 创建场景]\r\n * @param  {[type]} options [description]\r\n * @return {[type]}         [description]\r\n */\r\nexport function scene(id) {\r\n\r\n    setOption()\r\n\r\n    var wapper = '';\r\n    if (config.scrollPaintingMode) {\r\n        wapper = '<div id=\"{0}\" class=\"xut-waitLoad\" style=\"width:{1}px;height:{2}px;top:{3}px;left:{4}px;position:absolute;z-index:{5};\">' +\r\n            '<ul id=\"{6}\" class=\"xut-flip\" style=\"z-index:{7}\"></ul>' +\r\n            '<ul id=\"{8}\" class=\"xut-flip\" style=\"z-index:{9}\"></ul>' +\r\n            '</div>';\r\n    } else {\r\n        wapper = '<div id=\"{0}\" class=\"xut-waitLoad\" style=\"width:{1}px;height:{2}px;top:{3}px;left:{4}px;position:absolute;overflow:hidden;z-index:{5};\">' +\r\n            '<ul id=\"{6}\" class=\"xut-flip\" style=\"z-index:{7}\"></ul>' +\r\n            '<ul id=\"{8}\" class=\"xut-flip\" style=\"z-index:{9}\"></ul>' +\r\n            '</div>';\r\n    }\r\n    return String.format(wapper, 'scenario-' + id, config.virtualMode ? sWidth / 2 : sWidth, sHeight, calculate.top, calculate.left, Xut.sceneController.createIndex(),\r\n        'scenarioPage-' + id, 2,\r\n        'scenarioMaster-' + id, 1\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * [nav 导航菜单]\r\n * @param  {[type]} seasonSqlRet [description]\r\n * @return {[type]}              [description]\r\n */\r\nexport function nav(seasonSqlRet) {\r\n\r\n    setOption()\r\n\r\n    var dirNum = seasonSqlRet.length,\r\n        retStr, liCss, scroller, wrapper, seasonId, chapterId, data, xxtlink;\r\n    (function SectionWrapper() {\r\n        var width, height, blank,\r\n            font = round(proportion * 2);\r\n        if (config.layoutMode == 'horizontal') {\r\n            height = round(navHeight * 0.9);\r\n            width = round(height * sWidth / sHeight); //保持缩略图的宽高比\r\n            blank = round(navHeight * 0.05); //缩略图之间的间距\r\n            scroller = 'style=\"width:' + dirNum * (width + blank) + 'px\">';\r\n            liCss = 'float:left;width:' + width + 'px;height:' + height + 'px;margin-left:' + blank + 'px';\r\n            wrapper = 'width:96%;height:' + height + 'px;margin:' + blank + 'px auto;font-size:' + font + 'em';\r\n        } else {\r\n            scroller = '>';\r\n            width = round(navWidth * 0.9);\r\n            height = round(navWidth * 1.1);\r\n            blank = round(navWidth * 0.05);\r\n            liCss = 'width:' + width + 'px;height:' + height + 'px;margin:' + blank + 'px auto;border-bottom:1px solid rgba(0,0,0,0.3)';\r\n            wrapper = 'height:' + (navHeight - 4) + 'px;overflow:hidden;margin:2px auto;font-size:' + font + 'em';\r\n        }\r\n    })();\r\n\r\n    retStr = '<div id=\"SectionWrapper\" style=\"' + wrapper + '\">';\r\n    retStr += '<div id=\"Sectionscroller\" ';\r\n    retStr += scroller;\r\n    retStr += '<ul id=\"SectionThelist\">';\r\n\r\n    for (var i = 0; i < dirNum; i++) {\r\n        data = seasonSqlRet[i];\r\n        seasonId = data.seasonId;\r\n        chapterId = data._id;\r\n        xxtlink = seasonId + '-' + chapterId;\r\n        retStr += '<li style=\"' + liCss + '\">';\r\n        retStr += '<div class=\"xut-navBar-box\" data-xxtlink = \"' + xxtlink + '\">' + (i + 1) + '</div>';\r\n        retStr += '</li>';\r\n    }\r\n\r\n    retStr += '</ul></div>';\r\n\r\n    return retStr;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/scenario/layout.js\n **/","/**\r\n * 主场景工具栏\r\n * 系统工具栏\r\n */\r\nimport { ToolBar } from './base/toolBar'\r\nimport { close as navbarClose} from './navbar'\r\n\r\nvar sToolbar = ToolBar.extend({\r\n    init: function(options) {\r\n        this.arrows      = Object.create(null);\r\n        this.curTips     = null; //当前页码对象\r\n        this.Lock        = false; //操作锁\r\n        this.delay       = 50; //动画延时\r\n        this.hasTopBar   = true; //有顶部工具条\r\n        this.controlBar  = options.controlBar;\r\n        this.container   = options.container;\r\n        this.pageMode    = options.pageMode;\r\n        this.pageTotal   = options.pageTotal;\r\n        this.currentPage = options.currentPage;\r\n\r\n        //配置属性\r\n        //config\r\n        this.config = Xut.config\r\n        this.initConfig(this.config);\r\n\r\n        this.initTool();\r\n    }\r\n});\r\n  \r\n \r\nsToolbar.prototype.initTool = function() {\r\n\r\n    var bar = this.controlBar,\r\n        setting = this.settings;\r\n \r\n    //工具栏的显示状态\r\n    this.barStatus = (bar.css('display') === 'none') ? false : true;\r\n\r\n    //工具栏摆放位置\r\n    this.toolbarPostion(bar, setting.ToolbarPos);\r\n\r\n    //首页按钮\r\n    setting.HomeBut && this.createHomeIcon(bar);\r\n\r\n    //目录按钮\r\n    setting.ContentBut && this.createDirIcon(bar);\r\n\r\n    //添加标题\r\n    this.createTitle(bar);\r\n\r\n    //关闭子文档\r\n    setting.CloseBut && this.createCloseIcon(bar);\r\n\r\n    //页码数\r\n    setting.PageBut && this.createPageNum(bar);\r\n\r\n    //工具栏隐藏按钮\r\n    this.createHideToolbar(bar);\r\n\r\n    //翻页按钮\r\n    if (this.pageMode == 2) {\r\n        this.createArrows();\r\n    }\r\n\r\n    //邦定事件\r\n    this.bindButtonsEvent(bar);\r\n}\r\n\r\n//工具条的位置\r\nsToolbar.prototype.toolbarPostion = function(bar, position) {\r\n    var height = this.iconHeight,\r\n        TOP = this.barHeight;\r\n    if (position == 1) { //在底部\r\n        bar.css({\r\n            bottom: 0,\r\n            height: height + 'px'\r\n        });\r\n    } else { //在顶部\r\n        bar.css({\r\n            top: 0,\r\n            height: height + 'px',\r\n            paddingTop: TOP + 'px'\r\n        });\r\n    }\r\n}\r\n\r\n//创建主页按钮\r\nsToolbar.prototype.createHomeIcon = function(bar) {\r\n    var str = '<div id=\"backHome\" style=\"float:left;text-indent:0.25em;height:{0}px;line-height:{1}px;color:#007aff\">主页</div>',\r\n        height = this.iconHeight,\r\n        html = $(String.format(str, height, height));\r\n    bar.append(html);\r\n}\r\n\r\n//创建目录按钮\r\nsToolbar.prototype.createDirIcon = function(bar) {\r\n    var str = '<div id=\"backDir\" class=\"xut-controlBar-backDir\" style=\"float:left;margin-left:4px;width:{0}px;height:{1}px;background-size:cover\"></div>',\r\n        height = this.iconHeight,\r\n        html = $(String.format(str, height, height));\r\n    bar.append(html);\r\n}\r\n\r\n//创建页码数\r\nsToolbar.prototype.createPageNum = function(bar) {\r\n    var height = this.iconHeight,\r\n        marginTop = height * 0.25,\r\n        iconH = height * 0.5,\r\n        str, html;\r\n    str = '<div class=\"xut-controlBar-pageNum\" style=\"float:right;margin:{0}px 4px;padding:0 0.25em;height:{1}px;line-height:{2}px;border-radius:0.5em\"><span>{3}</span>/<span>{4}</span></div>';\r\n    html = $(String.format(str, marginTop, iconH, iconH, this.currentPage, this.pageTotal));\r\n    this.curTips = html.children().first();\r\n    bar.append(html);\r\n}\r\n\r\n//工具栏隐藏按钮\r\nsToolbar.prototype.createHideToolbar = function(bar) {\r\n    var html, style,\r\n        height = this.iconHeight;\r\n    style = 'float:right;width:' + height + 'px;height:' + height + 'px;background-size:cover';\r\n    html = '<div id=\"hideToolbar\" class=\"xut-controlBar-hide\" style=\"' + style + '\"></div>';\r\n    bar.append(html);\r\n}\r\n\r\n//关闭子文档按钮\r\nsToolbar.prototype.createCloseIcon = function(bar) {\r\n    var style, html, height = this.iconHeight;\r\n    style = 'float:right;margin-right:4px;width:' + height + 'px;height:' + height + 'px';\r\n    html = '<div class=\"si-icon\" data-icon-name=\"close\" style=\"' + style + '\"></div>';\r\n    html = $(html);\r\n    this.createSVGIcon(html[0],\r\n        function() {\r\n            if (SUbDOCCONTEXT) {\r\n                SUbDOCCONTEXT.Xut.publish('subdoc:dropApp');\r\n            } else {\r\n                Xut.publish('magazine:dropApp');\r\n            }\r\n        }\r\n    );\r\n    bar.append(html);\r\n}\r\n\r\n//应用标题\r\nsToolbar.prototype.createTitle = function(bar) {\r\n    var style, html,\r\n        appName = this.appName,\r\n        height = this.iconHeight;\r\n    style = 'width:100%;position:absolute;line-height:' + height + 'px;pointer-events:none';\r\n    html = '<div class=\"xut-controlBar-title\" style=\"z-index:-99;' + style + '\">' + appName + '</div>';\r\n    bar.append(html);\r\n}\r\n\r\n/**\r\n * [ 返回按钮]\r\n * @return {[type]} [description]\r\n */\r\nsToolbar.prototype.createBackIcon = function(container) {\r\n    var style, html,\r\n        height = this.iconHeight;\r\n    style = 'float:left;width:' + height + 'px;height:' + height + 'px';\r\n    html = '<div class=\"si-icon\" data-icon-name=\"back\" style=\"' + style + '\"></div>';\r\n    html = $(html);\r\n    this.createSVGIcon(html[0],\r\n        function() {\r\n            Xut.Application.Suspend({\r\n                dispose: function() { //停止热点动作\r\n                    Xut.Application.DropApp(); //退出应用\r\n                },\r\n                processed: function() {\r\n                    Xut.Application.DropApp(); //退出应用\r\n                }\r\n            });\r\n        }\r\n    );\r\n    container.append(html);\r\n}\r\n\r\n/**\r\n * 更新页码指示\r\n * @return {[type]} [description]\r\n */\r\nsToolbar.prototype.updatePointer = function(pageIndex) {\r\n    this.curTips && this.curTips.html(pageIndex + 1);\r\n}\r\n\r\nsToolbar.prototype.bindButtonsEvent = function(bar) {\r\n    var that = this;\r\n    bar.on(\"touchend mouseup\", function(e) {\r\n        var type = Xut.plat.evtTarget(e).id;\r\n        switch (type) {\r\n            case \"backHome\":\r\n                that.homeControl();\r\n                break;\r\n            case \"backDir\":\r\n                that.navigationBar();\r\n                break;\r\n            case 'hideToolbar':\r\n                that.hideTopBar();\r\n                break;\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * [ 跳转处理]\r\n * @return {[type]} [description]\r\n */\r\nsToolbar.prototype.homeControl = function() {\r\n    if (DUKUCONFIG) {\r\n        Xut.Application.Suspend({\r\n            dispose: function() {\r\n                Xut.Application.DropApp() //退出应用\r\n            },\r\n            processed: function() {\r\n                Xut.Application.DropApp() //退出应用\r\n            }\r\n        });\r\n        return;\r\n    }\r\n\r\n    Xut.Application.Suspend({\r\n        dispose: function(promptMessage) {\r\n            //停止热点动作\r\n            //promptMessage('再按一次将跳至首页！')\r\n        },\r\n        processed: function() {\r\n            Xut.View.GotoSlide(1) //调整到首页\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * [ 打开目录关闭当前页面活动热点]\r\n * @return {[type]} [description]\r\n */\r\nsToolbar.prototype.navigationBar = function() {\r\n   initNavBar(Xut.Presentation.GetPageIndex());\r\n}\r\n\r\n\r\n/**\r\n * [ 显示顶部工具栏]\r\n * @return {[type]} [description]\r\n */\r\nsToolbar.prototype.showTopBar = function() {\r\n    var that = this;\r\n\r\n    if (this.barStatus) {\r\n        this.Lock = false;\r\n        return;\r\n    }\r\n    this.controlBar.css({\r\n        'display': 'block',\r\n        'opacity': 0\r\n    });\r\n  \r\n    setTimeout(function() {\r\n        that.controlBar.animate({\r\n            'opacity': 1\r\n        }, that.delay, 'linear', function() {\r\n            navbarClose();\r\n            that.showSystemBar();\r\n            that.barStatus = true;\r\n            that.Lock = false;\r\n        });\r\n    }); \r\n} \r\n     \r\n/**\r\n * [ 隐藏顶部工具栏]\r\n * @return {[type]} [description]\r\n */\r\nsToolbar.prototype.hideTopBar = function() {\r\n    var that = this;\r\n\r\n    if (!this.barStatus) {\r\n        this.Lock = false;\r\n        return;\r\n    } \r\n \r\n    this.controlBar.animate({\r\n        'opacity': 0\r\n    }, that.delay, 'linear', function() {\r\n        navbarClose();\r\n        that.controlBar.hide();\r\n        that.hideSystemBar();\r\n        that.barStatus = false;\r\n        that.Lock = false;\r\n    });\r\n} \r\n\r\n\r\n//销毁 \r\nsToolbar.prototype.destroy = function() {\r\n    this.controlBar.off();\r\n    this.controlBar = null;\r\n    this.arrows = null;\r\n    this.curTips = null;\r\n    this.barStatus = false;\r\n}\r\n\r\n export {\r\n \tsToolbar\r\n }\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/sysbar.js\n **/","import {\r\n    svgIcon\r\n}\r\nfrom './svgicon'\r\nimport {\r\n    iconConfig\r\n}from './iconconfig'\r\n\r\n\r\nlet isIOS = Xut.plat.isIOS\r\n\r\n//获取翻页按钮位置\r\nvar arrowStyle = function() {\r\n    var config = Xut.config\r\n    var height = config.iconHeight\r\n    var settings = config.settings\r\n    var styleText = 'height:' + height + 'px;width:' + height + 'px';\r\n    switch (settings.NavbarPos) {\r\n        case 0:\r\n            styleText += ';top:0';\r\n            break; //顶部\r\n        case 1:\r\n            styleText += ';margin-top:' + (-height / 2) + 'px';\r\n            break; //中间\r\n        case 2:\r\n            styleText += ';top:auto;bottom:0';\r\n            break; //底部\r\n        default:\r\n            break;\r\n    }\r\n\r\n    return styleText;\r\n}\r\n\r\n//工具栏基础类\r\nlet ToolBar = Xut.CoreObject.extend({\r\n    barHeight: isIOS ? 20 : 0, //系统状态栏高度\r\n    enableLeft: true, //默认创建左翻页按钮\r\n    enableRight: true //默认创建右翻页按钮\r\n})\r\n\r\nToolBar.prototype.initConfig = function(config) {\r\n    var propHeight;\r\n    //获取高度缩放比\r\n    //自动选择缩放比例\r\n    this.propHeight = propHeight = function() {\r\n        var layout = config.layoutMode,\r\n            prop = config.proportion;\r\n        return layout == \"horizontal\" ? prop.width : prop.height;\r\n    }()\r\n\r\n    //获取图标高度\r\n    //工具栏图标高度\r\n    this.iconHeight = function() {\r\n        var height = config.iconHeight;\r\n        return isIOS ? height : Math.round(propHeight * height);\r\n    }()\r\n\r\n    this.appName = config.shortName //应用标题\r\n    this.settings = config.settings //应用默认配置\r\n}\r\n\r\n\r\n//创建翻页按钮\r\nToolBar.prototype.createArrows = function() {\r\n    //是否使用自定义的翻页按钮: true /false\r\n    //图标名称是客户端指定的：pageforward_'+appId+'.svg\r\n    var isCustom = this.settings.customButton;\r\n\r\n    if (this.enableLeft) {\r\n        isCustom ? this.createLeftIcon() : this.createLeftArrow();\r\n    }\r\n\r\n    if (this.enableRight) {\r\n        isCustom ? this.createRightIcon() : this.createRightArrow();\r\n    }\r\n}\r\n\r\n//左箭头翻页按钮\r\nToolBar.prototype.createLeftArrow = function() {\r\n    var style = arrowStyle(),\r\n        state = this.barStatus ? '' : 'hide',\r\n        $dom;\r\n    $dom = $('<div class=\"si-icon xut-flip-control left ' + state + '\" data-icon-name=\"prevArrow\" style=\"' + style + '\"></div>');\r\n\r\n    this.createSVGIcon($dom[0],\r\n        function() {\r\n            Xut.View.GotoPrevSlide();\r\n        }\r\n    );\r\n\r\n    this.container.append($dom);\r\n    this.arrows.prev = {\r\n        el: $dom,\r\n        able: true\r\n    };\r\n}\r\n\r\n//右箭头翻页按钮\r\nToolBar.prototype.createRightArrow = function() {\r\n    var style = arrowStyle(),\r\n        state = this.barStatus ? '' : 'hide',\r\n        $dom;\r\n    $dom = $('<div class=\"si-icon xut-flip-control right ' + state + '\" data-icon-name=\"nextArrow\" style=\"' + style + '\"></div>');\r\n\r\n    this.createSVGIcon($dom[0],\r\n        function() {\r\n            Xut.View.GotoNextSlide();\r\n        }\r\n    );\r\n\r\n    this.container.append($dom);\r\n    this.arrows.next = {\r\n        el: $dom,\r\n        able: true\r\n    };\r\n}\r\n\r\n//自定义左翻页按钮\r\nToolBar.prototype.createLeftIcon = function() {\r\n    var style = arrowStyle(),\r\n        appId = this.config.appId,\r\n        state = this.barStatus ? '' : 'hide',\r\n        $dom;\r\n    style += ';background-image:url(images/icons/pageforward_' + appId + '.svg);background-size:cover';\r\n    $dom = $('<div name=\"prevArrow\" class=\"xut-flip-control left ' + state + '\" style=\"' + style + '\"></div>');\r\n\r\n    $dom.on(\"touchend mouseup\", function() {\r\n        Xut.View.GotoPrevSlide();\r\n    });\r\n\r\n    this.container.append($dom);\r\n    this.arrows.prev = {\r\n        el: $dom,\r\n        able: true\r\n    };\r\n}\r\n\r\n//自定义右翻页按钮\r\nToolBar.prototype.createRightIcon = function() {\r\n    var style = arrowStyle(),\r\n        appId = this.config.appId,\r\n        state = this.barStatus ? '' : 'hide',\r\n        $dom;\r\n    style += ';background-image:url(images/icons/pageback_' + appId + '.svg);background-size:cover';\r\n    $dom = $('<div name=\"nextArrow\" class=\"xut-flip-control right ' + state + '\" style=\"' + style + '\"></div>');\r\n\r\n    $dom.on(\"touchend mouseup\", function() {\r\n        Xut.View.GotoNextSlide();\r\n    });\r\n\r\n    this.container.append($dom);\r\n    this.arrows.next = {\r\n        el: $dom,\r\n        able: true\r\n    };\r\n}\r\n\r\n/**\r\n * [ description]\r\n * @param  {[type]} dir [next,prev]\r\n * @param  {[type]} status  [true/false]\r\n * @return {[type]}       [description]\r\n */\r\nToolBar.prototype.toggleArrow = function(dir, status) {\r\n    var arrow = this.arrows[dir];\r\n    //如果没有创建翻页按钮,则不处理\r\n    if (!arrow) return;\r\n    arrow.able = status;\r\n    //如果人为隐藏了工具栏,则不显示翻页按钮\r\n    if (this.hasTopBar && !this.barStatus && status) {\r\n        return;\r\n    }\r\n    arrow.el[status ? 'show' : 'hide']();\r\n}\r\n\r\n//隐藏下一页按钮\r\nToolBar.prototype.hideNext = function() {\r\n    this.toggleArrow('next', false);\r\n}\r\n\r\n//显示下一页按钮\r\nToolBar.prototype.showNext = function() {\r\n    this.toggleArrow('next', true);\r\n}\r\n\r\n//隐藏上一页按钮\r\nToolBar.prototype.hidePrev = function() {\r\n    this.toggleArrow('prev', false);\r\n}\r\n\r\n//显示上一页按钮\r\nToolBar.prototype.showPrev = function() {\r\n    this.toggleArrow('prev', true);\r\n}\r\n\r\n/**\r\n * [ 显示翻页按钮]\r\n * @return {[type]}        [description]\r\n */\r\nToolBar.prototype.showPageBar = function() {\r\n    var arrows = this.arrows;\r\n\r\n    for (var dir in arrows) {\r\n        var arrow = arrows[dir];\r\n        arrow.able && arrow.el.show();\r\n    }\r\n}\r\n\r\n/**\r\n * [ 隐藏翻页按钮]\r\n * @param  {[type]} unlock [description]\r\n * @return {[type]}        [description]\r\n */\r\nToolBar.prototype.hidePageBar = function() {\r\n    var arrows = this.arrows;\r\n    for (var dir in arrows) {\r\n        arrows[dir].el.hide();\r\n    }\r\n}\r\n\r\n/**\r\n * [description]\r\n * @param  {[type]} state   [description]\r\n * @param  {[type]} pointer [description]\r\n * @return {[type]}         [description]\r\n */\r\nToolBar.prototype.toggle = function(state, pointer) {\r\n    if (this.Lock) return;\r\n    this.Lock = true;\r\n\r\n    switch (state) {\r\n        case 'show':\r\n            this.showToolbar(pointer);\r\n            break;\r\n        case 'hide':\r\n            this.hideToolbar(pointer);\r\n            break;\r\n        default:\r\n            this.barStatus ? this.hideToolbar(pointer) : this.showToolbar(pointer);\r\n            break;\r\n    }\r\n}\r\n\r\n/**\r\n * [ 显示工具栏]\r\n * @param  {[type]} pointer [description]\r\n * @return {[type]}         [description]\r\n */\r\nToolBar.prototype.showToolbar = function(pointer) {\r\n    switch (pointer) {\r\n        case 'controlBar':\r\n            this.showTopBar();\r\n            break;\r\n        case 'button':\r\n            this.showPageBar();\r\n            this.Lock = false;\r\n            break;\r\n        default:\r\n            this.showTopBar();\r\n            this.showPageBar();\r\n    }\r\n}\r\n\r\n/**\r\n * [ 隐藏工具栏]\r\n * @param  {[type]} pointer [description]\r\n * @return {[type]}         [description]\r\n */\r\nToolBar.prototype.hideToolbar = function(pointer) {\r\n    switch (pointer) {\r\n        case 'controlBar':\r\n            this.hideTopBar();\r\n            break;\r\n        case 'button':\r\n            this.hidePageBar();\r\n            this.Lock = false;\r\n            break;\r\n        default:\r\n            this.hideTopBar();\r\n            this.hidePageBar();\r\n    }\r\n}\r\n\r\n/**\r\n * 显示IOS系统工具栏\r\n *  iOS状态栏0=show,1=hide\r\n * @return {[type]} [description]\r\n */\r\nToolBar.prototype.showSystemBar = function() {\r\n    isIOS && Xut.Plugin.statusbarPlugin.setStatus(null, null, 0);\r\n}\r\n\r\n/**\r\n * 隐藏IOS系统工具栏\r\n * @return {[type]} [description]\r\n */\r\nToolBar.prototype.hideSystemBar = function() {\r\n    isIOS && Xut.Plugin.statusbarPlugin.setStatus(null, null, 1);\r\n}\r\n\r\n//创建SVG按钮\r\nToolBar.prototype.createSVGIcon = function(el, callback) {\r\n    var options = {\r\n        speed: 6000,\r\n        size: {\r\n            w: this.iconHeight,\r\n            h: this.iconHeight\r\n        },\r\n        onToggle: callback\r\n    };\r\n    return new svgIcon(el, iconConfig, options);\r\n}\r\n\r\n//重置翻页按钮,状态以工具栏为标准\r\nToolBar.prototype.reset = function() {\r\n    this.barStatus ? this.showPageBar() : this.hidePageBar();\r\n}\r\n\r\n\r\n\r\nexport {\r\n    ToolBar\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/base/toolBar.js\n **/","/**\r\n * svgicons.js v1.0.0\r\n * http://www.codrops.com\r\n *\r\n * Licensed under the MIT license.\r\n * http://www.opensource.org/licenses/mit-license.php\r\n *\r\n * Copyright 2013, Codrops\r\n * http://www.codrops.com\r\n */\r\n\r\n/*** helper functions ***/\r\n\r\n// from https://github.com/desandro/classie/blob/master/classie.js\r\nfunction classReg(className) {\r\n    return new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\");\r\n}\r\n\r\nfunction hasClass(el, c) {\r\n    return 'classList' in document.documentElement ? el.classList.contains(c) : classReg(c).test(el.className)\r\n}\r\n\r\nfunction extend(a, b) {\r\n    for (var key in b) {\r\n        if (b.hasOwnProperty(key)) {\r\n            a[key] = b[key];\r\n        }\r\n    }\r\n    return a;\r\n}\r\n\r\n// from http://stackoverflow.com/a/11381730/989439\r\nfunction mobilecheck() {\r\n    var check = false;\r\n    (function(a) {\r\n        if (/(android|ipad|playbook|silk|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true\r\n    })(navigator.userAgent || navigator.vendor || window.opera);\r\n    return check;\r\n}\r\n\r\n// http://snipplr.com/view.php?codeview&id=5259\r\nfunction isMouseLeaveOrEnter(e, handler) {\r\n    if (e.type != 'mouseout' && e.type != 'mouseover') return false;\r\n    var reltg = e.relatedTarget ? e.relatedTarget :\r\n        e.type == 'mouseout' ? e.toElement : e.fromElement;\r\n    while (reltg && reltg != handler) reltg = reltg.parentNode;\r\n    return (reltg != handler);\r\n}\r\n\r\n/*** svgIcon ***/\r\n\r\nfunction svgIcon(el, config, options) {\r\n    this.el = el;\r\n    this.options = extend({}, this.options);\r\n    extend(this.options, options);\r\n    this.svg = Snap(this.options.size.w, this.options.size.h);\r\n    this.svg.attr('viewBox', '0 0 32 32');\r\n    this.el.appendChild(this.svg.node);\r\n    // state\r\n    this.toggled = false;\r\n    // icons configuration\r\n    this.config = config[this.el.getAttribute('data-icon-name')];\r\n    // reverse?\r\n    if (hasClass(this.el, 'si-icon-reverse')) {\r\n        this.reverse = true;\r\n    }\r\n    if (!this.config) return;\r\n    var self = this;\r\n    // load external svg\r\n    Snap.load(this.config.url, function(f) {\r\n        var g = f.select('g');\r\n        self.svg.append(g);\r\n        self.options.onLoad();\r\n        self._initEvents();\r\n        if (self.reverse) {\r\n            self.toggle(true);\r\n        }\r\n    });\r\n}\r\n\r\nsvgIcon.prototype.options = {\r\n    speed: 200,\r\n    easing: mina.linear,\r\n    evtoggle: 'click', // click || mouseover\r\n    size: {\r\n        w: 44,\r\n        h: 44\r\n    },\r\n    onLoad: function() {\r\n        return false;\r\n    },\r\n    onToggle: function() {\r\n        return false;\r\n    }\r\n};\r\n\r\nsvgIcon.prototype._initEvents = function() {\r\n    var self = this,\r\n        toggleFn = function(ev) {\r\n            if (((ev.type.toLowerCase() === 'mouseover' || ev.type.toLowerCase() === 'mouseout') && isMouseLeaveOrEnter(ev, this)) || ev.type.toLowerCase() === 'touchstart' || ev.type.toLowerCase() === 'mousedown') {\r\n                self.toggle(true);\r\n                self.options.onToggle();\r\n            }\r\n            return false;\r\n        };\r\n\r\n    if (this.options.evtoggle === 'mouseover') {\r\n        this.el.addEventListener('mouseover', toggleFn);\r\n        this.el.addEventListener('mouseout', toggleFn);\r\n    } else {\r\n        Xut.plat.execEvent('on', {\r\n            context: this.el,\r\n            callback: {\r\n                start: function(e) {\r\n                    toggleFn(e)\r\n                }\r\n            }\r\n        })\r\n    }\r\n};\r\n\r\nsvgIcon.prototype.toggle = function(motion) {\r\n    if (!this.config.animation) return;\r\n    var self = this;\r\n    for (var i = 0, len = this.config.animation.length; i < len; ++i) {\r\n        var a = this.config.animation[i],\r\n            el = this.svg.select(a.el),\r\n            animProp = this.toggled ? a.animProperties.from : a.animProperties.to,\r\n            val = animProp.val,\r\n            timeout = motion && animProp.delayFactor ? animProp.delayFactor : 0;\r\n\r\n        if (animProp.before) {\r\n            el.attr(JSON.parse(animProp.before));\r\n        }\r\n\r\n        if (motion) {\r\n            setTimeout(function(el, val, animProp) {\r\n                return function() {\r\n                    el.animate(JSON.parse(val), self.options.speed, self.options.easing, function() {\r\n                        if (animProp.after) {\r\n                            this.attr(JSON.parse(animProp.after));\r\n                        }\r\n                        if (animProp.animAfter) {\r\n                            this.animate(JSON.parse(animProp.animAfter), self.options.speed, self.options.easing);\r\n                        }\r\n                    });\r\n                };\r\n            }(el, val, animProp), timeout * self.options.speed);\r\n        } else {\r\n            el.attr(JSON.parse(val));\r\n        }\r\n\r\n    }\r\n    this.toggled = !this.toggled;\r\n};\r\n\r\n// add to global namespace\r\nexport {\r\n    svgIcon\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/base/svgicon.js\n **/","/**\r\n * [svgIconConfig description]\r\n * http://tympanus.net/Development/AnimatedSVGIcons/\r\n * @type {Object}\r\n */\r\nlet iconConfig = {\r\n    nextArrow: {\r\n        url: 'images/icons/pageback.svg',\r\n        animation: [{\r\n            el: 'path:nth-child(1)',\r\n            animProperties: {\r\n                from: {\r\n                    val: '{\"transform\" : \"r0 16 16\", \"fill-opacity\" : \"0.9\"}',\r\n                    before: '{\"fill-opacity\" : \"0.9\", \"stroke-opacity\" : \"0\" , \"transform\" : \"r90 16 16\"}'\r\n                },\r\n                to: {\r\n                    val: '{\"transform\" : \"r360 16 16\", \"fill-opacity\": \"0\"}',\r\n                    before: '{\"fill-opacity\" : \"0\", \"stroke-opacity\" : \"1\" }'\r\n                }\r\n            }\r\n        }]\r\n    },\r\n    prevArrow: {\r\n        url: 'images/icons/pageforward.svg',\r\n        animation: [{\r\n            el: 'path:nth-child(1)',\r\n            animProperties: {\r\n                from: {\r\n                    val: '{\"transform\" : \"r0 16 16\", \"fill-opacity\" : \"0.9\"}',\r\n                    before: '{\"fill-opacity\" : \"0.9\", \"stroke-opacity\" : \"0\" , \"transform\" : \"r90 16 16\"}'\r\n                },\r\n                to: {\r\n                    val: '{\"transform\" : \"r360 16 16\", \"fill-opacity\": \"0\"}',\r\n                    before: '{\"fill-opacity\" : \"0\", \"stroke-opacity\" : \"1\" }'\r\n                }\r\n            }\r\n        }]\r\n    },\r\n    close: {\r\n        url: 'images/icons/close.svg',\r\n        animation: [{\r\n            el: 'path:nth-child(1)',\r\n            animProperties: {\r\n                from: {\r\n                    val: '{\"transform\" : \"r0 16 16\", \"fill-opacity\" : \"0.9\"}',\r\n                    before: '{\"fill-opacity\" : \"0.9\", \"stroke-opacity\" : \"0\" , \"transform\" : \"r90 16 16\"}'\r\n                },\r\n                to: {\r\n                    val: '{\"transform\" : \"r360 16 16\", \"fill-opacity\": \"0\"}',\r\n                    before: '{\"fill-opacity\" : \"0\", \"stroke-opacity\" : \"1\" }'\r\n                }\r\n            }\r\n        }]\r\n    },\r\n    back: {\r\n        url: 'images/icons/back.svg',\r\n        animation: [{\r\n            el: 'path:nth-child(1)',\r\n            animProperties: {\r\n                from: {\r\n                    val: '{\"transform\" : \"r0 16 16\", \"fill-opacity\" : \"0.9\"}',\r\n                    before: '{\"fill-opacity\" : \"0.9\", \"stroke-opacity\" : \"0\" , \"transform\" : \"r90 16 16\"}'\r\n                },\r\n                to: {\r\n                    val: '{\"transform\" : \"r360 16 16\", \"fill-opacity\": \"0\"}',\r\n                    before: '{\"fill-opacity\" : \"0\", \"stroke-opacity\" : \"1\" }'\r\n                }\r\n            }\r\n        }]\r\n    }\r\n};\r\n\r\n\r\nexport {iconConfig}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/base/iconconfig.js\n **/","/**\r\n * 函数工具栏\r\n */\r\n\r\n\r\nimport { ToolBar } from './base/toolBar'\r\n\r\nvar fToolbar = ToolBar.extend({\r\n    init: function(options) {\r\n\t\tthis.pageTips    = null;\r\n\t\tthis.currTip     = null;\r\n\t\tthis.tipsMode    = 0;\r\n\t\tthis.top         = 0;\r\n\t\tthis.Lock        = false;\r\n\t\tthis.delay       = 50;\r\n\t\tthis.hasTopBar   = false;\r\n\t\tthis.barStatus   = true;\r\n\t\tthis.arrows      = Object.create(null);\r\n\t\t//options\r\n\t\tthis.pageMode    = options.pageMode;\r\n\t\tthis.id          = options.id;\r\n\t\tthis.container   = options.container;\r\n\t\tthis.tbType      = options.tbType;\r\n\t\tthis.pageTotal   = options.pageTotal;\r\n\t\tthis.currentPage = options.currentPage;\r\n\r\n        //配置属性\r\n        //config\r\n\t\tthis.config = Xut.config\r\n\t\tthis.initConfig(this.config);\r\n\r\n        this.initTool();\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * 创建工具栏\r\n * tbType:\r\n *\t\t0\t禁止工具栏\r\n *\t\t1\t系统工具栏   - 显示IOS系统工具栏\r\n *\t\t2\t场景工具栏   - 显示关闭按钮\r\n *\t\t3\t场景工具栏   - 显示返回按钮\r\n *\t\t4\t场景工具栏   - 显示顶部小圆点式标示\r\n *\tpageMode:\r\n *  \t0禁止滑动\r\n *\t  \t1允许滑动无翻页按钮\r\n *\t   \t2 允许滑动带翻页按钮\r\n * @return {[type]} [description]\r\n */\r\nfToolbar.prototype.initTool = function() {\r\n    var container = this.container,\r\n        type;\r\n\r\n    container.hide();\r\n    this.controlBar = [];\r\n\r\n    while (type = this.tbType.shift()) {\r\n        switch (type) {\r\n            case 1:\r\n                this.createSystemBar();\r\n                break;\r\n            case 2:\r\n                this.createCloseIcon();\r\n                break;\r\n            case 3:\r\n                this.createBackIcon(container);\r\n                break;\r\n            case 4:\r\n                this.createPageTips();\r\n                break;\r\n            default:\r\n                this.barStatus = false;\r\n                this.hasTopBar = false;\r\n                break;\r\n        }\r\n    }\r\n\r\n    //创建翻页按钮\r\n    if (this.pageMode === 2) {\r\n        this.createArrows();\r\n    }\r\n\r\n    container.show();\r\n\r\n    //邦定事件\r\n    this.bindButtonsEvent();\r\n}\r\n\r\n/**\r\n * 系统工具栏\r\n */\r\nfToolbar.prototype.createSystemBar = function() {\r\n    var id = this.id,\r\n        TOP = this.barHeight,\r\n        html = '',\r\n        style = 'top:0;height:' + this.iconHeight + 'px;padding-top:' + TOP + 'px';\r\n    html = '<div id=\"controlBar' + id + '\" class=\"xut-controlBar\" style=\"' + style + '\"></div>';\r\n    html = $(html);\r\n    this.top = TOP;\r\n    this.showSystemBar();\r\n    this.createBackIcon(html);\r\n    this.createTitle(html);\r\n    this.createPageNum(html);\r\n    this.controlBar = html;\r\n    this.container.append(html);\r\n    this.hasTopBar = true;\r\n}\r\n\r\n/**\r\n * 页码小圆点\r\n */\r\nfToolbar.prototype.createPageTips = function() {\r\n    var chapters = this.pageTotal,\r\n        height = this.iconHeight,\r\n        TOP = this.top,\r\n        isIOS = Xut.plat.isIOS,\r\n        html = '';\r\n\r\n    //如果只有一页则不显示小圆\r\n    if (chapters < 2) {\r\n        return '';\r\n    }\r\n\r\n    var calculate = this.config.proportion.calculateContainer();\r\n    //圆点尺寸\r\n    var size = isIOS ? 7 : Math.max(8, Math.round(this.propHeight * 8)),\r\n        width = 2.5 * size, //圆点间距\r\n        tipsWidth = chapters * width, //圆点总宽度\r\n        top = (height - size) / 2, //保持圆点垂直居中\r\n        left = (calculate.width - tipsWidth) / 2; //保持圆点水平居中\r\n\r\n    html = '<ul class=\"xut-scenario-tips\"  style=\"top:' + TOP + 'px;left:' + left + 'px;width:' + tipsWidth + 'px;opacity:0.6\">';\r\n    for (var i = 1; i <= chapters; i++) {\r\n        html += '<li class=\"xut-scenario-dark\" style=\"float:left;width:' + width + 'px;height:' + height + 'px;\" data-index=\"' + i + '\">';\r\n        html += '<div class=\"xut-scenario-radius\" style=\"width:' + size + 'px;height:' + size + 'px;margin:' + top + 'px auto\"></div></li>';\r\n    }\r\n    html += '</ul>';\r\n    html = $(html);\r\n    this.pageTips = html.children();\r\n    this.tipsMode = 1;\r\n    this.controlBar.push(html);\r\n    this.container.append(html);\r\n}\r\n\r\n/**\r\n * 更新页码指示\r\n * @return {[type]} [description]\r\n */\r\nfToolbar.prototype.updatePointer = function(pageIndex) {\r\n    switch (this.tipsMode) {\r\n        case 1:\r\n            if (this.prevTip) {\r\n                this.prevTip.className = 'xut-scenario-dark';\r\n            }\r\n            this.currTip = this.pageTips[pageIndex];\r\n            this.currTip.className = 'xut-scenario-light';\r\n            this.prevTip = this.currTip;\r\n            break;\r\n        case 2:\r\n            this.currTip.html(pageIndex + 1);\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\n/**\r\n * [ 关闭按钮]\r\n * @return {[type]} [description]\r\n */\r\nfToolbar.prototype.createCloseIcon = function() {\r\n    var style, html,\r\n        TOP = this.top,\r\n        height = this.iconHeight;\r\n    style = 'top:' + TOP + 'px;width:' + height + 'px;height:' + height + 'px';\r\n    html = '<div class=\"si-icon xut-scenario-close\" data-icon-name=\"close\" style=\"' + style + '\"></div>';\r\n    html = $(html);\r\n    this.createSVGIcon($(html)[0],\r\n        function() {\r\n            Xut.View.CloseScenario()\r\n        }\r\n    );\r\n    this.controlBar.push(html);\r\n    this.container.append(html);\r\n}\r\n\r\n/**\r\n * [ 返回按钮]\r\n * @return {[type]} [description]\r\n */\r\nfToolbar.prototype.createBackIcon = function(container) {\r\n    var style, html,\r\n        TOP = this.top,\r\n        height = this.iconHeight;\r\n    style = 'top:' + TOP + 'px;width:' + height + 'px;height:' + height + 'px';\r\n    html = '<div class=\"si-icon xut-scenario-back\" data-icon-name=\"back\" style=\"' + style + '\"></div>';\r\n    html = $(html);\r\n    this.createSVGIcon(html[0],\r\n        function() {\r\n            Xut.View.CloseScenario()\r\n        }\r\n    );\r\n    this.controlBar.push(html);\r\n    container.append(html);\r\n}\r\n\r\n//创建页码数\r\nfToolbar.prototype.createPageNum = function(container) {\r\n    var pageTotal = this.pageTotal,\r\n        TOP = this.top,\r\n        height = this.iconHeight,\r\n        currentPage = this.currentPage,\r\n        style, html;\r\n    style = 'position:absolute;right:4px;top:' + (height * 0.25 + TOP) + 'px;padding:0 0.25em;height:' + height * 0.5 + 'px;line-height:' + height * 0.5 + 'px;border-radius:0.5em';\r\n    html = '<div class=\"xut-controlBar-pageNum\" style=\"' + style + '\">';\r\n    html += '<span class=\"currentPage\">' + currentPage + '</span>/<span>' + pageTotal + '</span>';\r\n    html += '</div>';\r\n    html = $(html);\r\n    this.tipsMode = 2;\r\n    this.currTip = html.children().first();\r\n    container.append(html);\r\n}\r\n\r\n//工具栏隐藏按钮\r\nfToolbar.prototype.createHideToolbar = function(container) {\r\n    var html, style,\r\n        TOP = this.top,\r\n        height = this.iconHeight,\r\n        right = iconHeight * 2.5;\r\n    style = 'position:absolute;right:' + right + 'px;top:' + TOP + 'px;width:' + height + 'px;height:' + height + 'px;background-size:cover';\r\n    html = '<div class=\"xut-controlBar-hide\" style=\"' + style + '\"></div>';\r\n    container.append(html);\r\n}\r\n\r\n//应用标题\r\nfToolbar.prototype.createTitle = function(container) {\r\n    var style, html,\r\n        appName = this.appName;\r\n    style = 'line-height:' + this.iconHeight + 'px';\r\n    html = '<div class=\"xut-controlBar-title\" style=\"' + style + '\">' + appName + '</div>';\r\n    container.append(html)\r\n}\r\n\r\n\r\n/**\r\n * [ 普通按钮邦定事件]\r\n * @param  {[type]} bar [description]\r\n * @return {[type]}     [description]\r\n */\r\nfToolbar.prototype.bindButtonsEvent = function() {\r\n    var that = this,\r\n        index = 1,\r\n        id = this.id;\r\n\r\n    this.container.on(\"touchend touchend\", function(e) {\r\n        var target = Xut.plat.evtTarget(e),\r\n            type = target.className;\r\n        switch (type) {\r\n            case 'xut-controlBar-hide':\r\n                that.hideTopBar();\r\n                break;\r\n            case 'xut-scenario-dark':\r\n                if (that.pageMode) {\r\n                    index = target.getAttribute('data-index') || 1;\r\n                    Xut.View.GotoSlide(Number(index));\r\n                }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * [ 显示顶部工具栏]\r\n * @return {[type]} [description]\r\n */\r\nfToolbar.prototype.showTopBar = function() {\r\n    var that = this,\r\n        delay = this.delay,\r\n        controlBar = this.controlBar;\r\n    if (this.barStatus) {\r\n        this.Lock = false;\r\n        return;\r\n    }\r\n    if (this.hasTopBar) {\r\n        controlBar.css({\r\n            'display': 'block',\r\n            'opacity': 0\r\n        });\r\n        setTimeout(function() {\r\n            controlBar.animate({\r\n                'opacity': 1\r\n            }, delay, 'linear', function() {\r\n                that.showSystemBar();\r\n                that.barStatus = true;\r\n                that.Lock = false;\r\n            });\r\n        });\r\n    } else {\r\n        controlBar.forEach(function(el) {\r\n            el.show();\r\n            that.Lock = false;\r\n            that.barStatus = true;\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * [ 隐藏顶部工具栏]\r\n * @return {[type]} [description]\r\n */\r\nfToolbar.prototype.hideTopBar = function() {\r\n    var that = this,\r\n        delay = this.delay,\r\n        controlBar = this.controlBar;\r\n\r\n    if (!this.barStatus) {\r\n        this.Lock = false;\r\n        return;\r\n    }\r\n    if (this.hasTopBar) {\r\n        controlBar.animate({\r\n            'opacity': 0\r\n        }, delay, 'linear', function() {\r\n            that.controlBar.hide();\r\n            that.hideSystemBar();\r\n            that.barStatus = false;\r\n            that.Lock = false;\r\n        });\r\n    } else {\r\n        controlBar.forEach(function(el) {\r\n            el.hide(delay, function() {\r\n                that.Lock = false;\r\n                that.barStatus = false;\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nfToolbar.prototype.destroy = function() {\r\n    this.container.off();\r\n    this.controlBar = null;\r\n    this.arrows = null;\r\n    this.pageTips = null;\r\n    this.currTip = null;\r\n    this.prevTip = null;\r\n}\r\n\r\n\r\n\r\nexport {\r\n    fToolbar \r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/fnbar.js\n **/","import { BookMark } from './bookmark'\r\nimport { ToolBar } from './base/toolBar'\r\nimport { parseJSON } from '../util/index'\r\n\r\n/**\r\n * 阅读模式工具栏\r\n * @param options object\r\n * @demo {container:页面容器,controlBar:工具栏容器,...}\r\n * @desc 继承自Toolbar.js\r\n */\r\n\r\nvar Bar = ToolBar.extend({\r\n    init: function(options) {\r\n        //左右箭头\r\n        this.arrows = {};\r\n        //工具栏父容器\r\n        this.container = options.container;\r\n        //工具栏容器\r\n        this.controlBar = options.controlBar;\r\n        this.pageMode = options.pageMode;\r\n        //是否有顶部工具栏\r\n        this.hasTopBar = true;\r\n        this.Lock = false;\r\n        this.delay = 50;\r\n        //图书工具栏高度\r\n        this.topBarHeight = this.iconHeight * 1.25;\r\n\r\n        //配置属性\r\n        //config\r\n        this.config = Xut.config\r\n        this.initConfig(this.config);\r\n\r\n        this.initTool();\r\n    }\r\n});\r\n\r\n/**\r\n * 初始化\r\n */\r\nBar.prototype.initTool = function() {\r\n    //工具栏的显示状态\r\n    var display = this.controlBar.css('display');\r\n    this.barStatus = display == 'none' ? false : true;\r\n    this.setToolbarStyle();\r\n    this.createBackIcon();\r\n    this.createDirIcon();\r\n    this.createMarkIcon();\r\n    // this.createStarIcon();\r\n\r\n    //翻页按钮\r\n    if (this.pageMode == 2) {\r\n        this.createArrows();\r\n    }\r\n\r\n    //监听事件\r\n    var ele = this.container[0];\r\n\r\n    Xut.plat.execEvent('on', {\r\n        context: ele,\r\n        callback: {\r\n            end: this\r\n        }\r\n    })\r\n\r\n}\r\n\r\n/**\r\n * 工具条的样式\r\n */\r\nBar.prototype.setToolbarStyle = function() {\r\n    var height = this.topBarHeight,\r\n        TOP = this.barHeight; //系统工具栏占用的高度\r\n\r\n    //在顶部\r\n    this.controlBar.css({\r\n        top: 0,\r\n        height: height + 'px',\r\n        paddingTop: TOP + 'px',\r\n        backgroundColor: 'rgba(0, 0, 0, 0.2)', //transparent\r\n        fontSize: '0.625em',\r\n        color: 'white'\r\n    });\r\n\r\n}\r\n\r\n/**\r\n * 更新页码\r\n */\r\nBar.prototype.updatePointer = function() {\r\n    //预留\r\n}\r\n\r\n/**\r\n * 创建目录图标\r\n */\r\nBar.prototype.createDirIcon = function(bar) {\r\n    var icon = document.createElement('div');\r\n    icon.innerHTML = '目录';\r\n    icon.style.width = this.iconHeight + 'px';\r\n    icon.style.lineHeight = 1.5 * this.topBarHeight + 'px';\r\n    icon.className = 'xut-book-bar-dir';\r\n    this.controlBar.append(icon)\r\n}\r\n\r\n//创建书签图标\r\nBar.prototype.createMarkIcon = function(bar) {\r\n    var icon = document.createElement('div');\r\n    icon.innerHTML = '书签';\r\n    icon.style.width = this.iconHeight + 'px';\r\n    icon.style.lineHeight = 1.5 * this.topBarHeight + 'px';\r\n    icon.className = 'xut-book-bar-mark';\r\n    this.controlBar.append(icon)\r\n}\r\n\r\n/**\r\n * 创建评分图标\r\n */\r\nBar.prototype.createStarIcon = function(bar) {\r\n    var icon = document.createElement('div');\r\n    icon.innerHTML = '评分';\r\n    icon.style.width = this.iconHeight + 'px';\r\n    icon.style.lineHeight = 1.5 * this.topBarHeight + 'px';\r\n    icon.className = 'xut-book-bar-star';\r\n    this.controlBar.append(icon)\r\n}\r\n\r\n/**\r\n * 后退按钮\r\n * @return {[type]} [description]\r\n */\r\nBar.prototype.createBackIcon = function() {\r\n    var icon = document.createElement('div');\r\n    icon.style.width = this.topBarHeight + 'px';\r\n    icon.className = 'xut-book-bar-back';\r\n    this.controlBar.append(icon)\r\n}\r\n\r\n/**\r\n * 显示顶部工具栏\r\n * @return {[type]} [description]\r\n */\r\nBar.prototype.showTopBar = function() {\r\n    var that = this;\r\n\r\n    if (this.barStatus) {\r\n        this.Lock = false;\r\n        return;\r\n    }\r\n\r\n    this.controlBar.css({\r\n        'display': 'block',\r\n        'opacity': 0\r\n    });\r\n\r\n    setTimeout(function() {\r\n        that.controlBar.animate({\r\n            'opacity': 1\r\n        }, that.delay, 'linear', function() {\r\n            that.showSystemBar();\r\n            that.barStatus = true;\r\n            that.Lock = false;\r\n        });\r\n    }, 50);\r\n}\r\n\r\n/**\r\n * 隐藏顶部工具栏\r\n * @return {[type]} [description]\r\n */\r\nBar.prototype.hideTopBar = function() {\r\n    var that = this;\r\n\r\n    if (!this.barStatus) {\r\n        this.Lock = false;\r\n        return;\r\n    }\r\n\r\n    this.controlBar.animate({\r\n        'opacity': 0\r\n    }, that.delay, 'linear', function() {\r\n        that.controlBar.hide();\r\n        that.hideSystemBar();\r\n        that.barStatus = false;\r\n        that.Lock = false;\r\n    });\r\n}\r\n\r\n/**\r\n * 创建目录菜单\r\n */\r\nBar.prototype.createDirMenu = function() {\r\n    var self = this;\r\n    var wrap = document.createElement('div');\r\n    var mask = document.createElement('div');\r\n    //添加遮层\r\n    mask.className = 'xut-book-menu-mask';\r\n    //获取内容\r\n    this.getDirContent();\r\n    wrap.className = 'xut-book-menu';\r\n    wrap.innerHTML = '<ul>' + this.contentText + '</ul>';\r\n    this.container.append(wrap);\r\n    //是否滚动\r\n    this.isScrolled = false;\r\n\r\n    //添加滚动条\r\n    //url : http://iscrolljs.com/\r\n    this.iscroll = new iScroll(wrap, {\r\n        scrollbars: true,\r\n        fadeScrollbars: true,\r\n        scrollX: false\r\n    });\r\n\r\n    this.menu = wrap;\r\n\r\n    this.setColor();\r\n\r\n    this.iscroll.on('scrollStart', function(e) {\r\n        self.isScrolled = true;\r\n    });\r\n\r\n    this.iscroll.on('scrollEnd', function(e) {\r\n        self.isScrolled = false;\r\n    });\r\n\r\n    wrap.appendChild(mask);\r\n\r\n}\r\n\r\n/**\r\n *  显示目录菜单\r\n */\r\nBar.prototype.showDirMenu = function() {\r\n    //获取当前页面\r\n    var page = Xut.Presentation.GetPageElement();\r\n\r\n    if (this.menu) {\r\n        this.menu.style.display = 'block';\r\n    } else {\r\n        this.createDirMenu();\r\n    }\r\n\r\n    //添加模糊效果\r\n    page.addClass('filter');\r\n    this.page = page;\r\n\r\n    //隐藏顶部工具栏\r\n    this.controlBar.hide();\r\n    var iscroll = this.iscroll;\r\n    //自动定位到上一位置\r\n    if (iscroll.y > iscroll.wrapperHeight) {\r\n        iscroll.scrollToElement(this.selectedChild);\r\n    }\r\n}\r\n\r\n/**\r\n *  隐藏目录菜单\r\n */\r\nBar.prototype.hideDirMenu = function() {\r\n    this.menu.style.display = 'none';\r\n    //恢复顶部工具栏\r\n    this.controlBar.show();\r\n    //移除模糊效果\r\n    this.page.removeClass('filter');\r\n}\r\n\r\n/**\r\n *  创建目录内容\r\n */\r\nBar.prototype.getDirContent = function() {\r\n\r\n    var Api = Xut.Presentation;\r\n    var data = Api.GetAppSectionData();\r\n    var sns = data[0];\r\n    var seaonId = sns._id;\r\n    var cids = Xut.data.Chapter;\r\n\r\n    ////////////////////////////\r\n    //针对book模式，合并了Season的参数 //\r\n    //1 SeasonTitle\r\n    //2 ChapterList列表的范围区间\r\n    ////////////////////////////\r\n    data = parseJSON(sns.parameter);\r\n\r\n    if (!data) {\r\n        console.log('book模式parameter数据出错')\r\n        return;\r\n    }\r\n\r\n    //二级目录\r\n    function secondaryDirectory(startCid, endCid) {\r\n        var cid, str = '';\r\n        for (startCid; startCid <= endCid; startCid++) {\r\n            cid = cids.item(startCid - 1);\r\n            if (cid && cid.chapterTitle) {\r\n                str += '<section><a class=\"xut-book-menu-item\" data-mark=' + seaonId + '-' + startCid + ' href=\"javascript:0\">' + cid.chapterTitle + '</a></section>';\r\n            }\r\n        }\r\n        return str;\r\n    }\r\n\r\n    var i = 0;\r\n    var len = data.length;\r\n    var li = '<li class=\"title\"><center class=\"select\">目录</center></li>';\r\n    var seasonInfo, mark, seasonTitle, seaonId, startCid, endCid;\r\n\r\n    for (i; i < len; i++) {\r\n        seasonInfo = data[i];\r\n        startCid = seasonInfo.ChapterList[0];\r\n        endCid = seasonInfo.ChapterList[1];\r\n        mark = seaonId + '-' + startCid;\r\n        if (seasonInfo.SeasonTitle.length <= 0) continue;\r\n        seasonTitle = seasonInfo.SeasonTitle || '第' + (i + 1) + '章';\r\n        //第一级目录\r\n        li += '<li>' +\r\n            '<a class=\"xut-book-menu-item\" data-mark=\"' + mark + '\" href=\"javascript:0\">' + seasonTitle + '</a>' +\r\n            //第二级目录\r\n            secondaryDirectory(startCid, endCid)\r\n        '</li>';\r\n    }\r\n\r\n    this.contentText = li;\r\n}\r\n\r\n/**\r\n * 突出显示点击颜色\r\n */\r\nBar.prototype.setColor = function(element) {\r\n    if (this.selectedChild) {\r\n        this.selectedChild.className = 'xut-book-menu-item';\r\n    }\r\n\r\n    element = element || this.menu.querySelectorAll('li')[1].children[0];\r\n    element.className = 'select';\r\n    this.selectedChild = element;\r\n}\r\n\r\n/**\r\n * 跳转到指定书页\r\n */\r\nBar.prototype.turnToPage = function(target) {\r\n    //忽略滚动点击\r\n    if (this.isScrolled) return;\r\n    this.setColor(target);\r\n    this.hideDirMenu();\r\n    var data = target.dataset.mark || '';\r\n    if (data) {\r\n        data = data.split('-');\r\n        Xut.View.LoadScenario({\r\n            'scenarioId': data[0],\r\n            'chapterId': data[1]\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * 显示书签\r\n */\r\nBar.prototype.showBookMark = function() {\r\n    if (this.bookMark) {\r\n        this.bookMark.restore();\r\n    } else {\r\n        var pageData = Xut.Presentation.GetPageData();\r\n        this.bookMark = new BookMark({\r\n            parent: this.container,\r\n            seasonId: pageData.seasonId,\r\n            pageId: pageData._id\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * 返回首页\r\n */\r\n\r\nBar.prototype.goBack = function() {\r\n    var self = this;\r\n    Xut.Application.Suspend({\r\n        dispose: function(promptMessage) {\r\n            //停止热点动作\r\n            //promptMessage('再按一次将跳至首页！')\r\n        },\r\n        processed: function() {\r\n            Xut.View.GotoSlide(1) //调整到首页\r\n            self.setColor();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 事件处理\r\n */\r\nBar.prototype.handleEvent = function(e) {\r\n\r\n    var target = e.target || e.srcElement;\r\n\r\n    var name = target.className;\r\n\r\n    switch (name) {\r\n        case 'xut-book-bar-back':\r\n            this.goBack();\r\n            //返回\r\n            break;\r\n        case 'xut-book-bar-dir':\r\n            //目录\r\n            this.showDirMenu();\r\n            break;\r\n        case 'xut-book-bar-mark':\r\n            //书签\r\n            this.showBookMark();\r\n            break;\r\n        case 'xut-book-bar-star':\r\n            //评分\r\n            break;\r\n        case 'xut-book-menu-item':\r\n            //跳转\r\n            this.turnToPage(target);\r\n            break;\r\n        case 'xut-book-menu-mask':\r\n        case 'select':\r\n            this.hideDirMenu();\r\n            break;\r\n        default:\r\n            // console.log(name+':undefined')\r\n            break;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 销毁\r\n */\r\nBar.prototype.destroy = function() {\r\n    this.iscroll && this.iscroll.destroy();\r\n    this.bookMark && this.bookMark.destroy();\r\n    var ele = this.container[0];\r\n    ele.removeEventListener('touchend', this, false);\r\n    ele.removeEventListener('mouseup', this, false);\r\n    this.iscroll = null;\r\n    this.menu = null;\r\n    this.page = null;\r\n}\r\n\r\n\r\nexport { Bar }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/bookbar.js\n **/","/**\r\n * 书签栏\r\n * 加入这个书签功能后，可以让用户自由选择哪页是需要保存记录的\r\n * @param options object\r\n * @example {parent:页面容器,pageId:chapterId,seasonId:seasionId}\r\n */\r\n\r\nimport {\r\n    _set,\r\n    _get\r\n}\r\nfrom '../util/index'\r\n\r\n\r\n\tvar icons = {\r\n\t\t\thide : 'images/icons/arrowDown.svg'\r\n\t\t},\r\n\t\tsLineHeiht = parseInt($('body').css('font-size'))||16, //行高\r\n\t\tBOOKCACHE; //书签缓存\r\n\r\n\r\n\tfunction BookMark(options){\r\n\t\tthis.parent = options.parent;\r\n\t\tthis.pageId = options.pageId;\r\n\t\tthis.seasonId = options.seasonId;\r\n\r\n\t\tthis.screenSize = Xut.config.screenSize,\r\n\t\tthis.sHeight = screenSize.height,\r\n\t\tthis.sWidth  = screenSize.width,\r\n\r\n\t\t//是否已存储\r\n\t\tthis.isStored = false;\r\n\t\tthis.init();\r\n\t}\r\n\r\n\t/**\r\n\t * 初始化\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.init = function(){\r\n\t\tvar $bookMark = this.createBookMark(),\r\n\t\t\tdom = this.parent[0],\r\n\t\t\tthat = this;\r\n\r\n\t\tthis.parent.append($bookMark);\r\n\t\tthis.bookMarkMenu = $bookMark.eq(0);\r\n\t\t//显示书签\r\n\t\tsetTimeout(function(){\r\n\t\t\tthat.restore();\r\n\t\t},20);\r\n\t\t//获取历史记录\r\n\t\tBOOKCACHE = this.getHistory();\r\n\r\n\t\t//邦定用户事件\r\n\t\tXut.plat.execEvent('on', {\r\n\t\t\tcontext: dom,\r\n\t\t\tcallback: {\r\n\t\t\t\tend : this\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 创建书签\r\n\t * @return {[object]} [jquery生成的dom对象]\r\n\t */\r\n\tBookMark.prototype.createBookMark = function(){\r\n\t\tvar height = sLineHeiht * 3, // menu的高为3em\r\n\t\t    box = '<div class=\"xut-bookmark-menu\" style=\"width:100%;height:{0}px;left:0;top:{1}px;\">'+\r\n\t\t\t\t'<div class=\"xut-bookmark-wrap\">'+\r\n\t\t\t\t\t'<div class=\"xut-bookmark-add\">加入书签</div>'+\r\n\t\t\t\t\t'<div class=\"xut-bookmark-off\" style=\"background-image:url({2})\"></div>'+\r\n\t\t\t\t\t'<div class=\"xut-bookmark-view\">书签记录</div>'+\r\n\t\t\t\t'</div>'+\r\n\t\t\t'</div>'+\r\n\t\t\t'<div class=\"xut-bookmark-list\" style=\"display:none;width:100%;height:{3}px;\">'+\r\n\t\t\t\t'<ul class=\"xut-bookmark-head\">'+\r\n\t\t\t\t\t'<li class=\"xut-bookmark-back\">返回</li>'+\r\n\t\t\t\t\t'<li>书签</li>'+\r\n\t\t\t\t'</ul>'+\r\n\t\t\t\t'<ul class=\"xut-bookmark-body\"></ul>'+\r\n\t\t\t'</div>';\r\n\t\tbox = String.format(box,height,this.sHeight,icons.hide,this.sHeight);\r\n\t\tthis.markHeight = height;\r\n\t\treturn $(box);\r\n\t}\r\n\r\n\t/**\r\n\t * 生成书签列表\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.createMarkList = function(){\r\n\t\tvar tmp,seasonId,pageId,\r\n\t\t    list = '',\r\n\t\t\tbox  = '',\r\n\t\t\tself = this;\r\n\r\n\t\t//取历史记录\r\n\t\t_.each(BOOKCACHE,function(mark){\r\n\t\t\ttmp = mark.split('-');\r\n\t\t\tseasonId = tmp[0];\r\n\t\t\tpageId = tmp[1];\r\n\t\t\tmark = self.getMarkId(seasonId,pageId);\r\n\t\t\tlist += '<li><a data-mark=\"'+mark+'\" class=\"xut-bookmark-id\" href=\"javascript:0\">第'+pageId+'页</a><a class=\"xut-bookmark-del\" data-mark=\"'+mark+'\" href=\"javascript:0\">X</a></li>';\r\n\t\t})\r\n\r\n\t\treturn list;\r\n\t}\r\n\r\n\t/**\r\n\t * 创建存储标签\r\n\t * 存储格式 seasonId-pageId\r\n\t * @return {string} [description]\r\n\t */\r\n\tBookMark.prototype.getMarkId = function(seasonId,pageId){\r\n\t\treturn seasonId+'-'+pageId;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取历史记录\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.getHistory = function(){\r\n\t\tvar mark = _get('bookMark');\r\n\t\tif(mark){\r\n\t\t\treturn mark.split(',');\r\n\t\t}\r\n\t\treturn [];\r\n\t}\r\n\r\n\t/**\r\n\t * 添加书签\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.addBookMark = function(){\r\n\t\tvar key;\r\n\r\n\t\tthis.updatePageInfo();\r\n\t\tkey = this.getMarkId(this.seasonId,this.pageId);\r\n\r\n\t\t//避免重复缓存\r\n\t\tif(BOOKCACHE.indexOf(key)>-1){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tBOOKCACHE.push(key)\r\n\t\t_set('bookMark',BOOKCACHE);\r\n\t}\r\n\r\n\t/**\r\n\t * 更新页信息\r\n\t *  针对母板层上的书签\r\n\t */\r\n\tBookMark.prototype.updatePageInfo = function(){\r\n\t\tvar pageData = Xut.Presentation.GetPageData();\r\n\t\tthis.pageId = pageData._id;\r\n\t\tthis.seasonId = pageData.seasonId;\r\n\t}\r\n\r\n\t/**\r\n\t * 删除书签\r\n\t * @param {object} [key] [事件目标对象]\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.delBookMark = function(target){\r\n\t\tif(!target || !target.dataset) return;\r\n\r\n\t\tvar key = target.dataset.mark,\r\n\t\t    index = BOOKCACHE.indexOf(key);\r\n\r\n\t\tBOOKCACHE.splice(index,1);\r\n\t\t_set('bookMark',BOOKCACHE);\r\n\r\n\t\tif(BOOKCACHE.length == 0){\r\n\t\t\t_remove('bookMark');\r\n\t\t}\r\n\r\n\t\t//移除该行\r\n\t\t$(target).parent().remove();\r\n\t}\r\n\r\n\t/**\r\n\t * 显示书签\r\n\t * @param {object} [target] [事件目标对象]\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.viewBookMark = function(target){\r\n\t\tvar $bookMarkList,\r\n\t\t    list = this.createMarkList();\r\n\r\n\t\tif(this.bookMarkList){\r\n\t\t\t$bookMarkList = this.bookMarkList;\r\n\t\t}else{\r\n\t\t\t$bookMarkList = $(target).parent().parent().next();\r\n\t\t}\r\n\t\t//更新书签内容\r\n\t\t$bookMarkList.find('.xut-bookmark-body').html(list);\r\n\t\tthis.bookMarkList = $bookMarkList;\r\n\t\t$bookMarkList.fadeIn();\r\n\t}\r\n\r\n\t/**\r\n\t * 点击放大效果\r\n\t * @param  {[object]} target [事件目标对象]\r\n\t * @return {[type]}      [description]\r\n\t */\r\n\tBookMark.prototype.iconManager = function(target){\r\n\t\tvar $icon = this.bookMarkIcon = $(target),\r\n\t\t    restore = this.iconRestore;\r\n\r\n\t\t$icon.css({\r\n\t\t\t'transform': 'scale(1.2)',\r\n\t\t\t'transition-duration':'500ms'\r\n\t\t})[0].addEventListener(Xut.plat.TRANSITION_EV,restore.bind(this),false);\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 复原按钮\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.iconRestore = function(){\r\n\t\tthis.bookMarkIcon.css('transform','');\r\n\t}\r\n\r\n\t/**\r\n\t * 跳转到书签页\r\n\t * @param  {[type]} target [description]\r\n\t * @return {[type]}        [description]\r\n\t */\r\n\tBookMark.prototype.goBookMark = function(target){\r\n\t\tif(!target || !target.dataset) return;\r\n\r\n\t\tvar key = target.dataset.mark.split('-'),\r\n\t\t    seasonId = Number(key[0]),\r\n\t\t    pageId = Number(key[1]);\r\n\r\n\t\tthis.updatePageInfo();\r\n\t\t//关闭书签列表\r\n\t\tthis.backBookMark();\r\n\r\n\t\t//忽略当前页的跳转\r\n\t\tif(this.pageId == pageId && this.seasonId == seasonId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tXut.View.LoadScenario({\r\n\t\t\t'scenarioId' : seasonId,\r\n\t\t\t'chapterId'  : pageId\r\n\t\t})\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 书签回退键\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.backBookMark = function(){\r\n\t\tthis.bookMarkList.fadeOut();\r\n\t}\r\n\r\n\t/**\r\n\t * 邦定事件\r\n\t * @param  {[type]} evt [事件]\r\n\t * @return {[type]}     [description]\r\n\t */\r\n\tBookMark.prototype.handleEvent = function(evt){\r\n\t\tvar target = evt.target;\r\n\t\tswitch(target.className){\r\n\t\t\t//加入书签\r\n\t\t\tcase 'xut-bookmark-add':\r\n\t\t\t\tthis.addBookMark();\r\n\t\t\t\tthis.iconManager(target);\r\n\t\t\t\tbreak;\r\n\t\t\t//显示书签记录\r\n\t\t\tcase 'xut-bookmark-view':\r\n\t\t\t\tthis.viewBookMark(target);\r\n\t\t\t\tthis.iconManager(target);\r\n\t\t\t\tbreak;\r\n\t\t\t//关闭书签\r\n\t\t\tcase 'xut-bookmark-off':\r\n\t\t\t\tthis.closeBookMark(target);\r\n\t\t\t\tbreak;\r\n\t\t\t//返回书签主菜单\r\n\t\t\tcase 'xut-bookmark-back':\r\n\t\t\t\tthis.backBookMark();\r\n\t\t\t\tbreak;\r\n\t\t\t//删除书签记录\r\n\t\t\tcase 'xut-bookmark-del':\r\n\t\t\t\tthis.delBookMark(target);\r\n\t\t\t\tbreak;\r\n\t\t\t//跳转到书签页\r\n\t\t\tcase 'xut-bookmark-id':\r\n\t\t\t\tthis.goBookMark(target);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t//console.log(target.className)\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 关闭书签菜单\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.closeBookMark = function(target){\r\n\t\tthis.bookMarkMenu.css({\r\n\t\t\ttransform : 'translate3d(0,0,0)',\r\n\t\t\t'transition-duration': '1s'\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 恢复书签菜单\r\n\t */\r\n\tBookMark.prototype.restore = function(){\r\n\t\tthis.bookMarkMenu.css({\r\n\t\t\ttransform : 'translate3d(0,-'+this.markHeight+'px,0)',\r\n\t\t\t'transition-duration': '1s'\r\n\t\t})\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁书签\r\n\t * @return {[type]} [description]\r\n\t */\r\n\tBookMark.prototype.destroy = function(){\r\n\t\tvar dom = this.parent[0],\r\n\t\t    events = Xut.plat;\r\n\r\n\t\tdom.removeEventListener('touchend',this,false);\r\n\t\tdom.removeEventListener('mouseup',this,false);\r\n\r\n\t\t//菜单部分\r\n\t\tif(this.bookMarkMenu){\r\n\t\t\tthis.bookMarkMenu.remove();\r\n\t\t\tthis.bookMarkMenu = null;\r\n\t\t}\r\n\r\n\t\t//列表部分\r\n \t\tif(this.bookMarkList){\r\n \t\t\tthis.bookMarkList.remove();\r\n \t\t\tthis.bookMarkList = null;\r\n \t\t}\r\n\r\n \t\t//按钮效果\r\n \t\tif(this.bookMarkIcon){\r\n \t\t\tthis.bookMarkIcon[0].removeEventListener(events.TRANSITION_EV,this.iconRestore,false);\r\n \t\t\tthis.bookMarkIcon = null;\r\n \t\t}\r\n\r\n\t\tthis.parent = null;\r\n\t}\r\n\r\n\r\n\r\nexport {BookMark}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/toolbar/bookmark.js\n **/","/*********************************************************************\r\n *              场景容器构造器\r\n *          1 构件页面级容器\r\n *          2 翻页全局事件\r\n *\r\n **********************************************************************/\r\n\r\n// 定义访问器\r\nimport {\r\n    defProtected as def, defAccess\r\n}\r\nfrom '../util/index'\r\n\r\n// 观察\r\nimport {\r\n    observe\r\n}\r\nfrom '../observer/observe'\r\n\r\n//全部交互通知\r\nimport {\r\n    GlobalEvent\r\n}\r\nfrom './globalevent'\r\n\r\n//动态api\r\nimport {\r\n    overrideApi\r\n}\r\nfrom './overrideapi'\r\n\r\n//调度器\r\nimport {\r\n    trigger\r\n}\r\nfrom '../scheduler/index'\r\n\r\n//调度任务\r\nimport {\r\n    Scheduler\r\n}\r\nfrom './schedule'\r\n\r\nlet config\r\n\r\n// 'container'     : this.elements[0],\r\n// 'pageMode'      : pageMode,\r\n// 'multiScenario' : !isMain,\r\n// 'rootPage'      : scenarioPage,\r\n// 'rootMaster'    : scenarioMaster,\r\n// 'initIndex'     : pageIndex, //保存索引从0开始\r\n// 'pagetotal'     : pageTotal,\r\n// 'sectionRang'   : this.sectionRang,\r\n// 'scenarioId'    : scenarioId,\r\n// 'chapterId'     : this.chapterId,\r\n// 'isInApp'       : this.isInApp //提示页面\r\nfunction Manager(parameter) {\r\n\r\n    config = Xut.config\r\n\r\n    var vm = this;\r\n\r\n    var options = {\r\n        //数据库定义的翻页模式\r\n        //用来兼容客户端的制作模式\r\n        //妙妙学模式处理，多页面下翻页切换\r\n        //0 翻页滑动\r\n        //1 没有滑动过程,直接切换页面\r\n        'pageFlip': config.pageFlip,\r\n\r\n        //翻页模式\r\n        //根据页码数决定,主要是优化一些代码\r\n        //true  是多页面模式,支持翻页滑动\r\n        //false 单页面模式,不能翻页，只能跳转\r\n        'pageMode': false,\r\n\r\n        //是否多场景加载\r\n        //单页场景 false\r\n        //多场景   true\r\n        'multiScenario': false,\r\n\r\n        //是否为连续页面\r\n        //通过pageMode的参数定义\r\n        'multiplePages': false\r\n    };\r\n\r\n    //配置文件\r\n    options = vm.options = _.extend(options, parameter);\r\n\r\n    //强制转换\r\n    //multiplePages\r\n    //是否为连续页面\r\n    if (Xut.IBooks.Enabled) {\r\n        options.multiplePages = false;\r\n    } else {\r\n        options.multiplePages = options.pageFlip ?\r\n            options.pageFlip :\r\n            options.pageMode ? true : false;\r\n    }\r\n\r\n    //创建翻页滑动\r\n    var $globalEvent = vm.$globalEvent = new GlobalEvent(options, config);\r\n\r\n    // console.log( $globalEvent)\r\n\r\n    //创建page页面管理\r\n    var $scheduler = vm.$scheduler = new Scheduler(vm);\r\n\r\n    //委托事件处理钩子\r\n    var delegateHooks = {\r\n        //超连接,跳转\r\n        //svg内嵌跳转标记处理\r\n        'data-xxtlink': function(target, attribute, rootNode, pageIndex) {\r\n            try {\r\n                var para = attribute.split('-');\r\n                if (para.length > 1) { //如果有多个就是多场景的组合\r\n                    Xut.View.GotoSlide(para[0], para[1])\r\n                } else {\r\n                    Xut.View.GotoSlide(para[0])\r\n                }\r\n            } catch (err) {\r\n                console.log('跳转错误')\r\n            }\r\n        },\r\n\r\n        //Action', 'Widget', 'Video', 'ShowNote', 'SubDoc'委托\r\n        'data-delegate': function(target, attribute, rootNode, pageIndex) {\r\n            trigger.apply(null, arguments);\r\n        },\r\n\r\n        //如果是canvas节点\r\n        'data-canvas': function(cur) {\r\n            // alert(1)\r\n        }\r\n    }\r\n\r\n    //如果是主场景,才能切换系统工具栏\r\n    if (options.multiplePages) {\r\n        _.extend(delegateHooks, {\r\n            //li节点,多线程创建的时候处理滑动\r\n            'data-container': function() {\r\n                vm.$emit('change:toggleToolbar')\r\n            },\r\n\r\n            //是背景层\r\n            'data-multilayer': function() {\r\n                //改变工具条状态\r\n                vm.$emit('change:toggleToolbar')\r\n            },\r\n\r\n            //默认content元素可以翻页\r\n            'data-behavior': function(target, attribute, rootNode, pageIndex) {\r\n                //没有事件的元素,即可翻页又可点击切换工具栏\r\n                if (attribute == 'click-swipe') {\r\n                    vm.$emit('change:toggleToolbar')\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    //简化委托处理，默认一层元素只能绑定一个委托事件\r\n    function filterProcessor(event, pageType) {\r\n        var i, k, attribute, attributes, value,\r\n            cur = event.target;\r\n\r\n        if (cur.nodeType) {\r\n            //如果触发点直接是li\r\n            if (cur === this) {\r\n                return {\r\n                    'rootNode': this,\r\n                    'elem': cur,\r\n                    'handlers': delegateHooks['data-container']\r\n                }\r\n            }\r\n            //否则是内部的节点\r\n            try {\r\n                for (; cur !== this; cur = cur.parentNode || this) {\r\n                    //如果是canvas节点\r\n                    if (cur.nodeName && cur.nodeName.toLowerCase() === 'canvas') {\r\n                        //是否为滑动行为\r\n                        if (Xut.Contents.Canvas.getSupportState()) {\r\n                            return true;\r\n                        } else {\r\n                            return false;\r\n                        }\r\n                    }\r\n                    //如果是dom节点\r\n                    attributes = cur['attributes'];\r\n                    for (k in delegateHooks) {\r\n                        if (attribute = attributes[k]) {\r\n                            value = attribute['value' || 'nodeValue'];\r\n                            return {\r\n                                'rootNode': this,\r\n                                'elem': cur,\r\n                                'attribute': value,\r\n                                'pageType': pageType,\r\n                                'handlers': delegateHooks[k]\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } catch (err) {\r\n                // config.isBrowser && console.log('默认事件跟踪', err)\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 判断处理那个页面层次\r\n     * 找到pageType类型\r\n     * 项目分4个层\r\n     * page mater page浮动 mater浮动\r\n     * 通过\r\n     * 因为冒泡的元素，可能是页面层，也可能是母板上的\r\n     * @return {Boolean} [description]\r\n     */\r\n    function isBelong(target) {\r\n        var pageType = 'page';\r\n        if (target.dataset && target.dataset.belong) {\r\n            pageType = target.dataset.belong;\r\n        }\r\n        return pageType\r\n    }\r\n\r\n    /**\r\n     * 阻止元素的默认行为\r\n     * 在火狐下面image带有href的行为\r\n     * 会自动触发另存为\r\n     * @return {[type]} [description]\r\n     *\r\n     * 2016.3.18\r\n     * 妙妙学 滚动插件默认行为被阻止\r\n     */\r\n    function preventDefault(evtObj, target) {\r\n        //var tagName = target.nodeName.toLowerCase();\r\n        if (Xut.plat.isBrowser && !Xut.IBooks.Enabled && !MMXCONFIG) {\r\n            evtObj.preventDefault && evtObj.preventDefault();\r\n        }\r\n    }\r\n\r\n    /*********************************************************************\r\n     *                对页面事件的调控与状态动作的处理\r\n     *                1 触屏 onswipedown\r\n     *                2 滑动 onSwipeMove\r\n     *                3 松手 onSwipeUp\r\n     *                3 松手继续滑动 onSwipeUpSlider\r\n     *                4 动画结束后处理 onAnimComplete                                                                               *\r\n     **********************************************************************/\r\n\r\n    /**\r\n     * 事件句柄对象\r\n     */\r\n    var handlerObj = null;\r\n\r\n\r\n    /**\r\n     * 过滤器.全局控制函数\r\n     * return true 阻止页面滑动\r\n     */\r\n    $globalEvent.$watch('filter', function(hookCallback, point, evtObj) {\r\n        var target, pageType, parentNode;\r\n        target = point.target;\r\n        //阻止默认行为\r\n        preventDefault(evtObj, target);\r\n        //页面类型\r\n        pageType = isBelong(target);\r\n        //根节点\r\n        parentNode = $globalEvent.findRootElement(point, pageType);\r\n        //执行过滤处理\r\n        handlerObj = filterProcessor.call(parentNode, point, pageType);\r\n        if (!handlerObj || handlerObj.attribute === 'disable') {\r\n            //停止翻页,针对content对象可以拖动,滑动的情况处理\r\n            hookCallback();\r\n        }\r\n    });\r\n\r\n\r\n    /**\r\n     * 触屏滑动,通知pageMgr处理页面移动\r\n     * @return {[type]} [description]\r\n     */\r\n    $globalEvent.$watch('onSwipeMove', function() {\r\n        $scheduler.move.apply($scheduler, arguments);\r\n    });\r\n\r\n\r\n    /**\r\n     * 触屏松手点击\r\n     * 无滑动\r\n     */\r\n    $globalEvent.$watch('onSwipeUp', function(pageIndex, hookCallback) {\r\n        if (handlerObj) {\r\n            if (handlerObj.handlers) {\r\n                handlerObj.handlers(handlerObj.elem, handlerObj.attribute, handlerObj.rootNode, pageIndex);\r\n            } else {\r\n                if (!Xut.Contents.Canvas.getIsTap()) {\r\n                    vm.$emit('change:toggleToolbar')\r\n                }\r\n            }\r\n            handlerObj = null;\r\n            hookCallback();\r\n        }\r\n    });\r\n\r\n\r\n    /**\r\n     * 触屏滑动,通知ProcessMgr关闭所有激活的热点\r\n     * @return {[type]}          [description]\r\n     */\r\n    $globalEvent.$watch('onSwipeUpSlider', function(pointers) {\r\n        $scheduler.suspend(pointers)\r\n    });\r\n\r\n\r\n    /**\r\n     * 翻页动画完成回调\r\n     * @return {[type]}              [description]\r\n     */\r\n    $globalEvent.$watch('onAnimComplete', function(direction, pagePointer, unfliplock, isQuickTurn) {\r\n        $scheduler.complete.apply($scheduler, arguments);\r\n    });\r\n\r\n\r\n    /**\r\n     * 切换页面\r\n     * @return {[type]}      [description]\r\n     */\r\n    $globalEvent.$watch('onJumpPage', function(data) {\r\n        $scheduler.jumpPage(data);\r\n    });\r\n\r\n\r\n    /**\r\n     * 退出应用\r\n     * @return {[type]}      [description]\r\n     */\r\n    $globalEvent.$watch('onDropApp', function(data) {\r\n        GLOBALIFRAME && Xut.publish('magazine:dropApp');\r\n    });\r\n\r\n\r\n    /**\r\n     * 母板移动反馈\r\n     * 只有存在data-parallaxProcessed\r\n     * 才需要重新激活对象\r\n     * 删除parallaxProcessed\r\n     */\r\n    $globalEvent.$watch('onMasterMove', function(hindex, target) {\r\n        if (/Content/i.test(target.id) && target.getAttribute('data-parallaxProcessed')) {\r\n            $scheduler.masterMgr && $scheduler.masterMgr.reactivation(target);\r\n        }\r\n    });\r\n\r\n\r\n    vm.$overrideApi();\r\n}\r\n\r\n\r\n\r\n//***************************************************************\r\n//\r\n//                      应用接口\r\n//\r\n//***************************************************************\r\n\r\n\r\nvar VMProto = Manager.prototype\r\n\r\n/**\r\n * 扩充事件\r\n */\r\nobserve.call(VMProto);\r\n\r\n/**\r\n * 是否多场景模式\r\n */\r\ndefAccess(VMProto, '$multiScenario', {\r\n    get: function() {\r\n        return this.options.multiScenario\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * 动态注入对象接口\r\n * 注入对象管理,注册所有widget组件对象\r\n *  content类型  创建时注册\r\n *  widget类型   执行时注册\r\n *  widget 包括 视频 音频 Action 子文档 弹出口 类型\r\n *  这种类型是冒泡处理，无法传递钩子，直接用这个接口与场景对接\r\n */\r\ndefAccess(VMProto, '$injectionComponent', {\r\n    set: function(regData) {\r\n        var injection;\r\n        if (injection = this.$scheduler[regData.pageType + 'Mgr']) {\r\n            injection.abstractAssistPocess(regData.pageIndex, function(pageObj) {\r\n                pageObj.baseRegisterComponent.call(pageObj, regData.widget);\r\n            })\r\n        } else {\r\n            console.log('注册injection失败,regData=' + regData)\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * 得到当前的视图页面\r\n * @return {[type]}   [description]\r\n */\r\ndefAccess(VMProto, '$curVmPage', {\r\n    get: function() {\r\n        return this.$scheduler.pageMgr.abstractGetPageObj(this.$globalEvent.hindex);\r\n    }\r\n});\r\n\r\n\r\n/**\r\n *  监听viewmodel内部的状态的改变,触发后传入值\r\n *\r\n *  与状态有关的change:\r\n *      翻页\r\n *          'flipOver' : function(pageIndex) {},\r\n *\r\n *      切换工具栏\r\n *          'toggleToolbar' : function(state, pointer) {},\r\n *\r\n *      复位工具栏\r\n *          'resetToolbar'  : function() {},\r\n *\r\n *      隐藏下一页按钮\r\n *          'hideNext'   : function(state) {},\r\n *\r\n *      显示下一页按钮\r\n *          'showNext'   : function() {}\r\n *\r\n *  与创建相关\r\n *      创建完毕回调\r\n *          'createComplete': null,\r\n *      创建后中断自动运行回调\r\n *          'suspendAutoCallback': null\r\n *\r\n */\r\ndef(VMProto, '$bind', function(key, callback) {\r\n    var vm = this\r\n    vm.$watch('change:' + key, function() {\r\n        callback.apply(vm, arguments)\r\n    })\r\n})\r\n\r\n\r\n/**\r\n * 创建页面\r\n * @return {[type]} [description]\r\n */\r\ndef(VMProto, '$init', function() {\r\n    this.$scheduler.initCreate();\r\n});\r\n\r\n\r\n/**\r\n * 运动动画\r\n * @return {[type]} [description]\r\n */\r\ndef(VMProto, '$run', function() {\r\n    var vm = this;\r\n    vm.$scheduler.pageMgr.activateAutoRuns(\r\n        vm.$globalEvent.hindex, Xut.Presentation.GetPageObj()\r\n    )\r\n});\r\n\r\n\r\n/**\r\n * 复位对象\r\n * @return {[type]} [description]\r\n */\r\ndef(VMProto, '$reset', function() {\r\n    return this.$scheduler.pageMgr.resetOriginal(this.$globalEvent.hindex);\r\n});\r\n\r\n\r\n/**\r\n * 停止所有任务\r\n * @return {[type]} [description]\r\n */\r\ndef(VMProto, '$suspend', function() {\r\n    Xut.Application.Suspend({\r\n        skipMedia: true //跨页面不处理\r\n    })\r\n});\r\n\r\n\r\n/**\r\n * 销毁场景内部对象\r\n * @return {[type]} [description]\r\n */\r\ndef(VMProto, '$destroy', function() {\r\n    this.$off();\r\n    this.$globalEvent.destroy();\r\n    this.$scheduler.destroy();\r\n    this.$scheduler = null;\r\n    this.$globalEvent = null;\r\n});\r\n\r\n\r\n/**\r\n * 设置所有API接口\r\n * @return {[type]} [description]\r\n */\r\ndef(VMProto, '$overrideApi', function() {\r\n    overrideApi(this)\r\n})\r\n\r\n\r\nexport {\r\n    Manager\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/core.js\n **/","/**\r\n *\r\n * 基本事件管理\r\n *\r\n */\r\n\r\nvar observe = (function(slice) {\r\n\r\n    var ArrayProto = Array.prototype;\r\n    var nativeIndexOf = ArrayProto.indexOf;\r\n    var slice = ArrayProto.slice;\r\n\r\n    function bind(event, fn) {\r\n        var i, part;\r\n        var events = this.events = this.events || {};\r\n        var parts = event.split(/\\s+/);\r\n        var num = parts.length;\r\n\r\n        for (i = 0; i < num; i++) {\r\n            events[(part = parts[i])] = events[part] || [];\r\n            if (_indexOf(events[part], fn) === -1) {\r\n                events[part].push(fn);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function one(event, fn) {\r\n        // [notice] The value of fn and fn1 is not equivalent in the case of the following MSIE.\r\n        // var fn = function fn1 () { alert(fn === fn1) } ie.<9 false\r\n        var fnc = function() {\r\n            this.unbind(event, fnc);\r\n            fn.apply(this, slice.call(arguments));\r\n        };\r\n        this.bind(event, fnc);\r\n        return this;\r\n    }\r\n\r\n    function unbind(event, fn) {\r\n        var eventName, i, index, num, parts;\r\n        var events = this.events;\r\n\r\n        if (!events) return this;\r\n\r\n        //指定\r\n        if (arguments.length) {\r\n            parts = event.split(/\\s+/);\r\n            for (i = 0, num = parts.length; i < num; i++) {\r\n                if ((eventName = parts[i]) in events !== false) {\r\n                    index = (fn) ? _indexOf(events[eventName], fn) : -1;\r\n                    if (index !== -1) {\r\n                        events[eventName].splice(index, 1);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            this.events = null;\r\n        }\r\n\r\n\r\n        return this;\r\n    }\r\n\r\n    function trigger(event) {\r\n        var args, i;\r\n        var events = this.events,\r\n            handlers;\r\n\r\n        if (!events || event in events === false) {\r\n            return this;\r\n        }\r\n\r\n        args = slice.call(arguments, 1);\r\n        handlers = events[event];\r\n        for (i = 0; i < handlers.length; i++) {\r\n            handlers[i].apply(this, args);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function _indexOf(array, needle) {\r\n        var i, l;\r\n\r\n        if (nativeIndexOf && array.indexOf === nativeIndexOf) {\r\n            return array.indexOf(needle);\r\n        }\r\n\r\n        for (i = 0, l = array.length; i < l; i++) {\r\n            if (array[i] === needle) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n\r\n    return function() {\r\n        this.$watch = this.bind = bind;\r\n        this.$off = this.unbind = unbind;\r\n        this.$emit = trigger;\r\n        this.$once = one;\r\n        return this;\r\n    };\r\n\r\n})([].slice);\r\n\r\nexport { observe }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/observer/observe.js\n **/","\r\n// 观察\r\nimport {observe} from '../observer/observe'\r\n\r\n/**\r\n * 初始化首次范围\r\n * @return {[type]} [description]\r\n */\r\nfunction initPointer(init, pagetotal) {\r\n    var leftscope = 0,\r\n        pagePointer = {};\r\n\r\n    if (init === leftscope) { //首页\r\n        pagePointer['currIndex'] = init;\r\n        pagePointer['rightIndex'] = init + 1;\r\n    } else if (init === pagetotal - 1) { //首页\r\n        pagePointer['currIndex'] = init;\r\n        pagePointer['leftIndex'] = init - 1;\r\n    } else { //中间页\r\n        pagePointer['leftIndex'] = init - 1;\r\n        pagePointer['currIndex'] = init;\r\n        pagePointer['rightIndex'] = init + 1;\r\n    }\r\n\r\n    return pagePointer;\r\n}\r\n\r\n\r\n//============================\r\n//\r\n//    自定义事件类型\r\n//\r\n// //触屏点击\r\n// 'onSwipeDown',\r\n// //触屏移动\r\n// 'onSwipeMove',\r\n// //触屏松手\r\n// 'onSwipeUp',\r\n// //触屏松手 滑动处理\r\n// 'onSwipeUpSlider',\r\n// //松手动画（反弹）\r\n// 'onFlipSliding',\r\n// //执行反弹\r\n// 'onFlipRebound',\r\n// //动画完成\r\n// 'onAnimComplete',\r\n// //退出应用\r\n// 'onDropApp'\r\n\r\n//element   根容器元素\r\n//pageIndex 页面索引\r\nfunction GlobalEvent(options, config) {\r\n\r\n\toptions.hindex = options.initIndex;\r\n\r\n\tthis.screenWidth = config.screenSize.width;\r\n\r\n\t_.extend(this, options);\r\n\r\n    // this.element = options.rootPage;\r\n    this.element = options.container;\r\n\r\n    /**\r\n     * 翻页时间\r\n     * @type {Number}\r\n     */\r\n    this.speed = options.pageFlip ? 0 : 500;\r\n\r\n    /**\r\n     * 翻页速率\r\n     * @type {Number}\r\n     */\r\n    this.clickSpeed = 600;\r\n\r\n\r\n    /**\r\n     * 速率\r\n     * @type {[type]}\r\n     */\r\n    this.speedRate = this.originalRate = this.speed / this.screenWidth;\r\n\r\n\r\n    /**\r\n     * 计算初始化页码\r\n     * @type {[type]}\r\n     */\r\n    this.pagePointer = initPointer(options.hindex, options.pagetotal);\r\n\r\n\r\n    /**\r\n     * 初始化绑定事件\r\n     */\r\n    if (!this.prveIndex) {\r\n        this.prveIndex = this.hindex;\r\n    }\r\n\r\n    //ibooks不绑定全局事件\r\n    // if (!Xut.IBooks.runMode()) {\r\n    this._bindEvt();\r\n    // }\r\n\r\n\r\n    //用于查找跟元素\r\n    var ul = this.element.querySelectorAll('ul');\r\n    this.bubbleNode = {\r\n        page: ul[0],\r\n        master: ul[1]\r\n    }\r\n};\r\n\r\n\r\n\r\nvar edProto = GlobalEvent.prototype;\r\n\r\n/**\r\n * 首位越界处理，不反弹\r\n * @param  {[type]} deltaX [description]\r\n * @return {[type]}        [description]\r\n */\r\nedProto.overstep = function(deltaX) {\r\n    //首页,并且是左滑动\r\n    if (this.hindex === 0 && deltaX > 0) {\r\n        return true;\r\n        //尾页\r\n    } else if (this.hindex === this.pagetotal - 1 && deltaX < 0) {\r\n        return true;\r\n    }\r\n}\r\n\r\n/**\r\n * 前翻页接口\r\n * @return {[type]} [description]\r\n */\r\nedProto.prev = function() {\r\n    if (!this.overstep(1)) {\r\n        this.slideTo('prev');\r\n    };\r\n}\r\n\r\n/**\r\n * 后翻页接口\r\n * @return {Function} [description]\r\n */\r\nedProto.next = function() {\r\n    if (!this.overstep(-1)) {\r\n        this.slideTo('next');\r\n    }\r\n}\r\n\r\n/**\r\n * 检车是否还在移动中\r\n * @return {Boolean} [description]\r\n */\r\nedProto.isMove = function() {\r\n    return this.fliplock;\r\n}\r\n\r\n/**\r\n * 是否为边界\r\n * @param  {[type]}  distance [description]\r\n * @return {Boolean}          [description]\r\n */\r\nedProto.isBorder = function(distance) {\r\n    //起点左偏移\r\n    if (this.hindex === 0 && distance > 0) {\r\n        return true;\r\n    }\r\n    //终点右偏移\r\n    if (this.hindex === (this.pagetotal - 1) && distance < 0) {\r\n        return true\r\n    }\r\n}\r\n\r\n/**\r\n * 目标元素\r\n * 找到li元素\r\n * @param  {Function} callback [description]\r\n * @return {[type]}            [description]\r\n */\r\nedProto.findRootElement = function(point, pageType) {\r\n    var liNode, map,\r\n        hindex = this.hindex,\r\n        sectionRang = this.sectionRang,\r\n        //找到对应的li\r\n        childNodes = this.bubbleNode[pageType].childNodes,\r\n        numNodes = childNodes.length;\r\n\r\n    while (numNodes--) {\r\n        liNode = childNodes[numNodes];\r\n        map = liNode.getAttribute('data-map');\r\n        if (sectionRang) {\r\n            hindex += sectionRang.start;\r\n        }\r\n        if (map == hindex) {\r\n            return liNode\r\n        }\r\n        hindex = this.hindex;\r\n    }\r\n}\r\n\r\n/**\r\n * 溢出控制\r\n * @param  {[type]} direction [description]\r\n * @return {[type]}           [description]\r\n */\r\nedProto.scopePointer = function(direction) {\r\n    var overflow,\r\n        pointer = this.pagePointer,\r\n        fillength = Object.keys(pointer).length;\r\n\r\n    switch (direction) {\r\n        case 'prev': //前翻页\r\n            overflow = (pointer.currIndex === 0 && fillength === 2) ? true : false;\r\n            break;\r\n        case 'next': //后翻页\r\n            overflow = (pointer.currIndex === (this.pagetotal - 1) && fillength === 2) ? true : false;\r\n            break;\r\n    }\r\n\r\n    return {\r\n        pointer: pointer,\r\n        overflow: overflow //是否溢出\r\n    }\r\n}\r\n\r\n//转换页码索引\r\n//direction 方向\r\n//pointer 当前页码标示\r\n//[17 18 19]  pagePointer\r\n//[18 19 20]  转换后\r\n// 17 销毁\r\n// 20 创建\r\nedProto.shiftPointer = function(pointer) {\r\n    var createPointer, //创建的页\r\n        destroyPointer; //销毁的页\r\n\r\n    switch (this.direction) {\r\n        case 'prev': //前处理\r\n            createPointer = (pointer.leftIndex - 1);\r\n            destroyPointer = (pointer.rightIndex);\r\n            break;\r\n        case 'next': //后处理\r\n            createPointer = (pointer.rightIndex + 1);\r\n            destroyPointer = (pointer.leftIndex);\r\n            break;\r\n    }\r\n\r\n    pointer['createPointer'] = createPointer;\r\n    pointer['destroyPointer'] = destroyPointer;\r\n\r\n    return pointer;\r\n}\r\n\r\n//修正页码指示\r\nedProto.revisedFilpPointer = function(pointer) {\r\n\r\n    //需要停止动作的页面索引\r\n    var stopPointer = pointer.currIndex;\r\n\r\n    switch (this.direction) {\r\n        case 'prev': //前处理\r\n            if (-1 < pointer.createPointer) { //首页情况\r\n                this.updataPointer(pointer.createPointer, pointer.leftIndex, pointer.currIndex);\r\n            }\r\n            if (-1 === pointer.createPointer) {\r\n                this.pagePointer['rightIndex'] = pointer.currIndex;\r\n                this.pagePointer['currIndex'] = pointer.leftIndex;\r\n                delete this.pagePointer['leftIndex'];\r\n            }\r\n            break;\r\n        case 'next': //后处理\r\n            if (this.pagetotal > pointer.createPointer) {\r\n                this.updataPointer(pointer.currIndex, pointer.rightIndex, pointer.createPointer);\r\n            }\r\n            if (this.pagetotal === pointer.createPointer) { //如果是尾页\r\n                this.pagePointer['leftIndex'] = pointer.currIndex;\r\n                this.pagePointer['currIndex'] = pointer.rightIndex;\r\n                delete this.pagePointer['rightIndex'];\r\n            }\r\n            break;\r\n    }\r\n\r\n    this.pagePointer['createPointer'] = pointer.createPointer;\r\n    this.pagePointer['destroyPointer'] = pointer.destroyPointer;\r\n    this.pagePointer['stopPointer'] = stopPointer;\r\n\r\n    return this.pagePointer;\r\n}\r\n\r\n//更新页码标示\r\nedProto.updataPointer = function(leftIndex, currIndex, rightIndex) {\r\n    if (arguments.length === 3) {\r\n        this.pagePointer = {\r\n            'leftIndex': leftIndex,\r\n            'currIndex': currIndex,\r\n            'rightIndex': rightIndex\r\n        }\r\n        return;\r\n    }\r\n\r\n    if (arguments.length === 1) {\r\n        var data = leftIndex;\r\n        var viewFlip = data['viewFlip'];\r\n\r\n        this.fixHindex(data.targetIndex);\r\n\r\n        if (viewFlip.length === 3) {\r\n            this.updataPointer(viewFlip[0], viewFlip[1], viewFlip[2]);\r\n        }\r\n        if (viewFlip.length === 2) {\r\n            if (viewFlip[0] === 0) { //首页\r\n                this.pagePointer['rightIndex'] = viewFlip[1];\r\n                this.pagePointer['currIndex'] = viewFlip[0];\r\n                delete this.pagePointer['leftIndex'];\r\n            } else { //尾页\r\n                this.pagePointer['leftIndex'] = viewFlip[0];\r\n                this.pagePointer['currIndex'] = viewFlip[1];\r\n                delete this.pagePointer['rightIndex'];\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n}\r\n\r\n//修正页面索引\r\nedProto.fixHindex = function(currIndex) {\r\n    this.hindex = currIndex; //翻页索引\r\n}\r\n\r\nedProto.slideTo = function(direction) {\r\n    var resolve;\r\n    //如果在忙碌状态,如果翻页还没完毕\r\n    if (Xut.busyBarState || this.fliplock) {\r\n        return;\r\n    };\r\n    resolve = this.scopePointer(direction);\r\n    if (resolve.overflow) return;\r\n    this.startAnimTo(resolve.pointer, direction);\r\n}\r\n\r\nedProto.startAnimTo = function(pointer, direction) {\r\n    this.fliplock = true;\r\n    this.prveHindex = this.hindex;\r\n    this.direction = direction;\r\n    this.judgeQuickTurn();\r\n    if (direction === 'next') {\r\n        this.nextRun(pointer);\r\n    } else {\r\n        this.preRun(pointer);\r\n    }\r\n}\r\n\r\n\r\n//上翻页\r\nedProto.preRun = function(pointer) {\r\n    var pointers, me = this;\r\n\r\n    function createPrev() {\r\n        pointers = me.shiftPointer(pointer);\r\n        pointers = me.revisedFilpPointer(pointers);\r\n        me.sliderStop(pointers);\r\n        me.fixHindex(pointers.currIndex);\r\n    }\r\n\r\n    this.processorMove({\r\n        'pageIndex': this.hindex,\r\n        'speed': this.calculatespeed(),\r\n        'distance': 0,\r\n        'direction': this.direction,\r\n        'action': 'flipOver'\r\n    });\r\n\r\n    //动画执行\r\n    setTimeout(createPrev);\r\n}\r\n\r\n//下翻页\r\nedProto.nextRun = function(pointer) {\r\n    var pointers, me = this;\r\n\r\n    function createNext() {\r\n        pointers = me.shiftPointer(pointer);\r\n        pointers = me.revisedFilpPointer(pointers);\r\n        me.sliderStop(pointers);\r\n        me.fixHindex(pointers.currIndex);\r\n    }\r\n\r\n    this.processorMove({\r\n        'pageIndex': this.hindex,\r\n        'speed': this.calculatespeed(),\r\n        'distance': 0,\r\n        'direction': this.direction,\r\n        'action': 'flipOver'\r\n    });\r\n\r\n    //动画执行\r\n    setTimeout(createNext);\r\n}\r\n\r\n\r\n/**\r\n * 判断是否快速翻页\r\n * @return {[type]} [description]\r\n */\r\nedProto.judgeQuickTurn = function() {\r\n\r\n    var startDate = +new Date();\r\n\r\n    if (this.preClickTime) {\r\n        if (startDate - this.preClickTime < this.clickSpeed) {\r\n            this.setRate();\r\n        }\r\n    }\r\n\r\n    this.preClickTime = +new Date();\r\n}\r\n\r\n\r\n/**\r\n * 计算滑动速度\r\n * @return {[type]} [description]\r\n */\r\nedProto.calculatespeed = function() {\r\n    return (this.screenWidth - (Math.abs(this.deltaX))) * this.speedRate || this.speed;\r\n}\r\n\r\n/**\r\n * 处理松手后滑动\r\n * pageIndex 页面\r\n * distance  移动距离\r\n * speed     时间\r\n * viewTag   可使区标记\r\n * follow    是否为跟随滑动\r\n * @return {[type]} [description]\r\n */\r\nedProto.processorMove = function(data) {\r\n    var pagePointer = this.pagePointer;\r\n    data.leftIndex = pagePointer.leftIndex;\r\n    data.rightIndex = pagePointer.rightIndex;\r\n    this.$emit('onSwipeMove', data)\r\n}\r\n\r\n/**\r\n * 滑动事件派发处理\r\n * 停止动画,视频 音频\r\n * @return {[type]} [description]\r\n */\r\nedProto.sliderStop = function(pointers) {\r\n    this.$emit('onSwipeUpSlider', pointers);\r\n}\r\n\r\n/*********************************************************************\r\n *                 页面交互\r\n *                                                         *\r\n **********************************************************************/\r\n\r\n/**\r\n * 兼容事件对象\r\n * @return {[type]}   [description]\r\n */\r\nfunction compatibilityEvent(e) {\r\n    var point;\r\n    if (e.touches && e.touches[0]) {\r\n        point = e.touches[0];\r\n    } else {\r\n        point = e;\r\n    }\r\n    return point\r\n}\r\n\r\n\r\nedProto.onTouchStart = function(e) {\r\n\r\n    var interrupt,\r\n        point = compatibilityEvent(e);\r\n\r\n    if (!point) {\r\n        return interrupt = this.preventSwipe = true;\r\n    }\r\n\r\n    /**\r\n     * 获取观察对象\r\n     * 钩子函数\r\n     * point 事件对象\r\n     * @return {[type]} [description]\r\n     */\r\n    this.$emit('filter', function() {\r\n        interrupt = true;\r\n    }, point, e)\r\n\r\n\r\n    //打断动作\r\n    if (interrupt) return;\r\n\r\n    this.deltaX = 0;\r\n    this.deltaY = 0;\r\n    this.preventSwipe = false, //是否滑动事件受限\r\n        this.isoverstep = false; //是否边界溢出\r\n    this.isScrollX = false; //是否为X轴滑动\r\n    this.isScrollY = false; //是否为Y轴滑动\r\n    this.isTouching = true; //点击了屏幕\r\n\r\n    this.start = {\r\n        pageX: point.pageX,\r\n        pageY: point.pageY,\r\n        time: (+new Date())\r\n    };\r\n}\r\n\r\nedProto.onTouchMove = function(e) {\r\n\r\n    //如果没有点击\r\n    //或是Y轴滑动\r\n    //或者是阻止滑动\r\n    if (!this.isTouching || this.isScrollY || this.preventSwipe) return;\r\n\r\n    var point = compatibilityEvent(e),\r\n        deltaX = point.pageX - this.start.pageX,\r\n        deltaY = point.pageY - this.start.pageY,\r\n        absDeltaX = Math.abs(deltaX),\r\n        absDeltaY = Math.abs(deltaY);\r\n\r\n    if (!this.isScrollY) {\r\n        //===============Y轴滑动======================\r\n        //\r\n        if (absDeltaY > absDeltaX) {\r\n            this.isScrollY = true; //为Y轴滑动\r\n            return;\r\n        }\r\n    }\r\n\r\n    //===============X轴滑动======================\r\n\r\n    //越界处理\r\n    if (this.isoverstep = this.overstep(deltaX)) return;\r\n\r\n    //防止滚动\r\n    e.preventDefault();\r\n\r\n    this.deltaX = deltaX / ((!this.hindex && deltaX > 0 // 在首页\r\n            || this.hindex == this.pagetotal - 1 // 尾页\r\n            && deltaX < 0 // 中间\r\n        ) ?\r\n        (absDeltaX / this.screenWidth + 1) : 1);\r\n\r\n    if (!this.isScrollX && this.deltaX) {\r\n        this.isScrollX = true;\r\n    }\r\n\r\n    //算一次有效的滑动\r\n    if (absDeltaX <= 25) return;\r\n\r\n    var delayX = 0;\r\n\r\n    if (this.deltaX < 0) {\r\n        delayX = 20;\r\n    } else {\r\n        delayX = (-20);\r\n    }\r\n\r\n    !this.fliplock && this.processorMove({\r\n        'pageIndex': this.hindex,\r\n        'distance': this.deltaX + delayX,\r\n        'speed': 0,\r\n        'direction': this.deltaX > 0 ? 'prev' : 'next',\r\n        'action': 'flipMove'\r\n    });\r\n\r\n}\r\n\r\nedProto.onTouchEnd = function(e) {\r\n\r\n    this.isTouching = false;\r\n\r\n    if (this.isoverstep || this.preventSwipe) return;\r\n\r\n    //点击\r\n    if (!this.isScrollX && !this.isScrollY) {\r\n        var isReturn = false;\r\n        this.$emit('onSwipeUp', this.hindex, function() {\r\n            isReturn = true;\r\n        });\r\n        if (isReturn) return;\r\n    }\r\n\r\n    //如果是左右滑动\r\n    if (this.isScrollX) {\r\n\r\n        var duration = +new Date - this.start.time,\r\n            deltaX = Math.abs(this.deltaX),\r\n            //如果是首尾\r\n            isPastBounds = !this.hindex && this.deltaX > 0 || this.hindex == this.pagetotal - 1 && this.deltaX < 0,\r\n            isValidSlide =\r\n            Number(duration) < 200 && Math.abs(deltaX) > 30 || Math.abs(deltaX) > this.screenWidth / 6;\r\n\r\n\r\n        //跟随移动\r\n        if (!this.fliplock && isValidSlide && !isPastBounds) {\r\n            if (this.deltaX < 0) { //true:right, false:left\r\n                this.slideTo('next');\r\n            } else {\r\n                this.slideTo('prev');\r\n            }\r\n        } else {\r\n            //反弹\r\n            this.processorMove({\r\n                'pageIndex': this.hindex,\r\n                'direction': this.deltaX > 0 ? 'prev' : 'next',\r\n                'distance': 0,\r\n                'speed': 300,\r\n                'action': 'flipRebound'\r\n            });\r\n        }\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 设置动画完成\r\n * @param {[type]} element [description]\r\n */\r\nedProto.setAnimComplete = function(element) {\r\n    this.distributed(element[0]);\r\n}\r\n\r\n/**\r\n * 动画结束后处理\r\n * @param  {[type]} e [description]\r\n * @return {[type]}   [description]\r\n */\r\nedProto.onAnimComplete = function(e) {\r\n    var target = e.target,\r\n        pageType = target.getAttribute('data-pageType'),\r\n        view = target.getAttribute('data-view'); //操作的可视窗口\r\n\r\n    //反弹效果,未翻页\r\n    if (!view) {\r\n        if (!pageType) {\r\n            //只针对母板处理\r\n            this.$emit('onMasterMove', this.hindex, target);\r\n        }\r\n        return;\r\n    }\r\n\r\n    this.distributed(target);\r\n}\r\n\r\n/**\r\n * 派发事件\r\n * @return {[type]} [description]\r\n */\r\nedProto.distributed = function(element) {\r\n\r\n    //针对拖拽翻页阻止\r\n    this.preventSwipe = true;\r\n    this.isTouching = false;\r\n\r\n    //快速翻页\r\n    var isQuickTurn = this.isQuickTurn;\r\n\r\n    //恢复速率\r\n    this.resetRate();\r\n\r\n    element.removeAttribute('data-view', 'false');\r\n\r\n    var slef = this;\r\n    setTimeout(function() {\r\n        slef.$emit('onAnimComplete', slef.direction, slef.pagePointer, slef.unlock.bind(slef), isQuickTurn);\r\n    }, 100)\r\n}\r\n\r\n\r\nedProto.lock = function() {\r\n    this.fliplock = true;\r\n}\r\n\r\n//解锁翻页\r\nedProto.unlock = function() {\r\n    this.fliplock = false;\r\n}\r\n\r\n//快速翻页时间计算\r\nedProto.setRate = function() {\r\n    this.speedRate = 50 / this.screenWidth;\r\n    this.isQuickTurn = true;\r\n}\r\n\r\n//复位速率\r\nedProto.resetRate = function() {\r\n    this.speedRate = this.originalRate;\r\n    this.isQuickTurn = false;\r\n}\r\n\r\nedProto.openSwipe = function() {\r\n    this._bindEvt();\r\n}\r\n\r\nedProto.closeSwipe = function() {\r\n    this.evtDestroy();\r\n}\r\n\r\n\r\n/*********************************************************************\r\n *\r\n *                 页面跳转事件\r\n *                                                         *\r\n **********************************************************************/\r\n\r\n\r\n//计算当前已经创建的页面索引\r\nfunction calculationPosition(currIndex, targetIndex, pagetotal) {\r\n    var i = 0,\r\n        existpage,\r\n        createpage,\r\n        pageIndex,\r\n        ruleOut = [],\r\n        create = [],\r\n        destroy,\r\n        viewFlip;\r\n\r\n    //存在的页面\r\n    if (currIndex === 0) {\r\n        existpage = [currIndex, currIndex + 1];\r\n    } else if (currIndex === pagetotal - 1) {\r\n        existpage = [currIndex - 1, currIndex];\r\n    } else {\r\n        existpage = [currIndex - 1, currIndex, currIndex + 1];\r\n    }\r\n\r\n    //需要创建的新页面\r\n    if (targetIndex === 0) {\r\n        createpage = [targetIndex, targetIndex + 1];\r\n    } else if (targetIndex === pagetotal - 1) {\r\n        createpage = [targetIndex - 1, targetIndex];\r\n    } else {\r\n        createpage = [targetIndex - 1, targetIndex, targetIndex + 1];\r\n    }\r\n\r\n    for (; i < createpage.length; i++) {\r\n        pageIndex = createpage[i];\r\n        //跳过存在的页面\r\n        if (-1 === existpage.indexOf(pageIndex)) {\r\n            //创建目标的页面\r\n            create.push(pageIndex);\r\n        } else {\r\n            //排除已存在的页面\r\n            ruleOut.push(pageIndex);\r\n        }\r\n    }\r\n\r\n    _.each(ruleOut, function(ruleOutIndex) {\r\n        existpage.splice(existpage.indexOf(ruleOutIndex), 1)\r\n    });\r\n\r\n    destroy = existpage;\r\n\r\n    viewFlip = [].concat(create).concat(ruleOut).sort(function(a, b) {\r\n        return a - b\r\n    });\r\n\r\n    return {\r\n        'create': create,\r\n        'ruleOut': ruleOut,\r\n        'destroy': destroy,\r\n        'viewFlip': viewFlip,\r\n        'targetIndex': targetIndex,\r\n        'currIndex': currIndex\r\n    }\r\n}\r\n\r\n\r\nedProto.scrollToPage = function(targetIndex, preMode, complete) { //目标页面\r\n\r\n    //如果还在翻页中\r\n    if (this.fliplock) return\r\n\r\n    var data;\r\n    var currIndex = this.hindex; //当前页面\r\n\r\n    switch (targetIndex) {\r\n        //前一页\r\n        case (currIndex - 1):\r\n            if (this.multiplePages) {\r\n                return this.prev();\r\n            }\r\n            break;\r\n            //首页\r\n        case currIndex:\r\n            if (currIndex == 0) {\r\n                this.$emit('onDropApp');\r\n            }\r\n            return\r\n            //后一页\r\n        case (currIndex + 1):\r\n            if (this.multiplePages) {\r\n                return this.next();\r\n            }\r\n            break;\r\n    }\r\n\r\n    //算出是相关数据\r\n    data = calculationPosition(currIndex, targetIndex, this.pagetotal)\r\n\r\n    //更新页码索引\r\n    this.updataPointer(data);\r\n\r\n    data.pagePointer = this.pagePointer;\r\n\r\n    this.$emit('onJumpPage', data);\r\n}\r\n\r\n/**\r\n * 事件处理\r\n * @param  {[type]} e [description]\r\n * @return {[type]}   [description]\r\n */\r\nedProto.handleEvent = function(e) {\r\n    Xut.plat.handleEvent({\r\n        start: function(e) {\r\n            this.onTouchStart(e);\r\n        },\r\n        move: function(e) {\r\n            this.onTouchMove(e);\r\n        },\r\n        end: function(e) {\r\n            this.onTouchEnd(e);\r\n        },\r\n        transitionend: function(e) {\r\n            this.onAnimComplete(e);\r\n        }\r\n    }, this, e)\r\n}\r\n\r\n/**\r\n * 绑定事件\r\n * @return {[type]} [description]\r\n */\r\nedProto._bindEvt = function() {\r\n    var self = this;\r\n    //pageFlip启动，没有滑动处理\r\n    if (this.pageFlip) {\r\n        Xut.plat.execEvent('on', {\r\n            context: this.element,\r\n            callback: {\r\n                start: this,\r\n                end: this,\r\n                transitionend: this\r\n            }\r\n        })\r\n    } else if (this.multiplePages) {\r\n        Xut.plat.execEvent('on', {\r\n            context: this.element,\r\n            callback: {\r\n                start: this,\r\n                move: this,\r\n                end: this,\r\n                transitionend: this\r\n            }\r\n        })\r\n    } else {\r\n        Xut.plat.execEvent('on', {\r\n            context: this.element,\r\n            callback: {\r\n                start: this,\r\n                end: this\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * 销毁事件\r\n * @return {[type]} [description]\r\n */\r\nedProto.evtDestroy = function() {\r\n    var self = this;\r\n    Xut.plat.execEvent('off', {\r\n        context: this.element,\r\n        callback: {\r\n            start: this,\r\n            move: this,\r\n            end: this,\r\n            transitionend: this\r\n        }\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 销毁所有\r\n * @return {[type]} [description]\r\n */\r\nedProto.destroy = function() {\r\n    this.evtDestroy();\r\n    this.$off();\r\n    this.bubbleNode.page = null;\r\n    this.bubbleNode.master = null;\r\n    this.element = null;\r\n}\r\n\r\n/**\r\n * 扩充事件\r\n */\r\nobserve.call(GlobalEvent.prototype);\r\n\r\n\r\nexport { GlobalEvent }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/globalevent.js\n **/","/**\r\n * 应用对外接口\r\n * 此模块的所有方法都是动态修正上下文，自动切换场景\r\n * 1.\tXut.Application\r\n * \t\t\ta)\t整个应用程序的接口，执行应用级别的操作，例如退出应用之类。\r\n * 2.\tXut.DocumentWindow\r\n * \t\t\ta)\t窗口的接口。窗口就是电子杂志的展示区域，可以操作诸如宽度、高度、长宽比之类。\r\n * 3.\tXut.View\r\n * \t\t\ta)\t视图接口。视图是窗口的展示方式，和页面相关的接口，都在这里。\r\n * 4.\tXut.Presentation\r\n * \t\t\ta)\t数据接口。和电子杂志的数据相关的接口，都在这里。\r\n * 5.\tXut.Slides\r\n *\t\t\ta)\t所有页面的集合\r\n * 6.\tXut.Slide\r\n * \t\t\ta)\t单个页面\r\n * 7.\tXut.Master\r\n * \t\t\ta)\t页面的母版\r\n * @return {[type]} [description]\r\n */\r\n\r\nimport {reviseSize} from '../util/option'\r\n\r\n\r\nvar typeFilter = ['page', 'master'];\r\n\r\n/**\r\n * 合并参数设置\r\n * 1 pageMgr\r\n * 2 masterMgr\r\n * 3 修正pageType\r\n * 4 args参数\r\n * 5 回调每一个上下文\r\n */\r\nfunction createaAccess(mgr) {\r\n    return function(callback, pageType, args, eachContext) {\r\n        //如果第一个参数不是pageType模式\r\n        //参数移位\r\n        if (pageType !== undefined && -1 === typeFilter.indexOf(pageType)) {\r\n            var temp = args;\r\n            args = pageType;\r\n            eachContext = temp;\r\n            pageType = 'page';\r\n        }\r\n\r\n        //pageIndex为pageType参数\r\n        if (-1 !== typeFilter.indexOf(args)) {\r\n            pageType = args;\r\n            args = null;\r\n        }\r\n\r\n        pageType = pageType || 'page';\r\n\r\n        if (mgr[pageType]) {\r\n            return callback(mgr[pageType], pageType, args, eachContext)\r\n        } else {\r\n            console.log('传递到access的pageType错误！')\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 判断是否存在页码索引\r\n * 如果不存在默认取当前页面\r\n */\r\nfunction createExistIndex($globalEvent) {\r\n    return function(pageIndex) {\r\n        //如果不存在\r\n        if (pageIndex == undefined) {\r\n            pageIndex = $globalEvent.hindex //当前页面\r\n        }\r\n        return pageIndex\r\n    }\r\n}\r\n\r\n\r\nexport function overrideApi(vm) {\r\n\r\n    var $globalEvent = vm.$globalEvent;\r\n    var options = vm.options;\r\n    var $scheduler = vm.$scheduler\r\n\r\n    //页面与母版的管理器\r\n    var access = createaAccess({\r\n        page: $scheduler.pageMgr,\r\n        master: $scheduler.masterMgr\r\n    });\r\n\r\n    var isExistIndex = createExistIndex($globalEvent);\r\n\r\n    //***************************************************************\r\n    //\r\n    //  数据接口\r\n    //\r\n    //***************************************************************\r\n\r\n    var Presentation = Xut.Presentation;\r\n\r\n    /**\r\n     * 获取当前页码\r\n     */\r\n    Presentation.GetPageIndex = function() {\r\n        return $globalEvent.hindex;\r\n    };\r\n\r\n    ///////////////\r\n    //获取页面的总数据 //\r\n    //1 chapter数据\r\n    //2 section数据\r\n    ///////////////\r\n    _.each([\r\n        \"Section\",\r\n        \"Page\"\r\n    ], function(apiName) {\r\n        Presentation['GetApp' + apiName + 'Data'] = function(callback) {\r\n            var i = 0,\r\n                temp = [],\r\n                cps = Xut.data.query('app' + apiName),\r\n                cpsLength = cps.length;\r\n            for (i; i < cpsLength; i++) {\r\n                temp.push(cps.item(i))\r\n            }\r\n            return temp;\r\n        }\r\n    })\r\n\r\n\r\n    //////////////////\r\n    //获取首页的pageId //\r\n    //////////////////\r\n    Presentation.GetFirstPageId = function(seasonId) {\r\n        var sectionRang = Xut.data.query('sectionRelated', seasonId);\r\n        var pageData = Xut.data.query('appPage');\r\n        return pageData.item(sectionRang.start);\r\n    }\r\n\r\n    //==========================================\r\n    //\t四大数据接口\r\n    //\t快速获取一个页面的nodes值\r\n    //\t获取当前页面的页码编号 - chapterId\r\n    //\t快速获取指定页面的chapter数据\r\n    //\tpagebase页面管理对象\r\n    //==========================================\r\n    _.each([\r\n        \"GetPageId\",\r\n        \"GetPageNode\",\r\n        \"GetPageData\",\r\n        \"GetPageObj\"\r\n    ], function(apiName) {\r\n        Presentation[apiName] = function(pageType, pageIndex) {\r\n            return access(function(manager, pageType, pageIndex) {\r\n                pageIndex = isExistIndex(pageIndex);\r\n                return manager[\"abstract\" + apiName](pageIndex, pageType);\r\n            }, pageType, pageIndex)\r\n        }\r\n    })\r\n\r\n    /**\r\n     * 得到页面根节点\r\n     * li节点\r\n     */\r\n    Presentation.GetPageElement = function() {\r\n        var obj = Presentation.GetPageObj();\r\n        return obj.element;\r\n    };\r\n\r\n    /**\r\n     * 获取页码标记\r\n     * 因为非线性的关系，页面都是按chpater组合的\r\n     * page_0\r\n     * page_10\r\n     * 但是每一个章节页面的索引是从0开始的\r\n     * 区分pageIndex\r\n     */\r\n    Presentation.GetPagePrefix = function(pageType, pageIndex) {\r\n        var pageObj = Presentation.GetPageObj(pageType, pageIndex);\r\n        return pageObj.pid;\r\n    };\r\n\r\n\r\n    //命名前缀\r\n    var prefix = 'Content_';\r\n\r\n    /**\r\n     * 创建一个content的命名规则\r\n     */\r\n    Presentation.MakeContentPrefix = function(pageIndex) {\r\n        return prefix + Presentation.GetPagePrefix(pageIndex) + \"_\";\r\n    }\r\n\r\n    /**\r\n     * 获取命名规则\r\n     */\r\n    Presentation.GetContentName = function(id) {\r\n        if (id) {\r\n            return prefix + Presentation.GetPagePrefix() + \"_\" + id;\r\n        } else {\r\n            return prefix + Presentation.GetPagePrefix()\r\n        }\r\n    }\r\n\r\n\r\n    //***************************************************************\r\n    //\r\n    //  视图接口\r\n    //\r\n    //***************************************************************\r\n\r\n    var View = Xut.View;\r\n\r\n    /**\r\n     * 显示工具栏\r\n     * 没有参数显示 工具栏与控制翻页按钮\r\n     * 有参数单独显示指定的\r\n     */\r\n    View.ShowToolbar = function(point) {\r\n        vm.$emit('change:toggleToolbar', 'show', point)\r\n    };\r\n\r\n    /**\r\n     * 隐藏工具栏\r\n     * 没有参数隐藏 工具栏与控制翻页按钮\r\n     * 有参数单独隐藏指定\r\n     */\r\n    View.HideToolbar = function(point) {\r\n        vm.$emit('change:toggleToolbar', 'hide', point)\r\n    };\r\n\r\n    /**\r\n     * 指定特定的显示与隐藏\r\n     *  Xut.View.Toolbar({\r\n     *       show :'bottom',\r\n     *       hide :'controlBar'\r\n     *   })\r\n     *\r\n     *  //工具栏与翻页按钮全部显示/隐藏\r\n     *  Xut.View.Toolbar('show')\r\n     *  Xut.View.Toolbar('hide')\r\n     *\r\n     * @return {[type]} [description]\r\n     */\r\n    View.Toolbar = function(cfg) {\r\n        vm.$emit('change:toggleToolbar', cfg)\r\n    };\r\n\r\n    /**\r\n     * 跳转到上一个页面\r\n     */\r\n    View.GotoPrevSlide = function(seasonId, chapterId) {\r\n        if (seasonId && chapterId) {\r\n            Xut.View.LoadScenario({\r\n                'scenarioId': seasonId,\r\n                'chapterId': chapterId\r\n            })\r\n            return;\r\n        }\r\n\r\n        //ibooks模式下的跳转\r\n        //全部转化成超链接\r\n        if (Xut.IBooks.Enabled && Xut.IBooks.runMode()) {\r\n            location.href = (Xut.IBooks.pageIndex - 1) + \".xhtml\";\r\n            return\r\n        }\r\n\r\n        options.multiplePages && $globalEvent.prev();\r\n    };\r\n\r\n    /**\r\n     * 跳转到下一个页面\r\n     */\r\n    View.GotoNextSlide = function(seasonId, chapterId) {\r\n        if (seasonId && chapterId) {\r\n            Xut.View.LoadScenario({\r\n                'scenarioId': seasonId,\r\n                'chapterId': chapterId\r\n            })\r\n            return;\r\n        }\r\n\r\n        //ibooks模式下的跳转\r\n        //全部转化成超链接\r\n        if (Xut.IBooks.Enabled && Xut.IBooks.runMode()) {\r\n            location.href = (Xut.IBooks.pageIndex + 1) + \".xhtml\";\r\n            return\r\n        }\r\n\r\n        options.multiplePages && $globalEvent.next();\r\n    };\r\n\r\n    /**\r\n     * 跳转页面\r\n     * 场景内部切换\r\n     * 跳转到指定编号的页面\r\n     * Action 类型跳转\r\n     * xxtlink 超连接跳转,svg内嵌跳转标记处理\r\n     * 文本框跳转\r\n     * ........\r\n     */\r\n    View.GotoSlide = function(seasonId, chapterId) {\r\n        var count,\r\n            sceneObj,\r\n            currscene,\r\n            sceneController,\r\n            //修正参数\r\n            fixParameter = function(pageIndex) {\r\n                pageIndex = Number(pageIndex) - 1;\r\n                if (pageIndex < 0) {\r\n                    pageIndex = 0;\r\n                }\r\n                return pageIndex;\r\n            };\r\n\r\n        //ibooks模式下的跳转\r\n        //全部转化成超链接\r\n        if (Xut.IBooks.Enabled && Xut.IBooks.runMode() && chapterId) {\r\n            location.href = chapterId + \".xhtml\";\r\n            return\r\n        }\r\n\r\n        //兼容数据错误\r\n        if (!seasonId && !chapterId) return;\r\n\r\n        //如果是一个参数是传递页码数,则为内部跳转\r\n        if (arguments.length === 1) {\r\n            //复位翻页按钮\r\n            vm.$emit('change:showNext')\r\n            return $globalEvent.scrollToPage(fixParameter(seasonId))\r\n        }\r\n\r\n        //场景模式内部跳转\r\n        if (options.scenarioId == seasonId) {\r\n            //chpaterId 转化成实际页码\r\n            var sectionRang = Xut.data.query('sectionRelated', seasonId);\r\n            var pageIndex = chapterId - sectionRang.start;\r\n            vm.$emit('change:showNext')\r\n            return $globalEvent.scrollToPage(fixParameter(pageIndex))\r\n        }\r\n        //场景与场景的跳转\r\n        return View.LoadScenario({\r\n            'scenarioId': seasonId,\r\n            'chapterId': chapterId\r\n        });\r\n    }\r\n\r\n    //页面滑动\r\n    View.MovePage = function(distance, speed, direction, action) {\r\n        //如果禁止翻页模式 || 如果是滑动,不是边界\r\n        if (!options.multiplePages || $globalEvent.isMove() || action === 'flipMove' && $globalEvent.isBorder(distance)) {\r\n            return;\r\n        }\r\n        var pagePointer = $globalEvent.pagePointer,\r\n            data = {\r\n                'distance': distance,\r\n                'speed': speed,\r\n                'direction': direction,\r\n                'action': action,\r\n                'leftIndex': pagePointer.leftIndex,\r\n                'pageIndex': pagePointer.currIndex,\r\n                'rightIndex': pagePointer.rightIndex\r\n            };\r\n        $scheduler.move(data);\r\n        pagePointer = null;\r\n    };\r\n\r\n\r\n\r\n    //***************************************************************\r\n    //\r\n    //  辅助对象的控制接口\r\n    //\r\n    //***************************************************************\r\n\r\n    /**\r\n     * 运行辅助动画\r\n     * 辅助对象的activityId,或者合集activityId\r\n     * Run\r\n     * stop\r\n     * 1 零件\r\n     * 2 音频动画\r\n     */\r\n    var Assist = Xut.Assist;\r\n\r\n    _.each([\r\n        \"Run\",\r\n        \"Stop\"\r\n    ], function(apiName) {\r\n        Assist[apiName] = function(pageType, activityId, outCallBack) {\r\n            access(function(manager, pageType, activityId, outCallBack) {\r\n                //数组\r\n                if (_.isArray(activityId)) {\r\n                    //完成通知\r\n                    var markComplete = function() {\r\n                        var completeStatistics = activityId.length; //动画完成统计\r\n                        return function() {\r\n                            if (completeStatistics === 1) {\r\n                                outCallBack && outCallBack();\r\n                                markComplete = null;\r\n                            }\r\n                            completeStatistics--;\r\n                        }\r\n                    }();\r\n                    _.each(activityId, function(id) {\r\n                        manager.abstractAssistAppoint(id, $globalEvent.hindex, markComplete, apiName);\r\n                    })\r\n                } else {\r\n                    manager.abstractAssistAppoint(activityId, $globalEvent.hindex, outCallBack, apiName);\r\n                }\r\n            }, pageType, activityId, outCallBack)\r\n        }\r\n    })\r\n\r\n\r\n    //***************************************************************\r\n    //\r\n    //  针对page页面的content类型操作接口\r\n    //\r\n    //***************************************************************\r\n\r\n    var Contents = Xut.Contents;\r\n\r\n    /**\r\n     * 获取指定的对象\r\n     * 传递参数\r\n     * 单一 id\r\n     * 数据id合集 [1,2,4,5,6]\r\n     * @param {[type]}   contentIds  [description]\r\n     * @param {Function} eachContext 回调遍历每一个上下文\r\n     */\r\n    Contents.Get = function(pageType, contentIds, eachContext) {\r\n\r\n        return access(function(manager, pageType, contentIds, eachContext) {\r\n\r\n            var contentObj, contentObjs,\r\n                pageIndex = Presentation.GetPageIndex();\r\n\r\n            function findContent(currIndex, contentId) {\r\n                var pageObj;\r\n                if (pageObj = manager.abstractGetPageObj(currIndex)) {\r\n                    return pageObj.baseGetContentObject(contentId);\r\n                }\r\n            }\r\n\r\n            //如果传递是数组合集\r\n            if (_.isArray(contentIds)) {\r\n                contentObjs = [];\r\n                _.each(contentIds, function(id) {\r\n                    contentObj = findContent(pageIndex, id)\r\n                    if (eachContext) { //传递每一个处理的上下文\r\n                        eachContext(id, contentObj);\r\n                    } else {\r\n                        if (contentObj) {\r\n                            contentObjs.push(contentObj);\r\n                        } else {\r\n                            Xut.log('error', '找不到对应的content数据' + id)\r\n                        }\r\n                    }\r\n                })\r\n                return contentObjs;\r\n            }\r\n\r\n            //如果传递的是Content_1_3组合情况\r\n            if (/_/.test(contentIds)) {\r\n                var expr = contentIds.split('_');\r\n                if (expr.length > 1) {\r\n                    return findContent(expr[1], expr[2]);\r\n                }\r\n            }\r\n\r\n            //单一content id\r\n            contentObj = findContent(pageIndex, contentIds);\r\n\r\n            if (eachContext) {\r\n                eachContext(contentObj);\r\n            } else {\r\n                return contentObj;\r\n            }\r\n\r\n        }, pageType, contentIds, eachContext)\r\n    }\r\n\r\n\r\n    /**\r\n     * 得到指定页面零件的数据\r\n     * 获取指定的content数据\r\n     * @param  {[type]} contentId [description]\r\n     * @return {[type]}           [description]\r\n     */\r\n    Contents.GetPageWidgetData = function(pageType, contentId) {\r\n\r\n        //如果没有传递pageType取默认\r\n        if (-1 === typeFilter.indexOf(pageType)) {\r\n            contentId = pageType;\r\n            pageType = 'page';\r\n        }\r\n\r\n        //必须有数据\r\n        if (!contentId || !contentId.length) {\r\n            return;\r\n        }\r\n\r\n        //保证是数组格式\r\n        if (_.isString(contentId)) {\r\n            contentId = [contentId];\r\n        }\r\n\r\n        var contentDas, contents = [];\r\n\r\n        Contents.Get(pageType, contentId, function(cid, content) {\r\n            //是内部对象\r\n            if (content && (contentDas = content.contentDas)) { //通过内部管理获取对象\r\n                contents.push({\r\n                    'id': content.id,\r\n                    'idName': content.actName,\r\n                    'element': content.$contentProcess,\r\n                    'theTitle': contentDas.theTitle,\r\n                    'scaleHeight': contentDas.scaleHeight,\r\n                    'scaleLeft': contentDas.scaleLeft,\r\n                    'scaleTop': contentDas.scaleTop,\r\n                    'scaleWidth': contentDas.scaleWidth,\r\n                    'contentData': contentDas,\r\n                    'source': 'innerObjet' //获取方式内部对象\r\n                });\r\n            } else {\r\n                //如果通过内部找不到对象的content数据,则直接查找数据库\r\n                //可能是一个事件的钩子对象\r\n                if (contentDas = seekQuery(cid)) {\r\n                    var actName = Presentation.GetContentName(cid);\r\n                    var element;\r\n                    //如果对象是事件钩子或者是浮动对象\r\n                    //没有具体的数据\r\n                    if (content && content.$contentProcess) {\r\n                        element = content.$contentProcess;\r\n                    } else {\r\n                        element = $('#' + actName);\r\n                    }\r\n                    contents.push({\r\n                        'id': cid,\r\n                        'idName': actName,\r\n                        'element': element,\r\n                        'theTitle': contentDas.theTitle,\r\n                        'scaleHeight': contentDas.scaleHeight,\r\n                        'scaleLeft': contentDas.scaleLeft,\r\n                        'scaleTop': contentDas.scaleTop,\r\n                        'scaleWidth': contentDas.scaleWidth,\r\n                        'contentData': contentDas,\r\n                        'source': 'dataBase'\r\n                    });\r\n                } else {\r\n                    Xut.log('error', '找不到对应的GetPageWidgetData数据' + cid)\r\n                }\r\n            }\r\n        });\r\n        return contents;\r\n    }\r\n\r\n    //数据库查找\r\n    function seekQuery(id) {\r\n        var contentData = Xut.data.query('Content', id);\r\n        if (contentData) {\r\n            return reviseSize(_.extend({}, contentData));\r\n        }\r\n    }\r\n\r\n\r\n    //******************************************\r\n    //\r\n    //\t\t互斥接口\r\n    //\t\t直接显示\\隐藏\\停止动画\r\n    //\r\n    //*******************************************\r\n\r\n    //检测类型为字符串\r\n    function typeCheck(objNameList) {\r\n        return !objNameList || typeof objNameList !== 'string' ? true : false;\r\n    }\r\n\r\n    /**\r\n     * 针对文本对象的直接操作\r\n     * 显示\r\n     * 隐藏\r\n     * 停止动画\r\n     */\r\n    _.each([\r\n        \"Show\",\r\n        \"Hide\",\r\n        \"StopAnim\"\r\n    ], function(operate) {\r\n        Contents[operate] = function(pageType, nameList) {\r\n            access(function(manager, pageType, nameList) {\r\n                if (typeCheck(nameList)) return;\r\n                var pageBaseObj;\r\n                if (!(pageBaseObj = manager.abstractAssistPocess($globalEvent.hindex))) {\r\n                    console.log('注入互斥接口数据错误！')\r\n                    return;\r\n                }\r\n                _.each(nameList.split(','), function(contentId) {\r\n                    pageBaseObj.baseContentMutex(contentId, operate)\r\n                })\r\n            }, pageType, nameList)\r\n        }\r\n    })\r\n\r\n\r\n    //******************************************\r\n    //\r\n    //\t\tApplication\r\n    //\t\t应用接口\r\n    //\r\n    //*******************************************\r\n\r\n    var Application = Xut.Application;\r\n\r\n    /**\r\n     * 获取一个存在的实例对象\r\n     * 区分不同层级page/master\r\n     * 不同类型\t   content/widget\r\n     */\r\n    Application.GetSpecifiedObject = function(pageType, data) {\r\n        return access(function(manager, pageType) {\r\n            var pageObj;\r\n            if (pageObj = manager.abstractGetPageObj(data.pageIndex)) {\r\n                if (data.type === 'Content') {\r\n                    return pageObj.baseSpecifiedContent(data);\r\n                } else {\r\n                    return pageObj.baseSpecifiedComponent(data);\r\n                }\r\n            }\r\n        }, pageType)\r\n    }\r\n\r\n\r\n    /**\r\n     * 应用滑动接口\r\n     * @return {[type]}\r\n     */\r\n    _.each([\r\n        \"closeSwipe\",\r\n        \"openSwipe\"\r\n    ], function(operate) {\r\n        Application[operate] = function() {\r\n            $globalEvent[operate]();\r\n        }\r\n    })\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/overrideapi.js\n **/","/*********************************************************************\r\n *                 调度器 生成页面模块\r\n *\r\n *            处理：事件动作分派\r\n *            调度：\r\n *                1. PageMgr     模块\r\n *                2. MasterMgr 模块\r\n *                                                                    *\r\n **********************************************************************/\r\nimport {_set} from '../util/stroage'\r\n//页面管理\r\nimport {PageMgr} from './page'\r\nimport {MasterMgr} from './master'\r\n\r\n//错误的数据库表\r\nimport {errorTable} from '../data/index'\r\n//数据解析\r\nimport {query} from './parser'\r\n//页面切换\r\nimport {SwitchPage} from './switch'\r\n//Navbar\r\nimport {close as _close} from '../toolbar/navbar'\r\n\r\n\r\n\r\n//判断是否能整除2\r\nfunction offsetPage(num) {\r\n    return ((num % 2 == 0) ? 'left' : 'right');\r\n}\r\n\r\n//如果是场景加载，转化页码数\r\n//转化按0开始\r\n//pageIndex 页码\r\n//visiblePid 可见页面chpaterId\r\nfunction conversionPageOpts(pageIndex, visiblePid) {\r\n    var sectionRang;\r\n    //转化可视区域值viewPageIndex\r\n    if (this.options.multiScenario) {\r\n        sectionRang = this.options.sectionRang;\r\n        //如果传入的是数据\r\n        if (!visiblePid && _.isArray(pageIndex)) {\r\n            pageIndex.forEach(function(ele, index) {\r\n                pageIndex.splice(index, 1, ele - sectionRang.start)\r\n            })\r\n            return pageIndex;\r\n        }\r\n        pageIndex -= sectionRang.start;\r\n        visiblePid += sectionRang.start;\r\n    } else {\r\n        //pageIndex是数组，并且realPage为空\r\n        if (_.isArray(pageIndex)) {\r\n            return pageIndex;\r\n        }\r\n    }\r\n\r\n    return {\r\n        'pageIndex': pageIndex,\r\n        'visiblePid': visiblePid\r\n    }\r\n}\r\n\r\n///////////\r\n//计算翻页距离 //\r\n///////////\r\nfunction calculateDistance(action, distance, direction) {\r\n    var leftOffset,\r\n        currOffset,\r\n        rightOffset;\r\n\r\n\t//保持缩放比,计算缩放比情况下的转化\r\n\tvar calculateContainer = Xut.config.proportion.calculateContainer();\r\n\tvar  containerWidth    = calculateContainer.width;\r\n\r\n\r\n    switch (direction) {\r\n        //前翻\r\n        case 'prev':\r\n            switch (action) {\r\n                case 'flipMove':\r\n                    leftOffset = distance - containerWidth;\r\n                    currOffset = distance;\r\n                    rightOffset = distance + containerWidth;\r\n                    break;\r\n                case 'flipRebound':\r\n                    leftOffset = -containerWidth;\r\n                    currOffset = distance;\r\n                    rightOffset = containerWidth;\r\n                    break;\r\n                case 'flipOver':\r\n                    leftOffset = 0;\r\n                    currOffset = containerWidth;\r\n                    rightOffset = 2 * containerWidth\r\n                    break;\r\n            }\r\n            break;\r\n            //后翻\r\n        case 'next':\r\n            switch (action) {\r\n                case 'flipMove':\r\n                    leftOffset = distance - containerWidth;\r\n                    rightOffset = distance + containerWidth;\r\n                    currOffset = distance;\r\n                    break;\r\n                case 'flipRebound':\r\n                    leftOffset = -containerWidth;\r\n                    rightOffset = containerWidth;\r\n                    currOffset = distance;\r\n                    break;\r\n                case 'flipOver':\r\n                    leftOffset = -2 * containerWidth;\r\n                    rightOffset = distance;\r\n                    currOffset = -containerWidth;\r\n                    break;\r\n            }\r\n            break;\r\n    }\r\n\r\n    return [leftOffset, currOffset, rightOffset];\r\n}\r\n\r\n////////////\r\n//计算初始化页码 //\r\n////////////\r\nfunction calculatePointer(targetIndex, pageTotal, multiplePages) {\r\n\r\n    var leftscope = 0,\r\n        pagePointer = {},\r\n        createPointer = [];\r\n\r\n    function setValue(index) {\r\n        if (index.leftIndex !== undefined) {\r\n            pagePointer.leftIndex = index.leftIndex;\r\n            createPointer.push(index.leftIndex)\r\n        }\r\n        if (index.currIndex !== undefined) {\r\n            pagePointer.currIndex = index.currIndex;\r\n            createPointer.push(index.currIndex)\r\n        }\r\n        if (index.rightIndex !== undefined) {\r\n            pagePointer.rightIndex = index.rightIndex;\r\n            createPointer.push(index.rightIndex)\r\n        }\r\n    }\r\n\r\n    //如果只有一页 or  非线性,只创建一个页面\r\n    if (pageTotal === 1 || !multiplePages) {\r\n        setValue({\r\n            'currIndex': targetIndex\r\n        })\r\n    } else {\r\n        //多页情况\r\n        if (targetIndex === leftscope) { //首页\r\n            setValue({\r\n                'currIndex': targetIndex,\r\n                'rightIndex': targetIndex + 1\r\n            })\r\n        } else if (targetIndex === pageTotal - 1) { //尾页\r\n            setValue({\r\n                'currIndex': targetIndex,\r\n                'leftIndex': targetIndex - 1\r\n            })\r\n        } else { //中间页\r\n            setValue({\r\n                'currIndex': targetIndex,\r\n                'leftIndex': targetIndex - 1,\r\n                'rightIndex': targetIndex + 1\r\n            })\r\n        }\r\n    }\r\n\r\n    this.pagePointer = pagePointer;\r\n\r\n    return createPointer;\r\n}\r\n\r\n//保证可视页面第一个分解\r\n//createPage 需要创建的页面 [0,1,2]\r\n//visualPage 可视区页面       [1]\r\nfunction conversionCid(createPage, visualPage) {\r\n\r\n    var indexOf, start, less;\r\n\r\n    //如果第一个不是可视区域\r\n    //切换位置\r\n    //加快创建速度\r\n    if (createPage[0] !== visualPage) {\r\n        indexOf = createPage.indexOf(visualPage),\r\n            less = createPage.splice(indexOf, 1),\r\n            createPage = less.concat(createPage);\r\n    }\r\n\r\n    //场景加载模式,计算正确的chapter顺序\r\n    //多场景的模式chpater分段后\r\n    //叠加起始段落\r\n    if (this.options.multiScenario) {\r\n        //需要提前解析数据库的排列方式\r\n        //chpater的开始位置\r\n        start = this.options.sectionRang.start;\r\n        //拼接位置\r\n        createPage.forEach(function(page, index) {\r\n            createPage.splice(index, 1, page + start)\r\n        })\r\n    }\r\n\r\n    // [0,1,2] => [73,74,75]\r\n    return createPage;\r\n}\r\n\r\n\r\n//页码转化成相对应的chpater表数据\r\nfunction conversionPids(createPage) {\r\n    return query('chapter', createPage);\r\n}\r\n\r\n\r\n//检测是否构建母板模块处理\r\nfunction checkMasterCreate() {\r\n    var table = errorTable();\r\n    //如果没有Master数据,直接过滤\r\n    if (-1 !== table.indexOf('Master') || !Xut.data['Master'] || !Xut.data['Master'].length) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\n\r\n////////\r\n//调度器 //\r\n////////\r\nexport function Scheduler(vm) {\r\n\r\n    this.vm = vm;\r\n    this.options = vm.options;\r\n\r\n    /**\r\n     * 创建前景页面管理模块\r\n     * @type {PageMgr}\r\n     */\r\n    this.pageMgr = new PageMgr(vm);\r\n\r\n    /**\r\n     * 检测是否需要创母版模块\r\n     * @return {[type]} [description]\r\n     */\r\n    if (checkMasterCreate()) {\r\n        this.masterMgr = new MasterMgr(vm);\r\n    }\r\n};\r\n\r\n\r\nvar SchedulerProto = Scheduler.prototype\r\n\r\n\r\n/**\r\n * 初始化页面创建\r\n * 因为多个页面的问题，所以不是创建调用\r\n * 统一回调\r\n * @return {[type]} [description]\r\n */\r\nSchedulerProto.initCreate = function() {\r\n    var options = this.options;\r\n    /**\r\n     * 初始化构建页面\r\n     */\r\n    this.create(\r\n        calculatePointer.call(this, options.initIndex, options.pagetotal, options.multiplePages), options.initIndex, 'init'\r\n    );\r\n};\r\n\r\n\r\n/**\r\n *  创建普通页面\r\n *  创建母版页面\r\n *  createPointer  需要创建的页面索引\r\n *  visiblePage       当前可视区页面索引\r\n *  action         toPage/init/flipOver\r\n *  toPageCallback 跳转页面支持回调通知\r\n *  userStyle      规定创建的style属性\r\n **/\r\nSchedulerProto.create = function(createPage, visiblePage, action, toPageCallback, userStyle) {\r\n\r\n    //2016.1.20\r\n    //修正苗苗学问题 确保createPage不是undefined\r\n    if (void 0 === createPage[0]) {\r\n        return;\r\n    }\r\n\r\n\r\n    // console.debug('当前页面:' + this.pagePointer.currIndex + ',创建新页面:\"'+ createPointer + '\",动作:' +action)\r\n    var createPid,\r\n        pageBase,\r\n        visiblePid,\r\n        pageIndex,\r\n        conversion,\r\n        newCreate,\r\n        callbackAction,\r\n        virtualMode = Xut.config.virtualMode,\r\n        self = this,\r\n        multiplePages = this.options.multiplePages, //是否线性\r\n        total = createPage.length,\r\n        toPageAction = action === 'toPage', //如果是跳转\r\n        filpOverAction = action === 'flipOver', //如果是翻页\r\n\r\n        //使用第一个是分解可见页面\r\n        //将页码pageIndex转化成对应的chapter\r\n        createPids = conversionCid.call(this, createPage, visiblePage),\r\n\r\n        //收集创建的页面对象\r\n        //用于处理2个页面在切换的时候闪屏问题\r\n        //主要是传递createStyle自定义样式的处理\r\n        collectCreatePageBase = [],\r\n\r\n        //是否触发母版的自动时间\r\n        //因为页面每次翻页都会驱动auto事件\r\n        //但是母版可能是共享的\r\n        createMaster = false,\r\n\r\n        //收集完成回调\r\n        collectCallback = function() {\r\n            //收集创建页码的数量\r\n            var createContent = 0;\r\n            return function(callback) {\r\n                ++createContent\r\n                if (createContent === total) {\r\n                    callback();\r\n                }\r\n            }\r\n        }(),\r\n\r\n        //构建执行代码\r\n        callbackAction = {\r\n            //初始化\r\n            init: function() {\r\n                collectCallback(function() {\r\n                    self.loadPage('init');\r\n                })\r\n            },\r\n            //翻页\r\n            flipOver: function() {\r\n                collectCallback(function() {\r\n                    self.autoRun({ //翻页\r\n                        'createPointer': createPids,\r\n                        'createMaster': createMaster\r\n                    });\r\n                })\r\n            },\r\n            //跳转\r\n            toPage: function() {\r\n                collectCallback(function() {\r\n                    toPageCallback(collectCreatePageBase);\r\n                })\r\n            }\r\n        };\r\n\r\n    ////////////////////\r\n    //pid=>chpterData //\r\n    ////////////////////\r\n    var results = conversionPids(createPids);\r\n\r\n    ////////////\r\n    //如果是最后一页 //\r\n    //没有对应的虚拟数据，取前一页的\r\n    ////////////\r\n    if (virtualMode && !results.length) {\r\n        var virtualPid = _.extend([], createPids);\r\n        createPids.forEach(function(pid, index) {\r\n            virtualPid.splice(index, 1, --pid)\r\n        })\r\n        results = conversionPids(virtualPid);\r\n    }\r\n\r\n    //页码转成数据\r\n    _.each(results, function(chapterData, index) {\r\n\r\n        //转化值\r\n        //chapterId => createPid\r\n        createPid = createPids[index];\r\n\r\n        //createPid \r\n        //pageIndex \r\n        conversion = conversionPageOpts.call(self, createPid, visiblePage);\r\n        visiblePid = conversion.visiblePid;\r\n        pageIndex = conversion.pageIndex;\r\n\r\n        ////////////////\r\n        // 如果启动了虚拟页面模式 //\r\n        ////////////////\r\n        var virtualPid = false; //虚拟页面的pid编号\r\n        var virtualOffset = false; //页面坐标left,right\r\n        if (virtualMode) {\r\n            //页面位置\r\n            virtualOffset = offsetPage(pageIndex);\r\n\r\n            //获取新的chpater数据\r\n            function fixCids(originalIndex) {\r\n                var originalPid = conversionCid.call(self, [originalIndex]);\r\n                return conversionPids([originalPid])[0];\r\n            }\r\n\r\n            ////////////\r\n            //如果是翻页创建 //\r\n            //由于是拼接的所以chapter移位了\r\n            ////////////\r\n            if (virtualOffset === 'left') {\r\n                chapterData = fixCids(pageIndex / 2)\r\n            }\r\n            //修正右边chapter\r\n            if (virtualOffset === 'right') {\r\n                chapterData = fixCids((pageIndex - 1) / 2)\r\n            }\r\n        }\r\n\r\n        if (total === 1) {\r\n            self.options.chapterId = chapterData._id\r\n        }\r\n\r\n        //构件新的页面\r\n        //masterFilter 母板过滤器回调函数\r\n        newCreate = function(masterFilter) {\r\n\r\n            //跳转的时候，创建新页面可以自动样式信息\r\n            //优化设置，只是改变当前页面即可\r\n            if (toPageAction && visiblePid !== createPid) {\r\n                userStyle = undefined;\r\n            }\r\n\r\n            var dataOpts = {\r\n                'pageIndex': pageIndex,\r\n                'multiplePages': multiplePages,\r\n                'pid': createPid, //页码chapterId\r\n                'chapterDas': chapterData, //当前页面的chpater数据\r\n                'visiblePid': visiblePid, //实际中页面显示的索引\r\n                'userStyle': userStyle,\r\n                'virtualPid': virtualPid, //pid\r\n                'virtualOffset': virtualOffset //虚拟页面位置\r\n            }\r\n\r\n            //初始化构建页面对象\r\n            //page\r\n            //master\r\n            pageBase = this.create(dataOpts, pageIndex, masterFilter);\r\n\r\n            //构建页面对象后\r\n            //开始执行\r\n            if (pageBase) {\r\n                //开始线程任务\r\n                //当为滑动模式,支持快速创建\r\n                pageBase.startThreadTask(filpOverAction, function() {\r\n                    // console.log('创建完毕************** ' + (createPid+1) +' '+ action)\r\n                    callbackAction[action]();\r\n                });\r\n                //收集自定义样式的页面对象\r\n                if (userStyle) {\r\n                    collectCreatePageBase.push(pageBase);\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        //母版层\r\n        if (chapterData.pptMaster && self.masterMgr) {\r\n            newCreate.call(self.masterMgr, function() {\r\n                //母版是否创建等待通知\r\n                //母版是共享的所以不一定每次翻页都会创建\r\n                //如果需要创建,则叠加总数\r\n                ++total;\r\n                createMaster = true;\r\n            });\r\n        }\r\n\r\n        //页面层\r\n        newCreate.call(self.pageMgr);\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 滑动处理\r\n *  1 滑动\r\n *  2 反弹\r\n *  3 翻页\r\n */\r\nSchedulerProto.move = function(data) {\r\n\r\n    //动作\r\n    var action = data.action;\r\n\r\n    //用户强制直接切换模式\r\n    //禁止页面跟随滑动\r\n    if (this.options.pageFlip && action == 'flipMove') {\r\n        return\r\n    }\r\n\r\n    var speed = data.speed;\r\n    var distance = data.distance;\r\n    var leftIndex = data.leftIndex;\r\n    var currIndex = data.pageIndex;\r\n    var rightIndex = data.rightIndex;\r\n    var direction = data.direction;\r\n    //移动的距离\r\n    var moveDistance = calculateDistance(action, distance, direction);\r\n    //视觉差页面滑动\r\n    var nodes = this.pageMgr.abstractGetPageObj(currIndex)['chapterDas']['nodes'];\r\n\r\n    ///////\r\n    //页面改变 //\r\n    ///////\r\n    //通知page模块\r\n    this.pageMgr.move(leftIndex, currIndex, rightIndex, direction, speed, action, moveDistance);\r\n\r\n    //通知视觉差模块\r\n    this.callMasterMgr(function() {\r\n        this.move(leftIndex, currIndex, rightIndex, direction, moveDistance, action, speed, nodes);\r\n    })\r\n\r\n    //更新页码标示\r\n    'flipOver' === action && setTimeout(function() {\r\n        this.vm.$emit('change:pageUpdate', direction === 'next' ? rightIndex : leftIndex)\r\n    }.bind(this), 0);\r\n}\r\n\r\n\r\n/**\r\n * 翻页松手后\r\n * 暂停页面的各种活动动作\r\n * @param  {[type]} pointers [description]\r\n * @return {[type]}          [description]\r\n */\r\nSchedulerProto.suspend = function(pointers) {\r\n    //关闭层事件\r\n    this.pageMgr.suspend(pointers);\r\n    this.callMasterMgr(function() {\r\n            this.suspend(pointers)\r\n        })\r\n        //目录栏\r\n    _close();\r\n    //复位工具栏\r\n    this.vm.$emit('change:resetToolbar')\r\n}\r\n\r\n\r\n/**\r\n * 翻页动画完毕后\r\n * @return {[type]}              [description]\r\n */\r\nSchedulerProto.complete = function(direction, pagePointer, unfliplock, isQuickTurn) {\r\n    //方向\r\n    this.direction = direction;\r\n    //是否快速翻页\r\n    this.isQuickTurn = isQuickTurn || false;\r\n    //解锁\r\n    this.unfliplock = unfliplock;\r\n    //清理上一个页面\r\n    this._clearPage(pagePointer.destroyPointer)\r\n    this._updatePointer(pagePointer);\r\n    //预创建下一页\r\n    this._advanceCreate(direction, pagePointer);\r\n}\r\n\r\n\r\n//清理页面结构\r\nSchedulerProto._clearPage = function(clearPageIndex) {\r\n    this.pageMgr.clearPage(clearPageIndex);\r\n}\r\n\r\n\r\n//更新页码索引标示\r\nSchedulerProto._updatePointer = function(pagePointer) {\r\n    this.pagePointer = pagePointer;\r\n}\r\n\r\n\r\n//预创建新页面\r\nSchedulerProto._advanceCreate = function(direction, pagePointer) {\r\n    var pagetotal = this.options.pagetotal,\r\n        vm = this.vm,\r\n        createPointer = pagePointer.createPointer,\r\n        destroyPointer = pagePointer.destroyPointer,\r\n        //清理页码\r\n        clear = function() {\r\n            delete pagePointer.createPointer;\r\n            delete pagePointer.destroyPointer;\r\n        },\r\n        //创建新的页面对象\r\n        createNextContainer = function(createPointer, currIndex) {\r\n            this.create([createPointer], currIndex, 'flipOver');\r\n        };\r\n\r\n\r\n    //如果是右边翻页\r\n    if (direction === 'next') {\r\n        //首尾无须创建页面\r\n        if (pagePointer.currIndex === pagetotal - 1) {\r\n            this.autoRun();\r\n            //如果总数只有2页，那么首页的按钮是关闭的，需要显示\r\n            if (pagetotal == 2) {\r\n                vm.$emit('change:showPrev');\r\n            }\r\n            //多页处理\r\n            vm.$emit('change:hideNext');\r\n            return\r\n        }\r\n        if (createPointer < pagetotal) { //创建的页面\r\n            createNextContainer.call(this, createPointer, pagePointer.currIndex);\r\n            clear();\r\n            vm.$emit('change:showPrev');\r\n            return;\r\n        }\r\n    }\r\n\r\n    //如果是左边翻页\r\n    if (direction === 'prev') {\r\n        //首尾无须创建页面\r\n        if (pagePointer.currIndex === 0) {\r\n            this.autoRun();\r\n            //如果总数只有2页，那么首页的按钮是关闭的，需要显示\r\n            if (pagetotal == 2) {\r\n                vm.$emit('change:showNext');\r\n            }\r\n            vm.$emit('change:hidePrev');\r\n            return\r\n        }\r\n        if (pagePointer.currIndex > -1) { //创建的页面\r\n            createNextContainer.call(this, createPointer, pagePointer.currIndex);\r\n            clear();\r\n            vm.$emit('change:showNext');\r\n            return;\r\n        }\r\n    }\r\n\r\n    clear();\r\n\r\n    return;\r\n}\r\n\r\n\r\n/**\r\n * 自动运行处理\r\n *  流程四:执行自动触发动作\r\n *   1.初始化创建页面完毕\r\n *   2.翻页完毕\r\n */\r\nSchedulerProto.autoRun = function(para) {\r\n    var options = this.options,\r\n        pagePointer = this.pagePointer,\r\n        prevIndex = pagePointer.leftIndex,\r\n        currIndex = pagePointer.currIndex,\r\n        nextIndex = pagePointer.rightIndex,\r\n        action = para ? para.action : '',\r\n        createPointer = para ? para.createPointer : '',\r\n        direction = this.direction,\r\n        //暂停的页面索引autorun\r\n        suspendIndex = action === 'init' ? '' : direction === 'next' ? prevIndex : nextIndex;\r\n\r\n    /**\r\n     * 存在2中模式的情况下\r\n     * 转化页码标记\r\n     */\r\n    if (createPointer) {\r\n        createPointer = conversionPageOpts.call(this, createPointer);\r\n    }\r\n\r\n    var data = {\r\n        'prevIndex': prevIndex,\r\n        'currIndex': currIndex,\r\n        'nextIndex': nextIndex,\r\n        'suspendIndex': suspendIndex,\r\n        'createPointer': createPointer,\r\n        'direction': direction,\r\n        'isQuickTurn': this.isQuickTurn,\r\n        //中断通知\r\n        'suspendCallback': options.suspendAutoCallback,\r\n        //构建完毕通知\r\n        'buildComplete': function(scenarioId) {\r\n            //==========================================\r\n            //\r\n            //      构建完成通知,用于处理历史缓存记录\r\n            //      如果是调试模式\r\n            //      && 不是收费提示页面\r\n            //      && 多场景应用\r\n            //\r\n            //==========================================\r\n            if (Xut.config.recordHistory && !options.isInApp && options.multiScenario) {\r\n                var history;\r\n                if (history = Xut.sceneController.sequence(scenarioId, currIndex)) {\r\n                    _set(\"history\", history);\r\n                }\r\n            }\r\n        },\r\n\r\n        //流程结束通知\r\n        //包括动画都已经结束了\r\n        'processComplete': function() {}\r\n    };\r\n\r\n    //页面自动运行\r\n    this.pageMgr.autoRun(data);\r\n\r\n    //模板自动运行\r\n    this.callMasterMgr(function() {\r\n        //如果动作是初始化，或者触发了母版自动运行\r\n        //如果是越界处理\r\n        //console.log(action,this.isBoundary,para.createMaster)\r\n        if (action || this.isBoundary) {\r\n            this.autoRun(data);\r\n        }\r\n    })\r\n\r\n\r\n    /**\r\n     * 触发自动通知\r\n     * @type {[type]}\r\n     */\r\n    var vm = this.vm;\r\n\r\n    switch (action) {\r\n        case 'init':\r\n            //更新页码标示\r\n            vm.$emit('change:pageUpdate', currIndex)\r\n            resetToolbar.call(this)\r\n            setTimeout(function() {\r\n                $(\"#startupPage\").remove();\r\n                $(\"#removelayer\").remove();\r\n            }, 2000)\r\n            break;\r\n        case 'toPage':\r\n            //更新页码标示\r\n            vm.$emit('change:pageUpdate', currIndex)\r\n            resetToolbar.call(this)\r\n            break;\r\n    }\r\n\r\n\r\n    /**\r\n     * 初始化与跳转针对翻页案例的设置逻辑\r\n     * @return {[type]} [description]\r\n     */\r\n    function resetToolbar() {\r\n        //不显示首尾对应的按钮\r\n        if (currIndex == 0) {\r\n            vm.$emit('change:hidePrev');\r\n        } else if (currIndex == options.pagetotal - 1) {\r\n            vm.$emit('change:hideNext');\r\n            vm.$emit('change:showPrev');\r\n        } else {\r\n            vm.$emit('change:showNext');\r\n            vm.$emit('change:showPrev');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 线性结构\r\n     * 保存目录索引\r\n     */\r\n    if (!options.multiScenario) {\r\n        _set(\"pageIndex\", currIndex);\r\n    }\r\n\r\n\r\n    /**\r\n     * 解锁翻页\r\n     * 允许继续执行下一个翻页作用\r\n     */\r\n    if (this.unfliplock) {\r\n        this.unfliplock();\r\n        this.unfliplock = null;\r\n    }\r\n\r\n    //关闭快速翻页\r\n    this.isQuickTurn = false;\r\n\r\n}\r\n\r\n\r\n/**\r\n * 页面跳转切换处\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nSchedulerProto.jumpPage = function(data) {\r\n\r\n    Xut.View.ShowBusy();\r\n\r\n    //如果是非线性,创建页面修改\r\n    if (!this.options.multiplePages) {\r\n        data.create = [data.targetIndex];\r\n        data.destroy = [data.currIndex];\r\n        data.ruleOut = [data.targetIndex];\r\n        data.pagePointer = {\r\n            currIndex: data.targetIndex\r\n        }\r\n    }\r\n\r\n    //执行页面切换\r\n    SwitchPage(this, data, function(data) {\r\n        this._updatePointer(data.pagePointer);\r\n        this.autoRun({\r\n            'action': 'toPage',\r\n            'createPointer': data['create']\r\n        });\r\n        Xut.View.HideBusy();\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 加载页面事件与动作\r\n * @param  {[type]} action [description]\r\n * @return {[type]}        [description]\r\n */\r\nSchedulerProto.loadPage = function(action) {\r\n    var self = this;\r\n\r\n\r\n    //触发自动任务\r\n    function trigger() {\r\n        self.autoRun({\r\n            'action': 'init'\r\n        });\r\n    }\r\n\r\n    //加载主场景页面\r\n    function firstLoading() {\r\n\r\n        $(\"#sceneHome\").css({\r\n            'visibility': 'visible'\r\n        });\r\n\r\n        if (GLOBALIFRAME) {\r\n            trigger();\r\n            return;\r\n        }\r\n        //获取应用的状态\r\n        if (Xut.Application.getAppState()) {\r\n            //保留启动方法\r\n            var pre = Xut.Application.LaunchApp;\r\n            Xut.Application.LaunchApp = function() {\r\n                pre();\r\n                trigger();\r\n            };\r\n        } else {\r\n            trigger();\r\n        }\r\n    }\r\n\r\n\r\n    //创建完成回调\r\n    self.vm.$emit('change:createComplete', function() {\r\n        if (self.options.multiScenario) {\r\n            trigger();\r\n        } else {\r\n            //第一次加载\r\n            //进入应用\r\n            firstLoading();\r\n        }\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 调用母版管理器\r\n * @return {[type]} [description]\r\n */\r\nSchedulerProto.callMasterMgr = function(callback) {\r\n    if (this.masterMgr) {\r\n        callback.call(this.masterMgr)\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 销毁接口\r\n * 对应多场景操作\r\n * @return {[type]} [description]\r\n */\r\nSchedulerProto.destroy = function() {\r\n    this.pageMgr.destroy();\r\n    this.callMasterMgr(function() {\r\n        this.destroy();\r\n    })\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/schedule.js\n **/","/**\r\n * 页面模块\r\n * @param  {[type]}\r\n * @return {[type]}\r\n */\r\nimport { injectScript, extend } from '../util/index'\r\nimport { Abstract } from './abstract'\r\nimport { constor as Page } from '../pagebase/constor'\r\nimport { translation } from '../pagebase/translation'\r\n//epub使用\r\nimport { addEdges } from '../util/edge'\r\n//动作热热点派发 \r\nimport { suspend as _suspend, original as _original, autoRun as _autoRun } from '../scheduler/index'\r\n\r\n\r\nfunction PageMgr(vm) {\r\n\r\n    this.pageType = 'page';\r\n\r\n    /**\r\n     * 页面根节点\r\n     * @type {[type]}\r\n     */\r\n    this.rootNode = vm.options.rootPage;\r\n\r\n    /**\r\n     * 抽象方法\r\n     * 创建合集容器\r\n     */\r\n    this.abstractCreateCollection();\r\n};\r\n\r\n\r\n\r\nlet PageMgrProto = PageMgr.prototype;\r\n\r\n\r\n/****************************************************************\r\n *\r\n *                 对外接口\r\n *\r\n ***************************************************************/\r\n\r\n//====================页面结构处理===========================\r\n\r\n//创建页新的页面\r\nPageMgrProto.create = function(dataOpts, pageIndex) {\r\n\r\n    //生成指定页面对象\r\n    var pageObjs = new Page(\r\n        _.extend(dataOpts, {\r\n            'pageType': this.pageType, //创建页面的类型\r\n            'root': this.rootNode //根元素\r\n        })\r\n    )\r\n\r\n    //增加页面管理\r\n    this.abstractAddCollection(pageIndex, pageObjs);\r\n\r\n    return pageObjs;\r\n}\r\n\r\n/**\r\n * 清理视频\r\n * @return {[type]} [description]\r\n */\r\nfunction removeVideo(clearPageIndex) {\r\n    //处理视频\r\n    var pageId = Xut.Presentation.GetPageId(clearPageIndex);\r\n    Xut.VideoManager.removeVideo(pageId);\r\n}\r\n\r\n//清理其中的一个页面\r\nPageMgrProto.clearPage = function(clearPageIndex) {\r\n    var pageObj;\r\n    //清理视频\r\n    // removeVideo(clearPageIndex);\r\n    //销毁页面对象事件\r\n    if (pageObj = this.abstractGetPageObj(clearPageIndex)) {\r\n        //移除事件\r\n        pageObj.baseDestroy();\r\n        //移除列表\r\n        this.abstractRemoveCollection(clearPageIndex);\r\n    }\r\n}\r\n\r\n//销毁整个页面管理对象\r\nPageMgrProto.destroy = function() {\r\n    //清理视频\r\n    removeVideo(Xut.Presentation.GetPageIndex());\r\n    //清理对象\r\n    this.abstractDestroyCollection();\r\n    //清理节点\r\n    this.rootNode = null;\r\n}\r\n\r\n\r\n/**\r\n * 检测脚本注入\r\n * @return {[type]} [description]\r\n */\r\nfunction checkInjectScript(pageObject, type) {\r\n    var code;\r\n    if (code = pageObject.chapterDas[type]) {\r\n        injectScript(code, type)\r\n    }\r\n}\r\n\r\n/****************************************************************\r\n *\r\n *                 多线程任务片段调用\r\n *\r\n ***************************************************************/\r\n\r\n/**\r\n * 设置中断正在创建的页面对象任务\r\n * @param {[type]}   currIndex [description]\r\n * @param {Function} callback  [description]\r\n */\r\nPageMgrProto.suspendInnerCreateTasks = function(pointers) {\r\n    var pageObj,\r\n        self = this;\r\n    [pointers.leftIndex, pointers.currIndex, pointers.rightIndex].forEach(function(pointer) {\r\n        if (pageObj = self.abstractGetPageObj(pointer)) {\r\n            pageObj.setTaskSuspend();\r\n        }\r\n    })\r\n}\r\n\r\n/**\r\n * 检测活动窗口任务\r\n * @return {[type]} [description]\r\n */\r\nPageMgrProto.checkTaskCompleted = function(currIndex, callback) {\r\n    var currPageObj,\r\n        self = this;\r\n    // console.log('激活活动任务',currIndex)\r\n    if (currPageObj = self.abstractGetPageObj(currIndex)) {\r\n        currPageObj.checkThreadTask(function() {\r\n            // console.log('11111111111当前页面创建完毕',currIndex+1)\r\n            callback(currPageObj)\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * 检测后台预创建任务\r\n * @return {[type]} [description]\r\n */\r\nPageMgrProto.checkPreforkTasks = function(resumePointer, preCreateTask) {\r\n    var resumeObj, resumeCount;\r\n    if (!resumePointer.length) {\r\n        resumePointer = [resumePointer];\r\n    }\r\n    resumeCount = resumePointer.length;\r\n    while (resumeCount--) {\r\n        if (resumeObj = this.abstractGetPageObj(resumePointer[resumeCount])) {\r\n            resumeObj.createPreforkTasks(function() {\r\n                // console.log('后台处理完毕')\r\n            }, preCreateTask)\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/************************************************************\r\n *\r\n *                       页面滑动\r\n *\r\n * **********************************************************/\r\nPageMgrProto.move = function(leftIndex, currIndex, rightIndex, direction, speed, action, moveDistance) {\r\n\r\n    //////////////\r\n    //找到需要滑动的页面 //\r\n    //////////////\r\n    function findPage() {\r\n        return [\r\n            this.abstractGetPageObj(leftIndex),\r\n            this.abstractGetPageObj(currIndex),\r\n            this.abstractGetPageObj(rightIndex)\r\n        ];\r\n    }\r\n\r\n    ///////////\r\n    //开始移动页面 //\r\n    ///////////\r\n    _.each(findPage.call(this), function(pageObj, index) {\r\n        if (pageObj) {\r\n            //移动浮动页面容器\r\n            var flaotElement;\r\n            if (flaotElement = pageObj.floatContents.PageContainer) {\r\n                translation[action].call(pageObj, moveDistance[index], speed, flaotElement)\r\n            }\r\n            //正常页面\r\n            translation[action].call(pageObj, moveDistance[index], speed)\r\n        }\r\n    })\r\n}\r\n\r\n\r\n/****************************************************************\r\n *\r\n *                  流程状态控制\r\n *\r\n ***************************************************************/\r\n\r\n/**\r\n * 触屏翻页开始\r\n * 1 中断所有任务\r\n * 2 停止热点对象运行\r\n *     停止动画,视频音频等等\r\n */\r\nPageMgrProto.suspend = function(pointers) {\r\n    var stopPointer = pointers.stopPointer,\r\n        suspendPageObj = this.abstractGetPageObj(stopPointer),\r\n        prveChpterId = suspendPageObj.baseGetPageId(stopPointer);\r\n\r\n    //翻页结束脚本\r\n    checkInjectScript(suspendPageObj, 'postCode');\r\n\r\n    //中断节点创建任务\r\n    this.suspendInnerCreateTasks(pointers);\r\n\r\n    //停止活动对象活动\r\n    _suspend(suspendPageObj, prveChpterId);\r\n}\r\n\r\n/**\r\n * 复位初始状态\r\n * @return {[type]} [description]\r\n */\r\nPageMgrProto.resetOriginal = function(pageIndex) {\r\n    var originalPageObj, flaotElement;\r\n    if (originalPageObj = this.abstractGetPageObj(pageIndex)) {\r\n        if (flaotElement = originalPageObj.floatContents.PageContainer) {\r\n            //floatPages设置的content溢出后处理\r\n            //在非视区增加overflow:hidden\r\n            //可视区域overflow:''\r\n            flaotElement.css({\r\n                'zIndex': 2000,\r\n                'overflow': 'hidden'\r\n            })\r\n        }\r\n        _original(originalPageObj);\r\n    }\r\n}\r\n\r\n/**\r\n * 触屏翻页完成\r\n * 1 停止热点动作\r\n * 2 触发新的页面动作\r\n * @param  {[type]} prevPageIndex [上一页面]\r\n * @param  {[type]} currPageIndex [当前页码]\r\n * @param  {[type]} nextPageIndex [下一页页码]\r\n * @param  {[type]} suspendIndex  [停止动作的页码]因为要区分滑动的方向\r\n * @param  {[type]} createPointer [正在创建的页面]\r\n * @param  {[type]} direction     [滑动方向]\r\n */\r\nPageMgrProto.autoRun = function(data) {\r\n\r\n    var self = this;\r\n\r\n    //检测当前页面构建任务的情况\r\n    //如果任务没有完成，则等待任务完成\r\n    this.checkTaskCompleted(data.currIndex, function(currPageObj) {\r\n\r\n        //提升当前页面浮动对象的层级\r\n        //因为浮动对象可以是并联的\r\n        var flaotElement;\r\n        if (flaotElement = currPageObj.floatContents.PageContainer) {\r\n            flaotElement.css({\r\n                'zIndex': 2001,\r\n                'overflow': ''\r\n            })\r\n        }\r\n\r\n        //IE上不支持蒙版效果的处理\r\n        if (Xut.plat.noMaskBoxImage) {\r\n            addEdges();\r\n        }\r\n\r\n        //构件完成通知\r\n        data.buildComplete(currPageObj.scenarioId);\r\n\r\n        //执行自动动作之前的脚本\r\n        checkInjectScript(currPageObj, 'preCode');\r\n\r\n        //热点状态复位\r\n        self.resetOriginal(data.suspendIndex)\r\n\r\n        //预构建背景\r\n        preCreate('background');\r\n\r\n        //等待动画结束后构建\r\n        startAutoRun(currPageObj, data);\r\n    });\r\n\r\n    /**\r\n     * 预执行背景创建\r\n     * 支持多线程快速翻页\r\n     * 1 初始化,或者快速翻页补全前后页面\r\n     * 2 正常翻页创建前后\r\n     */\r\n    function preCreate(preCreateTask) {\r\n        var resumePointer;\r\n        if (data.isQuickTurn || !data.direction) {\r\n            resumePointer = [data.prevIndex, data.nextIndex];\r\n        } else {\r\n            resumePointer = data.createPointer || data.nextIndex || data.prevIndex\r\n        }\r\n        self.checkPreforkTasks(resumePointer, preCreateTask);\r\n    };\r\n\r\n\r\n    //激活自动运行对象\r\n    function startAutoRun(currPageObj, data) {\r\n\r\n        //结束通知\r\n        function complete() {\r\n            data.processComplete();\r\n            preCreate();\r\n        }\r\n\r\n        //如果页面容器存在,才处理自动运行\r\n        var currRootNode = currPageObj.element\r\n        if (!currRootNode) {\r\n            return complete();\r\n        }\r\n\r\n        //运行动作\r\n        function startRun() {\r\n            _autoRun(currPageObj, data.currIndex, complete);\r\n        }\r\n\r\n        //运行如果被中断,则等待\r\n        if (data.suspendCallback) {\r\n            data.suspendCallback(startRun)\r\n        } else {\r\n            startRun();\r\n        }\r\n    }\r\n}\r\n\r\n//混入抽象接口方法\r\nextend(PageMgr, Abstract)\r\n\r\n\r\nexport { PageMgr }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/page.js\n **/","/**\r\n * 抽象管理接口\r\n * @return {[type]} [description]\r\n */\r\n\r\nexport function Abstract() {}\r\n\r\n\r\nAbstract.prototype = {\r\n    /**\r\n     * 创建页面合集\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractCreateCollection: function() {\r\n        this.Collections = {}\r\n    },\r\n\r\n    /**\r\n     * 增加合集管理\r\n     */\r\n    abstractAddCollection: function(pageIndex, pageObj) {\r\n        this.Collections[pageIndex] = pageObj;\r\n    },\r\n \r\n    /**\r\n     * 得到页面合集\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractGetCollection: function() {\r\n        return this.Collections;\r\n    },\r\n\r\n    /**\r\n     * 删除合集管理\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractRemoveCollection: function(pageIndex) {\r\n        delete this.Collections[pageIndex];\r\n    },\r\n\r\n    /**\r\n     * 销毁合集\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractDestroyCollection: function() {\r\n        var k, Collections = this.Collections;\r\n        for (k in Collections) {\r\n            Collections[k].baseDestroy();\r\n        }\r\n        this.Collections = null;\r\n    },\r\n\r\n    /**\r\n     * 找到页面对象\r\n     * 1.页面直接pageIndex索引\r\n     * 2.母版通过母版Id索引\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractGetPageObj: function(pageIndex, pageType) {\r\n        pageType = pageType || this.pageType;\r\n        //模板传递的可能不是页码\r\n        if (pageType === 'master') {\r\n            if (!/-/.test(pageIndex)) { //如果不是母版ID，只是页码\r\n                pageIndex = this.conversionMasterId(pageIndex); //转化成母版id\r\n            }\r\n        }\r\n        return this.Collections[pageIndex];\r\n    },\r\n\r\n    /**\r\n     * 合并处理\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractAssistPocess: function(pageIndex, callback) {\r\n        var pageObj;\r\n        if (pageObj = this.abstractGetPageObj(pageIndex, this.pageType)) {\r\n            if (callback) {\r\n                callback(pageObj)\r\n            } else {\r\n                return pageObj;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 获取页面容器ID\r\n     * chpaterID\r\n     * masterID\r\n     * @return {[type]} [description]\r\n     */\r\n    abstractGetPageId: function(pageIndex, pageType) {\r\n        var key = pageType === 'page' ? '_id' : 'pptMaster'\r\n        return this.abstractGetPageData(pageIndex, key, pageType)\r\n    },\r\n\r\n    /**\r\n     * 获取页面数据\r\n     */\r\n    abstractGetPageData: function(pageIndex, key, pageType) {\r\n        var pageObj;\r\n        //如果传递key是 pageType\r\n        if (!pageType && key == 'page' || key == 'master') {\r\n            pageType = key;\r\n            key = null;\r\n        }\r\n        if (pageObj = this.abstractGetPageObj(pageIndex, pageType)) {\r\n            return key ? pageObj.chapterDas[key] : pageObj.chapterDas;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 得到页面的nodes数据\r\n     * @param  {[type]} pageIndex [description]\r\n     * @return {[type]}           [description]\r\n     */\r\n    abstractGetPageNode: function(pageIndex, pageType) {\r\n        return this.abstractGetPageData(pageIndex, 'nodes', pageType);\r\n    },\r\n\r\n\r\n    //***************************************************************\r\n    //\r\n    //  执行辅助对象事件\r\n    //\r\n    //***************************************************************\r\n    abstractAssistAppoint: function(activityId, currIndex, outCallBack, actionName) {\r\n        var pageObj;\r\n        if (pageObj = this.abstractGetPageObj(currIndex)) {\r\n            return pageObj.baseAssistRun(activityId, outCallBack, actionName);\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/abstract.js\n **/","//***********************************************************\r\n//\r\n//              构造page类,继承PageBase类\r\n//\r\n//**********************************************************\r\n\r\nimport {\r\n\tPageBase\r\n}\r\nfrom './pagebase'\r\n\r\nlet constor = Xut.extend(PageBase, {\r\n\tconstructor: function(options) {\r\n\t\t//多线程处理\r\n\t\tthis.initTasks(options);\r\n\t\treturn this;\r\n\t}\r\n})\r\n\r\nexport {constor} \n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/constor.js\n **/","/*********************************************************************\r\n *                 构建页面对象\r\n *             实现目标：\r\n *                快速翻页\r\n *                最快中断任务\r\n *                提高优先级\r\n *\r\n *             1 构建四个大任务，每个大人物附属一堆小任务\r\n *             2 每次触发一个新的任务，都会去检测是否允许创建的条件\r\n *\r\n *  2014.11.18\r\n *  新增canvan模式\r\n *    contentMode 分为  0 或者 1\r\n *    0 是dom模式\r\n *    1 是canvas模式\r\n *    以后如果其余的在增加\r\n *    针对页面chapter中的parameter写入 contentMode   值为 1\r\n *    如果是canvas模式的时候，同时也是能够存在dom模式是\r\n *\r\n *                                                         *\r\n **********************************************************************/\r\n\r\n\r\nimport { Collection } from './collection'\r\nimport { createTransform } from './translation'\r\nimport { create as _create, destroy as _destroy } from './multievent'\r\n//分配任务\r\nimport { assignedTasks } from './threadtask'\r\n//canvas相关\r\nimport { Factory as CanvasRelated } from './canvasrelated'\r\n\r\n\r\nfunction PageBase() {};\r\nvar baseProto = PageBase.prototype\r\n\r\n\r\n/********************************************************************\r\n *\r\n *                    多线程创建管理\r\n *\r\n ********************************************************************/\r\n\r\n/**\r\n * 初始化多线程任务\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.initTasks = function(options) {\r\n\r\n    var self = this;\r\n\r\n    _.extend(self, options);\r\n\r\n    /**\r\n     * 数据缓存容器\r\n     * @type {Object}\r\n     */\r\n    this.dataCache = {};\r\n    this.scenarioId = this.chapterDas.seasonId;\r\n    this.chapterId = this.chapterDas._id\r\n\r\n    /**\r\n     * 是否开启多线程,默认开启\r\n     * 如果是非线性，则关闭多线程创建\r\n     * 启动 true\r\n     * 关闭 false\r\n     * @type {[type]}\r\n     */\r\n    this.isMultithread = this.multiplePages ? true : false;\r\n\r\n    //母版处理\r\n    if (self.pageType === 'master') {\r\n        this.isMaster = true;\r\n    }\r\n\r\n    /**\r\n     * canvas模式\r\n     * @type {Boolean}\r\n     */\r\n    this.canvasRelated = new CanvasRelated();\r\n\r\n    /**\r\n     * 创建相关的信息\r\n     * @type {Object}\r\n     */\r\n    var createRelated = this.createRelated = {\r\n\r\n        /**\r\n         * 主线任务等待\r\n         */\r\n        tasksHang: null,\r\n\r\n        /**\r\n         * 创建相关的信息\r\n         * @type {Object}\r\n         */\r\n        tasksTimer: 0,\r\n\r\n        /**\r\n         * 当前任务是否中断\r\n         * return\r\n         *     true  中断\r\n         *     false 没有中断\r\n         */\r\n        isTaskSuspend: false,\r\n\r\n        /**\r\n         * 是否预创建背景中\r\n         */\r\n        preCreateTasks: false,\r\n\r\n\r\n        /**\r\n         * 下一个将要运行的任务标示\r\n         * 1 主容器任务\r\n         * 2 背景任务\r\n         * 3 widget热点任务\r\n         * 4 content对象任务\r\n         */\r\n        nextRunTask: 'container',\r\n\r\n        /**\r\n         * 缓存构建中断回调\r\n         * 构建分2步骤\r\n         * 1 构建数据与结构（执行中断处理）\r\n         * 2 构建绘制页面\r\n         * @type {Object}\r\n         */\r\n        cacheTasks: function() {\r\n            var cacheTasks = {};\r\n            _.each([\"background\", \"components\", \"contents\"], function(taskName) {\r\n                cacheTasks[taskName] = false;\r\n            })\r\n            return cacheTasks;\r\n        }(),\r\n\r\n        /**\r\n         * 与创建相关的信息\r\n         * 创建坐标\r\n         * 1 创建li位置\r\n         * 2 创建浮动对象\r\n         * \"translate3d(0px, 0, 0)\", \"original\"\r\n         */\r\n        initTransformParameter: createTransform(this.visiblePid, this.pid),\r\n\r\n        /**\r\n         * 预创建\r\n         * 构建页面主容器完毕后,此时可以翻页\r\n         * @return {[type]} [description]\r\n         */\r\n        preforkComplete: function() {},\r\n\r\n        /**\r\n         * 整个页面都构建完毕通知\r\n         * @return {[type]} [description]\r\n         */\r\n        createTasksComplete: function() {}\r\n    }\r\n\r\n\r\n    //==================内部钩子相关===========================\r\n    //\r\n    // * 监听状态的钩子\r\n    // * 注册所有content对象管理\r\n    // * 收集所有content对象\r\n    // * 构建li主结构后,即可翻页\r\n    // * 构建所有对象完毕后处理\r\n    //\r\n\r\n    //抽象activtiys合集,用于关联各自的content\r\n    //划分各自的子作用域\r\n    //1对多的关系\r\n    this.abActivitys = new Collection();\r\n\r\n    //widget热点处理类\r\n    //1 iframe零件\r\n    //2 页面零件\r\n    //只存在当前页面\r\n    this.components = new Collection();\r\n\r\n    /**\r\n     * 缓存所有的content对象引用\r\n     * 1对1的关系\r\n     * @type {Object}\r\n     */\r\n    this.contentsCollector = {};\r\n\r\n\r\n    /**\r\n     * 浮动对象\r\n     * 1 母版中\r\n     * 2 页面中\r\n     * 页面中是最高的\r\n     * [floatContents description]\r\n     * @type {Object}\r\n     */\r\n    var floatContents = this.floatContents = {\r\n\r\n        /**\r\n         * 页面浮动对象容器\r\n         * @type {[type]}\r\n         */\r\n        PageContainer: null,\r\n\r\n        /**\r\n         * 浮动页面对象\r\n         * @type {Object}\r\n         */\r\n        Page: {},\r\n\r\n        /**\r\n         * 浮动母版容器\r\n         */\r\n        MasterContainer: null,\r\n\r\n        /**\r\n         * 浮动母版的content对象\r\n         * 用于边界切换,自动加上移动\r\n         * @type {Object}\r\n         *     1：Object {}      //空对象,零件\r\n         *     2: PPTeffect  {}  //行为对象\r\n         */\r\n        Master: {}\r\n    }\r\n\r\n\r\n    /**\r\n     * 对象的处理情况的内部钩子方法\r\n     * @type {Object}\r\n     */\r\n    this.listenerHooks = {\r\n\r\n        //注册抽象Activity类content(大类,总content对象)\r\n        registerAbstractActivity: function(contentsObjs) {\r\n            self.abActivitys.register(contentsObjs);\r\n        },\r\n\r\n        //收集器\r\n        collector: {\r\n            //搜集所有的content(每一个content对象)\r\n            //因为content多页面共享的,所以content的合集需要保存在pageMgr中（特殊处理）\r\n            contents: function(pid, id, contentScope) {\r\n                var scope = self.baseGetContentObject[id];\r\n                //特殊处理,如果注册了事件ID,上面还有动画,需要覆盖\r\n                if (scope && scope.isBindEventHooks) {\r\n                    self.contentsCollector[id] = contentScope;\r\n                }\r\n                if (!scope) {\r\n                    self.contentsCollector[id] = contentScope;\r\n                }\r\n            },\r\n\r\n            //2014.11.7\r\n            //新概念，浮动页面对象\r\n            //用于是最顶层的，比母版浮动对象还要高\r\n            //所以这个浮动对象需要跟随页面动\r\n            floatPages: function(data) {\r\n                var contentObj\r\n                //浮动页面对象容器\r\n                floatContents.PageContainer = data.container;\r\n                _.each(data.ids, function(id) {\r\n                    if (contentObj = self.baseGetContentObject(id)) {\r\n                        //初始视察坐标\r\n                        if (contentObj.parallax) {\r\n                            contentObj.parallaxOffset = contentObj.parallax.parallaxOffset;\r\n                        }\r\n                        floatContents.Page[id] = contentObj\r\n                    } else {\r\n                        console.log('页面浮动对象找不到')\r\n                    }\r\n                })\r\n            },\r\n\r\n            //浮动母版对象\r\n            //1 浮动的对象是有动画数据或者视觉差数据\r\n            //2 浮动的对象是用于零件类型,这边只提供创建\r\n            //  所以需要制造一个空的容器，用于母版交界动\r\n            floatMaters: function(data) {\r\n                var prefix,\r\n                    contentObj,\r\n                    contentProcess,\r\n                    contentsFragment;\r\n                //浮动容器\r\n                floatContents.MasterContainer = data.container;\r\n                //浮动对象\r\n                _.each(data.ids, function(id) {\r\n                    //转化成实际操作的浮动对象,保存\r\n                    if (contentObj = self.baseGetContentObject(id)) {\r\n                        //初始视察坐标\r\n                        if (contentObj.parallax) {\r\n                            contentObj.parallaxOffset = contentObj.parallax.parallaxOffset;\r\n                        }\r\n                        floatContents.Master[id] = contentObj\r\n                    } else {\r\n                        Xut.plat.isBrowser && console.log('浮动母版对象数据不存在原始对象,制作伪对象母版移动', id)\r\n                            //获取DOM节点\r\n                        if (contentsFragment = self.createRelated.cacheTasks.contents.contentsFragment) {\r\n                            prefix = 'Content_' + self.pid + \"_\";\r\n                            _.each(contentsFragment, function(dom) {\r\n                                var makePrefix = prefix + id;\r\n                                if (dom.id == makePrefix) {\r\n                                    contentProcess = dom;\r\n                                }\r\n                            })\r\n                        }\r\n                        //制作一个伪数据\r\n                        //作为零件类型的空content处理\r\n                        floatContents.Master[id] = {\r\n                            id: id,\r\n                            pid: self.pid,\r\n                            $contentProcess: $(contentProcess),\r\n                            'empty': true //空类型\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n        },\r\n\r\n        //多事件钩子\r\n        //执行多事件绑定\r\n        eventBinding: function(eventRelated) {\r\n            _create(self, eventRelated);\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * 设置下一个标记\r\n     */\r\n    function setNextRunTask(taskName) {\r\n        createRelated.nextRunTask = taskName;\r\n    }\r\n\r\n    function callContext(taskName, fn) {\r\n        return assignedTasks[taskName](fn, self)\r\n    }\r\n\r\n    /**\r\n     * 任务钩子\r\n     * @type {Object}\r\n     */\r\n    self.tasks = {\r\n        container: function() {\r\n            callContext('Container', function(element, pseudoElement) {\r\n                //////////////\r\n                //li,li-div //\r\n                //////////////\r\n                self.element = element;\r\n                self.pseudoElement = pseudoElement;\r\n                //获取根节点\r\n                self.getElement = function() {\r\n                    return pseudoElement ? pseudoElement : element\r\n                }\r\n\r\n                setNextRunTask('background')\r\n                    //构建主容器li完毕,可以提前执行翻页动作\r\n                createRelated.preforkComplete();\r\n                //视觉差不管\r\n                if (self.isMaster) {\r\n                    self.nextTasks({\r\n                        'taskName': '外部background',\r\n                        'outNextTasks': function() {\r\n                            self.dispatchTasks();\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        },\r\n        background: function() {\r\n            var nextRun = function() {\r\n                createRelated.preCreateTasks = false;\r\n                setNextRunTask('components')\r\n                    //针对当前页面的检测\r\n                if (!createRelated.tasksHang || self.isMaster) {\r\n                    self.nextTasks({\r\n                        'taskName': '外部widgets',\r\n                        outNextTasks: function() {\r\n                            self.dispatchTasks();\r\n                        }\r\n                    });\r\n                }\r\n\r\n                //如果有挂起任务，则继续执行\r\n                if (createRelated.tasksHang) {\r\n                    createRelated.tasksHang();\r\n                }\r\n            }\r\n\r\n            callContext('Background', nextRun)\r\n        },\r\n        components: function() {\r\n            //构件零件类型任务\r\n            callContext('Components', function() {\r\n                setNextRunTask('contents')\r\n                self.nextTasks({\r\n                    'taskName': '外部contents',\r\n                    outNextTasks: function() {\r\n                        self.dispatchTasks();\r\n                    }\r\n                });\r\n            })\r\n        },\r\n        contents: function() {\r\n            callContext('Contetns', function() {\r\n                setNextRunTask('complete')\r\n                createRelated.createTasksComplete();\r\n            })\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/****************************************************************\r\n *\r\n *                     对外接口\r\n *\r\n *               1 开始调用任务\r\n *               2 调用自动运行任务\r\n *               3 设置中断\r\n *               4 取消中断设置\r\n *\r\n * **************************************************************/\r\n\r\n/**\r\n * 开始调用任务\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.startThreadTask = function(flipOver, callback) {\r\n\r\n    //制作回调\r\n    //如果是快速翻页,立刻调用\r\n    this.createRelated.preforkComplete = function(context) {\r\n        return function() {\r\n            //滑动允许打断创建\r\n            flipOver ? callback() :\r\n                //所有继续分解任务\r\n                context.checkTasksCreate(function() {\r\n                    callback();\r\n                })\r\n        }\r\n    }(this);\r\n\r\n    //继续构建任务\r\n    this.dispatchTasks();\r\n}\r\n\r\n/**\r\n * 检测任务是否完成\r\n * actTasksCallback 活动任务完成\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.checkThreadTask = function(actTasksCallback) {\r\n    var self = this;\r\n    this.isAutoRun = true;\r\n    this.checkTasksCreate(function() {\r\n        self.isAutoRun = false;\r\n        actTasksCallback();\r\n    })\r\n}\r\n\r\n/**\r\n * 后台预创建任务\r\n * @param  {[type]} tasksTimer [时间间隔]\r\n * @return {[type]}            [description]\r\n */\r\nbaseProto.createPreforkTasks = function(callback, isPreCreate) {\r\n    var self = this;\r\n    //2个预创建间隔太短\r\n    //背景预创建还在进行中，先挂起来等待\r\n    if (this.createRelated.preCreateTasks) {\r\n        this.createRelated.tasksHang = function(callback) {\r\n            return function() {\r\n                self.checkTasksCreate(callback);\r\n            }\r\n        }(callback);\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * 翻页完毕后\r\n     * 预创建背景\r\n     */\r\n    if (isPreCreate) {\r\n        this.createRelated.preCreateTasks = true;\r\n    }\r\n\r\n    this.checkTasksCreate(callback);\r\n}\r\n\r\n/**\r\n * 自动运行：检测是否需要开始创建任务\r\n * 1 如果任务全部完成了毕\r\n * 2 如果有中断任务,就需要继续创建未完成的任务\r\n * 3 如果任务未中断,还在继续创建\r\n * currtask 是否为当前任务，加速创建\r\n */\r\nbaseProto.checkTasksCreate = function(callback, context) {\r\n\r\n    //如果任务全部完成\r\n    if (this.createRelated.nextRunTask === 'complete') {\r\n        return callback.call(context);\r\n    }\r\n\r\n    var self = this;\r\n\r\n    //开始构未完成的任务\r\n    this.cancelTaskSuspend();\r\n\r\n    //完毕回调\r\n    this.createRelated.createTasksComplete = function() {\r\n        callback.call(context)\r\n    };\r\n\r\n    //派发任务\r\n    this.nextTasks({\r\n        outNextTasks: function() {\r\n            self.dispatchTasks();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 设置任务中断\r\n */\r\nbaseProto.setTaskSuspend = function() {\r\n    this.isAutoRun = false;\r\n    this.canvasRelated.isTaskSuspend = true;\r\n    this.createRelated.preCreateTasks = false;\r\n    this.createRelated.tasksHang = null;\r\n}\r\n\r\n/**\r\n * 取消任务中断\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.cancelTaskSuspend = function() {\r\n    this.canvasRelated.isTaskSuspend = false\r\n}\r\n\r\n/**\r\n * 检测任务是否需要中断\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.checkTaskSuspend = function() {\r\n    return this.canvasRelated.isTaskSuspend;\r\n}\r\n\r\n\r\n/**\r\n * 多线程检测\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.multithreadCheck = function(callbacks, interrupt) {\r\n    //多线程检测\r\n    var self = this;\r\n\r\n    function check() {\r\n        if (self.checkTaskSuspend()) {\r\n            self.tasksTimeOutId && clearTimeout(self.tasksTimeOutId)\r\n            callbacks.suspendCallback.call(self);\r\n        } else {\r\n            callbacks.nextTaskCallback.call(self);\r\n        }\r\n    }\r\n\r\n    function next() {\r\n        self.tasksTimeOutId = setTimeout(function() {\r\n            check();\r\n        }, self.canvasRelated.tasksTimer);\r\n    }\r\n\r\n    //自动运行页面构建\r\n    if (self.isAutoRun) {\r\n        //自动运行content中断检测 打断一次\r\n        if (interrupt) {\r\n            next();\r\n        } else {\r\n            check();\r\n        }\r\n    } else {\r\n        //后台构建\r\n        next();\r\n    }\r\n}\r\n\r\n/**\r\n * 任务队列挂起\r\n * nextTaskCallback 成功回调\r\n * suspendCallback  中断回调\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.asyTasks = function(callbacks, interrupt) {\r\n\r\n    //如果关闭多线程,不检测任务调度\r\n    if (!this.isMultithread) {\r\n        return callbacks.nextTaskCallback.call(this);\r\n    }\r\n\r\n    //多线程检测\r\n    this.multithreadCheck(callbacks, interrupt)\r\n}\r\n\r\n/**\r\n * 开始执行下一个线程任务,检测是否中断\r\n * outSuspendTasks,\r\n * outNextTasks\r\n * taskName\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.nextTasks = function(callback) {\r\n    var outSuspendTasks,\r\n        outNextTasks,\r\n        taskName;\r\n\r\n    this.asyTasks({\r\n        suspendCallback: function() {\r\n            // console.log('@@@@@@@@@@中断创建任务 ' + callback.taskName + ' @@@@@@@@@@@', this.pid + 1, this.element)\r\n            if (outSuspendTasks = callback.outSuspendTasks) {\r\n                outSuspendTasks();\r\n            }\r\n        },\r\n        nextTaskCallback: function() {\r\n            if (outNextTasks = callback.outNextTasks) {\r\n                outNextTasks();\r\n            }\r\n        }\r\n    }, callback.interrupt)\r\n}\r\n\r\n\r\n/**\r\n * 任务调度\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.dispatchTasks = function() {\r\n    var tasks;\r\n    if (tasks = this.tasks[this.createRelated.nextRunTask]) {\r\n        tasks();\r\n    }\r\n}\r\n\r\n//========================构建模块任务对象=========================\r\n//\r\n//  taskCallback 每个模块任务完毕后的回调\r\n//  用于继续往下个任务构建\r\n//\r\n//==================================================================\r\n\r\n/**\r\n * 对象实例内部构建\r\n * @return {[type]} [description]\r\n */\r\nbaseProto.checkInstanceTasks = function(taskName) {\r\n    var tasksObj;\r\n    if (tasksObj = this.createRelated.cacheTasks[taskName]) {\r\n        tasksObj.runSuspendTasks();\r\n        return true;\r\n    }\r\n}\r\n\r\n\r\n//获取页面数据\r\nbaseProto.baseData = function() {\r\n    return this.dataCache[this.pageType];\r\n}\r\n\r\n//获取热点数据信息\r\nbaseProto.baseActivits = function() {\r\n    return this.dataCache['activitys'];\r\n}\r\n\r\n//获取自动运行数据\r\nbaseProto.baseAutoRun = function() {\r\n    var autoRunDas = this.dataCache['autoRunDas'];\r\n    return autoRunDas && autoRunDas;\r\n}\r\n\r\n//获取chapterid\r\nbaseProto.baseGetPageId = function(pid) {\r\n    return this.baseData(pid)['_id'];\r\n}\r\n\r\n\r\n/**\r\n * 找到对象的content对象\r\n * @param  {[type]}   contentId [description]\r\n * @param  {Function} callback  [description]\r\n * @return {[type]}             [description]\r\n */\r\nbaseProto.baseGetContentObject = function(contentId) {\r\n    var contentsObj;\r\n    if (contentsObj = this.contentsCollector[contentId]) {\r\n        return contentsObj;\r\n    } else {\r\n        //查找浮动母版\r\n        return this.floatContents.Master[contentId];\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Xut.Content.show/hide 针对互斥效果增加接口\r\n * 扩充，显示，隐藏，动画控制接口\r\n * @param  {[type]} name [description]\r\n * @return {[type]}      [description]\r\n */\r\nbaseProto.baseContentMutex = function(contentId, type) {\r\n    var contentObj,\r\n        base = this;\r\n    if (contentObj = base.baseGetContentObject(contentId)) {\r\n        var context = contentObj.$contentProcess;\r\n        var handle = {\r\n            'Show': function() {\r\n                if (contentObj.type === 'dom') {\r\n                    context.css({\r\n                        'display': 'blcok',\r\n                        'visibility': 'visible'\r\n                    }).prop(\"mutex\", false);\r\n                } else {\r\n                    context.visible = true;\r\n                    console.log('show')\r\n                    base.canvasRelated.oneRender()\r\n                }\r\n            },\r\n            'Hide': function() {\r\n                if (contentObj.type === 'dom') {\r\n                    context.css({\r\n                        'display': 'none',\r\n                        'visibility': 'hidden'\r\n                    }).prop(\"mutex\", true);\r\n                } else {\r\n                    console.log('hide')\r\n                    context.visible = false;\r\n                    base.canvasRelated.oneRender()\r\n                }\r\n            },\r\n            'StopAnim': function() {\r\n                contentObj.stopAnims && contentObj.stopAnims();\r\n            }\r\n        }\r\n        handle[type]()\r\n    }\r\n}\r\n\r\n\r\n//content接口\r\n_.each([\r\n    \"Get\",\r\n    \"Specified\"\r\n], function(type) {\r\n    baseProto['base' + type + 'Content'] = function(data) {\r\n        switch (type) {\r\n            case 'Get':\r\n                return this.abActivitys.get();\r\n            case 'Specified':\r\n                return this.abActivitys.specified(data);\r\n        }\r\n    }\r\n})\r\n\r\n//components零件类型处理\r\n//baseGetComponent\r\n//baseRemoveComponent\r\n//baseRegisterComponent\r\n//baseSpecifiedComponent\r\n_.each([\r\n    \"Get\",\r\n    \"Remove\",\r\n    \"Register\",\r\n    \"Specified\"\r\n], function(type) {\r\n    baseProto['base' + type + 'Component'] = function(data) {\r\n        switch (type) {\r\n            case 'Register':\r\n                return this.components.register(data);\r\n            case 'Get':\r\n                return this.components.get();\r\n            case 'Specified':\r\n                return this.components.specified(data);\r\n            case 'Remove':\r\n                return this.components.remove();\r\n        }\r\n    }\r\n})\r\n\r\n//***************************************************************\r\n//\r\n//               运行辅助对象事件\r\n//\r\n//***************************************************************\r\nbaseProto.baseAssistRun = function(activityId, outCallBack, actionName) {\r\n    var activity;\r\n    if (activity = this.abActivitys) {\r\n        _.each(activity.get(), function(contentObj, index) {\r\n            if (activityId == contentObj.activityId) {\r\n                if (actionName == 'Run') {\r\n                    contentObj.runEffects(outCallBack, true);\r\n                }\r\n                if (actionName == 'Stop') {\r\n                    contentObj.stopEffects(outCallBack);\r\n                }\r\n            }\r\n        }, this);\r\n    }\r\n}\r\n\r\n//销毁页面对象\r\nbaseProto.baseDestroy = function() {\r\n\r\n    //清理图片缓存\r\n    //读库快速退出模式下报错修正\r\n    try {\r\n        this.element.hide().find('img').each(function(aaa, img) {\r\n            img.src = 'images/icons/clearmem.png'\r\n        })\r\n    } catch (e) {\r\n\r\n    }\r\n\r\n    //清理线程任务块\r\n    var cacheTasks, key, tasks;\r\n    if (cacheTasks = this.createRelated.cacheTasks) {\r\n        for (key in cacheTasks) {\r\n            if (tasks = cacheTasks[key]) {\r\n                tasks.clearReference();\r\n            }\r\n        }\r\n    }\r\n\r\n    //浮动对象\r\n    var floatMaterContents = this.floatContents.Master\r\n        //是否有浮动对象\r\n    var hasFloatMater = !_.isEmpty(floatMaterContents);\r\n\r\n    //清理content类型对象\r\n    var contents;\r\n    if (contents = this.abActivitys.get()) {\r\n        contents.forEach(function(contentObj) {\r\n            contentObj.destroy(function(destroyObj) {\r\n                //如果不是浮动对象,清理元素引用\r\n                if (!hasFloatMater || destroyObj && !floatMaterContents[destroyObj.id]) {\r\n                    destroyObj.$contentProcess = null;\r\n                }\r\n            });\r\n        })\r\n    }\r\n\r\n    //清除母版浮动容器\r\n    if (hasFloatMater && this.floatContents.MasterContainer) {\r\n        this.floatContents.MasterContainer.remove();\r\n    }\r\n\r\n    //清除浮动页面对象\r\n    if (this.floatContents.Page && this.floatContents.PageContainer) {\r\n        this.floatContents.PageContainer.remove();\r\n    }\r\n\r\n    //清理零件类型对象\r\n    var components;\r\n    if ((components = this.baseGetComponent())) {\r\n        components.length && components.forEach(function(componentObj) {\r\n            componentObj.destroy && componentObj.destroy();\r\n        })\r\n    }\r\n\r\n    //多事件销毁\r\n    _destroy(this);\r\n\r\n    //销毁canvas相关\r\n    if (this.canvasRelated && this.canvasRelated.destroy) {\r\n        this.canvasRelated.destroy();\r\n    }\r\n\r\n    //伪li节点\r\n    if (this.pseudoElement) {\r\n        this.pseudoElement = null;\r\n    }\r\n\r\n    //移除li容器节点节点\r\n    this.element.remove();\r\n    this.root = null;\r\n    this.element = null;\r\n}\r\n\r\n\r\nexport { PageBase }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/pagebase.js\n **/","/**\r\n * [ description]\r\n * @return {[type]} [description]\r\n */\r\n\r\nexport function Collection() {\r\n    this.reset();\r\n}\r\n\r\nCollection.prototype = {\r\n\r\n    register: function(contentObj) {\r\n        if (!this._list) {\r\n            this._list = [contentObj];\r\n        } else {\r\n            this._list.push(contentObj);\r\n        }\r\n    },\r\n\r\n    get: function() {\r\n        return this._list;\r\n    },\r\n\r\n    //得到一个指定的实例\r\n    specified: function(data) {\r\n        var instance;\r\n        var listLength = this._list.length;\r\n        while (listLength) {\r\n            listLength--;\r\n            if (instance = this._list[listLength]) {\r\n                if (instance.type === data.type && instance.id === data.id) {\r\n                    return instance;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    remove: function() {\r\n        this._list = [];\r\n    },\r\n\r\n    reset: function() {\r\n        this._list = [];\r\n    }\r\n\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/collection.js\n **/","/**\r\n * 页面切换效果\r\n * 平移\r\n * @return {[type]} [description]\r\n */\r\nvar prefix = Xut.plat.prefixStyle,\r\n    xxtTrans = function(offset) {\r\n        offset = Xut.config.virtualMode ? offset / 2 : offset;\r\n        return \"translate3d(\" + offset + \"px, 0, 0)\";\r\n    };\r\n\r\nfunction dydTransform(distance) {\r\n    distance = Xut.config.virtualMode ? distance / 2 : distance;\r\n    return prefix('transform') + ':' + 'translate3d(' + distance + 'px,0px,0px)'\r\n}\r\n\r\n\r\n//保持缩放比,计算缩放比情况下的转化\r\nlet calculateContainer\r\nlet offsetLeft\r\nlet offsetRight\r\nlet offsetCut\r\nlet prevEffect\r\nlet currEffect\r\nlet nextEffect\r\n\r\nfunction setConfig() {\r\n    calculateContainer = Xut.config.proportion.calculateContainer(),\r\n    offsetLeft = (-1 * calculateContainer.width),\r\n    offsetRight = calculateContainer.width,\r\n    offsetCut = 0,\r\n    prevEffect = xxtTrans(offsetLeft),\r\n    currEffect = xxtTrans(offsetCut),\r\n    nextEffect = xxtTrans(offsetRight);\r\n}\r\n\r\n//切换坐标\r\nfunction toTranslate3d(distance, speed, element) {\r\n    distance = Xut.config.virtualMode ? distance / 2 : distance;\r\n    if (element = element || this.element || this.$contentProcess) {\r\n        element.css(prefix('transform'), 'translate3d(' + distance + 'px,0px,0px)');\r\n        if (Xut.config.pageFlip) {\r\n            //修正pageFlip切换页面的处理\r\n            //没有翻页效果\r\n            if (distance === 0) {\r\n                var cur = Xut.sceneController.containerObj('current')\r\n                cur.vm.$globalEvent.setAnimComplete(element);\r\n            }\r\n        } else {\r\n            element.css(prefix('transition-duration'), speed + \"ms\")\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 创建起始坐标\r\n * @return {[type]}\r\n */\r\nexport function createTransform(currPageIndex, createPageIndex) {\r\n    setConfig();\r\n    var translate3d, direction, offset;\r\n    if (createPageIndex < currPageIndex) {\r\n        translate3d = prevEffect;\r\n        offset = offsetLeft;\r\n        direction = 'before';\r\n    } else if (createPageIndex > currPageIndex) {\r\n        translate3d = nextEffect;\r\n        offset = offsetRight;\r\n        direction = 'after';\r\n    } else if (currPageIndex == createPageIndex) {\r\n        translate3d = currEffect;\r\n        offset = offsetCut;\r\n        direction = 'original';\r\n    }\r\n    return [translate3d, direction, offset, dydTransform];\r\n\r\n}\r\n\r\n\r\n/**\r\n * 修正坐标\r\n * @return {[type]} [description]\r\n */\r\nexport function fix(translate3d) {\r\n    var transform = prefix('transform')\r\n    var translate3d = translate3d === 'prevEffect' ? prevEffect : nextEffect\r\n    this.element.css(transform, translate3dt)\r\n}\r\n\r\nexport function reset() {\r\n    var element;\r\n    if (element = this.element || this.$contentProcess) {\r\n        element.css(prefix('transition-duration'), '');\r\n        element.css(prefix('transform'), 'translate3d(0px,0px,0px)');\r\n    }\r\n}\r\n\r\n/**\r\n * 移动\r\n * @return {[type]} [description]\r\n */\r\nexport function flipMove(distance, speed, element) {\r\n    toTranslate3d.apply(this, arguments)\r\n}\r\n\r\n/**\r\n * 移动反弹\r\n * @return {[type]} [description]\r\n */\r\nexport function flipRebound(distance, speed) {\r\n    toTranslate3d.apply(this, arguments)\r\n}\r\n\r\n/**\r\n * 移动结束\r\n * @return {[type]} [description]\r\n */\r\nexport function flipOver(distance, speed) {\r\n    /**\r\n     * 过滤多个动画回调，保证指向始终是当前页面\r\n     */\r\n    if (this.pageType === 'page') {\r\n        if (distance === 0) { //目标页面传递属性\r\n            this.element.attr('data-view', true)\r\n        }\r\n    }\r\n    toTranslate3d.apply(this, arguments)\r\n}\r\n\r\n\r\nvar translation = {\r\n    reset       : reset,\r\n    flipMove    : flipMove,\r\n    flipRebound : flipRebound,\r\n    flipOver    : flipOver\r\n}\r\n\r\nexport {translation}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/translation.js\n **/","//***********************************************************\r\n//\r\n//             多事件模块\r\n//\r\n//**********************************************************\r\n\r\nimport {\r\n    conversionEventType, bindEvents, destroyEvents\r\n}\r\nfrom '../component/content/event'\r\n\r\n//获取对应的activity对象\r\nvar getActivity = function(activityId, callback) {\r\n    var activity;\r\n    if (activity = this.abActivitys) {\r\n        _.each(activity.get(), function(contentObj, index) {\r\n            if (activityId == contentObj.activityId) {\r\n                callback(contentObj)\r\n                return;\r\n            }\r\n        }, this);\r\n    }\r\n}\r\n\r\n//制作一个处理绑定函数\r\nvar makeRunBinding = function(pagebase) {\r\n    var registers = this.registers;\r\n    var shift;\r\n    return function() {\r\n        var activityId = registers[0];\r\n        getActivity.call(pagebase, activityId, function(activityObj) {\r\n            activityObj.runEffects(function() {\r\n                shift = registers.shift();\r\n                registers.push(shift);\r\n            })\r\n        })\r\n    }\r\n};\r\n\r\n/**\r\n * 多事件处理\r\n * 每次通过同一个热点,触发不同的对象操作\r\n * @return {[type]} [description]\r\n */\r\nfunction combineEvents(pagebase, eventRelated) {\r\n\r\n    var contentObj, element, eventName;\r\n\r\n    //多条activty数据,一个对象上多事件\r\n    _.each(eventRelated, function(edata) {\r\n\r\n        _.each(edata, function(scope) {\r\n\r\n            contentObj = pagebase.baseGetContentObject(scope.eventContentId)\r\n\r\n            if (!contentObj) {\r\n                Xut.log('error', 'pagebase.js第' + pagebase.pageIndex + '页多事件处理出错!!!!')\r\n                return\r\n            }\r\n\r\n            element = contentObj.$contentProcess;\r\n            eventName = conversionEventType(scope.eventType);\r\n\r\n            //制动运行动作\r\n            scope.runEffects = makeRunBinding.call(scope, pagebase);\r\n\r\n            //销毁方法\r\n            scope.destroy = function() {\r\n                destroyEvents(scope, eventName);\r\n                scope.registers = null\r\n                scope.runEffects = null;\r\n            }\r\n\r\n            //事件绑定\r\n            bindEvents({\r\n                'eventRun': function() {\r\n                    scope.runEffects();\r\n                },\r\n                'eventHandler': function(eventReference, eventHandler) {\r\n                    scope.eventReference = eventReference;\r\n                    scope.eventHandler = eventHandler;\r\n                },\r\n                'eventContext': element,\r\n                'eventName': eventName,\r\n                'parameter': scope.dragdropPara,\r\n                'target': null,\r\n                'domMode': true\r\n            })\r\n        })\r\n\r\n        //暴露引用\r\n        pagebase.listenerHooks.registerEvents = eventRelated;\r\n    })\r\n}\r\n\r\n\r\n\r\nexport function create(pagebase, eventRelated) {\r\n    combineEvents(pagebase, eventRelated);\r\n}\r\n\r\n\r\nexport function destroy(pagebase) {\r\n    var registerEvents;\r\n    if (registerEvents = pagebase.listenerHooks.registerEvents) {\r\n        _.each(registerEvents, function(edata) {\r\n            _.each(edata, function(obj) {\r\n                obj.destroy && obj.destroy();\r\n            })\r\n        })\r\n    }\r\n    pagebase.listenerHooks.registerEvents = null;\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/multievent.js\n **/","/**\r\n * ppt事件接口\r\n *\r\n * 允许用户自定义其行为\r\n *     1 支持14种操作行为\r\n *     2 默认对象都具有滑动翻页的特性\r\n *     3 翻页的特性在遇到特性的情况可以被覆盖\r\n *     比如\r\n *         行为1：用户定义该名字可以支持  click 点击行为， 那么该元素左右滑动能过翻页\r\n *         行为2：用户如果定义swipeLeft 行为，该元素左右滑动将不会翻页，因为默认翻页已经被覆盖\r\n *\r\n * 此接口函数有作用域隔离\r\n */\r\n\r\n/**\r\n * ie10下面mouse事件怪异\r\n * @return {Boolean} [description]\r\n */\r\nvar isIE10 = document.documentMode === 10;\r\n\r\n\r\n/**\r\n * 事件类型\r\n * @type {Array}\r\n */\r\nvar eventName = ['null', 'auto', 'tap', 'drag', 'dragTag',\r\n    'swipeleft', 'swiperight', 'swipeup', 'swipedown', 'doubletap',\r\n    'press', 'pinchout', 'pinchin', 'rotate', 'assist'\r\n]\r\n\r\n/*********************************************************************\r\n *                重写默认事件\r\n *\r\n *                Content对象默认具有左右翻页的特性\r\n *                根据过滤来选择是否覆盖重写这个特性\r\n *                比如 用户如果遇到 swipeLeft，swipeRight 这种本身与翻页行为冲突的\r\n *                将要覆盖这个行为\r\n *                                                         *\r\n **********************************************************************/\r\n\r\n//过滤事件\r\n//如果用户指定了如下操作行为,将覆盖默认的翻页行为\r\nvar filterEvent = ['drag', 'dragTag', 'swipeleft', 'swiperight', 'swipeup', 'swipedown'];\r\n\r\n\r\n/**\r\n * 是否过滤\r\n * @param  {[type]} evtName [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction isfilter(eventName) {\r\n    return filterEvent.indexOf(eventName) === -1 ? true : false;\r\n}\r\n\r\n/**\r\n * 特性摘除\r\n * 1 ：无事件，默认可以翻页，还可以切换工具栏\r\n * 2 ：静态事件，默认可以翻页\r\n * 3 : 冲突事件，默认删除\r\n * 去除默认元素具有的翻页特性\r\n * @param  {[type]} evtName [事件名]\r\n * @return {[type]}         [description]\r\n */\r\nfunction checkDefaultBehavior(supportSwipe, element) {\r\n    if (supportSwipe) {\r\n        //静态事件，默认可以翻页，还可以切换工具栏\r\n        element.attr('data-behavior', 'swipe');\r\n    } else {\r\n        //如果事件存在\r\n        element.attr('data-behavior', 'disable');\r\n    }\r\n}\r\n\r\n/**\r\n * 针对软件培训的操作行为下光标状态需求\r\n * @param {[type]} element [description]\r\n */\r\nfunction addCursor(eventName, $element) {\r\n    if ($element) {\r\n        if (!$element.prop('setCursor')) { //只设置一次\r\n            if (eventName === ('drag' || 'dragTag')) {\r\n                $element.css('cursor', 'Move')\r\n            } else {\r\n                $element.css('cursor', 'Pointer')\r\n            }\r\n            $element.prop('setCursor', 'true');\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 针对canvas模式\r\n * 特殊的hack\r\n */\r\nfunction setCanvasStart(supportSwipe) {\r\n    Xut.Contents.Canvas.Reset()\r\n        //当前点击的元素是滑动元素\r\n        //处理元素的全局事件\r\n    Xut.Contents.Canvas.SupportSwipe = supportSwipe;\r\n    Xut.Contents.Canvas.isTap = true;\r\n}\r\n\r\nfunction setCanvasMove() {\r\n    Xut.Contents.Canvas.isSwipe = true;\r\n}\r\n\r\n\r\n/**\r\n * 兼容事件对象\r\n * @return {[type]}   [description]\r\n */\r\nfunction compatibilityEvent(e) {\r\n    var point;\r\n    if (e.touches && e.touches[0]) {\r\n        point = e.touches[0];\r\n    } else {\r\n        point = e;\r\n    }\r\n    return point\r\n}\r\n\r\n/**\r\n * 如果是简单的点击事件\r\n */\r\nfunction tapEvent(eventContext, domMode, eventHandle, supportSwipe) {\r\n\r\n    eventContext.isTap = false;\r\n\r\n    //这里单独绑定事件有个问题,单击move被触发\r\n    //如果停止e.stopPropagation，那么默认行为就不会被触发\r\n    //你绑定单击的情况下可以翻页\r\n    //这里通过坐标的位置来判断\r\n    var start = function(e) {\r\n            var point = compatibilityEvent(e);\r\n            //记录开始坐标\r\n            eventContext.pageX = point.pageX;\r\n            //是否是tap事件\r\n            eventContext.isTap = true;\r\n            setCanvasStart(supportSwipe);\r\n        },\r\n        move = function(e) {\r\n            if (!eventContext.isTap) {\r\n                return\r\n            }\r\n            var point = compatibilityEvent(e),\r\n                deltaX = point.pageX - eventContext.pageX;\r\n            //如果有move事件，则取消tap事件\r\n            if (Math.abs(deltaX)) {\r\n                eventContext.isTap = false;\r\n                setCanvasMove(supportSwipe);\r\n            }\r\n        },\r\n        end = function(e) {\r\n            //触发tap事件\r\n            eventContext.isTap && eventHandle();\r\n        };\r\n\r\n    //绑定canvas事件\r\n    function onCanvas(eventContext) {\r\n        eventContext.mousedown = eventContext.touchstart = start\r\n        eventContext.mousemove = eventContext.touchmove = move\r\n        eventContext.mouseup = eventContext.touchend = end\r\n    }\r\n\r\n    function offCanvas(eventContext) {\r\n        eventContext.mousedown = eventContext.touchstart = null\r\n        eventContext.mousemove = eventContext.touchmove = null\r\n        eventContext.mouseup = eventContext.touchend = null\r\n    }\r\n\r\n\r\n    if (domMode) {\r\n        eventContext = eventContext[0];\r\n        //IE10是不支持touch事件，直接绑定click事件\r\n        if (isIE10) {\r\n            eventContext.isTap = true;\r\n            eventContext.addEventListener('click', end, false);\r\n        } else {\r\n            Xut.plat.execEvent('on', {\r\n                context: eventContext,\r\n                callback: {\r\n                    start: start,\r\n                    move: move,\r\n                    end: end\r\n                }\r\n            })\r\n        }\r\n    } else {\r\n        //canvas开启模式\r\n        eventContext.interactive = true;\r\n        onCanvas(eventContext)\r\n    }\r\n\r\n    //销毁接口\r\n    return {\r\n        off: function() {\r\n            if (eventContext) {\r\n                if (domMode) {\r\n                    if (isIE10) {\r\n                        eventContext.removeEventListener('click', end, false);\r\n                    } else {\r\n                        Xut.plat.execEvent('off', {\r\n                            context: eventContext,\r\n                            callback: {\r\n                                start: start,\r\n                                move: move,\r\n                                end: end\r\n                            }\r\n                        })\r\n                    }\r\n                    eventContext = null;\r\n                } else {\r\n                    //canvas模式处理\r\n                    if (eventContext.destroy) {\r\n                        eventContext.destroy()\r\n                    } else {\r\n                        offCanvas(eventContext)\r\n                    }\r\n                    eventContext = null;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 优化hammer创建,生成必要配置文件\r\n * @return {[type]} [description]\r\n */\r\nfunction createRecognizers(eventName) {\r\n    var recognizers = [];\r\n    switch (eventName) {\r\n        //如果是swipe处理\r\n        case 'swipeleft':\r\n        case 'swiperight':\r\n        case 'swipeup':\r\n        case 'swipedown':\r\n            var direction = Hammer.DIRECTION_HORIZONTAL;\r\n            if (eventName === 'swipeup' || eventName === \"swipedown\") {\r\n                direction = Hammer.DIRECTION_VERTICAL;\r\n            }\r\n            recognizers.push([Hammer.Swipe, { 'direction': direction, 'velocity': 0.01 }])\r\n            break;\r\n        case 'doubletap': //双击\r\n            recognizers.push([Hammer.Tap])\r\n            recognizers.push([Hammer.Tap, { event: 'doubletap', taps: 2 },\r\n                ['tap']\r\n            ])\r\n            break\r\n        case 'press': //长按\r\n            recognizers.push([Hammer.Press])\r\n            return\r\n    }\r\n    return recognizers;\r\n}\r\n\r\n\r\n/**\r\n * 创建hammer引用\r\n * @return {[type]}         [description]\r\n */\r\nfunction createHammer(eventContext, eventName, domMode, supportSwipe) {\r\n    var eventReference;\r\n    if (domMode) {\r\n        var context = eventContext[0];\r\n        var recognizer = createRecognizers(eventName)\r\n        if (recognizer && recognizer.length) {\r\n            eventReference = Hammer(context, {\r\n                'recognizers': recognizer\r\n            });\r\n        } else {\r\n            eventReference = Hammer(context)\r\n        }\r\n    } else {\r\n        //canvas模式事件绑定\r\n        eventContext.interactive = true;\r\n        eventReference = Hammer(context, {\r\n            'recognizers': recognizer,\r\n            'pixiContext': eventContext,\r\n            'returnStart': function(evt) {\r\n                setCanvasStart(supportSwipe);\r\n            },\r\n            'returnMove': function() {\r\n                setCanvasMove(supportSwipe);\r\n            }\r\n        });\r\n    }\r\n    return eventReference;\r\n}\r\n\r\n/**\r\n * 复杂的事件\r\n * @return {[type]} [description]\r\n */\r\nfunction complexEvent(eventContext, eventName, domMode, eventHandler, supportSwipe) {\r\n    var eventReference = createHammer(eventContext, eventName, domMode, supportSwipe);\r\n    eventReference.on(eventName, function(ev) {\r\n        eventHandler();\r\n    });\r\n    return eventReference;\r\n}\r\n\r\n//绑定事件\r\nfunction bindEvent(eventDrop, data) {\r\n    var dragObj, eventHandler, eventReference;\r\n    var eventContext = data.eventContext;\r\n    var eventName = data.eventName;\r\n    var domMode = data.domMode;\r\n    switch (eventName) {\r\n        case 'drag': //拖动\r\n            dragObj = new DragDropClass(eventContext, null, data.parameter, eventDrop.startRun, eventDrop.stopRun);\r\n            break;\r\n        case 'dragTag': //拖拽\r\n            dragObj = new DragDropClass(eventContext, data.target, 1, eventDrop.startRun, eventDrop.stopRun);\r\n            break;\r\n        default:\r\n            //事件句柄\r\n            eventHandler = function() {\r\n                data.eventRun.call(eventContext);\r\n            };\r\n            eventReference = eventName === 'tap' ? tapEvent(eventContext, domMode, eventHandler, data.supportSwipe) : complexEvent(eventContext, eventName, domMode, eventHandler, data.supportSwipe)\r\n            break;\r\n    }\r\n    return [dragObj, eventReference, eventHandler]\r\n}\r\n\r\n\r\n\r\n//绑定事件\r\n// parameter 参数\r\n// 1：对于自由拖动drag，para参数为0，表示松手后，停留在松手的地方\r\n//                      para参数为1，表示松手后，返回原来的位置\r\n//\r\n// 2: 对于拖拽dragTag， para表示目标对象的target\r\nfunction applyEvent(data) {\r\n\r\n    //针对软件培训的操作行为下光标状态需求\r\n    Xut.plat.isBrowser && data.domMode && addCursor(data.eventName, data.eventContext)\r\n\r\n    //绑定事件\r\n    var eventDrop = data.eventDrop,\r\n        eventObj = bindEvent(eventDrop, data);\r\n\r\n    //拖动,拖拽对象处理\r\n    if (eventObj[0] && eventDrop.init) {\r\n        eventDrop.init(eventObj[0]);\r\n    } else {\r\n        //传递引用\r\n        data.eventHandler(eventObj[1], eventObj[2])\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n//================事件接口====================\r\n\r\n/**\r\n * 注册自定义事件\r\n * this还是引用的当前实例的上下文\r\n *\r\n *   'element'   : 事件对象\r\n *   'target'    : 目标对象\r\n *   'parameter' : 拖动参数\r\n *   'evtName'   : 事件名,\r\n *\r\n *   callbackHook 回调函数 ,处理具体的事情\r\n */\r\nexport function bindEvents(data) {\r\n    //是否支持翻页\r\n    var supportSwipe = data.supportSwipe = isfilter(data.eventName);\r\n    //检测是否移除元素的默认行为,因为元素都具有翻页的特性\r\n    if (data.domMode) {\r\n        checkDefaultBehavior(supportSwipe, data.eventContext);\r\n    }\r\n    //执行事件绑定\r\n    applyEvent(data);\r\n}\r\n\r\n//数据库预定义14个事件接口\r\n//提供给content文件\r\n//用于过滤数据库字段指定的行为\r\n//https://github.com/EightMedia/hammer.js/wiki/Getting-Started\r\n//2014.3.18 新增assist 辅助对象事件\r\nexport function conversionEventType(eventType) {\r\n    return eventName[Number(eventType) - 1] || null;\r\n}\r\n\r\n\r\nexport function defaultBehavior(element) {\r\n    element && element.attr('data-behavior', 'disable');\r\n}\r\n\r\n//销毁对象事件\r\nexport function destroyEvents(eventData, eventName) {\r\n    if (eventData.eventReference) {\r\n        eventData.eventReference.off(eventName || eventData.eventName, eventData.eventHandler)\r\n        eventData.eventReference = null;\r\n        eventData.eventHandler = null\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/event.js\n **/","//***********************************************************\r\n//\r\n//             多线程任务构建\r\n//\r\n//**********************************************************\r\n\r\n//数据解析\r\nimport { query } from '../manager/parser'\r\n//子任务\r\nimport { TaskContainer, TaskBackground, TaskContents, TaskComponents } from './thread/index'\r\n\r\n\r\n//更新数据缓存\r\nfunction updataCache(pid, callback) {\r\n    var fn,\r\n        base = this,\r\n        pageType = base.pageType;\r\n\r\n    //缓存数据\r\n    function addCacheDas(namespace, data) {\r\n        var key;\r\n        if (!base.dataCache[namespace]) {\r\n            base.dataCache[namespace] = data;\r\n        } else {\r\n            for (key in data) {\r\n                base.dataCache[namespace][key] = data[key];\r\n            }\r\n        }\r\n    }\r\n\r\n    //增加数据缓存\r\n    function addCache(data, activitys, autoRunDas) {\r\n        addCacheDas(base.pageType, data); //挂载页面容器数据\r\n        addCacheDas('activitys', activitys); //挂载activitys数据\r\n        addCacheDas('autoRunDas', autoRunDas); //挂载自动运行数据\r\n    }\r\n\r\n    query(pageType, {\r\n        'pageIndex': pid,\r\n        'pageData': base.chapterDas,\r\n        'pptMaster': base.pptMaster\r\n    }, function(data, activitys, autoRunDas) {\r\n        addCache.apply(addCache, arguments)\r\n        callback(data);\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 分配Container构建任务\r\n * 1 同步数据\r\n * 2 构建容器\r\n * 3 给出构建回调,这里不能中断,翻页必须存在节点\r\n * 4 等待之后自动创建或者后台空闲创建之后的任务\r\n * @return {[type]} [description]\r\n */\r\nvar assignedTasks = {\r\n\r\n    'Container': function(taskCallback, base) {\r\n        //同步数据\r\n        updataCache.call(base, [base.pid], function() {\r\n            var pageData = base.baseData();\r\n            if (pageData.parameter) {\r\n                // contentMode 分为  0 或者 1\r\n                // 1 是dom模式\r\n                // 0 是canvas模式\r\n                // 以后如果其余的在增加\r\n                // 针对页面chapter中的parameter写入 contentMode   值为 1\r\n                // 针对每一个content中的parameter写入 contentMode 值为 1\r\n                // 如果是canvas模式的时候，同时也是能够存在dom模式是\r\n                try {\r\n                    var parameter = JSON.parse(pageData.parameter);\r\n                    if (parameter && parameter.contentMode && parameter.contentMode == 1) {\r\n                        //启动dom模式\r\n                        base.canvasRelated.enable = true;\r\n                    }\r\n                } catch (e) {\r\n                    console.log('JSON错误,chpterId为', base.chapterId, pageData.parameter)\r\n                }\r\n            }\r\n\r\n            //创建主容器\r\n            TaskContainer({\r\n                'rootNode': base.root,\r\n                'prefix': base.pageType + \"-\" + (base.pageIndex + 1) + \"-\" + base.chapterId,\r\n                'pageType': base.pageType,\r\n                'pid': base.pid,\r\n                'baseData': pageData,\r\n                'virtualOffset': base.virtualOffset,\r\n                'initTransformParameter': base.createRelated.initTransformParameter,\r\n                'userStyle': base.userStyle //创建自定义style\r\n            }, taskCallback)\r\n        })\r\n    },\r\n\r\n\r\n    /**\r\n     *  分配背景构建任务\r\n     *    1 构建数据与结构,执行中断检测\r\n     *    2 绘制结构,执行回调\r\n     *\r\n     *  提供2组回调\r\n     *    1 构建数据结构 suspendCallback\r\n     *    2 执行innerhtml构建完毕 successCallback\r\n     */\r\n    'Background': function(taskCallback, base) {\r\n\r\n        if (base.checkInstanceTasks('background')) {\r\n            return;\r\n        }\r\n\r\n        var data = base.baseData(base.pid),\r\n            //构建中断回调\r\n            suspendCallback = function(innerNextTasks, innerSuspendTasks) {\r\n                base.nextTasks({\r\n                    'taskName': '内部background',\r\n                    'outSuspendTasks': innerSuspendTasks,\r\n                    'outNextTasks': innerNextTasks\r\n                });\r\n            },\r\n            //获取数据成功回调\r\n            successCallback = function() {\r\n                taskCallback();\r\n            };\r\n\r\n        base.createRelated.cacheTasks['background'] = new TaskBackground(base.getElement(), data, suspendCallback, successCallback)\r\n    },\r\n\r\n    /**\r\n     * 分配Components构建任务\r\n     * @return {[type]} [description]\r\n     */\r\n    'Components': function(taskCallback, base) {\r\n\r\n        if (base.checkInstanceTasks('components')) {\r\n            return;\r\n        }\r\n\r\n        var chapterDas = base.chapterDas,\r\n            baseData = base.baseData(),\r\n            //构建中断回调\r\n            suspendCallback = function(innerNextTasks, innerSuspendTasks) {\r\n                base.nextTasks({\r\n                    'taskName': '内部widgets',\r\n                    'outSuspendTasks': innerSuspendTasks,\r\n                    'outNextTasks': innerNextTasks\r\n                });\r\n            },\r\n            //获取数据成功回调\r\n            successCallback = function() {\r\n                taskCallback();\r\n            };\r\n\r\n        base.createRelated.cacheTasks['components'] = new TaskComponents({\r\n            'rootNode': base.getElement(),\r\n            'nodes': chapterDas['nodes'],\r\n            'pageOffset': chapterDas['pageOffset'],\r\n            'activitys': base.baseActivits(),\r\n            'chpaterData': baseData,\r\n            'chapterId': baseData['_id'],\r\n            'pid': base.pid,\r\n            'pageType': base.pageType,\r\n            'virtualOffset': base.virtualOffset\r\n        }, suspendCallback, successCallback);\r\n    },\r\n\r\n    /**\r\n     * 分配contetns构建任务\r\n     * @return {[type]} [description]\r\n     */\r\n    'Contetns': function(taskCallback, base) {\r\n\r\n        //通过content数据库为空处理\r\n        if (Xut.data.preventContent) {\r\n            return taskCallback();\r\n        }\r\n\r\n        if (base.checkInstanceTasks('contents')) {\r\n            return;\r\n        }\r\n\r\n        var chapterDas = base.chapterDas,\r\n            baseData = base.baseData(),\r\n            chapterId = baseData['_id'],\r\n            activitys = base.baseActivits(),\r\n\r\n            //生成钩子\r\n            // collector                : function (pageIndex, id, contentScope) {\r\n            // eventBinding             : function () { [native code] }\r\n            // floatMaters              : function (masters){\r\n            // registerAbstractActivity : function (pageIndex, type, contentsObjs) {\r\n            // successCallback          : function () {\r\n            // suspendCallback          : function (taskName, innerNextTasks, innerSuspendTasks) {\r\n            pageBaseHooks = _.extend({}, {\r\n                //构建中断回调\r\n                suspend: function(taskName, innerNextTasks, innerSuspendTasks) {\r\n                    //如果是当前页面构建,允许打断一次\r\n                    var interrupt\r\n                    if (base.isAutoRun && taskName === 'strAfter') {\r\n                        interrupt = true;\r\n                    }\r\n                    base.nextTasks({\r\n                        'interrupt': interrupt,\r\n                        'taskName': '内部contents',\r\n                        'outSuspendTasks': innerSuspendTasks,\r\n                        'outNextTasks': innerNextTasks\r\n                    });\r\n                },\r\n                //获取数据成功回调\r\n                success: function() {\r\n                    taskCallback();\r\n                }\r\n            }, base.listenerHooks);\r\n\r\n\r\n        base.createRelated.cacheTasks['contents'] = new TaskContents({\r\n            'canvasRelated': base.canvasRelated,\r\n            'rootNode': base.root,\r\n            'element': base.getElement(),\r\n            'pageType': base.pageType,\r\n            'nodes': chapterDas['nodes'],\r\n            'pageOffset': chapterDas['pageOffset'],\r\n            'activitys': activitys,\r\n            'chpaterData': baseData,\r\n            'chapterId': chapterId,\r\n            'pageIndex': base.pageIndex,\r\n            'pid': base.pid,\r\n            'pageBaseHooks': pageBaseHooks,\r\n            'virtualOffset': base.virtualOffset,\r\n            'initTransformParameter': base.createRelated.initTransformParameter\r\n        });\r\n    }\r\n}\r\n\r\nexport { assignedTasks }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/threadtask.js\n **/","//查询接口\r\nexport function query(tableName, options, callback) {\r\n    switch (tableName) {\r\n        case 'page':\r\n            //得到页面关联的数据\r\n            return getPageData(options, callback);\r\n        case 'master':\r\n            //得到母版关联的数据\r\n            return getMasterData(options, callback);\r\n        case 'chapter':\r\n            //得到chapter表数据\r\n            return parseChapter(options)\r\n        case 'scenarioChapter':\r\n            return scenarioChapter(options);\r\n    }\r\n}\r\n\r\n/**\r\n * 根据指定的chpaterId解析\r\n * @return {[type]} [description]\r\n */\r\nfunction scenarioChapter(chapterId) {\r\n    var chapterSection = Xut.data.chapterSection;\r\n    var rang = chapterSection['seasonId->' + chapterId];\r\n    return rang;\r\n}\r\n\r\n\r\n/*********************************************************************\r\n *\r\n *               1 解析chapter页面数据\r\n *               2 解析对应的Activity数据\r\n *               3 解析出自动widget数据结构\r\n *                                                         *\r\n **********************************************************************/\r\nfunction getPageData(data, callback) {\r\n    var parsePointer = data['pageIndex'],\r\n        pageData = data['pageData'];\r\n\r\n    if (pageData) {\r\n        getActivity(pageData, callback);\r\n    } else {\r\n        //解析章节数据\r\n        parseChapter(parsePointer, function(pageData) { //生成chapter数据\r\n            getActivity(pageData.length ? pageData[0] : pageData, callback);\r\n        });\r\n    }\r\n};\r\n\r\n//解析关联的Activity表数据\r\nfunction getActivity(pageData, callback) {\r\n    parseActivity(pageData, function(activitys, autoData) {\r\n        callback(pageData, activitys, autoData);\r\n    });\r\n}\r\n\r\n/**\r\n * 递归分解\r\n * chpater直接对应页面的ID编码，直接去下标即可\r\n * waitCreatePointer     需要分解的页面\r\n */\r\nfunction parseChapter(waitCreatePointer) {\r\n    var chapters = [],\r\n        chapter,\r\n        dataChpater = Xut.data.Chapter,\r\n        points = waitCreatePointer.length,\r\n        key;\r\n\r\n    while (points--) {\r\n        key = waitCreatePointer[points];\r\n        if (chapter = dataChpater.item(key)) {\r\n            chapters.unshift(chapter);\r\n        }\r\n    }\r\n\r\n    return chapters;\r\n};\r\n\r\n\r\n/*********************************************************************\r\n *\r\n *                解析视觉差的数据\r\n *                                                         *\r\n **********************************************************************/\r\nfunction getMasterData(data, callback) {\r\n    var pptMaster = data['pptMaster'];\r\n    var masterDas = Xut.data.query('Master', pptMaster)\r\n    parseActivity(masterDas, function(activitys, autoData) {\r\n        callback(masterDas, activitys, autoData);\r\n    });\r\n}\r\n\r\n\r\n/*********************************************************************\r\n *                解析activity表的数据\r\n *                                                         *\r\n **********************************************************************/\r\n/**\r\n * chpaters = {\r\n *     pageIndex-12: Object\r\n *     pageIndex-13: Object\r\n *     pageIndex-14: Object\r\n *  }\r\n **/\r\nfunction parseActivity(data, callback) {\r\n    if (!data) callback();\r\n    var activitys = [];\r\n    var chapterId = data['_id'];\r\n\r\n    Xut.data.query('Activity', chapterId, 'chapterId', function(item) {\r\n        activitys.push(item);\r\n    })\r\n\r\n    //混入文本提示框\r\n    mixShowNote(data, activitys);\r\n\r\n    //自动运行的数据\r\n    //解析出每一页自动运行的 Widget,Action,Video数据\r\n    var autoData = filterAutoRun(activitys);\r\n\r\n    callback(activitys, autoData);\r\n};\r\n\r\n\r\n/**\r\n * 混入shownote\r\n * 组合showNote数据,弹出信息框,也看作一个热点\r\n * shownote是chater的信息，混入到activity列表中当作每页的对象处理\r\n * @return {[type]} [description]\r\n */\r\nfunction mixShowNote(onechapter, activitydata) {\r\n    if (onechapter.note) {\r\n        activitydata.push(onechapter);\r\n    }\r\n};\r\n\r\n\r\n//解析出页面自动运行的数据\r\nfunction filterAutoRun(activitys) {\r\n\r\n    var collectAutoBuffers, key, id, key, sub;\r\n\r\n    if (!activitys || !activitys.length) return;\r\n\r\n    collectAutoBuffers = []; //自动热点\r\n\r\n    activitys.forEach(function(target, b) {\r\n        //如果是自动播放,并且满足自定义条件\r\n        //并且不是content类型\r\n        if (target.autoPlay && target.actType !== 'Content') {\r\n            //增加note提示信息数据\r\n            id = target['_id'];\r\n            key = target.actType ? target.actType + \"_\" + id : 'showNote_' + id;\r\n            sub = {\r\n                'id': id,\r\n                'type': target.actType,\r\n                'animation': target.animation,\r\n                'key': key,\r\n                'category': target.category,\r\n                'autoPlay': target.autoPlay\r\n            };\r\n            collectAutoBuffers.push(sub);\r\n        }\r\n    })\r\n\r\n    if (collectAutoBuffers.length) {\r\n        return collectAutoBuffers;\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/parser.js\n **/","export * from './container'\r\nexport * from './background'\r\nexport * from './contents'\r\nexport * from './components'\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/index.js\n **/","/**\r\n *\t创建主容器任务片\r\n *  state状态\r\n *   \t0 未创建\r\n *    \t1 正常创建\r\n *     \t2 创建完毕\r\n *      3 创建失败\r\n */\r\n\r\nvar prefixStyle = Xut.plat.prefixStyle;\r\n\r\n/**\r\n * 创建父容器li结构\r\n */\r\nfunction createContainer(transform, data) {\r\n\r\n    var str = '',\r\n        containerBackground = '',\r\n        userStyle = data.userStyle,\r\n        baseData = data.baseData,\r\n        url = baseData.md5;\r\n\r\n    var config = Xut.config\r\n\r\n    var proportion = config.proportion;\r\n    var calculate = proportion.calculateContainer();\r\n    var sWidth = calculate.width;\r\n    var sHeight = calculate.height;\r\n\r\n    //chpater有背景，不是svg格式\r\n    if (!/.svg$/i.test(url)) {\r\n        containerBackground = 'background-image:url(' + config.pathAddress + url + ');'\r\n    }\r\n\r\n    function createli(customStyle) {\r\n        customStyle = customStyle ? customStyle : '';\r\n        var str;\r\n        var offsetLeft = 0;\r\n        var pageType = data.pageType;\r\n        if (config.virtualMode) {\r\n            if (data.virtualOffset === 'right') {\r\n                offsetLeft = -(config.screenSize.width - proportion.offsetLeft);\r\n            }\r\n            str = String.format(\r\n                '<li id=\"{0}\" class=\"xut-flip\" data-map=\"{1}\" data-pageType=\"{2}\" data-container=\"true\" style=\"overflow:hidden;{3}:{4};{5}{6}\">' +\r\n                '<div style=\"width:{7}px;left:{8}px;height:100%;position:relative\"></div>' +\r\n                '</li>',\r\n                data.prefix, data.pid, pageType, prefixStyle('transform'), transform, containerBackground, customStyle, sWidth, offsetLeft\r\n            );\r\n        } else {\r\n            str = String.format(\r\n                '<li id=\"{0}\" class=\"xut-flip\" data-map=\"{1}\" data-pageType=\"{2}\" data-container=\"true\" style=\"overflow:hidden;{3}:{4};{5}{6}\"></li>',\r\n                data.prefix, data.pid, pageType, prefixStyle('transform'), transform, containerBackground, customStyle\r\n            );\r\n        }\r\n        return str;\r\n    }\r\n\r\n    /**\r\n     * 自定义配置了样式\r\n     * 因为单页面跳槽层级的问题处理\r\n     */\r\n    if (userStyle !== undefined) {\r\n        //解析自定义规则\r\n        var customStyle = '';\r\n        _.each(userStyle, function(value, key) {\r\n            customStyle += key + ':' + value + ';'\r\n        })\r\n        str = createli(customStyle)\r\n    } else {\r\n        str = createli()\r\n    }\r\n\r\n    return $(str); //转化成文档碎片\r\n}\r\n\r\n\r\nexport function TaskContainer(data, successCallback) {\r\n\r\n    var $element;\r\n\r\n    //iboosk编译\r\n    //在执行的时候节点已经存在\r\n    //不需要在创建\r\n    if (Xut.IBooks.runMode()) {\r\n        $element = $(\"#\" + data.prefix);\r\n        successCallback($element, pseudoElement)\r\n        return\r\n    }\r\n\r\n    var pseudoElement,\r\n        transform = data.initTransformParameter[0],\r\n        direction = data.initTransformParameter[1],\r\n        //创建的flip结构体\r\n        $element = createContainer(transform, data),\r\n        //创建节点的方向\r\n        direction = direction === 'before' ? 'first' : 'last';\r\n\r\n    //如果启动了wordMode模式,查找伪li\r\n    if (Xut.config.virtualMode) {\r\n        pseudoElement = $element.find('div');\r\n    }\r\n\r\n    Xut.nextTick({\r\n        container: data.rootNode,\r\n        content: $element,\r\n        position: direction\r\n    }, function() {\r\n        successCallback($element, pseudoElement)\r\n    });\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/container.js\n **/","\r\nimport {readFile} from '../../util/option'\r\n\r\n\r\n/**\r\n *\t创建背景\r\n */\r\n\r\nvar prefix = Xut.plat.prefixStyle;\r\n\r\n/**\r\n * 构建背景类\r\n * @param {[type]} rootNode             [根节点]\r\n * @param {[type]} data                 [数据]\r\n * @param {[type]} suspendCallback      [中断回调]\r\n * @param {[type]} successCallback      [description]\r\n */\r\nfunction TaskBackground(rootNode, data, suspendCallback, successCallback) {\r\n    var layer,\r\n        suspendTasks,\r\n        nextTasks,\r\n        self = this,\r\n        content = data[\"md5\"],\r\n        isSVGContent = /.svg$/i.test(content) ? true : false;\r\n\r\n    this.callback = {\r\n        'suspendCallback': suspendCallback,\r\n        'successCallback': successCallback\r\n    }\r\n\r\n\r\n    //iboosk节点预编译\r\n    //在执行的时候节点已经存在\r\n    //不需要在创建\r\n    if (Xut.IBooks.runMode()) {\r\n        //找到背景节点\r\n        var $element = rootNode.find('.multilayer');\r\n        successCallback()\r\n        return;\r\n    }\r\n\r\n\r\n    //背景是否需要SVG解析\r\n    this.parseMaster(isSVGContent, content, createWarpper);\r\n    //构建背景\r\n    function createWarpper(svgContents) {\r\n        var backgroundStr = createMaster(svgContents, data);\r\n        if (backgroundStr) {\r\n            svgContents = null;\r\n            self.compileSuspend($(backgroundStr), rootNode);\r\n        } else {\r\n            successCallback();\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nTaskBackground.prototype = {\r\n\r\n    clearReference: function() {},\r\n\r\n    //构建中断函数\r\n    compileSuspend: function($background, rootNode) {\r\n\r\n        var nextTasks, suspendTasks,\r\n            self = this;\r\n\r\n        //继续执行\r\n        nextTasks = function() {\r\n            Xut.nextTick({\r\n                'container': rootNode,\r\n                'content': $background\r\n            }, function() {\r\n                self.clearReference();\r\n                self.callback.successCallback();\r\n            });\r\n        }\r\n\r\n        //中断方法\r\n        suspendTasks = function() {\r\n            self.suspendQueues = [];\r\n            self.suspendQueues.push(function() {\r\n                nextTasks()\r\n            })\r\n        }\r\n        self.callback.suspendCallback(nextTasks, suspendTasks);\r\n    },\r\n\r\n    //运行被阻断的线程任务\r\n    runSuspendTasks: function() {\r\n        if (this.suspendQueues) {\r\n            var fn;\r\n            if (fn = this.suspendQueues.pop()) {\r\n                fn();\r\n            }\r\n            this.suspendQueues = null;\r\n        }\r\n    },\r\n\r\n    //解析SVG背景\r\n    parseMaster: function(isSVGContent, content, callback) {\r\n        if (isSVGContent) { //背景需要SVG解析的\r\n            readFile(content, function(svgContents) {\r\n                callback(svgContents);\r\n            });\r\n        } else {\r\n            callback('');\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n * 修正尺寸\r\n * @return {[type]} [description]\r\n */\r\n\r\nfunction fixSize(data) {\r\n    //缩放比\r\n\tvar proportion   = Xut.config.proportion;\r\n\tdata.path        = Xut.config.pathAddress;\r\n\tdata.imageWidth  = data.imageWidth * proportion.width;\r\n\tdata.imageHeight = data.imageHeight * proportion.height;\r\n\tdata.imageLeft   = data.imageLeft * proportion.left;\r\n\tdata.imageTop    = data.imageTop * proportion.top;\r\n}\r\n\r\n\r\n/*********************************************************************\r\n *                创建分层背景图层\r\n *                master               - 母版\r\n *                imageLayer,imageMask - 图像层图\r\n *                md5                  - 文字层图                                                                                     *\r\n **********************************************************************/\r\n\r\nfunction createMaster(svgContent, data) {\r\n    var imageLayer, maskLayer, restr = '',\r\n        imageLayerData = data[\"imageLayer\"], //图片层\r\n        imageMaskData = data[\"imageMask\"], //蒙版层\r\n        backImageData = data[\"backImage\"], //真实图片层\r\n        backMaskData = data[\"backMask\"], //真实蒙版层\r\n        masterData = data[\"master\"], //母板\r\n        backText = data['md5'], //背景文字\r\n        pptMaster = data['pptMaster']; //母板PPTID\r\n\r\n\r\n    //=======================未分层结构===========================\r\n    //\r\n    //\t\t 只有SVG数据，没有层次数据 ,不是视觉差\r\n    //\r\n    // ============================================================\r\n    if (backText && !masterData && !pptMaster && !imageLayerData) {\r\n        return svgContent ? '<div class=\"multilayer\" data-multilayer =\"true\" style=\"width:100%; height:100%;position:absolute;left:0;top:0;z-index:0;\">' + svgContent + '</div>' : '';\r\n    }\r\n\r\n    //=========================分层结构============================\r\n    //\r\n    //   1 分母板 文字层 背景 蒙版\r\n    //   2 视觉差分层处理\r\n    //\r\n    //=============================================================\r\n\r\n    //修正尺寸\r\n    fixSize(data);\r\n\r\n    //============= 组层背景图开始 ====================\r\n\r\n    restr = '<div class=\"multilayer\" data-multilayer =\"true\" style=\"width:100%; height:100%;position:absolute;left:0;top:0;z-index:0;\">';\r\n\r\n    //如果有母板数据,如果不是视觉差\r\n    if (masterData && !pptMaster) {\r\n        //母版图\r\n        restr += '<div class=\"master\" style=\"width:100%; height:100%;background-size:100% 100%;position:absolute;z-index:0;background-image:url({0});\"></div>';\r\n    }\r\n\r\n    //存在背景图\r\n    if (imageLayerData) {\r\n        //蒙版图（与背景图是组合关系）\r\n        maskLayer = data[\"imageMask\"] ? prefix(\"mask-box-image\") + \":url(\" + data.path + data[\"imageMask\"] + \");\" : \"\";\r\n        //图片层\r\n        restr += '<div class=\"imageLayer\" style=\"width:{1}px;height:{2}px;top:{3}px;left:{4}px;position:absolute;z-index:2;background-size:100% 100%;background-image:url({5});{6};\"></div>';\r\n    }\r\n\r\n    //新增的 真实背景图 默认全屏\r\n    if (backImageData) {\r\n        //计算出对页排版偏移值\r\n        var backImageOffset = (function() {\r\n            var background,\r\n                pageSide = data['pageSide'];\r\n\r\n            switch (Number(pageSide)) {\r\n                case 1:\r\n                    background = 'background-position:0';\r\n                    break\r\n                case 2:\r\n                    background = 'background-position:' + Xut.config.screenSize.width + 'px';\r\n                    break\r\n            }\r\n\r\n            return background;\r\n        })();\r\n\r\n        if (backMaskData) {\r\n            //带蒙版\r\n            if (prefix('mask-box-image') != undefined) {\r\n                restr += '<div class=\"backImage\" style=\"width:{7};height:100%;position:absolute;z-index:1;background-size:100% 100%;background-image:url(' + data.path + backImageData + ');' + prefix('mask-box-image') + ':url(' + data.path + backMaskData + ');{8}\"></div>';\r\n            } else {\r\n                restr += '<canvas class=\"backImage edges\" height=' + document.body.clientHeight + ' width=' + document.body.clientWidth + '  style=\"width:{7};opacity:0;height:100%;background-size:100% 100%;position:absolute;z-index:1;-webkit-mask-box-image:url(' + data.path + backMaskData + ');{8}\" src=' + data.path + backImageData + ' mask=' + data.path + backMaskData + '></canvas>';\r\n            }\r\n        } else {\r\n            //图片层\r\n            restr += '<div class=\"backImage\" style=\"width:{7};height:100%;position:absolute;z-index:1;background-size:100% 100%;background-image:url(' + data.path + backImageData + ');{8}\"></div>';\r\n        }\r\n    }\r\n\r\n    //存在svg文字\r\n    if (backText) {\r\n        restr += '<div class=\"words\" style=\"width:100%;height:100%;top:0;left:0;position:absolute;z-index:3;\">{9}</div>';\r\n    }\r\n\r\n    restr += '</div>';\r\n\r\n    //============= 组层背景图结束 ====================\r\n\r\n    return String.format(restr,\r\n        data.path + masterData,\r\n        data.imageWidth, data.imageHeight, data.imageTop, data.imageLeft, data.path + imageLayerData, maskLayer, backImageOffset ? '200%' : '100%', backImageOffset ? backImageOffset : '',\r\n        svgContent);\r\n}\r\n\r\n\r\n\r\nexport {TaskBackground}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/background.js\n **/","/****************************************************\r\n *\r\n *           构建TaskContents对象\r\n *\r\n *      依赖数据解析算法类 Algorithm\r\n *      结构合并创建类    Structure\r\n *      行为动画绑定类     Content\r\n * \r\n * ***************************************************/\r\nimport {\r\n    parseJSON, arrayUnique\r\n}\r\nfrom '../../util/index'\r\n\r\nimport {\r\n    parserRelated as conParser\r\n}\r\nfrom './content/data'\r\n\r\nimport {\r\n    structure as conStructure\r\n}\r\nfrom './content/structure'\r\n\r\nimport {\r\n    activityClass\r\n}\r\nfrom '../../component/content/activity'\r\n\r\n\r\n\r\nfunction TaskContents(data) {\r\n    var compileActivitys;\r\n    data = _.extend(this, data);\r\n\r\n    //如果有预执行动作\r\n    //Activity表数据存在\r\n    if (compileActivitys = parseContents(data)) {\r\n        //解析动画表数据结构\r\n        data = conParser(compileActivitys, data);\r\n        //如果有需要构建的content\r\n        //开始多线程处理\r\n        data.createContentIds.length ? this.dataAfterCheck(data) : this.loadComplete();\r\n    } else {\r\n        this.loadComplete();\r\n    }\r\n}\r\n\r\n\r\nvar taskProto = TaskContents.prototype;\r\n\r\n/**\r\n * 任务断言\r\n */\r\ntaskProto.assert = function(taskName, tasks) {\r\n\r\n    var self = this;\r\n\r\n    //中断方法\r\n    var suspendTasks = function() {\r\n        self.suspendQueues = [];\r\n        self.suspendQueues.push(function() {\r\n            tasks.call(self);\r\n        })\r\n    }\r\n\r\n    //完成方法\r\n    var nextTasks = function() {\r\n        tasks.call(self);\r\n    }\r\n\r\n    self.pageBaseHooks.suspend(taskName, nextTasks, suspendTasks);\r\n}\r\n\r\n\r\n/**\r\n * 运行被阻断的线程任务\r\n * @return {[type]} [description]\r\n */\r\ntaskProto.runSuspendTasks = function() {\r\n    if (this.suspendQueues) {\r\n        var fn;\r\n        if (fn = this.suspendQueues.pop()) {\r\n            fn();\r\n        }\r\n        this.suspendQueues = null;\r\n    }\r\n}\r\n\r\n/**\r\n * 构建完毕\r\n * @return {[type]} [description]\r\n */\r\ntaskProto.loadComplete = function() {\r\n    this.pageBaseHooks.success();\r\n}\r\n\r\n\r\nfunction createFn(obj, id, callback) {\r\n    var cObj = obj[id];\r\n    if (!cObj) {\r\n        cObj = obj[id] = {};\r\n    }\r\n    callback.call(cObj);\r\n}\r\n\r\n\r\n/**\r\n * 转成数组格式\r\n * @param  {[type]} contentsFragment [description]\r\n * @return {[type]}                  [description]\r\n */\r\nfunction toArray(o) {\r\n    var contentsFragment = [];\r\n    _.each(o, function(contentElements) {\r\n        contentsFragment.push(contentElements)\r\n    })\r\n    return contentsFragment;\r\n}\r\n\r\n/**\r\n * 构建快速查询节点对象\r\n * 转成哈希方式\r\n * @return {[type]} [description]\r\n */\r\nfunction toObject(cachedContentStr) {\r\n    var tempFragmentHash = {};\r\n    _.each($(cachedContentStr), function(ele, index) {\r\n        tempFragmentHash[ele.id] = ele;\r\n    })\r\n    return tempFragmentHash;\r\n};\r\n\r\n\r\n/**\r\n * 行为反馈\r\n *  content id = {\r\n *      弹动\r\n *      音频URl\r\n *  }\r\n */\r\nfunction addBehavior(data) {\r\n    var parameter, soundSrc, contentId, isButton,\r\n        feedbackBehavior = data.feedbackBehavior = {};\r\n    _.each(data.activitys, function(activitys) {\r\n        if (activitys.parameter && (parameter = parseJSON(activitys.parameter))) {\r\n            contentId = activitys.imageId;\r\n            //视觉反馈\r\n            if (isButton = parameter['isButton']) {\r\n                if (isButton != 0) { //过滤数据的字符串类型\r\n                    createFn(feedbackBehavior, contentId, function() {\r\n                        this['isButton'] = true;\r\n                    })\r\n                }\r\n            }\r\n            //音频行为\r\n            if (soundSrc = parameter['behaviorSound']) {\r\n                if (soundSrc != 0) {\r\n                    createFn(feedbackBehavior, contentId, function() {\r\n                        this['behaviorSound'] = soundSrc;\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 中断一:构建数据之后\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\ntaskProto.dataAfterCheck = function(data) {\r\n\r\n    this.assert('dataAfter', function() {\r\n\r\n        //浮动模板\r\n        //用于实现模板上的事件\r\n        data.floatMaters = {\r\n            'ids': [], //浮动id\r\n            'container': {}, //浮动容器\r\n            'zIndex': {}\r\n            // offset : {}  //初始化坐标数据\r\n        }\r\n\r\n        //浮动页面\r\n        //母板事件引起的层级遮挡问题\r\n        //用于提升最高\r\n        data.floatPages = {\r\n            'ids': [],\r\n            'zIndex': {}\r\n        }\r\n\r\n        //增加点击行为反馈\r\n        addBehavior(data)\r\n\r\n\r\n        //构建页面content类型结构\r\n        var createStr = function(contentDas, cachedContentStr, containerPrefix, idFix, contentHtmlBoxIds) {\r\n\r\n            data.contentHtmlBoxIds = contentHtmlBoxIds;\r\n\r\n            data.contentsFragment = {};\r\n\r\n            //iboosk节点预编译\r\n            //在执行的时候节点已经存在\r\n            //不需要在创建\r\n            if (Xut.IBooks.runMode()) {\r\n                _.each(idFix, function(id) {\r\n                    data.contentsFragment[id] = data.element.find(\"#\" + id)[0]\r\n                })\r\n            } else {\r\n                //构件快速查询节点对象\r\n                data.contentsFragment = toObject(cachedContentStr)\r\n            }\r\n\r\n            //容器的前缀\r\n            data.containerPrefix = containerPrefix;\r\n\r\n            //2015.5.6暴露到全局\r\n            //提供给音频字幕上下文                \r\n            if (!Xut.Contents.contentsFragment[data.chapterId]) {\r\n                Xut.Contents.contentsFragment[data.chapterId]\r\n            }\r\n            Xut.Contents.contentsFragment[data.chapterId] = data.contentsFragment\r\n\r\n            //开始下一个任务\r\n            this.dataStrCheck(data, contentDas);\r\n        }\r\n\r\n        //构建页面节点\r\n        conStructure(createStr, data, this);\r\n\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 中断二:构建结构之后\r\n * @param  {[type]} data       [description]\r\n * @param  {[type]} contentDas [description]\r\n * @return {[type]}            [description]\r\n */\r\ntaskProto.dataStrCheck = function(data, contentDas) {\r\n    this.assert('strAfter', function() {\r\n\r\n        //保留场景的留信息\r\n        //用做软件制作单页预加载\r\n        Xut.sceneController.seasonRelated = data.seasonRelated\r\n\r\n        //初始化content对象\r\n        //绑定content\r\n        //1 动画\r\n        //2 事件\r\n        //3 视觉差\r\n        //4 动画音频\r\n        //5 canvas动画\r\n        contentsBehavior(function(delayHooks) {\r\n            //渲染页面\r\n            this.eventAfterCheck(data, delayHooks);\r\n        }.bind(this), data, contentDas);\r\n    })\r\n}\r\n\r\n\r\n///////////////\r\n//创建浮动相关的信息 //\r\n///////////////\r\nfunction crateFloat(callback, floatName, dasFloat, data, base) {\r\n\r\n    var elements = [];\r\n    var prefix = 'Content_' + data.pid + \"_\";\r\n\r\n    //去重复\r\n    dasFloat.ids = arrayUnique(dasFloat.ids)\r\n\r\n    var makePrefix,\r\n        fragment,\r\n        zIndex,\r\n        zIndexs = dasFloat.zIndex;\r\n\r\n    data.count++;\r\n\r\n    //分离出浮动节点\r\n    _.each(dasFloat.ids, function(id) {\r\n        makePrefix = prefix + id;\r\n        if (fragment = data.contentsFragment[makePrefix]) {\r\n            zIndex = zIndexs[id];\r\n            //保证层级关系\r\n            // fragment.style.zIndex = (Number(zIndex) + Number(fragment.style.zIndex)) \r\n            elements.push(fragment);\r\n            delete data.contentsFragment[makePrefix]\r\n        }\r\n    })\r\n\r\n\r\n    //floatPages模式下面\r\n    //如果是当前页面\r\n    //因为会产生三页面并联\r\n    //所以中间去最高层级\r\n    if (floatName === 'floatPages' && (base.initTransformParameter[2]) === 0) {\r\n        zIndex = 2001\r\n    } else {\r\n        zIndex = 2000\r\n    }\r\n\r\n    //浮动根节点\r\n    //floatPages设置的content溢出后处理\r\n    //在非视区增加overflow:hidden\r\n    //可视区域overflow:''\r\n    var overflow = 'overflow:hidden;';\r\n    //如果是母板,排除\r\n    if (floatName === 'floatMaters') {\r\n        overflow = '';\r\n    }\r\n    var floatStr = String.format(\r\n        '<div id=\"' + floatName + '-li-{0}\" class=\"xut-float\" style=\"' + Xut.plat.prefixStyle('transform') + ':{1};z-index:' + zIndex + ';{2}\"></div>',\r\n        data.pid, base.initTransformParameter[0], overflow\r\n    );\r\n\r\n    var container = $(floatStr);\r\n\r\n    //增加浮动容器\r\n    $(data.rootNode).after(container)\r\n\r\n    callback(elements, container)\r\n}\r\n\r\n\r\n/**\r\n * 创建浮动母版对象\r\n * @return {[type]} [description]\r\n */\r\nfunction createFloatMater(base, data, complete) {\r\n    //创建浮动对象\r\n    crateFloat(function(elements, container) {\r\n        //浮动容器\r\n        data.floatMaters.container = container;\r\n\r\n        Xut.nextTick({\r\n            'container': container,\r\n            'content': elements\r\n        }, function() {\r\n            //收集浮动母版对象标识\r\n            base.pageBaseHooks.collector.floatMaters(data.floatMaters);\r\n            complete(data);\r\n        });\r\n    }, 'floatMaters', data.floatMaters, data, base)\r\n}\r\n\r\n\r\n/**\r\n * 创建浮动的页面对象\r\n */\r\nfunction createFloatPage(base, data, complete) {\r\n    //创建浮动对象\r\n    crateFloat(function(elements, container) {\r\n        //浮动容器\r\n        data.floatPages.container = container;\r\n        Xut.nextTick({\r\n            'container': container,\r\n            'content': elements\r\n        }, function() {\r\n            //收集浮动母版对象标识\r\n            base.pageBaseHooks.collector.floatPages(data.floatPages);\r\n            complete(data);\r\n        });\r\n    }, 'floatPages', data.floatPages, data, base)\r\n}\r\n\r\n\r\n/**\r\n * 中断三:绑定事件事件之后\r\n * @param  {[type]} iScrollHooks [description]\r\n * @return {[type]}              [description]\r\n */\r\ntaskProto.eventAfterCheck = function(data, delayHooks) {\r\n\r\n    var self = this;\r\n\r\n    this.assert('eventAfter', function() {\r\n\r\n        data.count = 1; //计算回调的成功的次数\r\n\r\n        /**\r\n         * 完成钩子函数\r\n         * 1 content的卷滚条\r\n         * 2 canvas事件绑定\r\n         * @return {[type]} [description]\r\n         */\r\n        var completeHooks = function() {\r\n            var hooks;\r\n            _.each(delayHooks, function(fns) {\r\n                while (hooks = fns.shift()) {\r\n                    hooks();\r\n                }\r\n            })\r\n        }\r\n\r\n        var nextTask = function() {\r\n            completeHooks();\r\n            self.applyAfterCheck();\r\n        }\r\n\r\n        /**\r\n         * 1 页面浮动\r\n         * 2 母版浮动\r\n         * 3 正常对象\r\n         */\r\n        var complete = function(data) {\r\n            return function() {\r\n                if (data.count === 1) {\r\n                    /**\r\n                     * 2016.2.16\r\n                     * 绘制canvas节点\r\n                     * @return {[type]}                           \r\n                     */\r\n                    if (data.canvasRelated.enable && data.canvasRelated.cid.length) {\r\n                        //初始化绘制canvas \r\n                        //页面显示\r\n                        data.canvasRelated.display();\r\n                        nextTask();\r\n                    } else {\r\n                        nextTask()\r\n                    }\r\n                    return\r\n                }\r\n                data.count--;\r\n            }\r\n        }(data);\r\n\r\n\r\n        //浮动页面对\r\n        //浮动对象比任何层级都都要高\r\n        //超过母版\r\n        if (data.floatPages.ids && data.floatPages.ids.length) {\r\n            createFloatPage(this, data, complete);\r\n        }\r\n\r\n        //如果存在母版浮动节点\r\n        //在创建节点structure中过滤出来，根据参数的tipmost\r\n        if (data.floatMaters.ids && data.floatMaters.ids.length) {\r\n            createFloatMater(this, data, complete);\r\n        }\r\n\r\n\r\n        //iboosk节点预编译\r\n        //在执行的时候节点已经存在\r\n        //不需要在创建\r\n        if (Xut.IBooks.runMode()) {\r\n            complete();\r\n        } else {\r\n            //正常对象\r\n            Xut.nextTick({\r\n                'container': data.element,\r\n                'content': toArray(data.contentsFragment)\r\n            }, complete);\r\n        }\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 中断四：渲染content\r\n * @return {[type]} [description]\r\n */\r\ntaskProto.applyAfterCheck = function() {\r\n    this.assert('applyAfter', function() {\r\n        //构建页面节点\r\n        // Xut.log('debug', '第' + (self.pid + 1) + '页面content相关的节点与事件全部构建完毕................')\r\n        this.loadComplete(true);\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 清理引用\r\n * @return {[type]} [description]\r\n */\r\ntaskProto.clearReference = function() {\r\n    //删除字幕用的碎片文档\r\n    if (Xut.Contents.contentsFragment[this.chapterId]) {\r\n        delete Xut.Contents.contentsFragment[this.chapterId]\r\n    }\r\n    this.element = null;\r\n    this.rootNode = null;\r\n    this.contentsFragment = null;\r\n}\r\n\r\n\r\n\r\n/** 配置ID\r\n * @return {[type]} [description]\r\n */\r\nfunction autoUUID() {\r\n    return 'autoRun-' + Math.random().toString(36).substring(2, 15)\r\n}\r\n\r\n\r\n/**\r\n * 给所有content节点绑定对应的事件与动画\r\n * @return {[type]} [description]\r\n */\r\nfunction contentsBehavior(callback, data, contentDas) {\r\n    var compiler,\r\n        element          = data.element,\r\n        eventRelated     = data.eventRelated, //合集事件\r\n        pid              = data.pid,\r\n        createActivitys  = data.createActivitys,\r\n        feedbackBehavior = data.feedbackBehavior, //反馈数据,跟事件相关\r\n        pageBaseHooks    = data.pageBaseHooks,\r\n        pageId           = data.chapterId;\r\n\r\n\r\n    //如果有浮动对象,才需要计算偏移量\r\n    //母版里面可能存在浮动或者不浮动的对象\r\n    //那么在布局的时候想对点不一样\r\n    //如果在浮动区域就取浮动初始值\r\n    //否则就是默认的想对点0\r\n    var transformOffset = function(ids, initTransformOffset) {\r\n        return function(id) {\r\n            //匹配是不是属于浮动对象\r\n            if (ids.length && ids[id]) {\r\n                //初始化容器布局的坐标\r\n                return initTransformOffset\r\n            }\r\n            return 0\r\n        }\r\n    }(data.floatMaters.ids, data.initTransformParameter[2]);\r\n\r\n\r\n    //相关回调\r\n    var relatedCallback = {\r\n        //绑定卷滚条钩子\r\n        'iscrollHooks': [],\r\n        //contetn钩子回调\r\n        'contentsHooks': pageBaseHooks.collector.contents\r\n    }\r\n\r\n    //相关数据\r\n    var relatedData = {\r\n        'floatMaters'        : data.floatMaters,\r\n        'seasonId'           : data.chpaterData.seasonId,\r\n        'pageId'             : pageId,\r\n        'contentDas'         : contentDas, //所有的content数据合集\r\n        'container'          : data.liRootNode,\r\n        'seasonRelated'      : data.seasonRelated,\r\n        'containerPrefix'    : data.containerPrefix,\r\n        'nodes'              : data.nodes,\r\n        'pageOffset'         : data.pageOffset,\r\n        'createContentIds'   : data.createContentIds,\r\n        'partContentRelated' : data.partContentRelated,\r\n        'transformOffset'    : transformOffset,\r\n        'contentsFragment'   : data.contentsFragment,\r\n        'contentHtmlBoxIds'  : data.contentHtmlBoxIds\r\n    }\r\n\r\n \r\n    /**\r\n     * 继续下一个任务\r\n     * @return {[type]} [description]\r\n     */\r\n    var nextTask = function() {\r\n        //多事件合集处理pagebase\r\n        if (eventRelated) {\r\n            pageBaseHooks.eventBinding && pageBaseHooks.eventBinding(eventRelated)\r\n        }\r\n        //删除钩子\r\n        delete relatedCallback.contentsHooks;\r\n        callback(relatedCallback)\r\n    }\r\n\r\n    /**\r\n     * 2016.4.11\r\n     * canvas模式创建的才完成数\r\n     * 监控完成度\r\n     * 如果是canvas就需要监听创建\r\n     * 因为存在异步创建\r\n     * @type {Object}\r\n     */\r\n    var monitor = {\r\n        total: createActivitys.length,\r\n        current: 0,\r\n        complete: function() {\r\n            ++monitor.current\r\n            if (monitor.current == monitor.total) {\r\n                nextTask();\r\n            }\r\n        }\r\n    }\r\n\r\n   /**\r\n     * 收集事件信息\r\n     * 为处理动态分段绑定的问题\r\n     * @type {Object}\r\n     */\r\n    var collectEventRelated = {};\r\n\r\n    /**\r\n     * 生成activty控制对象\r\n     * @type {[type]}\r\n     */\r\n    while (compiler = createActivitys.shift()) {\r\n\r\n        var filters;\r\n        var imageId        = compiler['imageIds']; //父id\r\n        var activity       = compiler['activity'];\r\n        var eventType      = activity.eventType;\r\n        var dragdropPara   = activity.para1;\r\n        var eventContentId = imageId;\r\n\r\n        /**\r\n         * 多事件数据过滤\r\n         * 为了防止数据写入错误数据\r\n         * 如果当前对象上有多事件的行为\r\n         * 则默认的事件去掉\r\n         * @type {[type]}\r\n         */\r\n        if (filters = eventRelated['eventContentId->' + imageId]) {\r\n            _.each(filters, function(edata) {\r\n                //id不需要\r\n                //eventContentId = void 0;\r\n                if (edata.eventType == activity.eventType) {\r\n                    //写入的是伪数据,此行为让多事件抽象接管\r\n                    eventType = dragdropPara = void 0;\r\n                }\r\n            })\r\n        }\r\n\r\n        //需要绑定事件的数据\r\n        var eventData = {\r\n            'eventContentId'   : eventContentId,\r\n            'eventType'        : eventType,\r\n            'dragdropPara'     : dragdropPara,\r\n            'feedbackBehavior' : feedbackBehavior\r\n        }\r\n\r\n        //缓存所有的事件数据\r\n        if (eventContentId) {\r\n            collectEventRelated[eventContentId] = eventData;\r\n            relatedData['collectEventRelated'] = collectEventRelated;\r\n        }\r\n\r\n\r\n        //注册引用\r\n        pageBaseHooks.registerAbstractActivity(\r\n            new activityClass({\r\n                'monitorComplete' : monitor.complete, //监听完成\r\n                'pageIndex'       : data.pageIndex,\r\n                'canvasRelated'   : data.canvasRelated, //父类引用\r\n                'id'              : imageId || autoUUID(),\r\n                \"type\"            : 'Content',\r\n                'pageId'          : pageId,\r\n                'activityId'      : activity._id,\r\n                'rootNode'        : element,\r\n                'pageType'        : compiler['pageType'], //构建类型 page/master\r\n                'seed'            : compiler['seed'], //动画表数据 or 视觉差表数据\r\n                \"pid\"             : pid, //页码\r\n                'eventData'       : eventData, //事件数据\r\n                'relatedData'     : relatedData, //相关数据,所有子作用域Activity对象共享\r\n                'relatedCallback' : relatedCallback //相关回调\r\n            })\r\n        );\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * 解析出需要构建的content对象\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nfunction parseContents(data) {\r\n    var actType,\r\n        preCompileContent = [];\r\n\r\n    //需要创建的数据结构\r\n    _.each(data.activitys, function(activityData) {\r\n        actType = activityData.actType || activityData.animation;\r\n        //特殊类型 showNote\r\n        if (!actType && activityData.note) {\r\n            activityData['actType'] = actType = \"ShowNote\";\r\n        }\r\n        if (activityData.itemArray || activityData.autoPlay !== 2) {\r\n            switch (actType) {\r\n                case 'Container':\r\n                case 'Content':\r\n                case 'Parallax':\r\n                case 'Contents':\r\n                    preCompileContent.push(activityData);\r\n                    //compileContent();\r\n                    break;\r\n            }\r\n        }\r\n        //编译content类型\r\n        // 1 通过Animation表产生\r\n        // 2 通过Parallax 表产生\r\n        function compileContent() {\r\n            preCompileContent.push({\r\n                postprocessor: function(rootEle, pid) {\r\n                    activityData['nodes'] = data['nodes'];\r\n                    activityData['pageOffset'] = data['pageOffset'];\r\n                    return activityData;\r\n                }\r\n            });\r\n        }\r\n    })\r\n    return preCompileContent.length ? preCompileContent : null;\r\n}\r\n\r\n\r\nexport {\r\n    TaskContents\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/contents.js\n **/","/********************************************************\r\n *\r\n *\t数据过滤,去重算法\r\n *\tcontent数据解析息息相关的方法\r\n *\r\n *======================================================*/\r\n\r\nimport { parseJSON, arrayUnique, contentCache } from '../../../util/index'\r\n\r\n\r\n//零件类型,快速判断\r\n//新增content卷滚区域,所有JS零件content\r\n//类型选择,content有扩充的子类型\r\n//针对零件类型在category字段中的子分类\r\nvar widgetType = {};\r\n_.each(\"jsWidget content svgWidget canvasWidget path\".split(\" \"), function(key, name) {\r\n    widgetType[key] = true\r\n});\r\n\r\n\r\n/**\r\n * 类型统一\r\n * @param  {[type]} activity [description]\r\n * @return {[type]}          [description]\r\n */\r\nfunction unifyType(activity) {\r\n    //满足条件统一为零件类型\r\n    return widgetType[activity.category] ? \"JsWidget\" : activity.actType\r\n}\r\n\r\n\r\n/**\r\n * 创建事件容器\r\n * @param  {[type]} eventId [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction createEventContainer(relateds, eventId) {\r\n    if (!relateds.seasonRelated[eventId]) {\r\n        relateds.seasonRelated[eventId] = {}\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 配合出item中相关信息\r\n * 1.场景信息\r\n * 2.收费信息\r\n * @param  {[type]} tokens [description]\r\n * @return {[type]}        [description]\r\n */\r\nfunction adapterItemArrayRelated(relateds, activitys, tokens) {\r\n    //如果分解出节信息\r\n    var seasonId,\r\n        inAppValue,\r\n        chapterId,\r\n        values,\r\n        eventId = activitys.imageId;\r\n\r\n    _.each(['seasonId', 'Inapp', 'SearchBar', 'BookMarks'], function(type) {\r\n        values = tokens[type];\r\n        //如果有值\r\n        if (values !== undefined) {\r\n            //创建容器\r\n            createEventContainer(relateds, eventId);\r\n            switch (type) {\r\n                //跳转新场景信息\r\n                case 'seasonId':\r\n                    chapterId = tokens['chapterId'] || tokens['chapter'];\r\n                    relateds.seasonRelated[eventId] = {\r\n                        seasonId: values[0],\r\n                        chapterId: chapterId ? chapterId[0] : ''\r\n                    };\r\n                    break;\r\n                    //收费信息,给事件上绑定收费接口\r\n                    //0 收费 1 已收费\r\n                case 'Inapp':\r\n                    relateds.seasonRelated[eventId]['Inapp'] = values[0];\r\n                    break;\r\n                default:\r\n                    //搜索栏\r\n                    //书签\r\n                    relateds.seasonRelated[eventId][type] = eventId;\r\n                    break\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\n\r\n////////////\r\n//解析相关数据 //\r\n//解析每一条 Activitys 对应的数据结构\r\n////////////\r\nfunction parserRelated(compileActivitys, data) {\r\n\r\n    var activitys,\r\n        hookType,\r\n        resultsActivitys, //结果结合\r\n        i        = compileActivitys.length,\r\n        pageType = data.pageType,\r\n        pid      = data.pid,\r\n\r\n        /**\r\n         * 相关数据合集\r\n         * @type {Object}\r\n         */\r\n        activityRelated = [], //Activit合集相关数据信息\r\n        tempRelated     = [], //临时数据\r\n\r\n        /**\r\n         * 解析出来的相关信息\r\n         * @type {Object}\r\n         */\r\n        relateds = {\r\n            seasonRelated      : {}, //节信息\r\n            containerRelated   : [], //容器合集相关数据信息\r\n            eventRelated       : {}, //多事件容器合集\r\n            partContentRelated : []  //卷滚conten只创建,不处理行为\r\n        };\r\n\r\n\r\n    /**\r\n     * 创建解析\r\n     * @param  {Function} callback [description]\r\n     * @return {[type]}            [description]\r\n     */\r\n    var createResolve = function(callback) {\r\n        return resolveContentToActivity(function(tokens) {\r\n            return callback(tokens);\r\n        }, activitys, pageType, pid)\r\n    }\r\n\r\n\r\n    /**\r\n     * 类型处理器\r\n     * 除去动画的其余处理类型\r\n     * @type {Object}\r\n     */\r\n    var hookResolve = {\r\n\r\n        /**\r\n         * 单独处理容器类型\r\n         * @param  {[type]} relateds [description]\r\n         * @return {[type]}          [description]\r\n         */\r\n        \"Container\": function() {\r\n            relateds.containerRelated.push(\r\n                createResolve(function(tokens) {\r\n                    return {\r\n                        'Container': tokens['Content']\r\n                    }\r\n                })\r\n            )\r\n        },\r\n\r\n        /**\r\n         * 多事件\r\n         * @param  {[type]} relateds [description]\r\n         * @return {[type]}          [description]\r\n         */\r\n        \"Contents\": function() {\r\n            var item;\r\n            if (item = createResolve(function(tokens) {\r\n                    return {\r\n                        'Contents': [tokens]\r\n                    }\r\n                })[0]) {\r\n                //给content注册多个绑定事件\r\n                var eventId = activitys.imageId;\r\n                var eventData = {\r\n                    'eventContentId' : eventId,\r\n                    'activityId'     : activitys._id,\r\n                    'registers'      : item['activity'],\r\n                    'eventType'      : activitys.eventType,\r\n                    'dragdropPara'   : activitys.para1 //拖拽对象\r\n                }\r\n                var isEvt = relateds.eventRelated['eventContentId->' + eventId];\r\n                if (isEvt) {\r\n                    isEvt.push(eventData);\r\n                } else {\r\n                    relateds.eventRelated['eventContentId->' + eventId] = [eventData]\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * 所有js零件\r\n         * @param  {[type]} relateds [description]\r\n         * @return {[type]}          [description]\r\n         */\r\n        \"JsWidget\": function() {\r\n            var scrollContents = parseJSON(activitys.itemArray);\r\n            if (_.isArray(scrollContents)) {\r\n                _.each(scrollContents, function(data) {\r\n                    relateds.partContentRelated.push(data.id)\r\n                })\r\n            } else {\r\n                relateds.partContentRelated.push(scrollContents.id);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * 解析出当前页面的所有的Activit表\r\n     * 1个chpater页面 可以对应多个Activit表中的数据\r\n     * 1 Container 容器类型\r\n     * 2 page 类型\r\n     * 3 parallax 类型\r\n     * 4 Scenario 类型\r\n     * 5 content合集 contents处理\r\n     *\r\n     */\r\n    while (activitys = compileActivitys.shift()) {\r\n\r\n        //统一类型\r\n        hookType = unifyType(activitys);\r\n\r\n        //类型匹配\r\n        if (!hookResolve[hookType]\r\n            /////////////////\r\n            ///钩子事件\r\n            ////////////////\r\n            || (hookResolve[hookType] && hookResolve[hookType](relateds)) ) {\r\n\r\n\r\n            /////////////////////\r\n            //Content类型处理 //\r\n            /////////////////////\r\n\r\n            //如果是动画表,视觉差表关联的content类型\r\n            resultsActivitys = createResolve(function(tokens) {\r\n\r\n                //解析itemArray字段中的相关的信息\r\n                adapterItemArrayRelated(relateds, activitys, tokens);\r\n\r\n                //解析表数据\r\n                switch (pageType) {\r\n                    case 'page':\r\n                        return parseTypeRelation(['Animation'], tokens)\r\n                    case 'master':\r\n                        //新增第三个参数，\r\n                        //视觉差支持所有content动画\r\n                        return parseTypeRelation(['Animation', 'Parallax'], tokens);\r\n                }\r\n\r\n            });\r\n\r\n\r\n            //如果有手动触发器,置于最后\r\n            if (activitys.imageId) {\r\n                tempRelated.push(resultsActivitys);\r\n            } else {\r\n                activityRelated.push(resultsActivitys);\r\n            }\r\n        }\r\n    }\r\n\r\n    //合并排序\r\n    if (tempRelated.length) {\r\n        activityRelated = activityRelated.concat(tempRelated);\r\n    }\r\n\r\n    /**\r\n     *\t过滤出与创建相关的content合集ID\r\n     *\treturn [\r\n     *\t\tcreateEventIds  主content列表 (用来绑定eventType事件)\r\n     *\t    createContentIds 合并所有content操作后,过滤掉重复的content,得到可以创建的content的ID合集\r\n     *\t]\r\n     *\r\n     * \twContentRelated  混入合并的数据\r\n     * partContentRelated 需要过滤的数据\r\n     */\r\n    // console.log(activityRelated.slice(0))\r\n    var createEventIds,\r\n        createContentIds,\r\n        cacheUUID = 'createRelevant-' + data.chapterId,\r\n        createRelevant = contentCache[cacheUUID];\r\n\r\n    //创建缓存\r\n    if (!createRelevant) {\r\n        createRelevant = contentCache(cacheUUID,\r\n            toRepeatCombineGroup(activityRelated, relateds.partContentRelated, pageType));\r\n    }\r\n\r\n    createEventIds   = createRelevant[0].slice(0);\r\n    createContentIds = createRelevant[1].slice(0);\r\n\r\n    //如果存在过滤器\r\n    if (Xut.CreateFilter.size()) {\r\n        var filterEach = Xut.CreateFilter.each(data.chapterId)\r\n        if (filterEach) {\r\n            filterEach(createEventIds, function(indexOf) {\r\n                createEventIds.splice(indexOf, 1)\r\n            })\r\n            filterEach(createContentIds, function(indexOf) {\r\n                createContentIds.splice(indexOf, 1)\r\n            })\r\n            filterEach = null;\r\n        }\r\n    }\r\n\r\n    return _.extend(data, relateds, {\r\n        'createEventIds'              : createEventIds, //事件ID数\r\n        'createContentIds'            : createContentIds, //创建的content总ID数\r\n        // 'originalCreateContentIds' : createContentIds.slice(0), //保留原始的创建副本\r\n        'createActivitys'             : activityRelated\r\n    });\r\n};\r\n\r\n\r\n/**************************************************************************\r\n *\r\n * \t\t分组Content表中对应的多个Conte\r\n *   \t1：Animation表\r\n *    \t2: Parallax表\r\n *     \t3: seed种子合集 就是解析1：Animation表，Parallax表得到的数据\r\n *\r\n ****************************************************************************/\r\nfunction resolveContentToActivity(callback, activity, pageType, pid) {\r\n    var animContentIds,\r\n        paraContentIds,\r\n        parallaxRelated,\r\n        parallaxDas,\r\n        animRelated,\r\n        animationDas = '',\r\n        eventId = activity.imageId,\r\n        //需要分解的contentIds合集\r\n        // 1 动画表数据\t\tAnimation\r\n        // 2 视觉差数据     Parallax\r\n        // 3 超链接\t\t\tseasonId\r\n        // 4 收费\t\t\tInapp\r\n        tokens = tokenize(activity['itemArray']) || [],\r\n        //解析Animations,Parallaxs数据\r\n        //\tseed {\r\n        //\t\tAnimation:[data,Ids]\r\n        //\t\tParallax:[data,Ids]\r\n        //\t}\r\n        seed = callback(tokens),\r\n\r\n        //判断类型\r\n        type = Object.keys(seed)[0];\r\n\r\n\r\n    /**\r\n     * 去重事件ID\r\n     * original  原ID合集\r\n     * detection 需要检测去重的ID\r\n     *\r\n     */\r\n    function toRepeatContents(original) {\r\n        if (original && eventId) {\r\n            var indexOf = original.indexOf(eventId);\r\n            if (-1 !== indexOf) {\r\n                original.splice(indexOf, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    switch (type) {\r\n        //容器\r\n        case 'Container':\r\n            animContentIds = seed.Container;\r\n            toRepeatContents(animContentIds);\r\n            break;\r\n            //多事件处理\r\n        case 'Contents':\r\n            return seed.Contents;\r\n        default:\r\n            /**\r\n             * 如果是对象处理，\r\n             * 针对动画表，视觉差表,行为的处理\r\n             */\r\n            //需要创建的content合集\r\n            if (_.keys(seed).length) {\r\n                animRelated = seed.Animation;\r\n                parallaxRelated = seed.Parallax;\r\n                //页面模式\r\n                if (pageType === 'page') {\r\n                    if (animRelated) {\r\n                        animContentIds = animRelated.ids;\r\n                        animationDas = animRelated.das;\r\n                    }\r\n                } else {\r\n                    //视觉差存在视觉差表处理\r\n                    // console.log(1111,animRelated, parallaxRelated)\r\n                    //母版的动画数据\r\n                    if (animRelated) {\r\n                        animContentIds = animRelated.ids;\r\n                        animationDas = animRelated.das;\r\n                    }\r\n                    //母版的视察数据\r\n                    if (parallaxRelated) {\r\n                        paraContentIds = parallaxRelated.ids;\r\n                        parallaxDas = parallaxRelated.das;\r\n                    }\r\n                }\r\n\r\n                //如果id都存在\r\n                //合并\r\n                if (animContentIds && paraContentIds) {\r\n                    animContentIds = animContentIds.concat(paraContentIds)\r\n                }\r\n\r\n                //只存在视察\r\n                if (!animContentIds && paraContentIds) {\r\n                    animContentIds = paraContentIds;\r\n                }\r\n                toRepeatContents(animContentIds);\r\n            }\r\n            break;\r\n    }\r\n\r\n\r\n    //创建对象是层次关系\r\n    return {\r\n        'pageType': pageType,\r\n        'activity': activity,\r\n        'imageIds': eventId,\r\n        //data\r\n        'seed': {\r\n            'animation': animationDas,\r\n            'parallax': parallaxDas\r\n        },\r\n        //id\r\n        'ids': {\r\n            'content': animContentIds,\r\n            'parallax': paraContentIds\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/************************************************************************\r\n *\r\n *     合并,过滤需要处理的content\r\n *     combineImageIds  可以创建的imageId合集，也就是content的合集,用来绑定自定义事件\r\n *     createContentIds 可以创建的content合集,过滤合并重复\r\n *\r\n * **********************************************************************/\r\nfunction toRepeatCombineGroup(compilerActivitys, mixFilterRelated, pageType) {\r\n    var ids,\r\n        contentIds,\r\n        needCreateContentIds,\r\n        imageIds,\r\n        activityRelated,\r\n        parallaxId,\r\n        combineItemIds = [],\r\n        combineImageIds = [],\r\n        i = compilerActivitys.length;\r\n\r\n    function pushCache(target, original, callback) {\r\n        var id,\r\n            i = original.length;\r\n        while (i--) {\r\n            id = Number(original[i]);\r\n            target.push(id)\r\n            callback && callback(id);\r\n        }\r\n    }\r\n\r\n    while (i--) {\r\n        //开始执行过滤操作\r\n        activityRelated = compilerActivitys[i];\r\n        ids             = activityRelated.ids;\r\n        contentIds      = ids.content;\r\n        parallaxId      = ids.parallax; //浮动类型的对象\r\n        imageIds        = activityRelated.imageIds;\r\n\r\n        //针对普通content对象\r\n        if (contentIds && contentIds.length) { //如果不为空\r\n            pushCache(combineItemIds, contentIds);\r\n        }\r\n\r\n        //视察对象\r\n        if (parallaxId && parallaxId.length) { //如果不为空\r\n            pushCache(combineItemIds, parallaxId);\r\n        }\r\n\r\n        //事件合集\r\n        if (imageIds) {\r\n            combineImageIds.push(Number(imageIds))\r\n        }\r\n    }\r\n\r\n    //混入外部合并了逻辑\r\n    if (mixFilterRelated && mixFilterRelated.length) {\r\n        _.each(mixFilterRelated, function(data) {\r\n            if (data) {\r\n                combineItemIds = combineItemIds.concat(data)\r\n            }\r\n        })\r\n    }\r\n\r\n    //过滤合并多个content数据\r\n    if (combineImageIds.length) {\r\n        needCreateContentIds = arrayUnique(combineItemIds.concat(combineImageIds));\r\n    } else {\r\n        needCreateContentIds = arrayUnique(combineItemIds);\r\n    }\r\n\r\n    //排序\r\n    needCreateContentIds = needCreateContentIds.sort(function(a, b) {\r\n        return a - b;\r\n    });\r\n\r\n    /**\r\n     * 合并创建信息\r\n     * 需要创建的事件\r\n     * 需要创建的所有对象\r\n     */\r\n    return [combineImageIds, needCreateContentIds];\r\n}\r\n\r\n\r\n\r\n/**\r\n * 解析指定类型数据\r\n * strengthenAnmin 视觉差增强动画表\r\n * @return {[type]}\r\n */\r\nfunction parseTypeRelation(tableName, tokenIds) {\r\n    var tokenId;\r\n    var itemData = {};\r\n    _.each(tableName, function(tName) {\r\n        if (tokenId = tokenIds[tName]) {\r\n            if (itemData[tName]) {\r\n                console.log('未处理解析同一个表')\r\n            } else {\r\n                itemData[tName] = inGroup(tName, tokenId);\r\n            }\r\n        }\r\n    })\r\n    return itemData;\r\n}\r\n\r\n\r\n/**\r\n * 分组\r\n * @return {[type]} [description]\r\n */\r\nfunction inGroup(tableName, contentIds) {\r\n    var k, keyName, data, contentId,\r\n        temp = {},\r\n        das = [],\r\n        ids = [],\r\n        query = Xut.data.query;\r\n\r\n    _.each(contentIds, function(id) {\r\n        if (data = query(tableName, id)) {\r\n            contentId = data.contentId;\r\n            if (-1 === ids.indexOf(contentId)) {\r\n                ids.push(contentId)\r\n            }\r\n            //合并同个contentId多条动画数据的情况\r\n            keyName = \"contentId-\" + contentId;\r\n            if (temp[keyName]) {\r\n                temp[keyName].push(data)\r\n            } else {\r\n                temp[keyName] = [data];\r\n            }\r\n        }\r\n    })\r\n\r\n    //转成数组格式\r\n    for (k in temp) {\r\n        das.push(temp[k])\r\n    }\r\n\r\n    return {\r\n        das: das,\r\n        ids: ids\r\n    }\r\n}\r\n\r\n\r\n//解析itemArray序列,得到对应的id\r\nfunction tokenize(itemArray) {\r\n    var itemJson,\r\n        actType,\r\n        anmins = {};\r\n    if (!itemArray) return;\r\n    itemJson = parseJSON(itemArray);\r\n    //解析多个参数\r\n    if (itemJson.length) {\r\n        _.each(itemJson, function(opts) {\r\n            actType = opts.actType;\r\n            if (!anmins[actType]) {\r\n                anmins[actType] = [];\r\n            }\r\n            anmins[actType].push(opts.id);\r\n        })\r\n    } else {\r\n        actType = itemJson.actType;\r\n        anmins[actType] = [];\r\n        //actType: \"Animation\", id: 14\r\n        //actType: \"Inapp\", value: 0\r\n        anmins[actType].push(itemJson.id || itemJson.value)\r\n    }\r\n    return anmins;\r\n}\r\n\r\n\r\nexport { parserRelated }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/content/data.js\n **/","/**\r\n * 编译content的容器\r\n * 2013.10.12\r\n * 1 为处理重复content数据引用问题,增加\r\n * \t\t\t  makeWarpObj方法,用于隔绝content数据的引用关系，导致重复数据被修正的问题\r\n * 2 多个页面引用同一个content的处理，Conetnt_0_1 ,类型+页码+ID的标示\r\n * @return {[type]} [description]\r\n */\r\n\r\nimport { parseJSON, arrayUnique ,reviseSize,readFile} from '../../../util/index'\r\n\r\nimport { Container as pixiContainer } from '../../../component/pixi/Container'\r\n\r\nlet prefix = Xut.plat.prefixStyle;\r\n\r\n/**\r\n * 解析序列中需要的数据\r\n * @param  {[type]}   contentIds [description]\r\n * @param  {Function} callback   [description]\r\n * @return {[type]}              [description]\r\n */\r\nfunction parseContentDas(contentIds, callback) {\r\n    var data, temp = [];\r\n    contentIds.forEach(function(contentId, index) {\r\n        data = Xut.data.query('Content', contentId)\r\n        temp.unshift(data)\r\n        callback && callback(data, contentId);\r\n    })\r\n    return temp;\r\n}\r\n\r\n/**\r\n * 制作包装对象\r\n * 用于隔绝content数据的引用关系\r\n * 导致重复数据被修正的问题\r\n * @return {[type]}             [description]\r\n */\r\nfunction makeWarpObj(contentId, content, pageType, pid, virtualOffset) {\r\n    //唯一标示符\r\n    var prefix = \"_\" + pid + \"_\" + contentId;\r\n    return {\r\n        pageType: pageType,\r\n        contentId: contentId,\r\n        isJs: /.js$/i.test(content.md5), //html类型\r\n        isSvg: /.svg$/i.test(content.md5), //svg类型\r\n        data: content,\r\n        pid: pid,\r\n        virtualOffset: virtualOffset, //布局位置\r\n        containerName: 'Content' + prefix,\r\n        makeId: function(name) {\r\n            return name + prefix;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 创建图片地址\r\n * @return {[type]}         [description]\r\n */\r\nfunction analysisPath(wrapObj, conData) {\r\n    var pathImg,\r\n        imgContent = conData.md5,\r\n        //是gif格式\r\n        isGif = /.gif$/i.test(imgContent),\r\n        //原始地址\r\n        originalPathImg = Xut.config.pathAddress + imgContent;\r\n\r\n    if (isGif) {\r\n        //处理gif图片缓存+随机数\r\n        pathImg = Xut.createRandomImg(originalPathImg)\r\n    } else {\r\n        pathImg = originalPathImg;\r\n    }\r\n    wrapObj['imgContent'] = imgContent;\r\n    wrapObj['isGif'] = isGif;\r\n    wrapObj['pathImg'] = pathImg;\r\n}\r\n\r\n\r\n/**\r\n * 组成HTML结构\r\n * @param  {[type]} argument [description]\r\n * @return {[type]}          [description]\r\n */\r\nfunction createDom(data, wrapObj) {\r\n    var restr = '';\r\n    //创建包装容器\r\n    restr += createWapper(data, wrapObj);\r\n    //创建内容\r\n    restr += createContent(data, wrapObj);\r\n    restr += \"</div></div>\";\r\n    return restr;\r\n}\r\n\r\n\r\n/**\r\n * 创建包含容器\r\n * @param  {[type]} data    [description]\r\n * @param  {[type]} wrapObj [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction createWapper(data, wrapObj) {\r\n    var wapper, actName, offset, visibility,\r\n        backwidth, backheight, backleft, backtop,\r\n        zIndex = data['zIndex'],\r\n        id = data['_id'],\r\n        containerName = wrapObj.containerName,\r\n        pid = wrapObj.pid,\r\n        makeId = wrapObj.makeId,\r\n        background = data.background ? 'background-image: url(' + Xut.config.pathAddress + data.background + ');' : '';\r\n\r\n    //背景尺寸优先\r\n    if (data.scaleBackWidth && data.scaleBackHeight) {\r\n        backwidth = data.scaleBackWidth;\r\n        backheight = data.scaleBackHeight;\r\n        backleft = data.scaleBackLeft;\r\n        backtop = data.scaleBackTop;\r\n        wrapObj.backMode = true //背景图模式\r\n    } else {\r\n        backwidth = data.scaleWidth;\r\n        backheight = data.scaleHeight;\r\n        backleft = data.scaleLeft;\r\n        backtop = data.scaleTop;\r\n    }\r\n\r\n    //content默认是显示的数据的\r\n    //content.visible = 0\r\n    //如果为1 就隐藏改成hidden\r\n    //05.1.14\r\n    visibility = 'visible'\r\n    if (data.visible) {\r\n        visibility = 'hidden';\r\n    }\r\n\r\n    // var isHtml = \"\";\r\n    //2015.12.29\r\n    //如果是html内容\r\n    if (wrapObj.isJs) {\r\n        //正常content类型\r\n        wapper = '<div id=\"{0}\"' + ' data-behavior=\"click-swipe\"' + ' style=\"overflow:hidden;width:{1}px;height:{2}px;top:{3}px;left:{4}px;position:absolute;z-index:{5};visibility:{6};background-size:100% 100%;{10}\">' + ' <div id=\"{7}\" style=\"width:{8}px;position:absolute;\">';\r\n\r\n        return String.format(wapper,\r\n            containerName, backwidth, backheight, backtop, backleft, zIndex, visibility,\r\n            makeId('contentWrapper'), backwidth, backheight, background\r\n        );\r\n    }\r\n\r\n    //正常content类型\r\n    wapper = '<div id=\"{0}\"' + ' data-behavior=\"click-swipe\"' + ' style=\"overflow:hidden;width:{1}px;height:{2}px;top:{3}px;left:{4}px;position:absolute;z-index:{5};visibility:{6};\">' + ' <div id=\"{7}\" style=\"width:{8}px;height:{9}px;{10}position:absolute;background-size:100% 100%;\">';\r\n\r\n\r\n    return String.format(wapper,\r\n        containerName, backwidth, backheight, backtop, backleft, zIndex, visibility,\r\n        makeId('contentWrapper'), backwidth, backheight, background\r\n    );\r\n}\r\n\r\n\r\n/**\r\n * content\r\n * \tsvg数据\r\n * \thtml数据\r\n * 解析外部文件\r\n * @param  {[type]} wrapObj     [description]\r\n * @param  {[type]} svgCallback [description]\r\n * @return {[type]}             [description]\r\n */\r\nfunction externalFile(wrapObj, svgCallback) {\r\n    //svg零件不创建解析具体内容\r\n    if (wrapObj.isSvg) {\r\n        readFile(wrapObj.data.md5, function(svgdata) {\r\n            wrapObj['svgstr'] = svgdata;\r\n            svgCallback(wrapObj);\r\n        });\r\n    } else if (wrapObj.isJs) {\r\n        //如果是.js的svg文件\r\n        readFile(wrapObj.data.md5, function(htmldata) {\r\n            wrapObj['htmlstr'] = htmldata;\r\n            svgCallback(wrapObj);\r\n        }, \"js\");\r\n    } else {\r\n        svgCallback(wrapObj);\r\n    }\r\n}\r\n\r\n/**\r\n * 创建内容\r\n * @param  {[type]} data    [description]\r\n * @param  {[type]} wrapObj [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction createContent(data, wrapObj) {\r\n    var restr = \"\";\r\n    //如果内容是图片\r\n    //如果是svg或者html\r\n    if (wrapObj.imgContent) {\r\n        //如果是SVG\r\n        if (wrapObj.isSvg) {\r\n            restr += svgContent(data, wrapObj);\r\n        } else if (wrapObj.isJs) {\r\n            //如果是.js结构的html文件\r\n            restr += jsContent(data, wrapObj)\r\n        } else {\r\n            //如果是蒙板，或者是gif类型的动画，给高度\r\n            restr += maskContent(data, wrapObj);\r\n        }\r\n    } else {\r\n        //纯文本文字\r\n        restr += textContent(data, wrapObj);\r\n    }\r\n    return restr;\r\n}\r\n\r\n\r\n/**\r\n * 如果是.js结尾的\r\n * 新增的html文件\r\n * @param  {[type]} data    [description]\r\n * @param  {[type]} wrapObj [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction jsContent(data, wrapObj) {\r\n    return wrapObj[\"htmlstr\"];\r\n}\r\n\r\n/**\r\n * 如果内容是svg\r\n * @param  {[type]} data    [description]\r\n * @param  {[type]} wrapObj [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction svgContent(data, wrapObj) {\r\n    var restr = \"\",\r\n        svgstr = wrapObj['svgstr'],\r\n        scaleWidth = data['scaleWidth'];\r\n\r\n    //从SVG文件中，读取Viewport的值\r\n    if (svgstr != undefined) {\r\n        var startPos = svgstr.search('viewBox=\"');\r\n        var searchTmp = svgstr.substring(startPos, startPos + 64).replace('viewBox=\"', '').replace('0 0 ', '');\r\n        var endPos = searchTmp.search('\"');\r\n        var temp = searchTmp.substring(0, endPos);\r\n        var sptArray = temp.split(\" \");\r\n        var svgwidth = sptArray[0];\r\n        var svgheight = sptArray[1];\r\n\r\n        //svg内容宽度:svg内容高度 = viewBox宽:viewBox高\r\n        //svg内容高度 = svg内容宽度 * viewBox高 / viewBox宽\r\n        var svgRealHeight = Math.floor(scaleWidth * svgheight / svgwidth);\r\n        //如果svg内容高度大于布局高度则添加滚动条\r\n        if (svgRealHeight > (data.scaleHeight + 1)) {\r\n            var svgRealWidth = Math.floor(scaleWidth);\r\n            //if there do need scrollbar, then restore text to its original prop\r\n            //布局位置\r\n            var marginleft = wrapObj['backMode'] ? data.scaleLeft - data.scaleBackLeft : 0;\r\n            var margintop = wrapObj['backMode'] ? data.scaleTop - data.scaleBackTop : 0;\r\n            temp = '<div style=\"width:{0}; height:{1};margin-left:{2}px;margin-top:{3}px;\">{4}</div>';\r\n\r\n            if (data.isScroll) {\r\n                restr = String.format(temp, svgRealWidth + 'px', svgRealHeight + 'px', marginleft, margintop, svgstr);\r\n            } else {\r\n                restr = String.format(temp, '100%', '100%', marginleft, margintop, svgstr);\r\n            }\r\n        } else {\r\n            restr += svgstr;\r\n        }\r\n    }\r\n    return restr;\r\n}\r\n\r\n/**\r\n * 蒙版动画\r\n * @param  {[type]} data    [description]\r\n * @param  {[type]} wrapObj [description]\r\n * @return {[type]}         [description]\r\n */\r\nfunction maskContent(data, wrapObj) {\r\n\r\n    var restr = \"\",\r\n        //如果有蒙版图\r\n        isMaskImg = data.mask ? prefix('mask-box-image') + \":url(\" + Xut.config.pathAddress + data.mask + \");\" : \"\";\r\n\r\n    //蒙板图\r\n    if (data.mask || wrapObj['isGif']) {\r\n        //蒙版图\r\n        if (prefix('mask-box-image') != undefined) {\r\n            restr += String.format(\r\n                '<img' + ' id=\"img_{1}\"' + ' class=\"contentScrollerImg\"' + ' src=\"{0}\"' + ' style=\"width:{2}px;height:{3}px;position:absolute;background-size:100% 100%;{4}\"/>',\r\n                wrapObj['pathImg'], data['_id'], data.scaleWidth, data.scaleHeight, isMaskImg\r\n            );\r\n        } else {\r\n            //canvas\r\n            restr += String.format(\r\n                ' <canvas src=\"{0}\"' + ' class=\"contentScrollerImg edges\"' + ' mask=\"{5}\"' + ' id = \"img_{1}\"' + ' width=\"{2}\"' + ' height=\"{3}\"' + ' style=\"width:{2}px; height:{3}px;opacity:0; background-size:100% 100%; {4}\"' + ' />',\r\n                wrapObj['pathImg'], data['_id'], data.scaleWidth, data.scaleHeight, isMaskImg, Xut.config.pathAddress.replace(/\\//g, \"\\/\") + data.mask);\r\n        }\r\n        //精灵图\r\n    } else if (data.category == 'Sprite') {\r\n\r\n        var matrixX = 100 * data.thecount;\r\n        var matrixY = 100;\r\n  \r\n        //如果有参数\r\n        //精灵图是矩阵图\r\n        if (data.parameter) {\r\n            var parameter = parseJSON(data.parameter);\r\n            if (parameter && parameter.matrix) {\r\n                var matrix = parameter.matrix.split(\"-\")\r\n                matrixX = 100 * Number(matrix[0])\r\n                matrixY = 100 * Number(matrix[1])\r\n            }\r\n        }\r\n        restr += String.format(\r\n            '<div' + ' class=\"sprite\"' + ' style=\"height:{0}px;background-image:url({1});background-size:{2}% {3}%;\"></div>',\r\n            data.scaleHeight, wrapObj['pathImg'], matrixX, matrixY\r\n        );\r\n\r\n    } else {\r\n        //普通图片\r\n        restr += String.format(\r\n            '<img' + ' src=\"{0}\"' + ' class=\"contentScrollerImg\"' + ' id=\"img_{1}\"' + ' style=\"width:{2}px;height:{3}px;position:absolute;background-size:100% 100%; {4}\"/>',\r\n            wrapObj['pathImg'], data['_id'], data.scaleWidth, data.scaleHeight, isMaskImg\r\n        );\r\n    }\r\n\r\n    return restr;\r\n}\r\n\r\n/**\r\n * 纯文本内容\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nfunction textContent(data) {\r\n    return String.format(\r\n        '<div' + ' id = \"{0}\"' + ' style=\"background-size:100% 100%;height:auto\">{1}</div>',\r\n        data['_id'], data.content\r\n    )\r\n}\r\n\r\n\r\n/**\r\n * 针对容器类型的处理\r\n * @param  {[type]} containerName [description]\r\n * @param  {[type]} contentId     [description]\r\n * @param  {[type]} pid     [description]\r\n * @return {[type]}               [description]\r\n */\r\nfunction createContainerWrap(containerName, contentId, pid) {\r\n    var contentDas = parseContentDas([contentId]),\r\n        data = reviseSize(contentDas[0]),\r\n        wapper = '<div' + ' id=\"{0}\"' + ' data-behavior=\"click-swipe\"' + ' style=\"width:{1}px;height:{2}px;top:{3}px;left:{4}px;position:absolute;z-index:{5};\">';\r\n\r\n    return String.format(wapper,\r\n        containerName, data.scaleWidth, data.scaleHeight, data.scaleTop, data.scaleLeft, data.zIndex)\r\n}\r\n\r\nfunction createContainer(containerRelated, pid) {\r\n    var itemIds, uuid, contentId,\r\n        containerName,\r\n        containerObj = {\r\n            createUUID: [],\r\n            containerName: []\r\n        };\r\n    containerRelated.forEach(function(data, index) {\r\n        contentId = data.imageIds;\r\n        containerName = \"Container_\" + pid + \"_\" + contentId,\r\n            uuid = \"aaron\" + Math.random();\r\n        containerObj[uuid] = {\r\n            'start': [createContainerWrap(containerName, contentId, pid)],\r\n            'end': '</div>'\r\n        };\r\n        containerObj.createUUID.push(uuid);\r\n        containerObj.containerName.push(containerName);\r\n        data.itemIds.forEach(function(id) {\r\n            containerObj[id] = uuid;\r\n        })\r\n    })\r\n    return containerObj;\r\n}\r\n\r\n\r\n//=====================================================\r\n//\r\n//\t构建content的序列tokens\r\n//\tcreateImageIds,\r\n//\tcreateContentIds\r\n//\tpid,\r\n//\tpageType,\r\n//\tdydCreate //重要判断,动态创建\r\n//\r\n//=======================================================\r\nexport function structure(callback, data, context) {\r\n    var content,\r\n        contentId,\r\n        wrapObj,\r\n        containerObj,\r\n        sizeResults,\r\n        contentCollection,\r\n        contentCount,\r\n        cloneContentCount,\r\n        pid              = data.pid,\r\n        pageType         = data.pageType,\r\n        containerRelated = data.containerRelated,\r\n        seasonRelated    = data.seasonRelated,\r\n        isMaster         = pageType === 'master',\r\n\r\n        //容器li生成的位置\r\n        //left,right\r\n        virtualOffset = data.virtualOffset,\r\n\r\n        ////////////\r\n        //浮动处理 //\r\n        //1.浮动母版对象\r\n        //2.浮动页面对象\r\n        ////////////\r\n        floatMaters = data.floatMaters,\r\n        floatPages  = data.floatPages,\r\n\r\n        //文本框\r\n        //2016.1.7\r\n        contentHtmlBoxIds = [],\r\n\r\n        //所有content的id记录\r\n        //返回出去给ibooks预编译使用\r\n        idFix = [],\r\n\r\n        //默认canvas容器的层级\r\n        //取精灵动画最高层级\r\n        //2016.2.25\r\n        canvasIndex = 1,\r\n\r\n        //缓存contentDas\r\n        contentDas = {},\r\n        //缓存content结构\r\n        cachedContentStr = [];\r\n\r\n\r\n    //启动cnavas模式\r\n    var canvasRelatedMode = data.canvasRelated.enable;\r\n\r\n\r\n    //容器结构创建 \r\n    if (containerRelated && containerRelated.length) {\r\n        containerObj = createContainer(containerRelated, pid);\r\n    }\r\n\r\n\r\n    //========================================\r\n    //\r\n    //\t    创建dom结构\r\n    //\r\n    //========================================\r\n\r\n\r\n    /**\r\n     * 转化canvas模式 contentMode 0/1\r\n     * 页面或者母板浮动对象\r\n     * 页面是最顶级的\r\n     * @return {[type]}           [description]\r\n     */\r\n    var eachPara = function(parameter, contentId, conData) {\r\n        var zIndex;\r\n        _.each(parameter, function(para) {\r\n            //针对母版content的topmost数据处理，找出浮动的对象Id\r\n            //排除数据topmost为0的处理\r\n            zIndex = para['topmost']\r\n            if (zIndex && zIndex != 0) {\r\n                if (isMaster) {\r\n                    //收集浮动的母版对象id\r\n                    floatMaters.ids.push(contentId)\r\n                    floatMaters.zIndex[contentId] = zIndex\r\n                } else {\r\n                    //浮动页面\r\n                    floatPages.ids.push(contentId)\r\n                    floatPages.zIndex[contentId] = zIndex\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    /**\r\n     * 设置canvas数据\r\n     */\r\n    var createCanvasData = function(type, contentId, conData) {\r\n        //content收集id标记\r\n        //cid =>content=> 普通动画 ppt\r\n        //wid =>widget=>高级动画 \r\n        if (data.canvasRelated[type].indexOf(contentId) == -1) {\r\n            data.canvasRelated[type].push(contentId);\r\n            conData.actionTypes[type] = true;\r\n        }\r\n\r\n        if (data.canvasRelated.cid.indexOf(contentId) == -1) {\r\n            data.canvasRelated.cid.push(contentId);\r\n        }\r\n\r\n        //给content数据增加直接判断标示\r\n        conData.canvasMode = true;\r\n\r\n        //拿到最高层级\r\n        if (conData.zIndex) {\r\n            if (conData.zIndex > canvasIndex) {\r\n                canvasIndex = conData.zIndex;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * canvas pixi.js类型处理转化\r\n     * 填充cid, wid\r\n     * @type {Object}\r\n     */\r\n    var pixiType = {\r\n        //普通精灵动画\r\n        \"Sprite\": function(contentId, conData) {\r\n            //启动精灵模式\r\n            //在动画处理的时候给initAnimations快速调用\r\n            createCanvasData('spiritId', contentId, conData)\r\n        },\r\n        //ppt=》pixi动画\r\n        \"PPT\": function(contentId, conData) {\r\n            createCanvasData('pptId', contentId, conData)\r\n        },\r\n        //高级精灵动画\r\n        //widget\r\n        \"SeniorSprite\": function(contentId, conData) {\r\n            createCanvasData('widgetId', contentId, conData)\r\n        },\r\n    }\r\n\r\n\r\n    /**\r\n     * 开始过滤参数\r\n     * @return {[type]}           [description]\r\n     */\r\n    var prefilter = function(conData, contentId) {\r\n        var eventId, parameter;\r\n        var category = conData.category;\r\n\r\n        //如果是模板书签，强制为浮动对象\r\n        if (isMaster && (eventId = seasonRelated[contentId])) {\r\n            if (eventId['BookMarks']) {\r\n                floatMaters.ids.push(contentId)\r\n            }\r\n        }\r\n\r\n        //如果有parameter参数\r\n        //1 浮动对象\r\n        //2 canvas对象\r\n        if (conData) {\r\n            //转成canvas标记\r\n            //如果有pixi的处理类型\r\n            //2016.2.25\r\n            //SeniorSprite,PPT\r\n            //Sprite,PPT\r\n            //SeniorSprite\r\n            //Sprite\r\n            //PPT\r\n            //5种处理方式\r\n            //可以组合\r\n            if (canvasRelatedMode && category) {\r\n                var _cat;\r\n                var cat;\r\n                var _cats = category.split(\",\");\r\n                var i = _cats.length;\r\n                //动作类型\r\n                conData.actionTypes = {};\r\n                if (i) {\r\n                    while (i--) {\r\n                        cat = _cats[i]\r\n                            //匹配数据类型\r\n                        pixiType[cat] && pixiType[cat](contentId, conData)\r\n                    }\r\n                }\r\n            }\r\n\r\n            //如果有parameter\r\n            if (conData.parameter) {\r\n                if (parameter = parseJSON(conData.parameter)) {\r\n                    //parameter保持数组格式\r\n                    eachPara(parameter.length ? parameter : [parameter], contentId, conData)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 解析出每一个content对应的动作\r\n     * 传递prefilter过滤器\r\n     * 1 浮动动作\r\n     * 2 canvas动作\r\n     * @type {[type]}\r\n     */\r\n    contentCollection = parseContentDas(data.createContentIds, prefilter);\r\n    contentCount = cloneContentCount = contentCollection.length;\r\n\r\n    //创建canvas画布 \r\n    if (canvasRelatedMode) {\r\n        pixiContainer(data, canvasIndex)\r\n    }\r\n\r\n    ////////////////\r\n    //开始生成所有的节点 //\r\n    //1:dom\r\n    //2:canvas\r\n    ////////////////\r\n    while (contentCount--) {\r\n\r\n        //根据数据创content结构\r\n        if (content = contentCollection[contentCount]) {\r\n            contentId = content['_id'];\r\n            //创建包装器,处理数据引用关系\r\n            wrapObj = makeWarpObj(contentId, content, pageType, pid, virtualOffset);\r\n            idFix.push(wrapObj.containerName)\r\n\r\n            //保存文本框content的Id\r\n            if (wrapObj.isJs) {\r\n                contentHtmlBoxIds.push(contentId)\r\n            }\r\n            //转换缩放比\r\n            sizeResults = reviseSize(wrapObj.data);\r\n\r\n            //如果启用了virtualMode模式\r\n            //对象需要分离创建\r\n            if (Xut.config.virtualMode) {\r\n                virtualCreate(sizeResults, wrapObj, content, contentId);\r\n            } else {\r\n                //正常模式下创建\r\n                startCreate(wrapObj, content, contentId)\r\n            }\r\n        } else {\r\n            //或者数据出错\r\n            checkComplete();\r\n        }\r\n    }\r\n\r\n\r\n    //开始创建节点\r\n    function startCreate(wrapObj, content, contentId) {\r\n        //缓存数据\r\n        contentDas[contentId] = content;\r\n        //开始创建\r\n        createRelated(contentId, wrapObj)\r\n    }\r\n\r\n\r\n    /**\r\n     * 清理剔除的content\r\n     * @param  {[type]} contentId [description]\r\n     * @return {[type]}           [description]\r\n     */\r\n    function clearContent(contentId) {\r\n        data.createContentIds.splice(data.createContentIds.indexOf(contentId), 1);\r\n        checkComplete();\r\n    }\r\n\r\n\r\n    /**\r\n     * 虚拟模式区分创建\r\n     * @param  {[type]} sizeResults [description]\r\n     * @param  {[type]} wrapObj     [description]\r\n     * @param  {[type]} content     [description]\r\n     * @param  {[type]} contentId   [description]\r\n     * @return {[type]}             [description]\r\n     */\r\n    function virtualCreate(sizeResults, wrapObj, content, contentId) {\r\n        // 创建分布左边的对象\r\n        if (wrapObj.virtualOffset === 'left') {\r\n            if (sizeResults.scaleLeft < Xut.config.screenSize.width) {\r\n                startCreate(wrapObj, content, contentId)\r\n            } else {\r\n                clearContent(contentId)\r\n            }\r\n        }\r\n        // 创建分布右边的对象\r\n        if (wrapObj.virtualOffset === 'right') {\r\n            if (sizeResults.scaleLeft > Xut.config.screenSize.width) {\r\n                startCreate(wrapObj, content, contentId)\r\n            } else {\r\n                clearContent(contentId)\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 创建content节点\r\n     * @param  {[type]} wrapObj [description]\r\n     * @return {[type]}         [description]\r\n     */\r\n    function createRelated(contentId, wrapObj) {\r\n        //解析外部文件\r\n        externalFile(wrapObj, function(wrapObj) {\r\n            var uuid,\r\n                startStr,\r\n                contentStr,\r\n                conData = wrapObj.data;\r\n\r\n            //拼接地址\r\n            analysisPath(wrapObj, conData)\r\n\r\n            //dom模式下生成dom节点\r\n            //canvas模式下不处理，因为要合并到pixi场景中\r\n            if (!conData.canvasMode) {\r\n                contentStr = createDom(conData, wrapObj)\r\n            }\r\n\r\n            //如果创建的是容器对象\r\n            if (containerObj && (uuid = containerObj[contentId])) {\r\n                startStr = containerObj[uuid];\r\n                startStr.start.push(contentStr)\r\n            } else {\r\n                //普通对象\r\n                cachedContentStr.unshift(contentStr);\r\n            }\r\n\r\n            //检测完毕\r\n            checkComplete();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 返回处理\r\n     * @return {[type]} [description]\r\n     */\r\n    function checkComplete() {\r\n        if (cloneContentCount === 1) {\r\n            //针对容器处理\r\n            if (containerObj) {\r\n                var start, end,\r\n                    containerStr = [];\r\n                //合并容器\r\n                containerObj.createUUID.forEach(function(uuid) {\r\n                    start = containerObj[uuid].start.join('');\r\n                    end = containerObj[uuid].end;\r\n                    containerStr.push(start.concat(end));\r\n                })\r\n                containerStr = containerStr.join('');\r\n                containerName = containerObj.containerName;\r\n                containerObj = null;\r\n                callback.call(context, contentDas, cachedContentStr.join('').concat(containerStr), containerName, idFix, contentHtmlBoxIds);\r\n            } else {\r\n                callback.call(context, contentDas, cachedContentStr.join(''), '', idFix, contentHtmlBoxIds);\r\n            }\r\n        }\r\n        cloneContentCount--;\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * 针对分段处理\r\n * 只构件必要的节点节点对象\r\n * content字段中visible === 0 是构建显示的对象\r\n * \t\t\t\t\t \t=== 1 是构建隐藏的对象\r\n *\r\n * 并且不是动态创建\r\n */\r\n// if (false && (1 == content.visible) && !data.dydCreate) {\r\n// endReturn();  //false 先屏蔽 ，客户端未实现\r\n// }else{}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/content/structure.js\n **/","/*******************************************\r\n *   canvas处理模块\r\n *   2016.2新增机制\r\n *   扩充pixi动画\r\n *                                      *\r\n ******************************************/\r\n\r\n\r\nimport {\r\n    oneQueue, addQueue, removeQueue, destroyQueue\r\n}\r\nfrom './queue'\r\n\r\n\r\n/**\r\n * 制作uuid\r\n * @return {[type]} [description]\r\n */\r\nfunction makeGuid() {\r\n    return Xut.guid('rAF');\r\n}\r\n\r\n \r\n/**\r\n * 创建pipx对象\r\n * @param  {[type]} canvasContainer [description]\r\n * @param  {[type]} wrapObj         [description]\r\n * @return {[type]}                 [description]\r\n */\r\nexport function Container(data, canvasIndex) {\r\n\r\n    var width = Xut.config.screenSize.width;\r\n    var height = Xut.config.screenSize.height;\r\n    var pageIndex = data.pageIndex;\r\n\r\n    var renderer = PIXI.autoDetectRenderer(width, height, {\r\n        transparent: true\r\n    });\r\n    //设置层级关系\r\n    renderer.view.style.position = \"absolute\"\r\n    renderer.view.style.zIndex = canvasIndex;\r\n\r\n    //放入容器\r\n    data.element.append(renderer.view)\r\n\r\n    //根容器\r\n    var containerStage = new PIXI.Container();\r\n\r\n\r\n    //扩充场景处理接口\r\n    var expandRelated = {\r\n        stageWidth: width,\r\n        stageHeight: height,\r\n        container: renderer.view, //canvas容器\r\n        containerStage: containerStage, //根容器\r\n        sprites: {}, //保存精灵合集\r\n\r\n        /**\r\n         * 将子pixi加入进来\r\n         */\r\n        addChild: function(stage) {\r\n            containerStage.addChild(stage);\r\n        },\r\n\r\n        /**\r\n         * 初始化绘制,3秒的时间\r\n         * 尽量保证节点加载完毕\r\n         * @return {[type]} [description]\r\n         */\r\n        display: function() {\r\n            oneQueue(pageIndex, function display() {\r\n                renderer.render(containerStage);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * 绘制一次\r\n         * @return {[type]} [description]\r\n         */\r\n        oneRender: function() {\r\n            renderer.render(containerStage);\r\n        },\r\n\r\n        /**\r\n         * 不断绘制\r\n         * task 外部任务\r\n         * type 执行play的类型 高级，普通精灵\r\n         * @return {[type]} [description]\r\n         */\r\n        play: function(type, task) {\r\n            var uuid = makeGuid();\r\n            addQueue(pageIndex, uuid, function play() {\r\n                task && task()\r\n                renderer.render(containerStage);\r\n            }, type);\r\n            return uuid;\r\n        },\r\n\r\n        /**\r\n         * 停止绘制\r\n         * @return {[type]} [description]\r\n         */\r\n        stop: function(uuid) {\r\n            removeQueue(pageIndex, uuid);\r\n        },\r\n\r\n        /**\r\n         * 销毁\r\n         * @return {[type]} [description]\r\n         */\r\n        destroy: function() {\r\n            if (data.canvasRelated) {\r\n                destroyQueue(pageIndex);\r\n                data.canvasRelated.container = null;\r\n                if (data.canvasRelated.containerStage) {\r\n                    data.canvasRelated.containerStage.removeChildren();\r\n                }\r\n                data.canvasRelated = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    //扩充pixi控制\r\n    _.extend(data.canvasRelated, expandRelated)\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/Container.js\n **/","import {\r\n    hash\r\n}\r\nfrom '../../util/index'\r\n\r\n\r\n/**\r\n * pixi帧队列控制器\r\n * @param  {[type]} Utils        [description]\r\n * @param  {[type]} Config       [description]\r\n * @param  {[type]} pixiFactory) {               var rAF [description]\r\n * @return {[type]}              [description]\r\n */\r\n\r\nvar rAF = function(callback) {\r\n    return window.setTimeout(callback, 1000 / 10);\r\n};\r\n\r\n\r\n//收集绘制内容\r\nvar rQueue = {};\r\n\r\n// $(\"body\").on(\"click\",function(){\r\n//     console.log(rQueue,Xut.Presentation.GetPageObj())\r\n// })\r\n\r\n/**\r\n * 运动动画\r\n * @param  {[type]} activeIndex [description]\r\n * @return {[type]}             [description]\r\n */\r\nfunction requestAnimation(activeIndex) {\r\n    var key, content;\r\n    var queue = rQueue[activeIndex];\r\n    var timeout = 0;\r\n    var state = true\r\n    var clern = function() {\r\n        clearTimeout(timeout)\r\n        timeout = null;\r\n    }\r\n    var run = function() {\r\n        //如果停止\r\n        if (!state) {\r\n            clern();\r\n            return\r\n        }\r\n        if (rQueue[activeIndex]) {\r\n            var fns = queue[\"fns\"];\r\n            //刷新\r\n            for (key in fns) {\r\n                fns[key](); //执行刷新\r\n            }\r\n            // console.log('runRequestAnimation....',activeIndex, Object.keys(fns).length)\r\n            timeout = rAF(function() {\r\n                run()\r\n            })\r\n        }\r\n    }\r\n    run();\r\n    //停止刷新\r\n    this.stop = function() {\r\n            if (state) {\r\n                state = false\r\n                clern()\r\n            }\r\n        }\r\n        //刷新停止\r\n        //外部重新激活\r\n    this.activate = function() {\r\n        if (!state) {\r\n            state = true\r\n            run();\r\n        }\r\n    }\r\n    return this;\r\n}\r\n\r\n\r\n/**\r\n * 检测运行\r\n * @param  {[type]} pageIndex [description]\r\n * @return {[type]}           [description]\r\n */\r\nfunction checkRun(pageIndex) {\r\n    // 活动页面索引\r\n    var activeIndex = Xut.Presentation.GetPageIndex();\r\n    //激活\r\n    if (activeIndex === pageIndex) {\r\n        var queue = rQueue[activeIndex];\r\n        //去重\r\n        if (queue.rAF) {\r\n            queue.rAF.activate();\r\n        } else {\r\n            queue.rAF = new requestAnimation(activeIndex);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/**\r\n * 用于绘制显示的，特殊处理\r\n * 单独只刷新一次\r\n * @return {[type]} [description]\r\n */\r\nexport function oneQueue(fn) {\r\n    var start = (+new Date());\r\n    var timeout;\r\n    var state = true\r\n    var run = function() {\r\n        if (!state) {\r\n            timeout && clearTimeout(timeout)\r\n        }\r\n        timeout = rAF(run)\r\n    }\r\n    if ((+new Date()) - start > 100) {\r\n        state = false\r\n        clearTimeout(timeout)\r\n        timeout = null;\r\n    }\r\n}\r\n\r\n/**\r\n * 加入绘制队列\r\n * @param {[type]} pageIndex [description]\r\n * @param {[type]} key       [description]\r\n * @param {[type]} value     [description]\r\n */\r\nexport function addQueue(pageIndex, key, value, type) {\r\n    // console.log('c',pageIndex,key)\r\n    if (!rQueue[pageIndex]) {\r\n        rQueue[pageIndex] = hash();\r\n        rQueue[pageIndex]['rAF'] = 0;\r\n        rQueue[pageIndex]['fns'] = hash();\r\n        rQueue[pageIndex]['types'] = hash();\r\n        rQueue[pageIndex]['length'] = 0;\r\n        rQueue[pageIndex]['pageIndex'] = pageIndex;\r\n    }\r\n    if (!rQueue[pageIndex]['fns'][key]) {\r\n        rQueue[pageIndex]['fns'][key] = value;\r\n        rQueue[pageIndex]['types'][key] = type\r\n            ++rQueue[pageIndex]['length']\r\n    } else {\r\n        console.log('rQueue' + key + '已存在')\r\n    }\r\n    //开始运行\r\n    checkRun(pageIndex)\r\n}\r\n\r\n/**\r\n * 移除刷新队列\r\n * @param  {[type]} pageIndex [description]\r\n * @param  {[type]} key       [description]\r\n * @return {[type]}           [description]\r\n */\r\nexport function removeQueue(pageIndex, key) {\r\n    if (rQueue[pageIndex] && rQueue[pageIndex]['fns']) {\r\n        delete rQueue[pageIndex]['fns'][key]\r\n        delete rQueue[pageIndex]['types'][key]\r\n            --rQueue[pageIndex]['length']\r\n        if (!Object.keys(rQueue[pageIndex]['fns']).length) {\r\n            if (rQueue[pageIndex].rAF) {\r\n                rQueue[pageIndex].rAF.stop();\r\n            }\r\n        }\r\n    } else {\r\n        console.log('删除的页面不存在')\r\n    }\r\n}\r\n\r\n/**\r\n * 销毁\r\n * @return {[type]} [description]\r\n */\r\nexport function destroyQueue(pageIndex) {\r\n    if (rQueue[pageIndex]) {\r\n        if (rQueue[pageIndex].rAF) {\r\n            rQueue[pageIndex].rAF.stop();\r\n        }\r\n        if (!Object.keys(rQueue[pageIndex]['fns']).length) {\r\n            delete rQueue[pageIndex];\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 查询队列\r\n * @return {[type]} [description]\r\n */\r\nexport function getQueue() {\r\n    return rQueue;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/queue.js\n **/","/*******************************************\r\n *   文本类\r\n *     处理:\r\n *       1 异步转同步deferred处理\r\n *       2 dom结循环创建\r\n *       创建的四种行为\r\n *          1 默认创建结构绑定事件\r\n *          2 用于预先创建activityMode模式,分发动画与事件\r\n *          3 递归创建,关联子热点\r\n *          4 ppt文字动画,不创建主体结构,递归子热点\r\n *                  A 递归处理PPT动画\r\n *                  B 处理同步音频\r\n *                                      *\r\n ******************************************/\r\n\r\n//卷滚\r\nimport { Iscroll } from './iscroll'\r\n\r\n//事件\r\nimport {\r\n    conversionEventType,\r\n    destroyEvents,\r\n    bindEvents as bindContentEvents\r\n}\r\nfrom './event'\r\n\r\n//混入content\r\nimport { Mix } from './mix'\r\n\r\n//content自对象\r\nimport { Child } from './child'\r\n\r\n//搜索\r\nimport { SearchBar } from './searchbar'\r\n\r\n//书签\r\nimport { BookMark } from './bookmark'\r\n\r\n//文本框\r\nimport { HtmlBox } from './htmlbox'\r\n\r\n//pixi事件\r\nimport { bindEvents as bindPixiEvents } from '../pixi/event'\r\n\r\n//任务\r\nimport { createNextTask } from './nexttask'\r\n\r\n\r\n/**\r\n * activity触发器类\r\n * @param  {[type]} data [description]\r\n * @return {[type]}      [description]\r\n */\r\nfunction activityClass(data) {\r\n\r\n    var self = this;\r\n\r\n    _.extend(this, data);\r\n\r\n    /**\r\n     * 2016.4.11\r\n     * 因为canvas模式导致\r\n     * 任务必须等待context上下创建\r\n     * 完成后执行\r\n     * 1 事件\r\n     * 2 预执行\r\n     * @type {Array}\r\n     */\r\n    this.nextTask = createNextTask(this.monitorComplete)\r\n\r\n    /**\r\n     * 初始化自定义事件\r\n     */\r\n    this.createEventRelated();\r\n\r\n    /**\r\n     * 为分段处理,记录需要加载的分段数据\r\n     * @type {Array}\r\n     */\r\n    this.waitCreateContent = [];\r\n\r\n    /**\r\n     * 保存子对象（PPT辅助对象）\r\n     * 1 动画作用域\r\n     * 2 视觉差作用域\r\n     * @type {Array}\r\n     */\r\n    this.abstractContents = Child(this);\r\n\r\n    /**\r\n     * 处理html文本框\r\n     * 2016.1.6\r\n     */\r\n    this.htmlTextBox();\r\n\r\n    /**\r\n     * 注册用户自定义事件\r\n     * dom\r\n     * canvas\r\n     */\r\n    this.registerEvent();\r\n\r\n    /**\r\n     * 构建用户行为\r\n     */\r\n    this.createActions();\r\n\r\n    /**\r\n     * 2016.2.26\r\n     * 修复妙妙学\r\n     * 妙妙客户端处理\r\n     * 点击效果的音频处理\r\n     * @type {Array}\r\n     */\r\n    this._fixAudio = [];\r\n\r\n\r\n    /**\r\n     * 是否正在等待创建的子对象\r\n     * 如果创建比流程先执行完毕\r\n     * @return {[type]}   \r\n     */\r\n    if (this.nextTask.context.wait) {\r\n        this.monitorComplete();\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * 等待创建执行\r\n     * @param  {[type]} this.nextTask.context.length() \r\n     * @return {[type]}                                \r\n     */\r\n    if (this.nextTask.context.length()) {\r\n        this.nextTask.context.wait = true;\r\n        return this;\r\n    }\r\n\r\n    this.monitorComplete();\r\n}\r\n\r\n\r\n\r\nvar activitProto = activityClass.prototype;\r\n\r\n\r\n/*********************************************************************\r\n *                 代码初始化\r\n *                初始基本参数\r\n *                构建动画关系作用域\r\n *                绑定基本事件\r\n **********************************************************************/\r\n\r\n\r\n/**\r\n * 检测是HTML文本框处理\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.htmlTextBox = function() {\r\n    var self = this;\r\n    var eventData = this.eventData;\r\n    var relatedData = this.relatedData;\r\n    var contentHtmlBoxIds = relatedData.contentHtmlBoxIds;\r\n    var contentId;\r\n    var contentName;\r\n    var eventElement;\r\n    //文本框实例对象\r\n    //允许一个activity有多个\r\n    this.htmlBoxInstance = [];\r\n    //创建文本框对象\r\n    if (contentHtmlBoxIds.length && relatedData.contentDas) {\r\n        _.each(relatedData.contentDas, function(cds) {\r\n            if (~contentHtmlBoxIds.indexOf(cds._id)) {\r\n                contentId = cds._id;\r\n                contentName = self._makePrefix('Content', self.pid, contentId);\r\n                //找到对应绑定事件的元素\r\n                eventElement = self._findContentElement(contentName)\r\n                if (!eventElement.attr(\"data-htmlbox\")) {\r\n                    //构建html文本框对象\r\n                    self.htmlBoxInstance.push(new HtmlBox(contentId, eventElement));\r\n                    //增加htmlbox标志去重\r\n                    //多个actictiy共享问题\r\n                    eventElement.attr(\"data-htmlbox\", \"true\")\r\n                }\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n * 保证正确遍历\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.eachAssistContents = function(callback) {\r\n    _.each(this.abstractContents, function(scope) {\r\n        //保存只能处理动画\r\n        //scope.processType === 'animation' || scope.processType === 'both')\r\n        callback.call(this, scope)\r\n    }, this)\r\n}\r\n\r\n\r\n/**\r\n * 初始化PPT动画与音频\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.createActions = function() {\r\n\r\n    var pageId = this.relatedData.pageId,\r\n        rootNode = this.rootNode,\r\n        collectorHooks = this.relatedCallback.contentsHooks,\r\n        pageType = this.pageType;\r\n\r\n    this.eachAssistContents(function(scope) {\r\n\r\n        var context, type, id, isRreRun, parameter;\r\n\r\n        //针对必须创建\r\n        if (!(context = scope.$contentProcess)) {\r\n            return\r\n        };\r\n\r\n        //如果是视觉差对象，也需要实现收集器\r\n        if (scope.processType === 'parallax') {\r\n            collectorHooks(scope.pid, scope.id, scope);\r\n            return;\r\n        }\r\n\r\n        //如果是动画才处理\r\n        id = scope.id,\r\n            isRreRun = scope.isRreRun,\r\n            parameter = scope.getParameter();\r\n\r\n\r\n        //如果不是预生成\r\n        //注册动画事件\r\n        if (isRreRun === undefined) {\r\n            scope.init(id, context, rootNode, pageId, parameter, pageType);\r\n        }\r\n\r\n        //绑定DOM一些属性\r\n        this._repeatBind(id, context, isRreRun, scope, collectorHooks, scope.canvasMode);\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * 检测创建完成度\r\n */\r\nactivitProto._checkCreate = function(callback) {\r\n    var waitCreateContent = this.waitCreateContent;\r\n    if (waitCreateContent && waitCreateContent.length) {\r\n        Mix(this, waitCreateContent, callback);\r\n    } else {\r\n        callback();\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 运行动画\r\n * @param  {[type]} outComplete [动画回调]\r\n * @return {[type]}             [description]\r\n * evenyClick 每次都算有效点击\r\n */\r\nactivitProto.runEffects = function(outComplete, evenyClick) {\r\n\r\n    var self = this;\r\n    var pageId = this.relatedData.pageId;\r\n\r\n    if (evenyClick) {\r\n        self.preventRepeat = false;\r\n    }\r\n\r\n    //防止重复点击\r\n    if (self.preventRepeat) {\r\n        return false;\r\n    }\r\n\r\n    self.preventRepeat = true;\r\n\r\n    //如果没有运行动画\r\n    if (!self.seed.animation) {\r\n        self.preventRepeat = false;\r\n        self.relevantOperation();\r\n        return;\r\n    }\r\n\r\n    //创建的无行为content\r\n    var partContentRelated = self.relatedData.partContentRelated;\r\n    var closeAnim;\r\n\r\n    //制作作用于内动画完成\r\n    //等待动画完毕后执行动作or场景切换\r\n    var captureAnimComplete = self.captureAnimComplete = function(counts) {\r\n        return function(scope) {\r\n            //动画结束,删除这个hack\r\n            scope\r\n                && scope.$contentProcess && scope.$contentProcess.removeProp && scope.$contentProcess.removeProp('animOffset')\r\n\r\n            //如果快速翻页\r\n            //运行动画的时候，发现不是可视页面\r\n            //需要关闭这些动画  \r\n            closeAnim = (pageId != Xut.Presentation.GetPageId());\r\n\r\n            if (closeAnim && scope) {\r\n                scope.stop && scope.stop(pageId);\r\n                scope.reset && scope.reset();\r\n            }\r\n\r\n            //捕获动画状态\r\n            if (counts === 1) {\r\n                if (closeAnim) {\r\n                    //复位动画\r\n                    self.resetAloneAnim();\r\n                }\r\n                self.preventRepeat = false;\r\n                self.relevantOperation();\r\n                outComplete && outComplete();\r\n                self.captureAnimComplete = null;\r\n            } else {\r\n                --counts;\r\n            }\r\n\r\n        }\r\n    }(this.abstractContents.length);\r\n\r\n\r\n    /**\r\n     * 如果是preRun处理\r\n     * @return {Boolean} [description]\r\n     */\r\n    function isRreRunPocess(scope) {\r\n        //针对空跳过处理\r\n        if (partContentRelated && partContentRelated.length && (-1 !== partContentRelated.indexOf(scope.id))) {\r\n            captureAnimComplete()\r\n        } else {\r\n            //必须要修改\r\n            if (scope.$contentProcess) {\r\n                if (scope.canvasMode) {\r\n                    //直接改变元素状态\r\n                    scope.$contentProcess.visible = scope.isRreRun === 'visible' ? true : false;\r\n                    self.canvasRelated.oneRender();\r\n                } else {\r\n                    //因为执行的顺序问题，动画与页面零件\r\n                    //isscroll标记控制\r\n                    if (!scope.$contentProcess.attr('isscroll')) {\r\n                        scope.$contentProcess.css({\r\n                            'visibility': scope.isRreRun\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n            captureAnimComplete()\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 检测创建完成度\r\n     * 递归创建\r\n     * @return {[type]}       [description]\r\n     */\r\n    self._checkCreate(function() {\r\n        //执行动画\r\n        self.eachAssistContents(function(scope) {\r\n            if (scope.isRreRun) {\r\n                isRreRunPocess(scope);\r\n            } else {\r\n\r\n                //标记动画正在运行\r\n                scope.$contentProcess && scope.$contentProcess.prop && scope.$contentProcess.prop({\r\n                    'animOffset': scope.$contentProcess.offset()\r\n                })\r\n\r\n                //ppt动画\r\n                //ppt音频\r\n                scope.run(function() {\r\n                    captureAnimComplete(scope);\r\n                });\r\n            }\r\n        })\r\n        self.runState = true;\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 停止动画\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.stopEffects = function() {\r\n    var pageId = this.relatedData.pageId;\r\n    this.runState = false;\r\n    this.eachAssistContents(function(scope) {\r\n        !scope.isRreRun && scope.stop && scope.stop(pageId);\r\n    })\r\n\r\n}\r\n\r\n\r\n/**\r\n * 处理拖动对象\r\n * @return {[type]} [description]\r\n */\r\nfunction accessDrop(eventData, callback) {\r\n    if (eventData && eventData.dragDrop) {\r\n        callback(eventData.dragDrop)\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 复位独立动画\r\n * 提供快速翻页复用\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.resetAloneAnim = function() {\r\n    //复位拖动对象\r\n    accessDrop(this.eventData, function(drop) {\r\n            drop.reset();\r\n        })\r\n        //如果是运行canvas模式\r\n        //停止绘制\r\n    if (this.canvasRelated.stopRender) {\r\n        setTimeout(function() {\r\n            this.canvasRelated.stopRender();\r\n        }.bind(this), 0)\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 复位状态\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.resetAnimation = function() {\r\n    this.eachAssistContents(function(scope) {\r\n        !scope.isRreRun && scope.reset && scope.reset(); //ppt动画\r\n    })\r\n\r\n    this.resetAloneAnim();\r\n}\r\n\r\n\r\n/**\r\n * 销毁动画\r\n * @param  {[type]} elementCallback [description]\r\n * @return {[type]}                 [description]\r\n */\r\nactivitProto.destroyEffects = function(elementCallback) {\r\n    //销毁拖动对象\r\n    accessDrop(this.eventData, function(drop) {\r\n        drop.destroy();\r\n    })\r\n    this.eachAssistContents(function(scope) {\r\n        if (scope.destroy) {\r\n            scope.destroy();\r\n        }\r\n        elementCallback && elementCallback(scope)\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 动画运行之后\r\n * 1 创建一个新场景\r\n * 2 执行跳转到收费提示页面\r\n * 3 触发搜索工具栏\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.relevantOperation = function() {\r\n\r\n    var scenarioInfo,\r\n        eventContentId;\r\n\r\n    //触发事件的content id\r\n    if (this.eventData) {\r\n        eventContentId = this.eventData.eventContentId;\r\n    }\r\n\r\n    if (eventContentId) {\r\n\r\n        //查找出当前节的所有信息\r\n        if (scenarioInfo = this.relatedData.seasonRelated[eventContentId]) {\r\n\r\n            //如果存在搜索栏触发\r\n            if (scenarioInfo.SearchBar) {\r\n                this.createSearchBar();\r\n                return;\r\n            }\r\n\r\n            //如果存在书签\r\n            if (scenarioInfo.BookMarks) {\r\n                this.createBookMark();\r\n                return;\r\n            }\r\n\r\n            //收费处理\r\n            if (scenarioInfo.Inapp !== undefined) {\r\n                if (scenarioInfo.Inapp == 1) {\r\n                    Xut.Application.HasBuyGood(); //已收费\r\n                } else {\r\n                    Xut.Application.BuyGood(); //付费接口\r\n                }\r\n                return\r\n            }\r\n\r\n            //处理新的场景\r\n            if (scenarioInfo.seasonId || scenarioInfo.chapterId) {\r\n                setTimeout(function() {\r\n                    Xut.View.LoadScenario({\r\n                        'scenarioId': scenarioInfo.seasonId,\r\n                        'chapterId': scenarioInfo.chapterId\r\n                    })\r\n                }, Xut.fix.audio ? 1000 : 0)\r\n                return\r\n            }\r\n\r\n            // console.log('content跳转信息出错',scenarioInfo)\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 创建搜索框\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.createSearchBar = function() {\r\n    var options = {\r\n        parent: this.rootNode\r\n    }\r\n    if (this.searchBar) {\r\n        //如果上次只是隐藏则可以恢复\r\n        this.searchBar.restore();\r\n    } else {\r\n        this.searchBar = new SearchBar(options);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 创建书签\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.createBookMark = function() {\r\n    var element, seasonId, pageId, pageData;\r\n    if (this.pageType === 'master') {\r\n        //模板取对应的页面上的数据\r\n        pageData = Xut.Presentation.GetPageData();\r\n        element = this.relatedData.floatMaters.container;\r\n        pageId = pageData._id;\r\n        seasonId = pageData.seasonId;\r\n    } else {\r\n        element = this.rootNode;\r\n        seasonId = this.relatedData.seasonId\r\n        pageId = this.pageId\r\n    }\r\n    var options = {\r\n        parent: element,\r\n        seasonId: seasonId,\r\n        pageId: pageId\r\n    }\r\n\r\n    if (this.bookMark) {\r\n        //如果上次只是隐藏则可以恢复\r\n        this.bookMark.restore();\r\n    } else {\r\n        this.bookMark = new BookMark(options);\r\n    }\r\n}\r\n\r\n\r\n/*********************************************************************\r\n *\r\n *                      用户自定义接口事件\r\n *                                                                    *\r\n **********************************************************************/\r\n\r\n/**\r\n * 构建事件体系\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.createEventRelated = function() {\r\n\r\n    //配置事件节点\r\n    var eventId,\r\n        pid,\r\n        contentName,\r\n        //事件上下文对象\r\n        eventContext,\r\n        eventData = this.eventData;\r\n\r\n    //如果存在imageIds才处理,单独绑定事件处理\r\n    if (eventId = eventData.eventContentId) {\r\n\r\n        //默认dom模式\r\n        _.extend(eventData, {\r\n            'type': 'dom',\r\n            'domMode': true,\r\n            'canvasMode': false\r\n        })\r\n\r\n        function domEvent() {\r\n            pid = this.pid\r\n            contentName = this._makePrefix('Content', pid, this.id)\r\n\r\n            //找到对应绑定事件的元素\r\n            eventContext = this._findContentElement(contentName)\r\n        }\r\n\r\n        function canvasEvent() {\r\n            eventContext = {}\r\n            eventData.type = 'canvas';\r\n            eventData.canvasMode = true;\r\n            eventData.domMode = false;\r\n        }\r\n\r\n        //canvas事件\r\n        if (-1 !== this.canvasRelated.cid.indexOf(eventId)) {\r\n            canvasEvent.call(this)\r\n        } else {\r\n            //dom事件\r\n            domEvent.call(this)\r\n        }\r\n\r\n        eventData.eventContext = eventContext;\r\n\r\n        if (eventContext) {\r\n            //绑定事件加入到content钩子\r\n            this.relatedCallback.contentsHooks(pid, eventId, {\r\n                $contentProcess: eventContext,\r\n                //增加外部判断\r\n                isBindEventHooks: true,\r\n                type: eventData.type\r\n            })\r\n        } else {\r\n            /**\r\n             * 针对动态事件处理\r\n             * 快捷方式引用到父对象\r\n             * @type {[type]}\r\n             */\r\n            eventData.parent = this;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 解析出事件类型\r\n     */\r\n    eventData.eventName = conversionEventType(eventData.eventType);\r\n\r\n}\r\n\r\n\r\n/**\r\n * 绑定事件行为\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.bindEventBehavior = function(callback) {\r\n    var self = this,\r\n        eventData = this.eventData,\r\n        eventName = eventData.eventName,\r\n        eventContext = eventData.eventContext;\r\n\r\n    /**\r\n     * 运行动画\r\n     * @return {[type]} [description]\r\n     */\r\n    function startRunAnim() {\r\n        //当前事件对象没有动画的时候才能触发关联动作\r\n        var animOffset,\r\n            boundary = 5; //边界值\r\n\r\n        if (eventData.domMode && (animOffset = eventContext.prop('animOffset'))) {\r\n            var originalLeft = animOffset.left;\r\n            var originalTop = animOffset.top;\r\n            var newOffset = eventContext.offset();\r\n            var newLeft = newOffset.left;\r\n            var newTop = newOffset.top;\r\n            //在合理的动画范围是允许点击的\r\n            //比如对象只是一个小范围的内的改变\r\n            //正负10px的移动是允许接受的\r\n            if (originalLeft > (newLeft - boundary) && originalLeft < (newLeft + boundary) || originalTop > (newTop - boundary) && originalTop < (newTop + boundary)) {\r\n                self.runEffects();\r\n            }\r\n        } else {\r\n            self.runEffects();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 设置按钮的行为\r\n     * 音频\r\n     * 反弹\r\n     */\r\n    function setBehavior(feedbackBehavior) {\r\n\r\n        var behaviorSound;\r\n        //音频地址\r\n        if (behaviorSound = feedbackBehavior.behaviorSound) {\r\n\r\n            var createAuido = function() {\r\n                    return new Xut.Audio({\r\n                        url: behaviorSound,\r\n                        trackId: 9999,\r\n                        complete: function() {\r\n                            this.play()\r\n                        }\r\n                    })\r\n                }\r\n                //妙妙学客户端强制删除\r\n            if (MMXCONFIG && audioHandler) {\r\n                self._fixAudio.push(createAuido())\r\n            } else {\r\n                createAuido();\r\n            }\r\n        }\r\n        //反弹效果\r\n        if (feedbackBehavior.isButton) {\r\n            //div通过css实现反弹\r\n            if (eventData.domMode) {\r\n                eventContext.addClass('xut-behavior');\r\n                setTimeout(function() {\r\n                    eventContext.removeClass('xut-behavior');\r\n                    startRunAnim();\r\n                }, 500)\r\n            } else {\r\n                //canvas反弹\r\n                var sx = eventContext.scale.x;\r\n                var px = eventContext.position.x;\r\n\r\n                eventContext.scale.x += 0.1;\r\n                eventContext.position.x -= Math.round(px * 0.05);\r\n                self.canvasRelated.oneRender();\r\n\r\n                setTimeout(function() {\r\n                    eventContext.scale.x = sx;\r\n                    eventContext.position.x = px;\r\n                    self.canvasRelated.oneRender();\r\n                }, 200);\r\n            }\r\n        } else {\r\n            startRunAnim();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 事件引用钩子\r\n     * 用户注册与执行\r\n     * @type {Object}\r\n     */\r\n    var eventDrop = {\r\n        //保存引用,方便直接销毁\r\n        init: function(drag) {\r\n            eventData.dragDrop = drag;\r\n        },\r\n        //拖拽开始的处理\r\n        startRun: function() {\r\n\r\n        },\r\n        //拖拽结束的处理\r\n        stopRun: function(isEnter) {\r\n            if (isEnter) { //为true表示拖拽进入目标对象区域\r\n                self.runEffects();\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 正常动画执行\r\n     * 除去拖动拖住外的所有事件\r\n     * 点击,双击,滑动等等....\r\n     * @return {[type]} [description]\r\n     */\r\n    var eventRun = function() {\r\n        //如果存在反馈动作\r\n        //优先于动画执行\r\n        var feedbackBehavior;\r\n        if (feedbackBehavior = eventData.feedbackBehavior[eventData.eventContentId]) {\r\n            setBehavior(feedbackBehavior)\r\n        } else {\r\n            startRunAnim();\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 事件对象引用\r\n     * @return {[type]} [description]\r\n     */\r\n    var eventHandler = function(eventReference, eventHandler) {\r\n        eventData.eventReference = eventReference;\r\n        eventData.eventHandler = eventHandler;\r\n    }\r\n\r\n\r\n    //绑定用户自定义事件\r\n    if (eventContext && eventName) {\r\n\r\n        var domName, target,\r\n            dragdropPara = eventData.dragdropPara;\r\n\r\n        //获取拖拽目标对象\r\n        if (eventName === 'dragTag') {\r\n            domName = this._makePrefix('Content', this.pid, dragdropPara);\r\n            target = this._findContentElement(domName);\r\n        }\r\n\r\n        //增加事件绑定标示\r\n        //针对动态加载节点事件的行为过滤\r\n        eventData.isBind = true;\r\n\r\n\r\n        callback.call(this, {\r\n            'eventDrop': eventDrop,\r\n            'eventRun': eventRun,\r\n            'eventHandler': eventHandler,\r\n            'eventContext': eventContext,\r\n            'eventName': eventName,\r\n            'parameter': dragdropPara,\r\n            'target': target,\r\n            'domMode': eventData.domMode\r\n        })\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 注册事件\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.registerEvent = function() {\r\n    var eventData = this.eventData;\r\n    /**\r\n     * 2016.2.19\r\n     * 绑定canvas事件\r\n     * 由于canvas有异步加载\r\n     * 这里content创建的时候不阻断加载\r\n     * 所以canvas的事件体系\r\n     * 放到所有异步文件加载后才执行\r\n     */\r\n    if (eventData.type === \"canvas\") {\r\n        var makeFunction = function bind() {\r\n            //找到对应的上下文pixi stoge\r\n            eventData.eventContext = {}\r\n            this.bindEventBehavior(function(eventData) {\r\n                bindPixiEvents(eventData);\r\n            })\r\n        }\r\n        console.log('content canvas事件')\r\n        this.nextTask.event.push(makeFunction.bind(this))\r\n    } else {\r\n        //dom事件\r\n        this.bindEventBehavior(function(eventData) {\r\n            bindContentEvents(eventData);\r\n        })\r\n    }\r\n}\r\n\r\n\r\n\r\n/*********************************************************************\r\n *\r\n *                 私有方法\r\n *\r\n **********************************************************************/\r\n\r\n/**\r\n * dom节点去重绑定\r\n * 在每一次构建activity对象中，不重复处理content一些特性\r\n * 1 翻页特性\r\n * 2 注册钩子\r\n * 3 预显示\r\n * @return {[type]} [description]\r\n */\r\nactivitProto._repeatBind = function(id, context, isRreRun, scope, collectorHooks, canvasMode) {\r\n    var indexOf,\r\n        relatedData = this.relatedData;\r\n\r\n    //过滤重复关系\r\n    if (-1 !== (indexOf = relatedData.createContentIds.indexOf(id))) {\r\n        //删除,去重\r\n        relatedData.createContentIds.splice(indexOf, 1);\r\n        //收集每一个content注册\r\n        collectorHooks(scope.pid, id, scope);\r\n        //canvas模式\r\n        if (canvasMode) {\r\n            if (isRreRun) {\r\n                // console.log(id,scope)\r\n                //直接改变元素状态\r\n                // context.visible = isRreRun === 'visible' ? true : false;\r\n                this.nextTask.pre[id] = function() {\r\n                    this.nextTask.pre.push(function pre(context) {\r\n                        console.log('预执行', isRreRun)\r\n                            //this.canvasRelated.oneRender();\r\n                    })\r\n                }\r\n            }\r\n        } else {\r\n            //dom模式\r\n            //增加翻页特性\r\n            this._addIScroll(scope, context);\r\n            //直接复位状态,针对出现动画 show/hide\r\n            if (isRreRun) {\r\n                //直接改变元素状态\r\n                context.css({\r\n                    'visibility': isRreRun\r\n                })\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 增加翻页特性\r\n * 可能有多个引用关系\r\n * @return {[type]}         [description]\r\n */\r\nactivitProto._addIScroll = function(scope, element) {\r\n    var self = this,\r\n        elementName,\r\n        contentDas = scope.contentDas;\r\n\r\n    //给外部调用处理\r\n    function makeUseFunction(element) {\r\n\r\n        var prePocess = self._makePrefix('Content', scope.pid, scope.id),\r\n            preEle = self._findContentElement(prePocess)\r\n\r\n        //重置元素的翻页处理\r\n        // defaultBehavior(preEle);\r\n\r\n        //ios or pc\r\n        if (!Xut.plat.isAndroid) {\r\n            return function() {\r\n                self.iscroll = Iscroll(element);\r\n            }\r\n        }\r\n\r\n        //在安卓上滚动文本的互斥不显示做一个补丁处理\r\n        //如果是隐藏的,需要强制显示,待邦定滚动之后再还原\r\n        //如果是显示的,则不需要处理,\r\n        var visible = preEle.css('visibility'),\r\n            restore = function() {};\r\n\r\n        if (visible == 'hidden') {\r\n            var opacity = preEle.css('opacity');\r\n            //如果设置了不透明,则简单设为可见的\r\n            //否则先设为不透明,再设为可见\r\n            if (opacity == 0) {\r\n                preEle.css({\r\n                    'visibility': 'visible'\r\n                })\r\n                restore = function() {\r\n                    preEle.css({\r\n                        'visibility': visible\r\n                    })\r\n                }\r\n            } else {\r\n                preEle.css({\r\n                    'opacity': 0\r\n                }).css({\r\n                    'visibility': 'visible'\r\n                })\r\n                restore = function() {\r\n                    preEle.css({\r\n                        'opacity': opacity\r\n                    }).css({\r\n                        'visibility': visible\r\n                    })\r\n                }\r\n            }\r\n        }\r\n\r\n        return function() {\r\n            self.iscroll = Iscroll(element);\r\n            restore();\r\n            preEle = null;\r\n            restore = null;\r\n        }\r\n    }\r\n\r\n    //增加卷滚条\r\n    if (contentDas.isScroll) {\r\n        //去掉高度，因为有滚动文本框\r\n        element.find(\">\").css(\"height\", \"\")\r\n\r\n        // elementName = this._makePrefix('contentWrapper', scope.pid, scope.id);\r\n        this.relatedCallback.iscrollHooks.push(makeUseFunction(element[0]));\r\n    }\r\n\r\n    //如果是图片则补尝允许范围内的高度\r\n    if (!contentDas.mask || !contentDas.isGif) {\r\n        element.find && element.find('img').css({\r\n            'height': contentDas.scaleHeight\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 制作一个查找标示\r\n * @return {[type]}\r\n */\r\nactivitProto._makePrefix = function(name, pid, id) {\r\n    return name + \"_\" + pid + \"_\" + id;\r\n}\r\n\r\n\r\n/**\r\n * 从文档碎片中找到对应的dom节点\r\n * 查找的范围\r\n * 1 文档根节点\r\n * 2 文档容器节点\r\n * @param  {[type]} prefix [description]\r\n * @return {[type]}        [description]\r\n */\r\nactivitProto._findContentElement = function(prefix) {\r\n    var element, containerPrefix,\r\n        contentsFragment = this.relatedData.contentsFragment;\r\n\r\n    if (element = (contentsFragment[prefix])) {\r\n        element = $(element)\r\n    } else {\r\n        //容器处理\r\n        if (containerPrefix = this.relatedData.containerPrefix) {\r\n            _.each(containerPrefix, function(containerName, index) {\r\n                element = contentsFragment[containerName];\r\n                element = $(element).find('#' + prefix);\r\n                if (element.length) {\r\n                    return;\r\n                }\r\n            })\r\n        }\r\n    }\r\n    return element;\r\n}\r\n\r\n\r\n\r\n/*********************************************************************\r\n *\r\n *                      外部调用接口\r\n *                                                                    *\r\n **********************************************************************/\r\n\r\n/**\r\n * 自动运行\r\n * @param  {[type]} outComplete [description]\r\n * @return {[type]}             [description]\r\n */\r\nactivitProto.autoPlay = function(outComplete) {\r\n    var eventData = this.eventData;\r\n    if (eventData && eventData.eventName === 'auto') {\r\n        this.runEffects(outComplete);\r\n    } else {\r\n        outComplete();\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 翻页开始\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.flipOver = function() {\r\n    if (this.runState) {\r\n        this.stopEffects();\r\n    }\r\n    this.preventRepeat = false\r\n        //复位盒子\r\n    if (this.htmlBoxInstance.length) {\r\n        _.each(this.htmlBoxInstance, function(instance) {\r\n            instance.removeBox();\r\n        })\r\n    }\r\n    //修复妙妙客户端\r\n    //没有点击音频结束的回调\r\n    //最多允许播放5秒\r\n    if (this._fixAudio.length) {\r\n        _.each(this._fixAudio, function(instance) {\r\n            setTimeout(function() {\r\n                instance.end();\r\n            }, 5000)\r\n        })\r\n        this._fixAudio = [];\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 翻页完成复位动画\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.flipComplete = function() {\r\n    this.resetAnimation();\r\n}\r\n\r\n\r\n//销毁\r\n//提供一个删除回调\r\n//用于处理浮动对象的销毁\r\nactivitProto.destroy = function(elementCallback) {\r\n\r\n    //销毁绑定事件\r\n    if (this.eventData.eventContext) {\r\n        destroyEvents(this.eventData);\r\n        this.eventData.eventContext = null;\r\n    }\r\n\r\n    //2016.1.7\r\n    //如果有文本框事件\r\n    //一个activity允许有多个文本框\r\n    //所以是数组索引\r\n    if (this.htmlBoxInstance.length) {\r\n        _.each(this.htmlBoxInstance, function(instance) {\r\n            instance.destroy();\r\n        })\r\n        this.htmlBoxInstance = null;\r\n    }\r\n\r\n    //销毁动画\r\n    this.destroyEffects(elementCallback);\r\n\r\n    //iscroll销毁\r\n    if (this.iscroll) {\r\n        this.iscroll.destroy();\r\n        this.iscroll = null;\r\n    }\r\n\r\n    //销毁搜索框\r\n    if (this.searchBar) {\r\n        this.searchBar.destroy();\r\n        this.searchBar = null;\r\n    }\r\n\r\n    //销毁书签\r\n    if (this.bookMark) {\r\n        this.bookMark.destroy();\r\n        this.bookMark = null;\r\n    }\r\n\r\n    this.rootNode = null;\r\n}\r\n\r\n\r\n/**\r\n * 复位\r\n * @return {[type]} [description]\r\n */\r\nactivitProto.recovery = function() {\r\n    if (this.runState) {\r\n        this.stopEffects();\r\n        return true\r\n    }\r\n    return false\r\n}\r\n\r\n\r\n\r\n\r\nexport {\r\n    activityClass\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/activity.js\n **/","/**\r\n * 填充缺少的content对象\r\n * @return {[type]} [description]\r\n */\r\n\r\n/**\r\n * 按照shift取出执行代码\r\n * @return {[type]} [description]\r\n */\r\nfunction segmentation(delayBind) {\r\n    var exetBind;\r\n    while (exetBind = delayBind.shift()) {\r\n        exetBind();\r\n    }\r\n}\r\n\r\n\r\nexport function Mix(base, waitCreateContent, exitCallback) {\r\n    var abstractContents = base.abstractContents,\r\n        contentsFragment = base.relatedData.contentsFragment,\r\n        pid = base.pid,\r\n        pageType = base.pageType,\r\n        //因为要dom去重,要处理创建的内容\r\n        execWaitCreateContent = function() {\r\n            var willCreate = [],\r\n                prefix;\r\n            _.each(waitCreateContent, function(contentId) {\r\n                prefix = base._makePrefix('Content', base.pid, contentId)\r\n                if (!contentsFragment[prefix]) { //如果dom不存在,则创建\r\n                    willCreate.push(contentId)\r\n                }\r\n            })\r\n            return willCreate;\r\n        }\r\n\r\n\r\n    /**\r\n     * 合并创建节点\r\n     **/\r\n    function fillStructure(callback) {\r\n        conStructure({\r\n            'dydCreate': true,\r\n            createContentIds: execWaitCreateContent,\r\n            pid: pid,\r\n            pageType: pageType\r\n        }, function(contentDas, cachedContentStr, containerPrefix) {\r\n            callback(contentDas, $(cachedContentStr), containerPrefix)\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 填充空节点数据\r\n     * contentsFragment临时文档碎片\r\n     * @return {[type]}       [description]\r\n     */\r\n    function fillFragment(cachedContentStr) {\r\n        _.each(cachedContentStr, function(ele, index) {\r\n            contentsFragment[ele.id] = ele;\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 填充作用域对象\r\n     * @return {[type]} [description]\r\n     */\r\n    function fillAssistContents() {\r\n        _.each(abstractContents, function(scope, index) {\r\n            var scopeObj;\r\n            if (!scope.$contentProcess) {\r\n                scopeObj = base.createHandlers(scope, 'waitCreate');\r\n                abstractContents.splice(index, 1, scopeObj) //替换作用域对象\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 重构动态事件\r\n     * 需要跳到不同的作用域对象\r\n     * @return {[type]}           [description]\r\n     */\r\n    function fillEvent() {\r\n        var collectEventRelated = base.relatedData.collectEventRelated,\r\n            eventObj, parent,\r\n            delayBind = []; //延时绑定\r\n        _.each(waitCreateContent, function(contentId) {\r\n            eventObj = collectEventRelated[contentId]\r\n                //事件对象存在,并且没有绑定事件\r\n            if (eventObj && !eventObj.isBind) {\r\n                parent = eventObj.parent;\r\n                parent.createEvent.call(parent)\r\n                delayBind.push(function() {\r\n                    parent.bindEvent.call(parent)\r\n                })\r\n            }\r\n        })\r\n        return delayBind;\r\n    }\r\n\r\n    /**\r\n     * 清理\r\n     * @return {[type]} [description]\r\n     */\r\n    function clean() {\r\n        base.waitCreateContent = null;\r\n    }\r\n\r\n    /**\r\n     * 绘制显示\r\n     * @return {[type]} [description]\r\n     */\r\n    function toRedraw(cachedContentStr) {\r\n        Xut.nextTick({\r\n            'container': base.rootNode,\r\n            'content': cachedContentStr\r\n        }, function() {\r\n            clean();\r\n            //绑定滑动isScroll\r\n            segmentation(base.relatedCallback.iScrollHooks)\r\n            exitCallback();\r\n        });\r\n    }\r\n\r\n\r\n    function pocessContent(contentDas, cachedContentStr, containerPrefix) {\r\n\r\n        //填充数据\r\n        cachedContentStr && fillFragment(cachedContentStr)\r\n\r\n        // 填充动画对象\r\n        fillAssistContents();\r\n\r\n        /**\r\n         * 填充事件\r\n         * 执行后绑定\r\n         * 跨作用域\r\n         */\r\n        segmentation(fillEvent());\r\n\r\n        /**\r\n         * 开始初始化构建\r\n         */\r\n        self.initEffects();\r\n\r\n        /**\r\n         * 绘制页面\r\n         */\r\n        if (cachedContentStr) {\r\n            toRedraw(cachedContentStr)\r\n        } else {\r\n            clean();\r\n            exitCallback();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 需要创建节点\r\n     */\r\n    if (execWaitCreateContent && execWaitCreateContent.length) {\r\n        fillStructure(pocessContent)\r\n    } else {\r\n        //不需要创建节点\r\n        pocessContent();\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/mix.js\n **/","/**\r\n * 创建执行对象\r\n * 1 动画作用域\r\n * 2 视觉差作用域\r\n * @type {Array}\r\n */\r\n\r\nimport {Animation} from './animation'\r\nimport {Parallax} from './parallax'\r\n\r\n\r\n/**\r\n * 预运行动作\r\n * 自动 && 出现 && 无时间 && 无音乐\r\n *  && 不是精灵动画 && 没有脚本代码 && 并且不能是收费\r\n * @return {[type]}         [description]\r\n */\r\nfunction preRunAction(data, eventName) {\r\n    var para, scopem,\r\n        parameter = data.getParameter();\r\n    //过滤预生成动画\r\n    if (parameter.length === 1) {\r\n        para = parameter[0];\r\n        if (para.animationName === 'EffectAppear' && eventName === 'auto' && !para.videoId && !para.delay && data.contentDas.category !== 'Sprite' && !para.preCode //动画前脚本\r\n            && !para.postCode //动画后脚本\r\n            && !/\"inapp\"/i.test(para.parameter)) { //并且不能是收费处理\r\n\r\n            /***********************************************\r\n             *      针对预处理动作,并且没有卷滚的不注册\r\n             *      满足是静态动画\r\n             * **********************************************/\r\n            //true是显示,false隐藏\r\n            return data.isRreRun = /\"exit\":\"False\"/i.test(para.parameter) === true ? 'visible' : 'hidden';\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 构建动画\r\n * @return {[type]} [description]\r\n */\r\nfunction createScope(base, contentId, pid, actName, contentDas, parameter, hasParallax) {\r\n    //默认启动dom模式\r\n    var data = {\r\n            type: 'dom',\r\n            canvasMode: false,\r\n            domMode: true\r\n        },\r\n        $contentProcess,\r\n        pageType = base.pageType;\r\n\r\n\r\n    //如果启动了canvas模式\r\n    //改成作用域的一些数据\r\n    if (base.canvasRelated.enable) {\r\n        //如果找到对应的canvas对象\r\n        if (-1 !== base.canvasRelated.cid.indexOf(contentId)) {\r\n            $contentProcess = {}; //等待填充\r\n            data.type = 'canvas';\r\n            data.canvasMode = true;\r\n            data.domMode = false;\r\n        }\r\n    }\r\n\r\n    //如果是dom模式\r\n    if (!$contentProcess) {\r\n        /**\r\n         * 确保节点存在\r\n         * @type {[type]}\r\n         */\r\n        if (!($contentProcess = base._findContentElement(actName))) {\r\n            return;\r\n        };\r\n    }\r\n\r\n    /**\r\n     * 制作公共数据\r\n     * @type {Object}\r\n     */\r\n    _.extend(data, {\r\n        base: base,\r\n        id: contentId,\r\n        pid: pid,\r\n        actName: actName,\r\n        contentDas: contentDas,\r\n        $contentProcess: $contentProcess,\r\n        pageType: pageType,\r\n        pageIndex: base.pageIndex,\r\n        canvasRelated: base.canvasRelated,\r\n        nextTask: base.nextTask\r\n    })\r\n\r\n\r\n    /**\r\n     * 如果是母版层理,视觉差处理\r\n     * processType 三种情况\r\n     *          parallax\r\n     *          animation\r\n     *          both(parallax,animation)\r\n     * @type {[type]}\r\n     */\r\n    if (hasParallax && pageType === 'master') {\r\n        data.processType = 'parallax';\r\n    } else {\r\n        data.processType = 'animation';\r\n    }\r\n\r\n\r\n    //生成查询方法\r\n    data.getParameter = function() {\r\n        //分区母版与页面的数据结构\r\n        //parameter-master-parallax\r\n        //parameter-master-animation\r\n        //parameter-page-animation\r\n        var fix = 'parameter-' + pageType + '-' + data.processType;\r\n        data[fix] = parameter;\r\n        return function() {\r\n            return data[fix];\r\n        }\r\n    }();\r\n\r\n\r\n    /**\r\n     * 生成视觉差作用域\r\n     * @type {[type]}\r\n     */\r\n    if (data.processType === 'parallax') {\r\n        //初始化视觉差对象的坐标偏移量\r\n        data.transformOffset = base.relatedData.transformOffset(data.id);\r\n        return Parallax.call(base, data);\r\n    }\r\n\r\n    /**\r\n     *  优化机制,预生成处理\r\n     *  过滤自动热点并且是出现动作，没有时间，用于提升体验\r\n     */\r\n    preRunAction(data, base.eventData.eventName)\r\n\r\n\r\n    /**\r\n     * 生成子作用域对象，用于抽象处理动画,行为\r\n     */\r\n    return new Animation(data);\r\n}\r\n\r\n\r\n/**\r\n * 分解每个子作用域\r\n * 1 生成临时占位作用域,用于分段动画\r\n * 2 生成所有动画子作用域\r\n * @param  {[type]} parameter [description]\r\n * @return {[type]}           [description]\r\n */\r\nfunction createHandlers(base, parameter, waitCreate) {\r\n    /**\r\n     * 如果是动态分段创建\r\n     * 混入新的作用域\r\n     */\r\n    if (waitCreate) {\r\n        return createScope.apply(base, parameter);\r\n    }\r\n\r\n    //dom对象\r\n    var para = parameter[0],\r\n        contentId = para['contentId'], //可能有多个动画数据 [Object,Object,Object]\r\n        pid = base.pid,\r\n        actName = base._makePrefix('Content', pid, contentId),\r\n        contentDas = base.relatedData.contentDas[contentId];\r\n\r\n    /**\r\n     * 客户端未实现\r\n     * 针对分段创建优化\r\n     * 初始化必要加载数据\r\n     * 临时占位数据\r\n     */\r\n    // if(contentDas && 1==contentDas.visible){\r\n    //  //记录分段标记,用户合并创建节点\r\n    //  base.waitCreateContent.push(contentId)\r\n    //  return [contentId, pid, actName, contentDas, parameter];\r\n    // }\r\n\r\n    /**\r\n     * 构建子作用域\r\n     */\r\n    return createScope(base, contentId, pid, actName, contentDas, parameter, para.masterId);\r\n}\r\n\r\n\r\n\r\n/**\r\n * 构建作用域\r\n * @return {[type]} [description]\r\n */\r\nfunction fnCreate(base) {\r\n    return function(data, callback) {\r\n        var para, handlers;\r\n        if (data && data.length) {\r\n            //生成动画作用域对象\r\n            while (para = data.shift()) {\r\n                if (handlers = createHandlers(base, para)) {\r\n                    callback(handlers);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 源对象复制到目标对象\r\n */\r\nfunction innerExtend(target, source) {\r\n    for (property in source) {\r\n        if (target[property] === undefined) {\r\n            target[property] = source[property];\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//处理itemArray绑定的动画对象\r\n//注入动画\r\n//绑定用户事件\r\nexport function Child(base) {\r\n    var animation = base.seed.animation,\r\n        parallax = base.seed.parallax,\r\n        //抽出content对象\r\n        abstractContents = [],\r\n        //创建引用\r\n        batcheCreate = fnCreate(base);\r\n\r\n    switch (base.pageType) {\r\n        case 'page':\r\n            batcheCreate(animation, function(handlers) {\r\n                abstractContents.push(handlers)\r\n            });\r\n            break;\r\n        case 'master':\r\n            //母版层的处理\r\n            var tempParallaxScope = {},\r\n                tempAnimationScope = {},\r\n                tempAssistContents = [];\r\n            //视觉差处理\r\n            batcheCreate(parallax, function(handlers) {\r\n                tempParallaxScope[handlers.id] = handlers;\r\n            });\r\n\r\n            batcheCreate(animation, function(handlers) {\r\n                tempAnimationScope[handlers.id] = handlers;\r\n            });\r\n\r\n            var hasParallax = _.keys(tempParallaxScope).length,\r\n                hasAnimation = _.keys(tempAnimationScope).length;\r\n\r\n            //动画为主\r\n            //合并，同一个对象可能具有动画+视觉差行为\r\n            if (hasParallax && hasAnimation) {\r\n                _.each(tempAnimationScope, function(target) {\r\n                        var id = target.id,\r\n                            source;\r\n                        if (source = tempParallaxScope[id]) { //如果能找到就需要合并\r\n                            innerExtend(target, source); //复制方法\r\n                            target.processType = 'both'; //标记新组合\r\n                            delete tempParallaxScope[id]; //删除引用\r\n                        }\r\n                    })\r\n                    //剩余的处理\r\n                if (_.keys(tempParallaxScope).length) {\r\n                    _.extend(tempAnimationScope, tempParallaxScope);\r\n                }\r\n                tempParallaxScope = null;\r\n            }\r\n            //转化成数组\r\n            _.each(hasAnimation ? tempAnimationScope : tempParallaxScope, function(target) {\r\n                tempAssistContents.push(target);\r\n            })\r\n            abstractContents = tempAssistContents;\r\n            break\r\n    }\r\n\r\n    batcheCreate = null;\r\n\r\n    return abstractContents;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/child.js\n **/","/*********************************************************************\r\n *\r\n * content的动画类对象\r\n * 1 ppt 动画\r\n * 2 精灵动画\r\n * 3 show/hide接口\r\n * 4 canvas动画\r\n * @return {[type]} [description]\r\n *\r\n ********************************************************************/\r\n\r\n//dom精灵动画\r\nimport { Sprite as domSprite } from './plug/sprite'\r\n\r\n//pixi普通精灵动画\r\nimport { Sprite as pixiSpirit } from '../pixi/sprite'\r\n\r\n//依赖\r\nimport { Dep } from './dep'\r\n\r\n\r\n\r\n/**\r\n * 销毁动画音频\r\n * @param  {[type]} videoIds  [description]\r\n * @param  {[type]} chapterId [description]\r\n * @return {[type]}           [description]\r\n */\r\nfunction destroyContentAudio(videoIds, chapterId) {\r\n    var isExist = false;\r\n    //如果有音频存在\r\n    videoIds && _.each(videoIds, function(data, index) {\r\n        //如果存在对象音频\r\n        if (data.videoId) {\r\n            isExist = true;\r\n            return 'breaker';\r\n        }\r\n    })\r\n    if (isExist) {\r\n        Xut.AudioManager.clearContentAudio(chapterId)\r\n    }\r\n}\r\n\r\n/**\r\n * 判断是否存在\r\n * @return {Boolean} [description]\r\n */\r\nfunction bind(instance, success, fail) {\r\n    if (instance) {\r\n        success.call(instance, instance)\r\n    } else {\r\n        fail && fail()\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n * 动画对象控制\r\n * @param {[type]} options [description]\r\n */\r\nvar Animation = function(options) {\r\n    //mix参数\r\n    _.extend(this, options);\r\n\r\n\r\n}\r\n\r\nvar animProto = Animation.prototype;\r\n\r\n\r\n/**\r\n * 绑定动画\r\n * 为了向上兼容API\r\n * element \r\n *  1 dom动画\r\n *  2 canvas动画\r\n * @param  {[type]} context   [description]\r\n * @param  {[type]} rootNode  [description]\r\n * @param  {[type]} chapterId [description]\r\n * @param  {[type]} parameter [description]\r\n * @param  {[type]} pageType  [description]\r\n * @return {[type]}           [description]\r\n */\r\nanimProto.init = function(id, context, rootNode, chapterId, parameter, pageType) {\r\n\r\n    var canvasRelated = this.canvasRelated;\r\n    var pageIndex = this.pageIndex;\r\n    var self = this;\r\n    var actionTypes;\r\n    var create = function(constructor, newContext) {\r\n        return new constructor(pageIndex, pageType, chapterId, newContext || context, parameter, rootNode);\r\n    }\r\n\r\n    //dom模式\r\n    if (this.domMode) {\r\n        //ppt动画\r\n        this.pptObj = create(PptAnimation);\r\n        //普通精灵动画\r\n        this.domSprites = this.contentDas.category === 'Sprite' ? true : false;\r\n    }\r\n\r\n\r\n    //canvas模式\r\n    //比较复杂\r\n    //1 普通与ppt组合\r\n    //2 高级与ppt组合\r\n    //3 ppt独立\r\n    //4 普通精灵动画\r\n    //  其中 高级精灵动画是widget创建，需要等待\r\n    if (this.canvasMode) {\r\n        //动作类型\r\n        //可能是组合动画\r\n        actionTypes = this.contentDas.actionTypes\r\n        //精灵动画\r\n        if (actionTypes.spiritId) {\r\n            //加入任务队列\r\n            this.nextTask.context.add(id)\r\n            this.pixiSpriteObj = new pixiSpirit(this.contentDas, canvasRelated);\r\n            //ppt动画\r\n            if (actionTypes.pptId) {\r\n                //构建精灵动画完毕后\r\n                //构建ppt对象\r\n                this.pixiSpriteObj.$once('load', function() {\r\n                    //content=>MovieClip\r\n                    self.pptObj = create(CanvasAnimation, this.movie);\r\n                    //任务完成\r\n                    self.nextTask.context.remove(id)\r\n                })\r\n            }\r\n        }\r\n\r\n        //高级精灵动画\r\n        //content需要依赖高级动画pixi创建\r\n        //因为精灵动画是widget创建类型\r\n        //所以代码需要延后，等待高级content先创建\r\n        if (actionTypes.widgetId) {\r\n            this.linker = function() {\r\n                return function pptwidget(context) {\r\n                    self.linker = null;\r\n                    self.pptObj = create(CanvasAnimation, context.sprObjs[0].advSprite);\r\n                    self.linker.dep.notify(self.pptObj)\r\n                }\r\n            }();\r\n            // 收集依赖\r\n            this.linker.dep = new Dep()\r\n        }\r\n    }\r\n\r\n};\r\n\r\n\r\n/**\r\n * 运行动画\r\n * @param  {[type]} scopeComplete   [动画回调]\r\n * @param  {[type]} canvasContainer [description]\r\n * @return {[type]}                 [description]\r\n */\r\nanimProto.run = function(scopeComplete) {\r\n\r\n    var self = this,\r\n        defaultIndex,\r\n        element = this.$contentProcess;\r\n\r\n    var succeed = function(animObj) {\r\n        //优化处理,只针对互斥的情况下\r\n        //处理层级关系\r\n        if (element.prop && element.prop(\"mutex\")) {\r\n            element.css({ //强制提升层级\r\n                'display': 'block'\r\n            })\r\n        }\r\n        //指定动画\r\n        animObj.runAnimation(scopeComplete);\r\n    }\r\n\r\n    //失败增加依赖触发\r\n    var fail = function() {\r\n        if(self.linker){\r\n            self.linker.dep.addSub(succeed)\r\n        }\r\n    }\r\n\r\n    //ppt动画\r\n    //dom\r\n    //canvas =》link => fail\r\n    bind(this.pptObj, succeed, fail)\r\n\r\n\r\n    //canvas普通精灵动画\r\n    bind(this.pixiSpriteObj, function(animObj) {\r\n        animObj.playPixi(scopeComplete);\r\n    })\r\n\r\n    //dom精灵动画\r\n    if (this.domSprites && element) {\r\n        //存在动画\r\n        if (this.spriteObj) {\r\n            this.spriteObj.playSprites();\r\n            return;\r\n        }\r\n        element = this.$contentProcess.find('.sprite').show();\r\n        this.spriteObj = domSprite({\r\n            element: element,\r\n            data: this.contentDas,\r\n            id: this.id,\r\n            mode: 'css'\r\n        });\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 停止动画\r\n * @param  {[type]} chapterId [description]\r\n * @return {[type]}           [description]\r\n */\r\nanimProto.stop = function(chapterId) {\r\n\r\n    //ppt动画\r\n    bind(this.pptObj, function(animObj) {\r\n        //销毁ppt音频\r\n        destroyContentAudio(animObj.options, chapterId);\r\n        //停止PPT动画\r\n        animObj.stopAnimation();\r\n    })\r\n\r\n    //canvas精灵\r\n    bind(this.pixiSpriteObj, function(animObj) {\r\n        animObj.stopPixi();\r\n    })\r\n\r\n    //dom精灵\r\n    bind(this.spriteObj, function(sprObj) {\r\n        sprObj.pauseSprites();\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * 翻页结束，复位上一页动画\r\n * @return {[type]} [description]\r\n */\r\nanimProto.reset = function() {\r\n    bind(this.pptObj, function(animObj) {\r\n        animObj.resetAnimation();\r\n    })\r\n}\r\n\r\n\r\n/**\r\n * 销毁动画\r\n * @return {[type]} [description]\r\n */\r\nanimProto.destroy = function() {\r\n\r\n    //canvas\r\n    bind(this.pixiSpriteObj, function(animObj) {\r\n        animObj.destroyPixi();\r\n    })\r\n\r\n    //dom ppt\r\n    bind(this.pptObj, function(animObj) {\r\n        animObj.destroyAnimation();\r\n    })\r\n\r\n    //dom 精灵\r\n    bind(this.spriteObj, function(sprObj) {\r\n        sprObj.stopSprites();\r\n    });\r\n\r\n    this.pptObj = null;\r\n    this.spriteObj = null;\r\n    this.getParameter = null;\r\n    this.pixiSpriteObj = null;\r\n}\r\n\r\nexport {\r\n    Animation\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/animation.js\n **/","/**\r\n * 普通精灵动画\r\n * dom版本\r\n */\r\n\r\nimport {\r\n    parseJSON\r\n}\r\nfrom '../../../util/index'\r\n\r\nlet DOC = document\r\nlet prefix = Xut.plat.prefixStyle\r\nlet KEYFRAMES = Xut.plat.KEYFRAMES\r\nlet ANIMATION_EV = Xut.plat.ANIMATION_EV\r\n    //全局样式style\r\nlet styleElement = null\r\nlet playState = prefix('animation-play-state')\r\n    //动画前缀\r\nlet prefixAnims = prefix('animation')\r\n\r\n//css3模式-单图\r\nfunction css3Animate(options) {\r\n    var $element = options.element,\r\n        data = options.data,\r\n        callback = options.callback || function() {},\r\n        aniName = 'sprite_' + options.id,\r\n        count = data.thecount,\r\n        fps = data.fps,\r\n        time = Math.round(1 / fps * count * 10) / 10,\r\n        width = Math.ceil(data.scaleWidth * count),\r\n        loop = data.loop ? 'infinite' : 1;\r\n\r\n    //如果是矩形图\r\n    var matrix;\r\n    if (data.parameter) {\r\n        var parameter = parseJSON(data.parameter);\r\n        //矩阵\r\n        if (parameter && parameter.matrix) {\r\n            matrix = parameter.matrix.split(\"-\")\r\n        }\r\n    }\r\n\r\n    /**\r\n     * [ description]动态插入一条样式规则\r\n     * @param  {[type]} rule [样式规则]\r\n     * @return {[type]}      [description]\r\n     */\r\n    function insertCSSRule(rule) {\r\n        var number, sheet, cssRules;\r\n        //如果有全局的style样式文件\r\n        if (styleElement) {\r\n            number = 0\r\n            try {\r\n                sheet = styleElement.sheet;\r\n                cssRules = sheet.cssRules;\r\n                number = cssRules.length;\r\n                sheet.insertRule(rule, number);\r\n            } catch (e) {\r\n                console.log(e );\r\n            }\r\n        } else {\r\n            //创建样式文件\r\n            styleElement = DOC.createElement(\"style\");\r\n            styleElement.type = 'text/css';\r\n            styleElement.innerHTML = rule;\r\n            styleElement.uuid = 'aaron';\r\n            DOC.head.appendChild(styleElement);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * [ description]删除一条样式规则\r\n     * @param  {[type]} ruleName [样式名]\r\n     * @return {[type]}          [description]\r\n     */\r\n    function deleteCSSRule(ruleName) {\r\n        if (styleElement) {\r\n            var sheet = styleElement.sheet,\r\n                cssRules = sheet.rules || sheet.cssRules, //取得规则列表\r\n                i = 0,\r\n                n = cssRules.length,\r\n                rule;\r\n            for (i; i < n; i++) {\r\n                rule = cssRules[i];\r\n                if (rule.name === ruleName) {\r\n                    //删除单个规则\r\n                    sheet.deleteRule(i);\r\n                    break;\r\n                }\r\n            }\r\n            //删除style样式\r\n            if (cssRules.length == 0) {\r\n                DOC.head.removeChild(styleElement);\r\n                styleElement = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    //格式化样式表达式\r\n    function setStep(aniName, time, count, loop) {\r\n        var rule\r\n        if (matrix) {\r\n            rule = '{0} {1}s step-start {2}';\r\n            return String.format(rule, aniName, time, loop);\r\n        } else {\r\n            rule = '{0} {1}s steps({2}, end) {3}';\r\n            return String.format(rule, aniName, time, count, loop);\r\n        }\r\n    }\r\n\r\n    //设置精灵动画位置\r\n    function setPostion(aniName, x) {\r\n        //矩阵生成step的处理\r\n        //  0 1 2\r\n        //  3 4 5\r\n        //  6 7 8\r\n        if (matrix) {\r\n            var frames = [];\r\n            var base = 100 / count;\r\n            var col = Number(matrix[0]); //列数\r\n            //首次\r\n            frames.push(0 + '% { background-position:0% 0%}')\r\n            for (var i = 0; i < count; i++) {\r\n                var currRow = Math.ceil((i + 1) / col); //当前行数\r\n                var currCol = Math.floor(i / col); //当前列数  \r\n                var period = currCol * col; //每段数量  \r\n                var x = 100 * (i - period)\r\n                var y = 100 * currCol;\r\n\r\n                x = x == 0 ? x : \"-\" + x;\r\n                y = y == 0 ? y : \"-\" + y;\r\n                frames.push(((i + 1) * base) + '% { background-position: ' + x + '% ' + y + '%}')\r\n            }\r\n            return aniName + '{' + frames.join(\"\") + '}';\r\n        } else {\r\n            var rule = '{0} {from { background-position:0 0; } to { background-position: -{1}px 0px}}';\r\n            return String.format(rule, aniName, Math.round(x));\r\n        }\r\n    }\r\n\r\n\r\n    //设置动画样式\r\n    function setAnimition($element, rule) {\r\n        prefixAnims && $element.css(prefixAnims, rule);\r\n    }\r\n\r\n    //添加到样式规则中\r\n    function setKeyframes(rule) {\r\n        if (KEYFRAMES) {\r\n            insertCSSRule(KEYFRAMES + rule);\r\n        }\r\n    }\r\n\r\n\r\n    //动画css关键帧规则\r\n    var rule1 = setStep(aniName, time, count, loop);\r\n    var rule2 = setPostion(aniName, width);\r\n\r\n    setAnimition($element, rule1);\r\n    setKeyframes(rule2);\r\n    $element.on(ANIMATION_EV, callback);\r\n\r\n    return {\r\n\r\n        runSprites: function() {\r\n            //运行动画\r\n            $element.show().css(playState, '');\r\n        },\r\n\r\n        stopSprites: function() {\r\n            //停止精灵动画\r\n            deleteCSSRule(aniName);\r\n            $element.off(ANIMATION_EV, callback);\r\n            $element = null;\r\n        },\r\n\r\n        pauseSprites: function() {\r\n            //暂停精灵动画\r\n            $element.css(playState, 'paused');\r\n        },\r\n\r\n        playSprites: function() {\r\n            //恢复精灵动画\r\n            $element.css(playState, '');\r\n        }\r\n\r\n    }\r\n}\r\n\r\n//帧模式-多图\r\nfunction keyframes(options) {\r\n    var $element = options.element,\r\n        status = '',\r\n        data = options.data,\r\n        src = data.md5,\r\n        count = data.thecount || 0,\r\n        loop = data.loop,\r\n        fps = data.fps || 1,\r\n        root = Xut.config.pathAddress,\r\n        info = parsePath(src),\r\n        url = root + info.name,\r\n        ext = info.ext,\r\n        num = info.num || 0,\r\n        timer = 0,\r\n        image = DOC.createElement('img');\r\n\r\n    image.src = root + src;\r\n    $element.append(image);\r\n\r\n    function runSprites() {\r\n        timer = setTimeout(function() {\r\n            image.src = url + num + ext;\r\n            num++;\r\n            check();\r\n        }, 1000 / fps);\r\n    }\r\n\r\n    function check() {\r\n        if (status === 'paused') {\r\n            return;\r\n        }\r\n        if (num > count) {\r\n            if (loop) {\r\n                num %= count;\r\n                runSprites();\r\n            } else {\r\n                timer = null;\r\n                callback();\r\n            }\r\n        } else {\r\n            runSprites();\r\n        }\r\n    }\r\n\r\n    //分解路径,得到扩展名和文件名\r\n    function parsePath(path) {\r\n        var tmp = path.split('.'),\r\n            ext = '.' + tmp[1],\r\n            tmp = tmp[0].split('-'),\r\n            name = tmp[0] + '-',\r\n            num = tmp[1] - 0;\r\n        return {\r\n            name: name,\r\n            ext: ext,\r\n            num: num\r\n        };\r\n    }\r\n\r\n    runSprites();\r\n\r\n    return {\r\n\r\n        runSprites: function() {\r\n            status = 'play';\r\n            runSprites();\r\n        },\r\n\r\n        stopSprites: function() {\r\n            //停止精灵动画\r\n            clearTimeout(timer);\r\n            status = 'paused';\r\n            num = 0;\r\n            $element = null;\r\n            image = null;\r\n        },\r\n\r\n        pauseSprites: function() {\r\n            //暂停精灵动画\r\n            status = 'paused';\r\n        },\r\n\r\n        playSprites: function() {\r\n            //恢复精灵动画\r\n            status = 'play';\r\n            check();\r\n        }\r\n\r\n    }\r\n}\r\n\r\n//用pixi库实现的精灵动画\r\nfunction pixiAnimate(options) {\r\n    var $element = options.element.parent(),\r\n        data = options.data,\r\n        callback = options.callback || function() {},\r\n        count = data.thecount,\r\n        fps = data.fps,\r\n        width = Math.ceil(data.scaleWidth),\r\n        height = Math.ceil(data.scaleHeight),\r\n        loop = data.loop ? true : false;\r\n\r\n    var scalex = Xut.config.proportion.width;\r\n    var scaley = Xut.config.proportion.height;\r\n    var path = Xut.config.pathAddress + data.md5;\r\n    var i = 0;\r\n    var x = 0;\r\n    var data = [];\r\n    var stage = new PIXI.Stage(0xFFFFFF);\r\n    var renderer = PIXI.autoDetectRenderer(width, height, null, true);\r\n\r\n    $element.empty().append(renderer.view);\r\n    var sprite = new PIXI.Sprite.fromImage(path);\r\n    sprite.scale.x = scalex;\r\n    sprite.scale.y = scaley;\r\n\r\n    for (var i = 0; i < count; i++) {\r\n        data.push(i * width);\r\n    }\r\n\r\n    stage.addChild(sprite);\r\n\r\n    requestAnimFrame(animate);\r\n\r\n    function animate() {\r\n        //控制刷新频率\r\n        if (i % 15 == 0) {\r\n            sprite.position.x = -data[x];\r\n            renderer.render(stage);\r\n            x++;\r\n            if (x > data.length - 1) {\r\n                x = 0;\r\n                i = 0;\r\n            }\r\n        }\r\n\r\n        i++;\r\n        requestAnimFrame(animate);\r\n    }\r\n}\r\n\r\nfunction spriteAnimate(options) {\r\n    var sprite = options.element,\r\n        data = options.data,\r\n\r\n        count = data.thecount,\r\n\r\n        width = Math.ceil(data.scaleWidth),\r\n        height = Math.ceil(data.scaleHeight),\r\n        loop = data.loop ? true : false;\r\n\r\n    var i = 0;\r\n    var x = 0;\r\n    var data = [];\r\n\r\n    for (var i = 0; i < count; i++) {\r\n        data.push(i * width);\r\n    }\r\n\r\n    requestAnimFrame(animate);\r\n\r\n    function animate() {\r\n        //控制刷新频率\r\n        if (i % 15 == 0) {\r\n            sprite.position.x = -data[x];\r\n\r\n            x++;\r\n            if (x > data.length - 1) {\r\n                x = 0;\r\n                i = 0;\r\n            }\r\n        }\r\n\r\n        i++;\r\n        //requestAnimFrame(animate);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * css3动画\r\n * 1 帧动画\r\n * 2 定时器动画\r\n * 3 canvas动画\r\n * @param {[type]} options [description]\r\n */\r\nexport function Sprite(options) {\r\n    var mode = options.mode || 'css';\r\n    switch (mode) {\r\n        case 'css':\r\n            return css3Animate(options);\r\n        case 'timer':\r\n            return keyframes(options);\r\n        case 'canvas':\r\n            return spriteAnimate(options);\r\n        default:\r\n            return pixiAnimate(options);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/plug/sprite.js\n **/","/**\r\n * pixi精灵动画\r\n * @param  {[type]} Utils   [description]\r\n * @param  {[type]} Config) {}          [description]\r\n * @return {[type]}         [description]\r\n */\r\n\r\nimport {\r\n    Factory\r\n}\r\nfrom './factory'\r\n\r\n/**\r\n * 精灵动画\r\n * @param  {[type]} data          [description]\r\n * @param  {[type]} canvasRelated [description]\r\n * @return {[type]}               [description]\r\n */\r\nvar Sprite = Factory.extend({\r\n\r\n    /**\r\n     * 初始化\r\n     * @param  {[type]} data          [description]\r\n     * @param  {[type]} canvasRelated [description]\r\n     * @return {[type]}               [description]\r\n     */\r\n    constructor: function(successCallback, failCallback, data, canvasRelated) {\r\n\r\n        var self = this;\r\n        this.data = data;\r\n        this.canvasRelated = canvasRelated;\r\n        //id标示\r\n        //可以用来过滤失败的pixi对象\r\n        this.contentId = data._id\r\n\r\n        //精灵场景容器\r\n        var spriteTtage = new PIXI.Container();\r\n        //加入场景容器\r\n        canvasRelated.addChild(spriteTtage);\r\n\r\n        //矩形图\r\n        var imgUrl = this.analysisPath(data);\r\n        var imageFilename = imgUrl.replace(/^.*[\\\\\\/]/, '');\r\n\r\n        //support both png and jpg+mask \r\n        var maskFilename = \"mask_\" + imageFilename;\r\n        var imageextension = imgUrl.split('.').pop();\r\n        var maskUrl = imgUrl.replace('.jpg', '_mask.png');\r\n\r\n        //保证和以前版本的兼容性，旧版本精灵只有一行，因此没有matrix参数\r\n        var matrixCols = data.thecount;\r\n        var matrixRows = 1;\r\n        if (data.parameter) {\r\n            //获取参数, 允许参数为null\r\n            try {\r\n                var paraObject = JSON.parse(data.parameter);\r\n            } catch (err) {\r\n                console.log('content parameter error')\r\n                return;\r\n            }\r\n            var dataMatrix = paraObject.matrix;\r\n            var matrixs = dataMatrix.split(\"-\");\r\n            matrixCols = matrixs[0];\r\n            matrixRows = matrixs[1];\r\n        }\r\n\r\n\r\n        var jsonUrl = \"lib/data/spritesheet.json\" + \"?imageurl=\" + imgUrl + \"&cols=\" + matrixCols + \"&rows=\" + matrixRows + \"&total=\" + data.thecount + \"&fps=\" + data.fps;\r\n        var movie;\r\n        var contentId = this.contentId;\r\n\r\n        //这里我们动态创建loader，加载完资源之后，就删除了。因此呢，也就没有缓存资源的情况了\r\n        //我觉得这样似乎更好。因为我们整本书的动画很多，如果所有资源都缓存下来，可能内存消耗极大\r\n        //现在这样每页动态创建，不加缓存，虽然性能上稍微差了一些，但是应该能够节省很多的内存\r\n        var loader = new PIXI.loaders.Loader();\r\n        if ('png' == imageextension) {\r\n            loader\r\n                .add(imageFilename, jsonUrl)\r\n                .load(onAssetsLoaded);\r\n        } else {\r\n            var maskJsonUrl = \"lib/data/spritesheet.json\" + \"?imageurl=\" + maskUrl + \"&cols=\" + matrixCols + \"&rows=\" + matrixRows + \"&total=\" + data.thecount + \"&fps=\" + data.fps;\r\n            loader\r\n                .add(imageFilename, jsonUrl)\r\n                .add(maskFilename, maskJsonUrl)\r\n                .load(onAssetsLoaded);\r\n        }\r\n        loader = null;\r\n\r\n        function onAssetsLoaded(loader, res) {\r\n\r\n\r\n            //资源加载失败\r\n            // if (arguments[1] && Object.keys(arguments[1]).length < 2) {\r\n            //     failCallback(contentId);\r\n            //     return\r\n            // }\r\n\r\n            //zhangyun, get the name of spritesheet\r\n            var textures = [];\r\n            var maskTextures = [];\r\n            //create textures array from res's textures object\r\n            var resObject, maskObject;\r\n            if (\"object\" == typeof res) {\r\n                //首次加载\r\n                resObject = res[Object.keys(res)[0]];\r\n            } else {\r\n                //重复加载时，传递的是字符串参数\r\n                //实际上这个分支没用到，如果需要处理缓存，则需要用到，现在我们没有缓存\r\n                resObject = PIXI.loader.resources[res];\r\n            }\r\n\r\n            //var resTextures = resObject.textures;\r\n            textures = Object.keys(resObject.textures).map(function(k) {\r\n                return resObject.textures[k];\r\n            });\r\n\r\n            //get fps\r\n            var fps = parseInt((resObject.url).split(\"fps=\")[1]);\r\n\r\n            movie = new PIXI.extras.MovieClip(textures);\r\n            movie.width = data.scaleWidth;\r\n            movie.height = data.scaleHeight;\r\n            movie.position.x = data.scaleLeft;\r\n            movie.position.y = data.scaleTop;\r\n\r\n            //if there are masks, make mask textures;\r\n            var imageextension = resObject.name.split('.').pop();\r\n            if (\"jpg\" == imageextension) {\r\n                var maskObject = res[Object.keys(res)[1]];\r\n\r\n                maskTextures = Object.keys(maskObject.textures).map(function(k) {\r\n                    return maskObject.textures[k];\r\n                });\r\n                movie.maskTextures = maskTextures;\r\n                spriteTtage.addChild(movie.maskSprite);\r\n            }\r\n\r\n            //动画速率\r\n            movie.animationSpeed = 0.15 * fps / 10;\r\n            movie.play();\r\n            spriteTtage.addChild(movie);\r\n\r\n            self.movie = movie;\r\n\r\n            //加载完毕\r\n            successCallback(contentId);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 运行动画\r\n     * @return {[type]} [description]\r\n     */\r\n    play: function() {\r\n        //绘制页面\r\n        this.uuid = this.canvasRelated.play('sprite')\r\n    },\r\n\r\n    /**\r\n     * 停止动画\r\n     * @return {[type]} [description]\r\n     */\r\n    stop: function() {\r\n        this.canvasRelated.stop(this.uuid)\r\n    },\r\n\r\n\r\n    /**\r\n     * 销毁动画\r\n     * @return {[type]} [description]\r\n     */\r\n    destroy: function() {\r\n        //if there are movie sprite, destory it\r\n        if (this.movie) {\r\n            //remove it from stage\r\n            if (this.stage) {\r\n                this.stage.removeChild(this.movie);\r\n            }\r\n            //remove texture for movie\r\n            for (var i = 0; i < this.movie.textures.length; i++) {\r\n                this.movie.textures[i].destroy(true);\r\n                if (this.movie.maskSprite) {\r\n                    this.movie.maskTextures[i].destroy(true);\r\n                }\r\n            }\r\n\r\n            //remove movie sprite\r\n            this.movie.destroy(true, true);\r\n        }\r\n        this.canvasRelated.destroy();\r\n    }\r\n\r\n\r\n})\r\n\r\n\r\nexport {\r\n    Sprite\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/sprite.js\n **/","/**\r\n * pixi精灵动画\r\n * @param  {[type]} Utils   [description]\r\n */\r\n\r\nimport {\r\n    observe\r\n}\r\nfrom '../../observer/observe'\r\n\r\nvar arr = [];\r\nvar slice = arr.slice;\r\nvar concat = arr.concat;\r\n\r\n/**\r\n * pixi类\r\n * 子动画基类\r\n * @param {[type]} options [description]\r\n */\r\nvar Factory = Xut.CoreObject.extend({\r\n\r\n    /**\r\n     * 初始化\r\n     * @param  {[type]} data          [description]\r\n     * @param  {[type]} canvasRelated [description]\r\n     * @return {[type]}               [description]\r\n     */\r\n    init: function(options) {\r\n        var pixi = this;\r\n        var args = [\r\n            /**\r\n             * 成功回调\r\n             * @param  {[type]} contentId [description]\r\n             * @return {[type]}           [description]\r\n             */\r\n            function successCallback(contentId) {\r\n                //加载完成构建 ppt实例\r\n                pixi.$emit('load')\r\n            },\r\n            /**\r\n             * 失败回调\r\n             * @param  {[type]} contentId [description]\r\n             * @return {[type]}           [description]\r\n             */\r\n            function failCallback(contentId) {\r\n                //删掉对应的cid记录\r\n                // var index =  canvasRelated.cid.indexOf(contentId)\r\n                // canvasRelated.cid.splice(index,1);\r\n                console.log('failCallback')\r\n            }\r\n        ]\r\n        this.constructor.apply(this, args.concat(slice.call(arguments)))\r\n    },\r\n\r\n    /**\r\n     * 播放\r\n     * @param  {[type]} completeCallback [完成回调]\r\n     * @return {[type]}                  [description]\r\n     */\r\n    playPixi: function(completeCallback) {\r\n        this.checkValidity(function() {\r\n            this.play();\r\n        })\r\n    },\r\n\r\n    //停止\r\n    stopPixi: function() {\r\n        this.checkValidity(function() {\r\n            this.stop();\r\n        })\r\n    },\r\n\r\n    //相关\r\n    destroyPixi: function() {\r\n        this.checkValidity(function() {\r\n            this.destroy();\r\n        })\r\n    },\r\n\r\n    /**\r\n     * 检测是否能有效运行\r\n     * pixi对象是否有效加载\r\n     * @return {[type]} [description]\r\n     */\r\n    checkValidity: function(successCallback) {\r\n        var failCid = this.canvasRelated.failCid;\r\n        var contentId = this.contentId;\r\n        //无效\r\n        if (failCid.length && -1 !== failCid.indexOf(contentId)) {\r\n            return;\r\n        }\r\n        //有效\r\n        successCallback && successCallback.call(this)\r\n    },\r\n\r\n    /**\r\n     * 创建图片地址\r\n     * @return {[type]}         [description]\r\n     */\r\n    analysisPath: function(conData) {\r\n        var pathImg,\r\n            imgContent = conData.md5,\r\n            //是gif格式\r\n            isGif = /.gif$/i.test(imgContent),\r\n            //原始地址\r\n            originalPathImg = Xut.config.pathAddress + imgContent;\r\n        if (isGif) {\r\n            //处理gif图片缓存+随机数\r\n            pathImg = Xut.createRandomImg(originalPathImg)\r\n        } else {\r\n            pathImg = originalPathImg;\r\n        }\r\n        return pathImg;\r\n    }\r\n\r\n});\r\n\r\nobserve.call(Factory.prototype);\r\n\r\n\r\nexport {\r\n    Factory\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/factory.js\n **/","let uid = 0\r\n\r\n/**\r\n * 依赖订阅\r\n */\r\nfunction Dep() {\r\n    this.id = uid++;\r\n    this.subs = []\r\n}\r\n\r\nDep.prototype.addSub = function(sub) {\r\n    this.subs.push(sub)\r\n}\r\n\r\nDep.prototype.removeSub = function(sub) {\r\n    this.subs = [];\r\n}\r\n\r\nDep.prototype.notify = function() {\r\n    if (this.subs.length) {\r\n        console.log('依赖队列')\r\n    }\r\n}\r\n\r\nexport {Dep}\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/dep.js\n **/","/***************************************************************\r\n *\r\n *          视觉差对象初始化操作\r\n *\r\n ****************************************************************/\r\n\r\n\r\nlet screenSize\r\n\r\n//变化节点的css3transform属性\r\nfunction transformNodes(rootNode, property, pageOffset) {\r\n    var style = {},\r\n        effect = '',\r\n        parallaxOffset, //最终的偏移量X\r\n        x = 0,\r\n        y = 0,\r\n        z = 0,\r\n        round = Math.round,\r\n        prefix = Xut.plat.prefixStyle,\r\n\r\n        //浮动对象初始化偏移量\r\n        parallaxOffset = pageOffset;\r\n\r\n    if (property.translateX != undefined || property.translateY != undefined || property.translateZ != undefined) {\r\n        x = round(property.translateX) || 0;\r\n        y = round(property.translateY) || 0;\r\n        z = round(property.translateZ) || 0;\r\n        parallaxOffset += x;\r\n        effect += String.format('translate3d({0}px,{1}px,{2}px) ', parallaxOffset, y, z);\r\n    }\r\n\r\n    if (property.rotateX != undefined || property.rotateY != undefined || property.rotateZ != undefined) {\r\n        x = round(property.rotateX);\r\n        y = round(property.rotateY);\r\n        z = round(property.rotateZ);\r\n        effect += x ? 'rotateX(' + x + 'deg) ' : '';\r\n        effect += y ? 'rotateY(' + y + 'deg) ' : '';\r\n        effect += z ? 'rotateZ(' + z + 'deg) ' : '';\r\n    }\r\n\r\n    if (property.scaleX != undefined || property.scaleY != undefined || property.scaleZ != undefined) {\r\n        x = round(property.scaleX * 100) / 100 || 1;\r\n        y = round(property.scaleY * 100) / 100 || 1;\r\n        z = round(property.scaleZ * 100) / 100 || 1;\r\n        effect += String.format('scale3d({0},{1},{2}) ', x, y, z);\r\n    }\r\n\r\n    if (property.opacity != undefined) {\r\n        style.opacity = round((property.opacityStart + property.opacity) * 100) / 100;\r\n        effect += ';'\r\n    }\r\n\r\n    if (effect) {\r\n        style[prefix('transform')] = effect;\r\n        rootNode.css(style);\r\n    }\r\n\r\n    return parallaxOffset;\r\n}\r\n\r\n//转换成比例值\r\nfunction conversionRatio(parameters) {\r\n    if (parameters.opacityStart > -1) {\r\n        parameters.opacity = (parameters.opacityEnd || 1) - parameters.opacityStart;\r\n        delete parameters.opacityEnd;\r\n    }\r\n    return parameters;\r\n}\r\n\r\n//转化成实际值\r\nfunction conversionValue(parameters, nodeProportion, screenSize) {\r\n    var results = {},\r\n        width = -screenSize.width,\r\n        height = -screenSize.height;\r\n\r\n    for (var i in parameters) {\r\n        switch (i) {\r\n            case 'translateX':\r\n            case 'translateZ':\r\n                results[i] = parameters[i] * nodeProportion * width;\r\n                break;\r\n            case 'translateY':\r\n                results[i] = parameters[i] * nodeProportion * height;\r\n                break;\r\n            case 'opacityStart':\r\n                results[i] = parameters[i];\r\n                break;\r\n            default:\r\n                results[i] = parameters[i] * nodeProportion;\r\n        }\r\n    }\r\n\r\n    return results;\r\n}\r\n\r\nexport function Parallax(data) {\r\n\r\n    screenSize = Xut.config.screenSize\r\n\r\n    try {\r\n        //转化所有css特效的参数的比例\r\n        var parameters = JSON.parse(data.getParameter()[0]['parameter']);\r\n    } catch (err) {\r\n        return false;\r\n    }\r\n    var pid = data.pid,\r\n        translate = conversionRatio(parameters),\r\n        //页面偏移量\r\n        pageOffset = this.relatedData.pageOffset && this.relatedData.pageOffset.split(\"-\"),\r\n        //开始的nodes值\r\n        currPageOffset = pageOffset[0],\r\n        //范围区域\r\n        pageRange = pageOffset[1],\r\n        //页面偏移比例\r\n        nodeOffsetProportion = (currPageOffset - 1) / (pageRange - 1),\r\n        //计算出偏移值\r\n        offsetTranslate = conversionValue(translate, nodeOffsetProportion, screenSize),\r\n        //页面分割比\r\n        nodeProportion = 1 / (pageRange - 1);\r\n\r\n    //改变节点的transform属性\r\n    //返回改变后translateX值\r\n    var parallaxOffset = transformNodes(data.$contentProcess, _.extend({}, offsetTranslate), data.transformOffset);\r\n\r\n    /**\r\n     * 为了兼容动画，把视觉差当作一种行为处理\r\n     * 合并data数据\r\n     * @type {Object}\r\n     */\r\n    data.parallax = {\r\n        //计算页码结束边界值,用于跳转过滤\r\n        calculateRangePage: function() {\r\n            return {\r\n                'start': pid - currPageOffset + 1,\r\n                'end': pageRange - currPageOffset + pid\r\n            }\r\n        },\r\n        'translate': translate,\r\n        'offsetTranslate': offsetTranslate,\r\n        'nodeProportion': nodeProportion,\r\n        'rootNode': data.$contentProcess,\r\n        'parallaxOffset': parallaxOffset //经过视觉差修正后的偏移量\r\n    }\r\n\r\n    return data;\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/parallax.js\n **/","/**\r\n * 搜索栏\r\n * 方便用户更加便捷的找到所需要的信息\r\n *\r\n */\r\n\r\n\r\n//图标\r\nvar icons = {\r\n    search: 'images/icons/search.svg',\r\n    clear: 'images/icons/clear.svg',\r\n    exit: 'images/icons/exit.svg'\r\n};\r\n\r\nfunction SearchBar(options) {\r\n    //父容器\r\n    this.parent = options.parent;\r\n    //提示信息\r\n    this.tips = options.tips;\r\n    this.init();\r\n}\r\n\r\n/**\r\n * 初始化\r\n * @return {[type]} [description]\r\n */\r\nSearchBar.prototype.init = function() {\r\n    var $box = this.searchForm(),\r\n        dom = this.parent[0];\r\n\r\n    this.parent.append($box);\r\n    this.searchBox = $box;\r\n    this.resultBox = $box.find('.xut-search-result');\r\n    this.input = $box.find('.xut-search-input');\r\n    this.searchBtn = $box.find('.xut-search-btn');\r\n\r\n    //用户操作事件邦定\r\n    Xut.plat.execEvent('on', {\r\n        context: dom,\r\n        callback: {\r\n            end: this\r\n        }\r\n    })\r\n\r\n    //即时搜索\r\n    dom.addEventListener('keyup', this, false);\r\n}\r\n\r\n/**\r\n * 创建搜索框\r\n * @return {[object]} [jquery生成的dom对象]\r\n */\r\nSearchBar.prototype.searchForm = function() {\r\n    var W = window.innerWidth * 0.3,\r\n        H = window.innerHeight;\r\n    var text = this.tips || '请在搜索框中输入要搜索的关键字';\r\n\r\n    var box = '<div class=\"xut-form-search\">' +\r\n        '<div class=\"xut-form-search-wrap\">' +\r\n        '<div style=\"height:17%;\">' +\r\n        '<div style=\"height:20%\"></div>' +\r\n        '<div class=\"xut-search-row\">' +\r\n        '<input type=\"text\" class=\"xut-search-input\">' +\r\n        '<div class=\"xut-search-btn\" style=\"background-image: url(' + icons.search + ')\"></div>' +\r\n        '</div>' +\r\n        '<p class=\"xut-search-tips\" style=\"line-height:' + Math.round(H * 0.06) + 'px\">' + text + '</p>' +\r\n        '</div>' +\r\n        '<div style=\"height:76%\">' +\r\n        '<ul class=\"xut-search-result\"></ul>' +\r\n        '</div>' +\r\n        '<div style=\"height:7%\">' +\r\n        '<div class=\"xut-search-exit\" style=\"background-image: url(' + icons.exit + ')\"></div>' +\r\n        '</div>' +\r\n        '</div></div>';\r\n\r\n    var $box = $(box);\r\n\r\n    $box.css('width', W < 200 ? 200 : W)\r\n\r\n    return $box;\r\n}\r\n\r\n\r\n/**\r\n * 搜索\r\n * @param {string} [keyword] [搜索关键字]\r\n */\r\nSearchBar.prototype.search = function(keyword) {\r\n    var data = Xut.data.Chapter,\r\n        ln = data.length,\r\n        list = '',\r\n        rs, pageId, seasonId;\r\n\r\n    if (!keyword) {\r\n        this.resultBox.html('');\r\n        return;\r\n    }\r\n\r\n    for (var i = 0; i < ln; i++) {\r\n        rs = data.item(i);\r\n        if (rs.chapterTitle.indexOf(keyword) > -1) {\r\n            pageId = rs._id;\r\n            seasonId = rs.seasonId;\r\n            list += '<li><a class=\"xut-search-link\" data-mark=\"' + seasonId + '-' + pageId + '\" href=\"javascript:0\">' + rs.chapterTitle + '</a></li>';\r\n        }\r\n    }\r\n\r\n    this.resultBox.html(list);\r\n}\r\n\r\n/**\r\n * 切换搜索按钮图标\r\n * @param  {[type]} icon [图标路径]\r\n * @return {[type]}      [description]\r\n */\r\nSearchBar.prototype.iconManager = function(icon) {\r\n    if (this.isChange) {\r\n        this.searchBtn.css('background-image', 'url(' + icon + ')');\r\n    };\r\n}\r\n\r\n/**\r\n * 跳转到搜索结果页\r\n * @param  {[type]} target [description]\r\n * @return {[type]}        [description]\r\n */\r\nSearchBar.prototype.searchLink = function(target) {\r\n    if (!target || !target.dataset) return;\r\n    var mark = target.dataset.mark.split('-'),\r\n        seasonId = mark[0],\r\n        pageId = mark[1];\r\n\r\n    Xut.View.LoadScenario({\r\n        'scenarioId': seasonId,\r\n        'chapterId': pageId\r\n    })\r\n}\r\n\r\n/**\r\n * 邦定事件\r\n * @param  {[type]} evt [事件]\r\n * @return {[type]}     [description]\r\n */\r\nSearchBar.prototype.handleEvent = function(evt) {\r\n    var target = evt.target;\r\n    switch (target.className) {\r\n        case 'xut-search-btn':\r\n            //点击搜索\r\n            this.search(this.input.val());\r\n            this.isChange = true;\r\n            this.iconManager(icons.clear);\r\n            break;\r\n        case 'xut-search-input':\r\n            //实时搜索\r\n            this.search(target.value);\r\n            //还原按钮图标\r\n            this.iconManager(icons.search);\r\n            this.isChange = false;\r\n            break;\r\n        case 'xut-search-exit':\r\n            //关闭搜索框\r\n            this.exit();\r\n            break;\r\n        case 'xut-search-link':\r\n            //跳转\r\n            this.searchLink(target);\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\n/**\r\n * 关闭搜索框\r\n * @return {[type]} [description]\r\n */\r\nSearchBar.prototype.exit = function() {\r\n    this.input.val('');\r\n    this.resultBox.empty();\r\n    this.searchBox.hide();\r\n}\r\n\r\n/**\r\n * 恢复搜索框\r\n */\r\nSearchBar.prototype.restore = function() {\r\n    var searchBox = this.searchBox;\r\n    searchBox && searchBox.show();\r\n}\r\n\r\n/**\r\n * 销毁搜索框\r\n * @return {[type]} [description]\r\n */\r\nSearchBar.prototype.destroy = function() {\r\n    var dom = this.parent[0];\r\n    dom.removeEventListener('keyup', this, false);\r\n    dom.removeEventListener('touchend', this, false);\r\n    dom.removeEventListener('mouseup', this, false);\r\n\r\n    this.searchBox.remove();\r\n    this.searchBox = null;\r\n    this.resultBox = null;\r\n    this.searchBtn = null;\r\n    this.input = null;\r\n    this.parent = null;\r\n}\r\n\r\nexport {\r\n    SearchBar\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/searchbar.js\n **/","/**\r\n * 书签栏\r\n * 加入这个书签功能后，可以让用户自由选择哪页是需要保存记录的\r\n * @param options object\r\n * @example {parent:页面容器,pageId:chapterId,seasonId:seasionId}\r\n */\r\n\r\nimport {\r\n    _set,\r\n    _get,\r\n    _remove\r\n}\r\nfrom '../../util/stroage'\r\n\r\nvar icons = {\r\n        hide: 'images/icons/arrowDown.svg'\r\n    },\r\n    sLineHeiht = parseInt($('body').css('font-size')) || 16, //行高\r\n    BOOKCACHE; //书签缓存\r\n\r\nfunction BookMark(options) {\r\n    this.parent = options.parent;\r\n    this.pageId = options.pageId;\r\n    this.seasonId = options.seasonId;\r\n    //是否已存储\r\n    this.isStored = false;\r\n    this.init();\r\n}\r\n\r\n/**\r\n * 初始化\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.init = function() {\r\n    var $bookMark = this.createBookMark(),\r\n        dom = this.parent[0],\r\n        that = this;\r\n\r\n    this.parent.append($bookMark);\r\n    this.bookMarkMenu = $bookMark.eq(0);\r\n    //显示书签\r\n    setTimeout(function() {\r\n        that.restore();\r\n    }, 20);\r\n    //获取历史记录\r\n    BOOKCACHE = this.getHistory();\r\n\r\n    //邦定用户事件\r\n    Xut.plat.execEvent('on', {\r\n        context: dom,\r\n        callback: {\r\n            end: this\r\n        }\r\n    })\r\n\r\n}\r\n\r\n/**\r\n * 创建书签\r\n * @return {[object]} [jquery生成的dom对象]\r\n */\r\nBookMark.prototype.createBookMark = function() {\r\n\r\n    var screenSize = Xut.config.screenSize\r\n    var sHeight = screenSize.height\r\n\r\n    var height = sLineHeiht * 3, // menu的高为3em\r\n        box = '<div class=\"xut-bookmark-menu\" style=\"width:100%;height:{0}px;left:0;top:{1}px;\">' +\r\n        '<div class=\"xut-bookmark-wrap\">' +\r\n        '<div class=\"xut-bookmark-add\">加入书签</div>' +\r\n        '<div class=\"xut-bookmark-off\" style=\"background-image:url({2})\"></div>' +\r\n        '<div class=\"xut-bookmark-view\">书签记录</div>' +\r\n        '</div>' +\r\n        '</div>' +\r\n        '<div class=\"xut-bookmark-list\" style=\"display:none;width:100%;height:{3}px;\">' +\r\n        '<ul class=\"xut-bookmark-head\">' +\r\n        '<li class=\"xut-bookmark-back\">返回</li>' +\r\n        '<li>书签</li>' +\r\n        '</ul>' +\r\n        '<ul class=\"xut-bookmark-body\"></ul>' +\r\n        '</div>';\r\n    box = String.format(box, height, sHeight, icons.hide, sHeight);\r\n    this.markHeight = height;\r\n    return $(box);\r\n}\r\n\r\n/**\r\n * 生成书签列表\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.createMarkList = function() {\r\n    var tmp, seasonId, pageId,\r\n        list = '',\r\n        box = '',\r\n        self = this;\r\n\r\n    //取历史记录\r\n    _.each(BOOKCACHE, function(mark) {\r\n        tmp = mark.split('-');\r\n        seasonId = tmp[0];\r\n        pageId = tmp[1];\r\n        mark = self.getMarkId(seasonId, pageId);\r\n        list += '<li><a data-mark=\"' + mark + '\" class=\"xut-bookmark-id\" href=\"javascript:0\">第' + pageId + '页</a><a class=\"xut-bookmark-del\" data-mark=\"' + mark + '\" href=\"javascript:0\">X</a></li>';\r\n    })\r\n\r\n    return list;\r\n}\r\n\r\n/**\r\n * 创建存储标签\r\n * 存储格式 seasonId-pageId\r\n * @return {string} [description]\r\n */\r\nBookMark.prototype.getMarkId = function(seasonId, pageId) {\r\n    return seasonId + '-' + pageId;\r\n}\r\n\r\n/**\r\n * 获取历史记录\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.getHistory = function() {\r\n    var mark = _get('bookMark');\r\n    if (mark) {\r\n        return mark.split(',');\r\n    }\r\n    return [];\r\n}\r\n\r\n/**\r\n * 添加书签\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.addBookMark = function() {\r\n    var key;\r\n\r\n    this.updatePageInfo();\r\n    key = this.getMarkId(this.seasonId, this.pageId);\r\n\r\n    //避免重复缓存\r\n    if (BOOKCACHE.indexOf(key) > -1) {\r\n        return;\r\n    }\r\n    BOOKCACHE.push(key)\r\n    _set('bookMark', BOOKCACHE);\r\n}\r\n\r\n/**\r\n * 更新页信息\r\n *  针对母板层上的书签\r\n */\r\nBookMark.prototype.updatePageInfo = function() {\r\n    var pageData = Xut.Presentation.GetPageData();\r\n    this.pageId = pageData._id;\r\n    this.seasonId = pageData.seasonId;\r\n}\r\n\r\n/**\r\n * 删除书签\r\n * @param {object} [key] [事件目标对象]\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.delBookMark = function(target) {\r\n    if (!target || !target.dataset) return;\r\n\r\n    var key = target.dataset.mark,\r\n        index = BOOKCACHE.indexOf(key);\r\n\r\n    BOOKCACHE.splice(index, 1);\r\n    _set('bookMark', BOOKCACHE);\r\n\r\n    if (BOOKCACHE.length == 0) {\r\n        _remove('bookMark');\r\n    }\r\n\r\n    //移除该行\r\n    $(target).parent().remove();\r\n}\r\n\r\n/**\r\n * 显示书签\r\n * @param {object} [target] [事件目标对象]\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.viewBookMark = function(target) {\r\n    var $bookMarkList,\r\n        list = this.createMarkList();\r\n\r\n    if (this.bookMarkList) {\r\n        $bookMarkList = this.bookMarkList;\r\n    } else {\r\n        $bookMarkList = $(target).parent().parent().next();\r\n    }\r\n    //更新书签内容\r\n    $bookMarkList.find('.xut-bookmark-body').html(list);\r\n    this.bookMarkList = $bookMarkList;\r\n    $bookMarkList.fadeIn();\r\n}\r\n\r\n/**\r\n * 点击放大效果\r\n * @param  {[object]} target [事件目标对象]\r\n * @return {[type]}      [description]\r\n */\r\nBookMark.prototype.iconManager = function(target) {\r\n    var $icon = this.bookMarkIcon = $(target),\r\n        restore = this.iconRestore;\r\n\r\n    $icon.css({\r\n        'transform': 'scale(1.2)',\r\n        'transition-duration': '500ms'\r\n    })[0].addEventListener(Xut.plat.TRANSITION_EV, restore.bind(this), false);\r\n\r\n}\r\n\r\n/**\r\n * 复原按钮\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.iconRestore = function() {\r\n    this.bookMarkIcon.css('transform', '');\r\n}\r\n\r\n/**\r\n * 跳转到书签页\r\n * @param  {[type]} target [description]\r\n * @return {[type]}        [description]\r\n */\r\nBookMark.prototype.goBookMark = function(target) {\r\n    if (!target || !target.dataset) return;\r\n\r\n    var key = target.dataset.mark.split('-'),\r\n        seasonId = Number(key[0]),\r\n        pageId = Number(key[1]);\r\n\r\n    this.updatePageInfo();\r\n    //关闭书签列表\r\n    this.backBookMark();\r\n\r\n    //忽略当前页的跳转\r\n    if (this.pageId == pageId && this.seasonId == seasonId) {\r\n        return;\r\n    }\r\n\r\n    Xut.View.LoadScenario({\r\n        'scenarioId': seasonId,\r\n        'chapterId': pageId\r\n    })\r\n\r\n}\r\n\r\n/**\r\n * 书签回退键\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.backBookMark = function() {\r\n    this.bookMarkList.fadeOut();\r\n}\r\n\r\n/**\r\n * 邦定事件\r\n * @param  {[type]} evt [事件]\r\n * @return {[type]}     [description]\r\n */\r\nBookMark.prototype.handleEvent = function(evt) {\r\n    var target = evt.target;\r\n    switch (target.className) {\r\n        //加入书签\r\n        case 'xut-bookmark-add':\r\n            this.addBookMark();\r\n            this.iconManager(target);\r\n            break;\r\n            //显示书签记录\r\n        case 'xut-bookmark-view':\r\n            this.viewBookMark(target);\r\n            this.iconManager(target);\r\n            break;\r\n            //关闭书签\r\n        case 'xut-bookmark-off':\r\n            this.closeBookMark(target);\r\n            break;\r\n            //返回书签主菜单\r\n        case 'xut-bookmark-back':\r\n            this.backBookMark();\r\n            break;\r\n            //删除书签记录\r\n        case 'xut-bookmark-del':\r\n            this.delBookMark(target);\r\n            break;\r\n            //跳转到书签页\r\n        case 'xut-bookmark-id':\r\n            this.goBookMark(target);\r\n            break;\r\n        default:\r\n            //console.log(target.className)\r\n            break;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 关闭书签菜单\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.closeBookMark = function(target) {\r\n    this.bookMarkMenu.css({\r\n        transform: 'translate3d(0,0,0)',\r\n        'transition-duration': '1s'\r\n    })\r\n}\r\n\r\n/**\r\n * 恢复书签菜单\r\n */\r\nBookMark.prototype.restore = function() {\r\n    this.bookMarkMenu.css({\r\n        transform: 'translate3d(0,-' + this.markHeight + 'px,0)',\r\n        'transition-duration': '1s'\r\n    })\r\n}\r\n\r\n/**\r\n * 销毁书签\r\n * @return {[type]} [description]\r\n */\r\nBookMark.prototype.destroy = function() {\r\n    var dom = this.parent[0],\r\n        events = Xut.plat;\r\n\r\n    dom.removeEventListener('touchend', this, false);\r\n    dom.removeEventListener('mouseup', this, false);\r\n\r\n    //菜单部分\r\n    if (this.bookMarkMenu) {\r\n        this.bookMarkMenu.remove();\r\n        this.bookMarkMenu = null;\r\n    }\r\n\r\n    //列表部分\r\n    if (this.bookMarkList) {\r\n        this.bookMarkList.remove();\r\n        this.bookMarkList = null;\r\n    }\r\n\r\n    //按钮效果\r\n    if (this.bookMarkIcon) {\r\n        this.bookMarkIcon[0].removeEventListener(events.TRANSITION_EV, this.iconRestore, false);\r\n        this.bookMarkIcon = null;\r\n    }\r\n\r\n    this.parent = null;\r\n}\r\n\r\n\r\nexport {\r\n    BookMark\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/bookmark.js\n **/","/**\r\n * html文本框\r\n * @param  {[type]} ){} [description]\r\n * @return {[type]}       [description]\r\n */\r\n\r\nimport {\r\n    bindEvents\r\n}\r\nfrom './event'\r\n\r\n\r\nimport {\r\n    _set,\r\n    _get\r\n}\r\nfrom '../../util/stroage'\r\n \r\nlet defaultFontSize\r\nlet baseValue1\r\nlet baseValue2\r\nlet baseValue3\r\n\r\nfunction setOption() {\r\n    var proportion = Xut.config.proportion.width;\r\n    var docEl = document.documentElement;\r\n    try {\r\n        defaultFontSize = parseInt(getComputedStyle(docEl).fontSize)\r\n    } catch (er) {\r\n        defaultFontSize = 16\r\n    }\r\n\r\n    //实际字体大小\r\n    defaultFontSize = defaultFontSize * proportion;\r\n\r\n    //设置默认rem\r\n    docEl.style.fontSize = defaultFontSize + \"px\"\r\n\r\n    baseValue1 = Math.floor(defaultFontSize * 1.5);\r\n    baseValue2 = Math.floor(defaultFontSize * 2.0);\r\n    baseValue3 = Math.floor(defaultFontSize * 2.5);\r\n}\r\n\r\n/**\r\n * 工具栏布局\r\n * @return {[type]} [description]\r\n */\r\nfunction textLayer() {\r\n    var str = '  <div class=\"htmlbox_close_container\">' + '        <a class=\"htmlbox_close\"></a>' + ' </div>' + ' <ul class=\"htmlbox_fontsizeUl\">' + '    <li>' + '        <a class=\"htmlbox_small\" style=\"width:{0}px;height:{1}px;margin-top:-{2}px\"></a>' + '     </li>' + '     <li>' + '        <a class=\"htmlbox_middle\" style=\"width:{3}px;height:{4}px;margin-top:-{5}px\"></a>' + '     </li>' + '    <li>' + '        <a class=\"htmlbox_big\" style=\"width:{6}px;height:{7}px;margin-top:-{8}px\"></a>' + '    </li>' + ' </ul>'\r\n\r\n    return String.format(str,\r\n        baseValue1, baseValue1, baseValue1 / 2,\r\n        baseValue2, baseValue2, baseValue2 / 2,\r\n        baseValue3, baseValue3, baseValue3 / 2\r\n    );\r\n}\r\n\r\n/**\r\n * 创建盒子容器\r\n * @return {[type]} [description]\r\n */\r\nfunction createWapper(boxName, textLayer, iscrollName, textContent) {\r\n    var wapper = ' <div id=\"{0}\" class=\"htmlbox_container\">' + '    <div class=\"htmlbox-toolbar\">{1}</div>' + '    <div id=\"{2}\" style=\"overflow:hidden;position:absolute;width:100%;height:92%;\">' + '        <ul>' + '          {3}' + '        </ul>' + '     </div>' + ' </div>'\r\n\r\n    return String.format(wapper, boxName, textLayer, iscrollName, textContent)\r\n}\r\n\r\n\r\nfunction HtmlBox(contentId, element) {\r\n\r\n    setOption();\r\n\r\n    this.contentId = contentId;\r\n    this.element = element;\r\n    var self = this;\r\n\r\n    //事件对象引用\r\n    var eventHandler = function(eventReference, eventHandler) {\r\n        self.eventReference = eventReference;\r\n        self.eventHandler = eventHandler;\r\n    }\r\n\r\n    //绑定点击事件\r\n    bindEvents({\r\n        'eventRun': function() {\r\n            Xut.View.HideToolbar();\r\n            self.init(contentId, element)\r\n        },\r\n        'eventHandler': eventHandler,\r\n        'eventContext': element,\r\n        'eventName': \"tap\",\r\n        'domMode': true\r\n    });\r\n}\r\n\r\nHtmlBox.prototype = {\r\n\r\n    /**\r\n     * 调整字体大小\r\n     * @return {[type]} [description]\r\n     */\r\n    adjustSize: function(value, save) {\r\n        value = parseInt(value);\r\n        docEl.style.fontSize = value + \"px\";\r\n        save && _set(this.storageName, value)\r\n    },\r\n\r\n    /**\r\n     * 卷滚\r\n     * @param  {[type]} iscrollName [description]\r\n     * @return {[type]}             [description]\r\n     */\r\n    createIscroll: function(iscrollName) {\r\n        this.iscroll = new iScroll(\"#\" + iscrollName, {\r\n            scrollbars: true,\r\n            fadeScrollbars: true\r\n        });\r\n    },\r\n\r\n    init: function(contentId, element) {\r\n\r\n        var self = this;\r\n\r\n        //移除偏移量 存在偏移量造成文字被覆盖\r\n        var textContent = element.find(\">\").html();\r\n        textContent = textContent.replace(/translate\\(0px, -\\d+px\\)/g, 'translate(0px,0px)');\r\n\r\n        var boxName = \"htmlbox_\" + contentId;\r\n        var iscrollName = \"htmlbox_iscroll_\" + contentId;\r\n\r\n        //缓存名\r\n        this.storageName = boxName + Xut.config.appId;\r\n\r\n        //获取保存的字体值\r\n        var storageValue = _get(this.storageName)\r\n        if (storageValue) {\r\n            this.adjustSize(storageValue)\r\n        }\r\n\r\n        //创建容器\r\n        this.$str = $(createWapper(boxName, textLayer(), iscrollName, textContent));\r\n        element.after(this.$str);\r\n\r\n        //卷滚\r\n        this.createIscroll(iscrollName);\r\n\r\n        //绑定事件上下文呢\r\n        this.eventContext = this.$str.find('.htmlbox-toolbar')[0];\r\n        //字体大小\r\n        var sizeArray = [\"1\", \"1.25\", \"1.5\"];\r\n        //改变字体与刷新卷滚\r\n        var change = function(fontsize) {\r\n                self.adjustSize(fontsize * defaultFontSize, true);\r\n                self.iscroll.refresh()\r\n            }\r\n            //处理器\r\n        var process = {\r\n                htmlbox_close_container: function() {\r\n                    self.adjustSize(defaultFontSize)\r\n                    self.removeBox();\r\n                },\r\n                htmlbox_close: function() {\r\n                    self.adjustSize(defaultFontSize)\r\n                    self.removeBox();\r\n                },\r\n                htmlbox_small: function() {\r\n                    change(sizeArray[0]);\r\n                },\r\n                htmlbox_middle: function() {\r\n                    change(sizeArray[1]);\r\n                },\r\n                htmlbox_big: function() {\r\n                    change(sizeArray[2]);\r\n                }\r\n            }\r\n            //冒泡匹配按钮点击\r\n        this.start = function(e) {\r\n            var className = e.target.className;\r\n            process[className] && process[className]();\r\n        }\r\n        Xut.plat.execEvent('on', {\r\n            context: this.eventContext,\r\n            callback: {\r\n                start: this.start\r\n            }\r\n        })\r\n    },\r\n\r\n    //移除盒子\r\n    removeBox: function() {\r\n        Xut.plat.execEvent('off', {\r\n            context: this.eventContext,\r\n            callback: {\r\n                start: this.start\r\n            }\r\n        })\r\n        this.$str && this.$str.remove();\r\n        this.iscroll && this.iscroll.destroy();\r\n        this.iscroll = null;\r\n    },\r\n\r\n    //销毁外部点击事件与\r\n    destroy: function() {\r\n        _.each(this.eventReference, function(off) {\r\n            off(\"tap\")\r\n        })\r\n        this.removeBox();\r\n    }\r\n}\r\n\r\n\r\nexport {\r\n    HtmlBox\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/htmlbox.js\n **/","/**\r\n * pixi事件绑定\r\n * @param  {[type]} Utils   [description]\r\n * @param  {[type]} Config) {}          [description]\r\n * @return {[type]}         [description]\r\n */\r\n\r\n/**\r\n * 动作适配\r\n * @type {Object}\r\n */\r\nvar adapter = {\r\n    /**\r\n     * 单击\r\n     * @return {[type]} [description]\r\n     */\r\n    \"tap\": function(eventData) {\r\n        var eventContext = eventData.eventContext;\r\n        eventContext.on('mousedown', eventData.eventRun);\r\n        eventContext.on('touchstart', eventData.eventRun);\r\n    }\r\n}\r\n\r\n/**\r\n * 绑定事件\r\n * @param  {[type]} eventData [description]\r\n * @return {[type]}           [description]\r\n */\r\nexport function bindEvents(eventData) {\r\n    //开启交互\r\n    eventData.eventContext.interactive = true;\r\n    adapter[eventData.eventName](eventData);\r\n}\r\n \r\n/**\r\n * 销毁事件\r\n * @return {[type]} [description]\r\n */\r\nexport function destroyEvents() {\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/pixi/event.js\n **/","/**\r\n * 2016.4.11\r\n * 因为canvas模式导致\r\n * 任务必须等待context上下创建\r\n * 完成后执行\r\n * 1 事件\r\n * 2 预执行\r\n * @type {Array}\r\n */\r\nexport function createNextTask(callback) {\r\n    return {\r\n        //子对象上下文\r\n        context: {\r\n            wait: false, //是否等待创建\r\n            statas: false, //是否完成创建\r\n            _ids: [],\r\n            /**\r\n             * 检测是否完成\r\n             * @return {[type]} [description]\r\n             */\r\n            check: function() {\r\n                var total = this.length();\r\n                if (!total.length) {\r\n                    //完成创建\r\n                    this.statas = true;\r\n                }\r\n                //如果已经等待\r\n                if (this.wait) {\r\n                    callback && callback()\r\n                    return\r\n                }\r\n                //创建比流程先执行完毕\r\n                //一般几乎不存在\r\n                //但是不排除\r\n                if (!this.wait && this.statas) {\r\n                    this.wait = true;\r\n                    return;\r\n                }\r\n            },\r\n            add: function(id) {\r\n                if (-1 === this._ids.indexOf(id)) {\r\n                    this._ids.push(id)\r\n                }\r\n            },\r\n            remove: function(id) {\r\n                if (!id) return;\r\n                var index = this._ids.indexOf(id)\r\n                var val = this._ids.splice(index, 1)\r\n                this.check(val);\r\n                return val\r\n            },\r\n            length: function() {\r\n                return this._ids.length;\r\n            }\r\n        },\r\n        event: [], //事件\r\n        pre: {} //预执行\r\n    };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/nexttask.js\n **/","/**\r\n *  创建widgets对象任务片\r\n *  state状态\r\n *      0 未创建\r\n *      1 正常创建\r\n *      2 创建完毕\r\n *      3 创建失败\r\n */\r\n\r\n//组件任务\r\nimport {Bind} from './dispenser/bind'\r\nimport {reviseSize} from '../../util/option'\r\n\r\nfunction TaskComponents(data, suspendCallback, successCallback) {\r\n\r\n    //预编译模式跳过创建\r\n    if (Xut.IBooks.runMode()) {\r\n        successCallback();\r\n        return;\r\n    }\r\n\r\n    if (data['activitys'].length) {\r\n        var str;\r\n        this.rootNode = data['rootNode'];\r\n        this.callback = {\r\n            'suspendCallback': suspendCallback,\r\n            'successCallback': successCallback\r\n        }\r\n        str = this.create(data);\r\n        this.compileSuspend(str);\r\n    } else {\r\n        successCallback();\r\n    }\r\n}\r\n\r\nTaskComponents.prototype = {\r\n\r\n    clearReference: function() {\r\n        this.rootNode = null;\r\n    },\r\n\r\n    create: function(data) {\r\n        var actType,\r\n            pageType      = data.pageType,\r\n            createWidgets = data.activitys,\r\n            chpaterData   = data.chpaterData,\r\n            chapterId     = data.chapterId,\r\n            pid           = data.pid,\r\n            virtualOffset = data.virtualOffset,\r\n            widgetRetStr  = [];\r\n            \r\n\r\n        function virtualCreate(actType, activityData) {\r\n            var scaleLeft = activityData.scaleLeft;\r\n            // 创建分布左边的对象\r\n            if (virtualOffset === 'left') {\r\n                if (scaleLeft < Xut.config.screenSize.width) {\r\n                    startCreate(actType, activityData)\r\n                }\r\n            }\r\n            //创建分布右边的对象\r\n            if (virtualOffset === 'right') {\r\n                if (scaleLeft > Xut.config.screenSize.width) {\r\n                    startCreate(actType, activityData)\r\n                }\r\n            }\r\n        }\r\n\r\n        //创建\r\n        function startCreate(actType, activityData) {\r\n            //创建DOM元素结构\r\n            //返回是拼接字符串\r\n            widgetRetStr.push(Bind[actType]['createDom'](\r\n                activityData, chpaterData, chapterId, pid, Xut.zIndexlevel(), pageType\r\n            ));\r\n        }\r\n\r\n\r\n        //需要创建的数据结构\r\n        createWidgets.forEach(function(activityData, index) {\r\n\r\n            //创建类型\r\n            actType = activityData.actType || activityData.animation;\r\n\r\n            //特殊类型 showNote\r\n            if (!actType && activityData.note) {\r\n                activityData['actType'] = actType = \"ShowNote\";\r\n            }\r\n\r\n            switch (actType) {\r\n                case 'ShowNote':\r\n                case 'Action':\r\n                case 'Widget':\r\n                case 'Audio':\r\n                case 'Video':\r\n\r\n                    //缩放比\r\n                    activityData = reviseSize(activityData);\r\n\r\n                    //处理虚拟模式创建\r\n                    if (Xut.config.virtualMode) {\r\n                        virtualCreate(actType, activityData)\r\n                    } else {\r\n                        startCreate(actType, activityData)\r\n                    }\r\n                    break;\r\n            }\r\n        })\r\n\r\n        return widgetRetStr.join(\"\");\r\n    },\r\n\r\n    /**\r\n     * 编译中断函数\r\n     * @return {[type]} [description]\r\n     */\r\n    compileSuspend: function(str) {\r\n\r\n        var nextTasks, suspendTasks,\r\n            self = this;\r\n\r\n        //继续执行\r\n        nextTasks = function() {\r\n            Xut.nextTick({\r\n                container: self.rootNode,\r\n                content: $(str)\r\n            }, function() {\r\n                self.clearReference();\r\n                self.callback.successCallback();\r\n            });\r\n        }\r\n\r\n        //中断方法\r\n        suspendTasks = function() {\r\n            self.suspendQueues = [];\r\n            self.suspendQueues.push(function() {\r\n                nextTasks()\r\n            })\r\n        }\r\n\r\n        self.callback.suspendCallback(nextTasks, suspendTasks);\r\n    },\r\n\r\n    //运行被阻断的线程任务\r\n    runSuspendTasks: function() {\r\n        if (this.suspendQueues) {\r\n            var fn;\r\n            if (fn = this.suspendQueues.pop()) {\r\n                fn();\r\n            }\r\n            this.suspendQueues = null;\r\n        }\r\n    }\r\n}\r\n\r\nexport { TaskComponents }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/thread/components.js\n **/","// 观察\r\nimport {observe} from '../observer/observe'\r\n\r\n/**\r\n * canvas相关处理\r\n * 启动canvas,pixi库\r\n * 事件，动画等\r\n * 需要收集所有content的执行\r\n * 因为canvas只能绘制一次\r\n * cnavas模式下 category === \"Sprite\" 转化cid\r\n */\r\n\r\nvar Factory = function() {\r\n\r\n    /**\r\n     * 是否启动模式\r\n     * @type {Boolean}\r\n     */\r\n    this.enable = false\r\n\r\n    /**\r\n     * 加载失败content列表\r\n     * @type {Array}\r\n     */\r\n    this.failCid = []\r\n\r\n    //所有contentId\r\n    this.cid = []\r\n\r\n    //开启了contentMode的节点\r\n    //对应的content转化成canvas模式\r\n    //普通精灵动画\r\n    //ppt动画=>转化\r\n    this.pptId = []\r\n\r\n    //普通灵精\r\n    this.spiritId = []\r\n\r\n    //widget零件保存的content id \r\n    //高级精灵动画\r\n    this.widgetId = []\r\n\r\n    /**\r\n     * cid=>wid\r\n     * 对应的pixi对象容器\r\n     * @type {Object}\r\n     */\r\n    this.collections = {}\r\n\r\n}\r\n\r\nobserve.call(Factory.prototype);\r\n\r\nexport { Factory }\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/pagebase/canvasrelated.js\n **/","/**\r\n * 利用canvas绘制出蒙板效果替换，需要蒙板效果的图片先用一个canvas占位，绘制是异步的\r\n */\r\n\r\nfunction _getCanvas(className) {\r\n    var children = document.getElementsByTagName('canvas'),\r\n        elements = new Array(),\r\n        i = 0,\r\n        child,\r\n        classNames,\r\n        j = 0;\r\n    for (i = 0; i < children.length; i++) {\r\n        child = children[i];\r\n        classNames = child.className.split(' ');\r\n        for (var j = 0; j < classNames.length; j++) {\r\n            if (classNames[j] == className) {\r\n                elements.push(child);\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return elements;\r\n}\r\n\r\n\r\nfunction _addEdge(canvas) {\r\n\r\n    var img = new Image(),\r\n        maskimg = new Image();\r\n    classNames = canvas.className.split(' ');\r\n    var context = canvas.getContext(\"2d\");\r\n    img.addEventListener(\"load\", loadimg);\r\n    maskimg.addEventListener(\"load\", loadmask);\r\n\r\n    function loadimg() {\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n        context.globalCompositeOperation = \"source-over\";\r\n        context.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n        maskimg.src = canvas.getAttribute(\"mask\");\r\n        img.removeEventListener(\"load\", loadimg);\r\n        img.src = null;\r\n        img = null;\r\n    }\r\n\r\n    function loadmask() {\r\n        context.globalCompositeOperation = \"destination-atop\";\r\n        context.drawImage(maskimg, 0, 0, canvas.width, canvas.height);\r\n        canvas.style.opacity = 1;\r\n        maskimg.removeEventListener(\"load\", loadmask);\r\n        maskimg.src = null;\r\n        maskimg = null;\r\n        context = null;\r\n        classNames = null;\r\n        canvas.className = canvas.className.replace(\"edges\", \"\");\r\n    }\r\n    img.src = canvas.getAttribute(\"src\");\r\n}\r\n\r\nexport function addEdges() {\r\n    var thecanvas = _getCanvas('edges'),\r\n        i;\r\n    for (i = 0; i < thecanvas.length; i++) {\r\n        _addEdge(thecanvas[i]);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/util/edge.js\n **/","/**\r\n * 母版管理模块\r\n * @param  {[type]}\r\n * @return {[type]}\r\n */\r\nimport {\r\n    extend\r\n}\r\nfrom '../util/index'\r\nimport { Abstract } from './abstract'\r\nimport { translation } from '../pagebase/translation'\r\nimport { constor as Master} from '../pagebase/constor'\r\n//动作热热点派发 \r\nimport { suspend as _suspend, original as _original, autoRun as _autoRun } from '../scheduler/index'\r\n\r\n\r\nlet prefix = Xut.plat.prefixStyle\r\nlet rword = \"-\"\r\n\r\n\r\n/**\r\n * parallaObjsCollection: Object\r\n *  \t0: Page\r\n *\t    1: Page\r\n *\r\n *\trecordMasterId: Object\r\n *\t\t0: 9001\r\n *\t \t1: 9001\r\n *\r\n *\trecordMasterscope: Object\r\n *\t\t9001: Array[2]\r\n *\r\n *\trootNode: ul # parallax.xut - parallax xut - flip\r\n *\r\n *\tcurrMasterId: 9001 //实际的可使区\r\n */\r\n\r\nfunction MasterMgr(vm) {\r\n\r\n    var config = Xut.config\r\n\r\n    this.screenWidth = config.screenSize.width\r\n    this.screenHeight = config.screenSize.height\r\n\r\n    this.pageType = 'master';\r\n\r\n    this.rootNode = vm.options.rootMaster;\r\n    this.recordMasterscope = {}; //记录master区域范围\r\n    this.recordMasterId = {}; //记录页面与母板对应的编号\r\n    this.currMasterId = null; //可视区母板编号\r\n\r\n    //记录视察处理的对象\r\n    this.parallaxProcessedContetns = {};\r\n\r\n    /**\r\n     * 抽象方法\r\n     * 创建视觉差容器\r\n     */\r\n    this.abstractCreateCollection();\r\n}\r\n\r\n\r\nvar MasterProto = MasterMgr.prototype;\r\n\r\n\r\n/****************************************************************\r\n *\r\n *                 对外接口\r\n *\r\n ***************************************************************/\r\n\r\n//====================页面结构处理===========================\r\n\r\nMasterProto.create = function(dataOpts, pageIndex, createCallBack) {\r\n    var masterObj, reuseMasterId, reuseMasterKey,\r\n        pptMaster = dataOpts.chapterDas.pptMaster,\r\n        pageOffset = dataOpts.chapterDas.pageOffset;\r\n\r\n    //母板复用的标示\r\n    reuseMasterId = pageOffset && pageOffset.split(rword);\r\n\r\n    //组合下标\r\n    if (reuseMasterId && reuseMasterId.length === 3) {\r\n        reuseMasterKey = pptMaster + rword + reuseMasterId[2];\r\n    } else {\r\n        reuseMasterKey = pptMaster;\r\n    }\r\n\r\n    //检测视觉差对象是否重复创建\r\n    if (this._checkRepeat(reuseMasterKey, pageOffset, pageIndex)) {\r\n        return\r\n    }\r\n\r\n    //通知外部,需要创建的母版\r\n    createCallBack();\r\n\r\n    masterObj = new Master(\r\n        _.extend(dataOpts, {\r\n            'pageType': this.pageType, //创建页面的类型\r\n            'root': this.rootNode, //根元素\r\n            'pptMaster': pptMaster //ppt母板ID\r\n        })\r\n    );\r\n\r\n    //增加页面管理\r\n    this.abstractAddCollection(reuseMasterKey, masterObj);\r\n\r\n    return masterObj;\r\n}\r\n\r\n\r\n//销毁整个页面对象\r\nMasterProto.destroy = function() {\r\n    this.rootNode = null;\r\n    //销毁对象\r\n    this.abstractDestroyCollection();\r\n}\r\n\r\n\r\n/**\r\n * 找到当前页面的可以需要滑动是视觉页面对象\r\n * @return {[type]}            [description]\r\n */\r\nMasterProto.findMaster = function(leftIndex, currIndex, rightIndex, direction, action) {\r\n    var prevFlag,\r\n        nextFlag,\r\n        prevMasterObj,\r\n        currMasterObj,\r\n        nextMasterObj,\r\n        prevMasterId = this.conversionMasterId(leftIndex),\r\n        currMasterId = this.conversionMasterId(currIndex),\r\n        nextMasterId = this.conversionMasterId(rightIndex);\r\n\r\n    switch (direction) {\r\n        case 'prev':\r\n            if (prevFlag = (currMasterId !== prevMasterId)) {\r\n                currMasterObj = this.abstractGetPageObj(currMasterId);\r\n            }\r\n            if (prevMasterId && prevFlag) {\r\n                action === 'flipOver' && this.checkClear([currMasterId, prevMasterId]); //边界清理\r\n                prevMasterObj = this.abstractGetPageObj(prevMasterId)\r\n            }\r\n            break;\r\n        case 'next':\r\n            if (nextFlag = (currMasterId !== nextMasterId)) {\r\n                currMasterObj = this.abstractGetPageObj(currMasterId);\r\n            }\r\n            if (nextMasterId && nextFlag) {\r\n                action === 'flipOver' && this.checkClear([currMasterId, nextMasterId]); //边界清理\r\n                nextMasterObj = this.abstractGetPageObj(nextMasterId)\r\n            }\r\n            break;\r\n    }\r\n    return [prevMasterObj, currMasterObj, nextMasterObj];\r\n}\r\n\r\n\r\n/**\r\n * 页面滑动处理\r\n * 1 母版之间的切换\r\n * 2 浮动对象的切换\r\n */\r\nMasterProto.move = function(leftIndex, currIndex, rightIndex, direction, moveDistance, action, speed, nodes) {\r\n    var parallaxOffset,\r\n        self = this,\r\n        isBoundary = false; //是边界处理\r\n\r\n    //找到需要滑动的母版\r\n    _.each(this.findMaster(leftIndex, currIndex, rightIndex, direction, action), function(pageObj, index) {\r\n        if (pageObj) {\r\n            isBoundary = true;\r\n            //母版交接判断\r\n            //用户事件的触发\r\n            pageObj.onceMaster = false;\r\n            //移动母版\r\n            translation[action].call(pageObj, moveDistance[index], speed)\r\n                //移动浮动容器\r\n            if (pageObj.floatContents.MasterContainer) {\r\n                translation[action].call(pageObj, moveDistance[index], speed, pageObj.floatContents.MasterContainer)\r\n            }\r\n        }\r\n    })\r\n\r\n    //越界不需要处理内部视察对象\r\n    this.isBoundary = isBoundary;\r\n    if (isBoundary) {\r\n        return;\r\n    }\r\n\r\n    //移动视察对象\r\n    function moveParallaxObject(nodes) {\r\n        self.moveParallaxs(moveDistance, currIndex, action, direction, speed, nodes)\r\n    }\r\n\r\n    //移动视察对象\r\n    switch (direction) {\r\n        case 'prev':\r\n            moveParallaxObject();\r\n            break;\r\n        case 'next':\r\n            nodes && moveParallaxObject(nodes)\r\n            break;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 停止行为\r\n * @return {[type]} [description]\r\n */\r\nMasterProto.suspend = function(pointers) {\r\n    //如果未越界不需要处理行为\r\n    if (!this.isBoundary) return;\r\n    var masterObj,\r\n        stopPointer = pointers.stopPointer;\r\n    if (masterObj = this.abstractGetPageObj(stopPointer)) {\r\n        var pageId = masterObj.baseGetPageId(stopPointer);\r\n        //停止活动对象活动\r\n        _suspend(masterObj, pageId);\r\n    }\r\n}\r\n\r\n/**\r\n * 复位初始状态\r\n * @return {[type]} [description]\r\n */\r\nMasterProto.resetOriginal = function(pageIndex) {\r\n    var originalPageObj;\r\n    if (originalPageObj = this.abstractGetPageObj(pageIndex)) {\r\n        _original(originalPageObj);\r\n    }\r\n}\r\n\r\n/**\r\n * \t母版自动运行\r\n */\r\nMasterProto.autoRun = function(data) {\r\n    var masterObj, element;\r\n    if (masterObj = this.abstractGetPageObj(data.currIndex)) {\r\n        //热点状态复位\r\n        this.resetOriginal(data.suspendIndex)\r\n        _autoRun(masterObj, data.currIndex);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 移动内部的视察对象\r\n */\r\nMasterProto.moveParallaxs = function(moveDistance, currIndex, action, direction, speed, nodes) {\r\n    var rootNode,\r\n        floatObj,\r\n        contentObj,\r\n        contentObjs,\r\n        baseContents,\r\n        currParallaxObj,\r\n        currMoveDistance,\r\n        hasFloatMater,\r\n        floatMaterParallaxChange,\r\n        //需要执行动画\r\n        activationAnim = action === \"flipRebound\" || action === \"flipOver\",\r\n        self = this;\r\n\r\n    //处理当前页面内的视觉差对象效果\r\n    if (currParallaxObj = this.abstractGetPageObj(this.conversionMasterId(currIndex))) {\r\n        if (baseContents = currParallaxObj.baseGetContent()) {\r\n            self.baseContents = baseContents;\r\n            //移动距离\r\n            currMoveDistance = moveDistance[1];\r\n            //遍历所有活动对象\r\n            _.each(baseContents, function(content) {\r\n                content.eachAssistContents(function(scope) {\r\n                    //如果是视察对象移动\r\n                    if (scope.parallax) {\r\n                        rootNode = scope.parallax.rootNode;\r\n                        contentObj = currParallaxObj.baseGetContentObject(scope.id)\r\n                            /////////////////////\r\n                            //如果有这个动画效果 //\r\n                            //先停止否则通过视觉差移动会出问题\r\n                            // //影响，摩天轮转动APK\r\n                            // * 重新激动视觉差对象\r\n                            // * 因为视察滑动对象有动画\r\n                            // * 2个CSS3动画冲突的\r\n                            // * 所以在视察滑动的情况下先停止动画\r\n                            // * 然后给每一个视察对象打上对应的hack=>data-parallaxProcessed\r\n                            // * 通过动画回调在重新加载动画\r\n                            /////////////////////\r\n                        if (action === \"flipMove\" && contentObj.anminInstance && !contentObj.parallaxProcessed) {\r\n                            //标记\r\n                            var actName = contentObj.actName;\r\n                            contentObj.stopAnimations();\r\n                            //视觉差处理一次,停止过动画\r\n                            contentObj.parallaxProcessed = true;\r\n                            //增加标记\r\n                            rootNode.attr('data-parallaxProcessed', actName);\r\n                            //记录\r\n                            self.parallaxProcessedContetns[actName] = contentObj;\r\n                        }\r\n\r\n                        //移动视觉差对象\r\n                        conversionTranslateX(rootNode, scope.parallax, direction, action, speed, nodes, currMoveDistance, floatMaterParallaxChange);\r\n                    }\r\n                })\r\n            })\r\n        }\r\n    }\r\n\r\n    function conversionTranslateX(rootNode, scope, direction, action, speed, nodes, currMoveDistance, floatMaterParallaxChange) {\r\n        var translate = scope.translate,\r\n            offsetTranslate = scope.offsetTranslate,\r\n            nodes_1, moveTranslate;\r\n\r\n        //往前翻页\r\n        if (direction === 'prev') {\r\n            //分割的比例\r\n            nodes_1 = scope.nodeProportion;\r\n            //如果往前溢出则取0\r\n            nodes = (nodes == nodes_1) ? 0 : nodes_1;\r\n        }\r\n\r\n        //视觉对象移动的距离\r\n        moveTranslate = self._transformConversion(translate, currMoveDistance, nodes);\r\n\r\n        switch (action) {\r\n            //移动中\r\n            case 'flipMove':\r\n                moveTranslate = self._flipMove(moveTranslate, offsetTranslate);\r\n                break;\r\n                //反弹\r\n            case 'flipRebound':\r\n                moveTranslate = self._flipRebound(moveTranslate, offsetTranslate);\r\n                break;\r\n                //翻页结束,记录上一页的坐标\r\n            case 'flipOver':\r\n                if (direction === 'prev') {\r\n                    moveTranslate = self._flipOver(moveTranslate, offsetTranslate);\r\n                }\r\n                self._overMemory(moveTranslate, offsetTranslate);\r\n                /**\r\n                 * 记录浮动母版视察修改\r\n                 * 2014.6.30针对浮动处理\r\n                 */\r\n                // floatMaterParallaxChange && floatMaterParallaxChange(moveTranslate.translateX)\r\n                break;\r\n        }\r\n\r\n        //直接操作元素\r\n        self._transformNodes(rootNode, speed, moveTranslate, offsetTranslate.opacityStart || 0);\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 重新激动视觉差对象\r\n * 因为视察滑动对象有动画\r\n * 2个CSS3动画冲突的\r\n * 所以在视察滑动的情况下先停止动画\r\n * 然后给每一个视察对象打上对应的hack=>data-parallaxProcessed\r\n * 通过动画回调在重新加载动画\r\n * @return {[type]} [description]\r\n */\r\nMasterProto.reactivation = function(target) {\r\n    if (this.parallaxProcessedContetns) {\r\n        var actName = target.id;\r\n        var contentObj = this.parallaxProcessedContetns[actName];\r\n        if (contentObj) {\r\n            contentObj.runAnimations();\r\n            //视觉差处理一次,停止过动画\r\n            contentObj.parallaxProcessed = false;\r\n            //移除标记\r\n            target.removeAttribute('data-parallaxProcessed');\r\n            //记录\r\n            delete this.parallaxProcessedContetns[actName];\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//变化节点的css3transform属性\r\nMasterProto._transformNodes = function(rootNode, speed, property, opacityStart) {\r\n    var style = {},\r\n        effect = '',\r\n        x = 0,\r\n        y = 0,\r\n        z = 0,\r\n        round = Math.round;\r\n\r\n    if (property.translateX != undefined || property.translateY != undefined || property.translateZ != undefined) {\r\n        x = round(property.translateX) || 0;\r\n        y = round(property.translateY) || 0;\r\n        z = round(property.translateZ) || 0;\r\n        effect += String.format('translate3d({0}px,{1}px,{2}px) ', x, y, z);\r\n    }\r\n\r\n    if (property.rotateX != undefined || property.rotateY != undefined || property.rotateZ != undefined) {\r\n        x = round(property.rotateX);\r\n        y = round(property.rotateY);\r\n        z = round(property.rotateZ);\r\n        effect += x ? 'rotateX(' + x + 'deg) ' : '';\r\n        effect += y ? 'rotateY(' + y + 'deg) ' : '';\r\n        effect += z ? 'rotateZ(' + z + 'deg) ' : '';\r\n    }\r\n\r\n    if (property.scaleX != undefined || property.scaleY != undefined || property.scaleZ != undefined) {\r\n        x = round(property.scaleX * 100) / 100 || 1;\r\n        y = round(property.scaleY * 100) / 100 || 1;\r\n        z = round(property.scaleZ * 100) / 100 || 1;\r\n        effect += String.format('scale3d({0},{1},{2}) ', x, y, z);\r\n    }\r\n\r\n    if (property.opacity != undefined) {\r\n        style.opacity = round(property.opacity * 100) / 100 + opacityStart;\r\n        effect += ';'\r\n    }\r\n\r\n    ////////////////\r\n    //最终改变视觉对象的坐标 //\r\n    ////////////////\r\n    if (effect) {\r\n        style[prefix('transition-duration')] = speed + 'ms';\r\n        style[prefix('transform')] = effect;\r\n        rootNode.css(style);\r\n    }\r\n}\r\n\r\n\r\n//针对跳转页面\r\n//制作处理器\r\nMasterProto.makeJumpPocesss = function(data) {\r\n    var filter;\r\n    var master = this;\r\n    return {\r\n        pre: function() {\r\n            var targetIndex = data.targetIndex;\r\n            //目标母板对象\r\n            var targetkey = master.conversionMasterId(targetIndex);\r\n            //得到过滤的边界keys\r\n            //在filter中的页面为过滤\r\n            filter = master.scanBounds(targetIndex, targetkey);\r\n            //清理多余母板\r\n            //filter 需要保留的范围\r\n            master.checkClear(filter, true);\r\n            //更新可视母板编号\r\n            master.currMasterId = targetkey;\r\n        },\r\n        //修正位置\r\n        clean: function(currIndex, targetIndex) {\r\n            master._fixPosition(filter);\r\n            master._checkParallaxPox(currIndex, targetIndex);\r\n        }\r\n    }\r\n}\r\n\r\n//扫描边界\r\n//扫描key的左右边界\r\n//当前页面的左右边\r\nMasterProto.scanBounds = function(currPage, currkey) {\r\n    var currKey = this.conversionMasterId(currPage),\r\n        filter = {},\r\n        i = currPage,\r\n        prevKey, nextKey;\r\n\r\n    //往前\r\n    while (i--) {\r\n        prevKey = this.conversionMasterId(i);\r\n        if (prevKey && prevKey !== currkey) {\r\n            filter['prev'] = prevKey;\r\n            break;\r\n        }\r\n    }\r\n\r\n    //往后\r\n    nextKey = this.conversionMasterId(currPage + 1);\r\n\r\n    //如果有下一条记录\r\n    if (nextKey && nextKey !== currkey) {\r\n        //如果不是当期页面满足范围要求\r\n        filter['next'] = nextKey;\r\n    }\r\n\r\n    //当前页面\r\n    if (currKey) {\r\n        filter['curr'] = currKey;\r\n    }\r\n    return filter;\r\n}\r\n\r\n\r\n//修正位置\r\nMasterProto._fixPosition = function(filter) {\r\n\r\n    var self = this\r\n\r\n    function setPosition(parallaxObj, position) {\r\n        //设置移动\r\n        function toMove(distance, speed) {\r\n            var element = parallaxObj.element;\r\n            if (element) {\r\n                element.css(prefix('transition-duration'), speed + 'ms');\r\n                element.css(prefix('transform'), 'translate3d(' + distance + 'px,0px,0px)');\r\n            }\r\n        }\r\n\r\n        if (position === 'prev') {\r\n            toMove(-self.screenWidth);\r\n        } else if (position === 'next') {\r\n            toMove(self.screenWidth);\r\n        } else if (position === 'curr') {\r\n            toMove(0);\r\n        }\r\n    }\r\n\r\n    for (var key in filter) {\r\n        switch (key) {\r\n            case 'prev':\r\n                setPosition(this.abstractGetPageObj(filter[key]), 'prev')\r\n                break;\r\n            case 'curr':\r\n                setPosition(this.abstractGetPageObj(filter[key]), 'curr')\r\n                break;\r\n            case 'next':\r\n                setPosition(this.abstractGetPageObj(filter[key]), 'next')\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n\r\nMasterProto._checkParallaxPox = function(currPageIndex, targetIndex) {\r\n    var key, pageObj,\r\n        pageCollection = this.abstractGetCollection();\r\n    for (key in pageCollection) {\r\n        pageObj = pageCollection[key];\r\n        //跳跃过的视觉容器处理\r\n        this._fixParallaxPox(pageObj, currPageIndex, targetIndex)\r\n    }\r\n}\r\n\r\n\r\n//=======================去重检测==============================\r\n\r\n//当前同一视觉页面作用的范围\r\nMasterProto._toRepeat = function(reuseMasterKey, pageIndex) {\r\n    var temp;\r\n    if (temp = this.recordMasterscope[reuseMasterKey]) {\r\n        return temp;\r\n    }\r\n    return false;\r\n}\r\n\r\n//更新母板作用域范围\r\n//recordMasterscope:{\r\n//\t 9001-1:[0,1], master 对应记录的页码\r\n//\t 9002-1:[2,3]\r\n//\t 9001-2:[4,5]\r\n//}\r\nMasterProto._updataMasterscope = function(reuseMasterKey, pageIndex) {\r\n    var scope;\r\n    if (scope = this.recordMasterscope[reuseMasterKey]) {\r\n        if (-1 === scope.indexOf(pageIndex)) {\r\n            scope.push(pageIndex);\r\n        }\r\n    } else {\r\n        this.recordMasterscope[reuseMasterKey] = [pageIndex]\r\n    }\r\n}\r\n\r\n//记录页面与模板标示的映射\r\nMasterProto._updatadParallaxMaster = function(reuseMasterKey, pageIndex) {\r\n    //记录页面与模板标示的映射\r\n    this.recordMasterId[pageIndex] = reuseMasterKey;\r\n    //更新可视区母板的编号\r\n    this.currMasterId = this.conversionMasterId(Xut.Presentation.GetPageIndex())\r\n}\r\n\r\n//检测是否需要创建视觉差\r\nMasterProto._checkRepeat = function(reuseMasterKey, pageOffset, pageIndex) {\r\n    var tag = this._toRepeat(reuseMasterKey, pageIndex); //false就是没找到视察对象\r\n    this._updataMasterscope(reuseMasterKey, pageIndex);\r\n    this._updatadParallaxMaster(reuseMasterKey, pageIndex);\r\n    return tag;\r\n}\r\n\r\n//transform转化成相对应的偏移量\r\nMasterProto._transformConversion = function(property, moveDistance, nodes) {\r\n    var temp = {},\r\n        i;\r\n\r\n    for (i in property) {\r\n        switch (i) {\r\n            case 'translateX':\r\n            case 'translateZ':\r\n                temp[i] = moveDistance * nodes * property[i];\r\n                break;\r\n            case 'translateY':\r\n                temp[i] = moveDistance * (this.screenHeight / this.screenWidth) * nodes * property[i];\r\n                break;\r\n            case 'opacityStart':\r\n                temp[i] = property.opacityStart;\r\n                break;\r\n            default:\r\n                //乘以-1是为了向右翻页时取值为正,位移不需这样做\r\n                temp[i] = -1 * moveDistance / this.screenWidth * property[i] * nodes;\r\n        }\r\n    }\r\n    return temp;\r\n}\r\n\r\n//移动叠加值\r\nMasterProto._flipMove = function(property, repairProperty) {\r\n    var temp = {};\r\n    var start = property.opacityStart;\r\n    for (var i in property) {\r\n        temp[i] = property[i] + repairProperty[i];\r\n    }\r\n    if (start > -1) temp.opacityStart = start;\r\n    return temp;\r\n}\r\n\r\n//反弹\r\nMasterProto._flipRebound = function(property, repairProperty) {\r\n    var temp = {};\r\n    for (var i in property) {\r\n        temp[i] = repairProperty[i] || property[i];\r\n    }\r\n    return temp;\r\n}\r\n\r\n//翻页结束\r\nMasterProto._flipOver = function(property, repairProperty) {\r\n    return this._flipMove(property, repairProperty);\r\n}\r\n\r\n//结束后缓存上一个记录\r\nMasterProto._overMemory = function(property, repairProperty) {\r\n    for (var i in property) {\r\n        repairProperty[i] = property[i];\r\n    }\r\n}\r\n\r\n\r\n//修正跳转后视觉对象坐标\r\nMasterProto._fixParallaxPox = function(parallaxObj, currPageIndex, targetIndex) {\r\n    var self = this,\r\n        contentObjs, prevNodes, nodes;\r\n    if (contentObjs = parallaxObj.baseGetContent()) {\r\n        contentObjs.forEach(function(contentObj) {\r\n            contentObj.eachAssistContents(function(scope) {\r\n                if (scope.parallax) {\r\n                    repairNodes.call(self, scope.parallax, currPageIndex, targetIndex);\r\n                }\r\n            })\r\n        })\r\n    }\r\n\r\n    function repairNodes(scope, currPageIndex, targetIndex) {\r\n        var rangePage = scope.calculateRangePage(),\r\n            rootNode = scope.rootNode,\r\n            translate = scope.translate,\r\n            offsetTranslate = scope.offsetTranslate,\r\n            moveTranslate,\r\n            nodes = Xut.Presentation.GetPageNode(targetIndex - 1);\r\n\r\n        if (targetIndex > currPageIndex) {\r\n            //next\r\n            if (targetIndex > rangePage['end']) {\r\n                nodes = 1;\r\n            }\r\n        } else {\r\n            //prev\r\n            if (targetIndex < rangePage['start']) {\r\n                nodes = 0;\r\n            }\r\n        }\r\n\r\n        moveTranslate = this._transformConversion(translate, -self.screenWidth, nodes);\r\n        this._transformNodes(rootNode, 300, moveTranslate, offsetTranslate.opacityStart);\r\n        this._overMemory(moveTranslate, offsetTranslate);\r\n    }\r\n\r\n}\r\n\r\n//扁平化对象到数组\r\nfunction toArray(filter) {\r\n    var arr = []; \r\n    if (!filter.length) {\r\n        for (var key in filter) {\r\n            arr.push(filter[key]);\r\n        }\r\n        filter = arr;\r\n    }\r\n    return filter;\r\n}\r\n\r\n//检测是否需要清理\r\n// 1 普通翻页清理  【数组过滤条件】\r\n// 2 跳转页面清理  【对象过滤条件】\r\nMasterProto.checkClear = function(filter, toPage) {\r\n    var key, indexOf,\r\n        removeMasterId = _.keys(this.abstractGetCollection());\r\n\r\n    // 如果有2个以上的母板对象,就需要清理\r\n    if (removeMasterId.length > 2 || toPage) { //或者是跳转页面\r\n        //解析对象\r\n        filter = toArray(filter);\r\n        //过滤\r\n        _.each(filter, function(masterId) {\r\n            if (masterId !== undefined) {\r\n                indexOf = removeMasterId.indexOf(masterId.toString());\r\n                if (-1 !== indexOf) {\r\n                    //过滤需要删除的对象\r\n                    removeMasterId.splice(indexOf, 1);\r\n                }\r\n            }\r\n        })\r\n        this.clearMemory(removeMasterId);\r\n    }\r\n}\r\n\r\n//清理内存\r\n//需要清理的key合集\r\nMasterProto.clearMemory = function(removeMasterId) {\r\n    var pageObj, self = this;\r\n    _.each(removeMasterId, function(removekey) {\r\n        //销毁页面对象事件\r\n        if (pageObj = self.abstractGetPageObj(removekey)) {\r\n            //移除事件\r\n            pageObj.baseDestroy();\r\n            //移除列表\r\n            self.abstractRemoveCollection(removekey);\r\n            self.removeRecordMasterscope(removekey);;\r\n        }\r\n        //清理作用域缓存\r\n        delete self.recordMasterscope[removekey];\r\n    })\r\n}\r\n\r\n\r\n//注册状态管理\r\nMasterProto.register = function(pageIndex, type, hotspotObj) {\r\n    var parallaxObj;\r\n    if (parallaxObj = this.abstractGetPageObj(this.conversionMasterId(pageIndex))) {\r\n        parallaxObj.registerCotents.apply(pageObj, arguments);\r\n    }\r\n}\r\n \r\n//=======================工具方法==============================\r\n\r\n//page转化成母版ID\r\nMasterProto.conversionMasterId = function(pageIndex) {\r\n    return this.recordMasterId ? this.recordMasterId[pageIndex] : undefined;\r\n}\r\n\r\nMasterProto.removeRecordMasterscope = function(removekey) {\r\n    var me = this;\r\n    var recordMasterscope = me.recordMasterscope[removekey];\r\n    //清理页码指示标记\r\n    recordMasterscope.forEach(function(scope) {\r\n        delete me.recordMasterId[scope];\r\n    })\r\n}\r\n\r\n\r\n//混入抽象接口方法\r\nextend(MasterMgr, Abstract)\r\n\r\n\r\nexport {\r\n    MasterMgr\r\n}\r\n\r\n// })\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/master.js\n **/","import {\r\n    Store as store\r\n}\r\nfrom './store'\r\n\r\n//数据缓存\r\nlet dataCache\r\n    //带有场景信息存数\r\nlet sectionRelated\r\n    //音频的ActivityId信息;\r\nlet videoActivityIdCache\r\n\r\n\r\n//混入数据到data中\r\nfunction mixToData(collections) {\r\n    Xut.data = dataCache = collections;\r\n}\r\n\r\n\r\n//计算数据偏移量\r\nfunction dataOffset(tableName) {\r\n    var start,\r\n        data = dataCache[tableName];\r\n    if (data.length) {\r\n        if (data.item(0)) {\r\n            if (start = data.item(0)._id) {\r\n                dataCache[tableName].start = start;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//转化video的activtiy信息\r\n//因为Video不是靠id关联的 是靠activtiy关联\r\nfunction videoActivity() {\r\n    var d, activityIds = {},\r\n        data = dataCache.Video;\r\n    _.each(data, function(_, index) {\r\n        d = data.item(index)\r\n        if (d && d.activityId) { //确保activityIdID是有值，这样才是靠activity关联的video,而不是动画的video\r\n            activityIds[d.activityId] = d._id;\r\n        }\r\n    })\r\n    return activityIds;\r\n}\r\n\r\n\r\n//chpater分段\r\n//转化section信息\r\n//带有场景处理\r\nfunction conversionSectionRelated() {\r\n    var seasonId, start, length, sid, i, id, seasonInfo, toolbar, Chapters,\r\n        container = {},\r\n        Chapter = dataCache.Chapter,\r\n        l = Chapter.length,\r\n        end = 0;\r\n\r\n    //找到指定的season信息\r\n    var findSeasonInfo = function(seasonId) {\r\n        var temp,\r\n            seasonNum = dataCache.Season.length;\r\n        while (seasonNum--) {\r\n            if (temp = dataCache.Season.item(seasonNum)) {\r\n                if (temp._id == seasonId) {\r\n                    return temp;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    for (i = 0; i < l; i++) {\r\n        Chapters = Chapter.item(i);\r\n        if (Chapters) {\r\n            id = Chapters._id - 1; //保存兼容性,用0开头\r\n            seasonId = Chapters.seasonId;\r\n            sid = 'seasonId->' + seasonId;\r\n            //如果不在集合,先创建\r\n            if (!container[sid]) {\r\n                //场景工具栏配置信息\r\n                if (seasonInfo = findSeasonInfo(seasonId)) {\r\n                    toolbar = seasonInfo.parameter;\r\n                }\r\n                container[sid] = {\r\n                    start: id,\r\n                    length: 1,\r\n                    end: id,\r\n                    toolbar: toolbar\r\n                }\r\n            } else {\r\n                container[sid].end = id;\r\n                container[sid].length = (container[sid].length + 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    return container;\r\n}\r\n\r\n\r\n//转化数据结构\r\nfunction conversion() {\r\n\r\n    //数据段标记\r\n    for (var k in dataCache) {\r\n        if (dataCache[k].item) {\r\n            dataOffset(k);\r\n        }\r\n    }\r\n\r\n\r\n    //============数据特殊处理================\r\n\r\n    //vidoe特殊处理，需要记录chapterId范围\r\n    if (dataCache.Video) {\r\n        videoActivityIdCache = videoActivity();\r\n    }\r\n\r\n\r\n    /**\r\n     * 带有场景处理\r\n     * @type {[type]}\r\n     */\r\n    sectionRelated = conversionSectionRelated();\r\n\r\n\r\n    /**\r\n     * 标记应用ID\r\n     * @type {[type]}\r\n     */\r\n    dataCache.novelId = store.novelId;\r\n\r\n    /**\r\n     * 针对数据库content为空的处理\r\n     * @return {[type]} [description]\r\n     */\r\n    dataCache.preventContent = function() {\r\n        return dataCache.Content.length ? false : true;\r\n    }()\r\n\r\n    //===============================================\r\n    //  \r\n    //  查询数据接口\r\n    //\r\n    //  1 video表传递是activityId关联\r\n    //  2 其余表都是传递当前表的id\r\n    //  type 查询ID的类型, 数据的id或者activityId\r\n    //  callback 提供给chapterId使用\r\n    //================================================\r\n\r\n    /**\r\n     * 通过ID查询方式\r\n     * @param  {[type]}  tableName [description]\r\n     */\r\n    dataCache.query = function(tableName, id, type, callback) {\r\n        /**\r\n         * 特殊的字段关联\r\n         * 1 activityId\r\n         * 2 chpaterId\r\n         */\r\n        switch (type) {\r\n            /**\r\n             * 通过activityId查询的方式\r\n             *\r\n             * 表名,ID,类型\r\n             * Xut.data.query('Action', id, 'activityId');\r\n             *   \r\n             * @type {[type]}\r\n             */\r\n            case 'activityId':\r\n                var item;\r\n                var activityId = id;\r\n                var data = dataCache[tableName];\r\n                for (var i = 0, len = data.length; i < len; i++) {\r\n                    item = data.item(i);\r\n                    if (item) {\r\n                        if (item[type] == activityId) {\r\n                            return item;\r\n                        }\r\n                    }\r\n                }\r\n                return;\r\n\r\n                /**\r\n                 * 通过chpaterId查询方式\r\n                 * parser中的scanActivity过滤处理\r\n                 */\r\n            case 'chapterId':\r\n            case 'seasonId':\r\n                var chapterId = id;\r\n                var data = dataCache[tableName];\r\n                if (data) {\r\n                    var item;\r\n                    for (var i = 0, len = data.length; i < len; i++) {\r\n                        item = data.item(i);\r\n                        if (item) {\r\n                            if (item[type] == chapterId) {\r\n                                callback && callback(item)\r\n                            }\r\n                        }\r\n\r\n                    }\r\n                }\r\n                return;\r\n        }\r\n\r\n\r\n        /**\r\n         * 通过id查询的方式\r\n         */\r\n        switch (tableName) {\r\n            //////////////////////////\r\n            //获取整个一个用的chapter数据 //\r\n            //////////////////////////\r\n            case 'appPage':\r\n                return dataCache.Chapter;\r\n\r\n                //////////////////////////\r\n                //获取整个一个用的Section数据 //\r\n                //////////////////////////\r\n            case 'appSection':\r\n                return dataCache.Season;\r\n\r\n                //////////////////////\r\n                //如果是是section信息 //\r\n                //////////////////////\r\n            case 'sectionRelated':\r\n                return sectionRelated['seasonId->' + id];\r\n\r\n                //////////////\r\n                //如果是音频 //\r\n                //////////////\r\n            case 'Video':\r\n                if (type) {\r\n                    return Query();\r\n                } else {\r\n                    //传递的id是activityId\r\n                    var id = videoActivityIdCache[id];\r\n                    return dataCache.query('Video', id, true);\r\n                }\r\n\r\n            default:\r\n                /////////////////\r\n                //默认其余所有表 //\r\n                /////////////////\r\n                return Query();\r\n        }\r\n\r\n        //数据信息\r\n        function Query() {\r\n            var data = dataCache[tableName];\r\n            if (id) {\r\n                var index = id - data.start;\r\n                return data.item(index);\r\n            } else {\r\n                return data.length ? data.item(0) : null;\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 针对动态表查询\r\n     * 每次需要重新取数据\r\n     * Xut.data.oneQuery('Image',function(){});\r\n     * @return {[type]} [description]\r\n     */\r\n    dataCache.oneQuery = function(tableName, callback) {\r\n        store.oneQuery(tableName, function(data) {\r\n            callback && callback(data);\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 删除数据\r\n     * 表名,表ID\r\n     * @return {[type]} [description]\r\n     */\r\n    dataCache.remove = function(tableName, id, success, failure) {\r\n        var dfd = store.remove(tableName, id)\r\n        dfd.done(success, failure)\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * 返回错误的表\r\n * @return {[type]} [description]\r\n */\r\nexport function errorTable() {\r\n    return store.collectError;\r\n}\r\n\r\n/**\r\n *     初始化数据类\r\n    获取ppt总数\r\n * @return {[type]} [description]\r\n */\r\nexport function createStore() {\r\n    return $.Deferred(function(dfd) {\r\n        store.query().done(function(data) {\r\n            var novel = data.Novel;\r\n            //novel的id\r\n            var novelId = store.novelId = novel.item(0)['_id'];\r\n            //数据转换\r\n            mixToData(data);\r\n            //转化数据结构\r\n            conversion();\r\n            //数据缓存已存在\r\n            // storeMgr.dataCache = true\r\n            dfd.resolve(data.Setting, novel.item(0));\r\n        })\r\n    }).promise();\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/data/index.js\n **/","import {\r\n    execute\r\n}\r\nfrom '../util/execute'\r\n\r\n/**\r\n * 数据查询\r\n * @type {Object}\r\n */\r\nvar Store = {\r\n\r\n    statement: {},\r\n\r\n    /**\r\n     * novel表ID\r\n     * @type {[type]}\r\n     */\r\n    novelId: null,\r\n\r\n    /**\r\n     * ppt总数\r\n     * @type {Number}\r\n     */\r\n    count: 0,\r\n\r\n    /**\r\n     * 不存在的数据库表\r\n     * @type {Array}\r\n     */\r\n    collectError: []\r\n}\r\n\r\n//热点合集\r\nvar dataRet = {};\r\n\r\n\r\n'Setting,Parallax,Master,Activity,Content,Video,Image,Action,Animation,Widget,Novel,Season,Chapter'.replace(/[^, ]+/g, function(name) {\r\n    Store.statement[name] = 'select * FROM ' + (name) + ' order by _id ASC';\r\n})\r\n\r\n/**\r\n * 查询单一的数据\r\n * @return {[type]} [description]\r\n */\r\nStore.oneQuery = function(tableName, callback) {\r\n    execute('select * FROM ' + tableName + ' order by _id ASC', function(sqlRet, collectError) {\r\n        callback(sqlRet);\r\n    })\r\n}\r\n\r\n/**\r\n * 查询总数据\r\n */\r\nStore.query = function() {\r\n    var i, self = this;\r\n    return $.Deferred(function(dfd) {\r\n        //数据库表重复数据只查询一次\r\n        if (Object.keys(dataRet).length) {\r\n            dfd.resolve(dataRet);\r\n            return;\r\n        }\r\n        //ibook模式，数据库外部注入的\r\n        if (Xut.IBooks.CONFIG) {\r\n            // self.collectError = collectError;\r\n            dfd.resolve(Xut.IBooks.CONFIG.data);\r\n        } else {\r\n            //查询所有数据\r\n            execute(Store.statement, function(sqlRet, collectError) {\r\n                for (i in sqlRet) {\r\n                    dataRet[i] = sqlRet[i];\r\n                }\r\n                dfd.resolve(dataRet);\r\n            })\r\n        }\r\n    }).promise();\r\n}\r\n\r\n\r\n/**\r\n * 删除数据\r\n * @type {[type]}\r\n */\r\nStore.remove = function(tableName, id) {\r\n    var i, self = this;\r\n    var sql = 'delete from ' + tableName + ' where _id = ' + id;\r\n    return $.Deferred(function(dfd) {\r\n        //查询所有数据\r\n        execute(sql, function(success, failure) {\r\n            if (success) { //成功回调\r\n                dfd.resolve();\r\n            } else if (failure) { //失败回调\r\n                dfd.reject();\r\n            }\r\n        })\r\n    }).promise();\r\n}\r\n\r\n\r\nexport {\r\n    Store\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/data/store.js\n **/","/**\r\n * 页面切换逻辑\r\n * @param  {[type]} ) [description]\r\n * @return {[type]}   [description]\r\n */\r\n\r\n/**\r\n * 跳转之前提高层级问题\r\n * @return {[type]}          [description]\r\n */\r\nfunction prev(complier, data) {\r\n    var currIndex = data.currIndex;\r\n    //跳转之前提高层级问题\r\n    complier.pageMgr.abstractAssistPocess(currIndex, function(pageObj) {\r\n            pageObj.element.css({\r\n                'z-index': 9997\r\n            });\r\n        })\r\n        //提高母版层级\r\n    complier.callMasterMgr(function() {\r\n        this.abstractAssistPocess(currIndex, function(pageObj) {\r\n            pageObj.element.css({\r\n                'z-index': 1\r\n            });\r\n        })\r\n    })\r\n}\r\n\r\n\r\n//处理跳转逻辑\r\nfunction calculateFlip(complier, data, createCallback) {\r\n    //缓存当前页面索引用于销毁\r\n    var pageIndex,\r\n        i = 0,\r\n        collectContainers = [],\r\n        create = data.create,\r\n        targetIndex = data.targetIndex;\r\n\r\n    //需要创建的页面闭包器\r\n    for (; i < create.length; i++) {\r\n        pageIndex = create[i];\r\n        collectContainers.push(function(targetIndex, pageIndex) {\r\n            return function(callback) {\r\n                //创建新结构\r\n                complier.create([pageIndex], targetIndex, 'toPage', callback, {\r\n                    'opacity': 0 //同页面切换,规定切换的样式\r\n                });\r\n            }\r\n        }(targetIndex, pageIndex));\r\n    }\r\n\r\n\r\n    /**\r\n     * 二维数组保存，创建返回的对象\r\n     * 1 page对象\r\n     * 2 母版对象\r\n     * @type {Array}\r\n     */\r\n    data.pageBaseCollect = [];\r\n\r\n    var i = 0,\r\n        collectLength, count,\r\n        count = collectLength = collectContainers.length;\r\n\r\n    if (collectContainers && collectLength) {\r\n        for (; i < collectLength; i++) {\r\n            //收集创建的根节点,异步等待容器的创建\r\n            collectContainers[i].call(complier, function(callbackPageBase) {\r\n                if (count === 1) {\r\n                    collectContainers = null;\r\n                    setTimeout(function() {\r\n                        createCallback(data);\r\n                    }, 100);\r\n                }\r\n                //接受创建后返回的页面对象\r\n                data.pageBaseCollect.push(callbackPageBase);\r\n                count--;\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//节点创建完毕后，切换页面动，执行动作\r\nfunction createContainerView(complier, data) {\r\n\r\n    var prveHindex = data.currIndex;\r\n    var pageMgr = complier.pageMgr;\r\n\r\n    //停止当前页面动作\r\n    complier.suspend({\r\n        'stopPointer': prveHindex\r\n    });\r\n\r\n    //========处理跳转中逻辑=========\r\n\r\n    /**\r\n     * 清除掉不需要的页面\r\n     * 排除掉当前提高层次页面\r\n     */\r\n    _.each(data['destroy'], function(destroyIndex) {\r\n        if (destroyIndex !== data.currIndex) {\r\n            pageMgr.clearPage(destroyIndex)\r\n        }\r\n    })\r\n\r\n    //修正翻页2页的页面坐标值\r\n    _.each(data['ruleOut'], function(pageIndex) {\r\n        if (pageIndex > data['targetIndex']) {\r\n            pageMgr.abstractAssistAppoint(pageIndex, function(pageObj) {\r\n                Translation.fix.call(pageObj, 'nextEffect')\r\n            })\r\n        }\r\n        if (pageIndex < data['targetIndex']) {\r\n            pageMgr.abstractAssistAppoint(pageIndex, function(pageObj) {\r\n                Translation.fix.call(pageObj, 'prevEffect')\r\n            })\r\n        }\r\n    })\r\n\r\n\r\n    var jumpPocesss;\r\n\r\n    //母版\r\n    complier.callMasterMgr(function() {\r\n        jumpPocesss = this.makeJumpPocesss(data);\r\n        jumpPocesss.pre();\r\n    })\r\n\r\n    //===========跳槽后逻辑========================\r\n    pageMgr.clearPage(prveHindex);\r\n\r\n    jumpPocesss && jumpPocesss.clean(data.currIndex, data.targetIndex);\r\n\r\n    /**\r\n     * 同页面切换,规定切换的样式复位\r\n     * @param  {[type]} pageBase [description]\r\n     * @return {[type]}          [description]\r\n     */\r\n    _.each(data.pageBaseCollect, function(pageBase) {\r\n        _.each(pageBase, function(pageObj) {\r\n            pageObj.element && pageObj.element.css({\r\n                'opacity': 1\r\n            })\r\n        })\r\n    })\r\n\r\n    data.pageBaseCollect = null;\r\n    jumpPocesss = null;\r\n}\r\n\r\n\r\nexport function SwitchPage(complier, data, success) {\r\n    //跳前逻辑\r\n    prev(complier, data);\r\n    //处理逻辑\r\n    calculateFlip(complier, data, function(data) {\r\n        createContainerView(complier, data);\r\n        success.call(complier, data)\r\n    })\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/manager/switch.js\n **/","import {\r\n    _set, _get, remove, _save, parseJSON, hash\r\n}\r\nfrom '../../util/index'\r\n\r\n/**\r\n * content对象的创建过滤器\r\n * 用于阻断对象的创建\r\n */\r\nexport function contentFilter(filterName) {\r\n\r\n    //过滤的节点\r\n    var listFilters = function() {\r\n        var values = getCache();\r\n        var h = hash()\r\n        if (values) {\r\n            //keep the listFilters has no property\r\n            _.each(values, function(v, i) {\r\n                h[i] = v;\r\n            });\r\n        }\r\n        return h;\r\n    }();\r\n\r\n    function setCache(listFilters) {\r\n        _save(filterName, listFilters)\r\n    }\r\n\r\n    function getCache() {\r\n        var jsonStr = _get(filterName);\r\n        return parseJSON(jsonStr);\r\n    }\r\n\r\n    function access(callback, pageId, contentId) {\r\n        //如果是transformFilter,不需要pageIndex处理\r\n        if (filterName === 'transformFilter' && contentId === undefined) {\r\n            contentId = pageId;\r\n            pageId = 'transformFilter'\r\n        }\r\n        return callback(pageId, Number(contentId))\r\n    }\r\n\r\n    return {\r\n        add: function(pageId, contentId) {\r\n            access(function(pageId, contentId) {\r\n                if (!listFilters[pageId]) {\r\n                    listFilters[pageId] = [];\r\n                }\r\n                //去重\r\n                if (-1 === listFilters[pageId].indexOf(contentId)) {\r\n                    listFilters[pageId].push(contentId);\r\n                    setCache(listFilters)\r\n                }\r\n            }, pageId, contentId)\r\n        },\r\n\r\n        remove: function(pageId, contentId) {\r\n            access(function(pageId, contentId) {\r\n                var target = listFilters[pageId] || [],\r\n                    index = target.indexOf(contentId);\r\n                if (-1 !== index) {\r\n                    target.splice(index, 1);\r\n                    setCache(listFilters);\r\n                }\r\n            }, pageId, contentId)\r\n        },\r\n\r\n        has: function(pageId, contentId) {\r\n            return access(function(pageId, contentId) {\r\n                var target = listFilters[pageId];\r\n                return target ? -1 !== target.indexOf(contentId) ? true : false : false;\r\n            }, pageId, contentId)\r\n        },\r\n\r\n        /**\r\n         * 创建过滤器\r\n         * @param  {[type]} pageId [description]\r\n         * @return {[type]}        [description]\r\n         */\r\n        each: function(pageId) {\r\n            return access(function(pageId, contentId) {\r\n                var target, indexOf;\r\n                if (target = listFilters[pageId]) {\r\n                    return function(contentIds, callback) {\r\n                        _.each(target, function(ids) {\r\n                            var indexOf = contentIds.indexOf(ids);\r\n                            if (-1 !== indexOf) {\r\n                                callback(indexOf); //如果找到的过滤项目\r\n                            }\r\n                        })\r\n                    }\r\n                }\r\n            }, pageId)\r\n        },\r\n\r\n        //过滤器数量\r\n        size: function() {\r\n            return _.keys(listFilters).length;\r\n        },\r\n\r\n        empty: function() {\r\n            _remove(filterName);\r\n            listFilters = {};\r\n        }\r\n    }\r\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/component/content/filter.js\n **/","var preloadVideo = {\r\n    //播放状态\r\n    state: false,\r\n    //地址\r\n    path: DUKUCONFIG ? DUKUCONFIG.path + \"duku.mp4\" : 'android.resource://#packagename#/raw/duku',\r\n\r\n    //加载视频\r\n    load: function() {\r\n        // if (window.localStorage.getItem(\"videoPlayer\") == 'error') {\r\n        //       alert(\"error\")\r\n        //     return preloadVideo.launchApp();\r\n        // }\r\n        this.play();\r\n        this.state = true;\r\n    },\r\n\r\n    //播放视频\r\n    play: function() {\r\n        //延时应用加载\r\n        Xut.Application.delayAppRun();\r\n        Xut.Plugin.VideoPlayer.play(function() {\r\n            preloadVideo.launchApp();\r\n        }, function() {\r\n            //捕获出错,下次不进入了,,暂无ID号\r\n            // window.localStorage.setItem(\"videoPlayer\", \"error\")\r\n            preloadVideo.launchApp();\r\n        }, preloadVideo.path, 1, 0, 0, window.innerHeight, window.innerWidth);\r\n    },\r\n\r\n    //清理视频\r\n    closeVideo: function() {\r\n        Xut.Plugin.VideoPlayer.close(function() {\r\n            preloadVideo.launchApp();\r\n        });\r\n    },\r\n\r\n    //加载应用\r\n    launchApp: function() {\r\n        this.state = false;\r\n        Xut.Application.LaunchApp()\r\n    }\r\n}\r\n\r\nexport function loadVideo() {\r\n    preloadVideo.load();\r\n}\r\n\r\n\r\n/**************\r\n * 物理按键处理\r\n **************/\r\n\r\n//退出加锁,防止过快点击\r\nvar outLock = false;\r\n\r\n//回退按钮状态控制器\r\nfunction controller(state) {\r\n    //如果是子文档处理\r\n    if (Xut.isRunSubDoc) {\r\n        //通过Action动作激活的,需要到Action类中处理\r\n        Xut.publish('subdoc:dropApp');\r\n        return;\r\n    }\r\n    //正常逻辑\r\n    outLock = true;\r\n\r\n    Xut.Application.Suspend({\r\n        dispose: function() { //停止热点动作\r\n            setTimeout(function() {\r\n                outLock = false;\r\n            }, 100)\r\n        },\r\n        processed: function() { //退出应用\r\n            state === 'back' && Xut.Application.DropApp();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * 绑定控制案例事件\r\n * @param  {[type]} config [description]\r\n * @return {[type]}        [description]\r\n */\r\nexport function bindEvent(config) {\r\n    //存放绑定事件\r\n    config._event = {\r\n        //回退键\r\n        back: function() {\r\n            //如果是预加载视频\r\n            if (preloadVideo.state) {\r\n                preloadVideo.closeVideo()\r\n            } else {\r\n                controller('back');\r\n            }\r\n        },\r\n        //暂停键\r\n        pause: function() {\r\n            controller('pause');\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n/**\r\n *  创建播放器\r\n *  IOS，PC端执行\r\n */\r\nexport function html5Video() {\r\n    //延时应用开始\r\n    Xut.Application.delayAppRun();\r\n    var videoPlay = Xut.Video5({\r\n        url: 'duku.mp4',\r\n        startBoot: function() {\r\n            Xut.Application.LaunchApp();\r\n        }\r\n    });\r\n    videoPlay.play();\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/init/initprocess.js\n **/"],"sourceRoot":""}