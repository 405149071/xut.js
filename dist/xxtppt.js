/*!
 * Xut.js v887.9
 * Release date 2017-7-20
 * (c) 2010-2017 @ by Aaron
 * 仅供公司内部使用
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function t(t,e,i,n){var a=t.screenSize.width,o=t.screenSize.height,r=a,s=o,c=0,l=0;return i||bo("getVisualSize没有提供setVisualMode"),2===i&&(t.pptVertical&&(t.screenVertical&&(s=e.pptHeight*e.width,c=(o-s)/2),t.screenHorizontal&&(r=e.pptWidth*e.height,l=(a-r)/2)),t.pptHorizontal&&(t.screenHorizontal&&(s=e.pptHeight*e.width,c=(o-s)/2),t.screenVertical&&(s=e.pptHeight*e.width,c=(o-s)/2)),s>o&&(s=o,c=0)),3===i&&(t.pptVertical&&(t.screenVertical&&(r=e.pptWidth*e.height,l=(a-r)/2,r<a&&(r=a,l=0)),t.screenHorizontal&&(r=e.pptWidth*e.height,l=(a-r)/2)),t.pptHorizontal&&(t.screenHorizontal&&(r=e.pptWidth*e.height,l=(a-r)/2,!n&&r<a&&(r=a,l=0)),t.screenVertical&&(s=e.pptHeight*e.width,c=(o-s)/2))),t.launch.doublePageMode&&1===i&&(r/=2),5===i&&(r=2*a),{width:xo(r),height:xo(s),left:xo(l),top:xo(c)}}function e(){if(Xut.IBooks.Enabled){var t=Xut.IBooks.CONFIG.screenSize;if(t)return{width:t.width,height:t.height}}var e=document.documentElement.clientWidth||$(window).width(),i=document.documentElement.clientHeight||$(window).height();return No.launch.visualHeight&&(No.launch.visualTop=i-No.launch.visualHeight,i=No.launch.visualHeight),{width:e,height:i}}function i(t){return t.width>t.height?"horizontal":"vertical"}function n(t,e,i){var n=t.screenSize.width,a=t.screenSize.height,o=t.screenHorizontal,r=e?e:o?wo:ko,s=i?i:o?ko:wo,c=n/r,l=a/s;return{width:c,height:l,left:c,top:l,pptWidth:r,pptHeight:s}}function a(t,e,i){var n=e.width/i.pptWidth,a=e.height/i.pptHeight;return{width:n,height:a,left:n,top:a,offsetTop:0,offsetLeft:0}}function o(){Fo=null,Go=null,zo=null,Wo=null}function r(){Oo=!1,Ho=!1,Ro=!1,Lo=!1,No.data.pathAddress=Yo(),No.data.rootPath=No.data.pathAddress.replace("/gallery/","")}function s(t,e){return Jo(t,e),5===No.launch.visualMode?(Zo(t,e,No.launch.visualMode),void(No.originalVisualSize=No.visualSize)):No.launch.doublePageMode&&No.pptVertical&&No.screenHorizontal?(Zo(t,e,3===No.launch.visualMode?2:No.launch.visualMode),void(No.originalVisualSize=No.visualSize)):(No.pptHorizontal&&No.screenHorizontal&&3===No.launch.visualMode?Zo(t,e,No.launch.visualMode,!0):Zo(t,e,3===No.launch.visualMode?2:No.launch.visualMode),No.originalVisualSize=No.visualSize,No.pptVertical&&No.screenHorizontal&&(No.verticalToHorizontalVisual=!0),No.pptHorizontal&&No.screenVertical&&(No.horizontalToVerticalVisual=!0),void(2===No.launch.visualMode?No.visualSize.left&&tr(t,e,{width:No.visualSize.width,height:No.visualSize.height},No.launch.visualMode):3===No.launch.visualMode&&(No.visualSize.left?tr(t,e,{width:No.visualSize.width,height:No.visualSize.height},1):tr(t,e,"",1))))}function c(e){return t(No,Ao,e)}function l(t){return a(No,t,Ao)}function u(t,e,i,n,a){er(t,e,{value:i,enumerable:n,writable:a,configurable:!0})}function d(t,e,i){er(t,e,{get:i.get,set:i.set})}function h(t){return t.replace(/(\w)/,function(t){return t.toUpperCase()})}function p(t,e){if(t&&e){if(e.length&&~e.indexOf(t))return!0;if("string"==typeof e&&t===e)return!0}}function f(t){return Number(t)||null}function v(){return Object.create(null)}function g(t,e){for(var i in e)i&&(t[i]?bo("接口方法重复","Key->"+i,"Value->"+t[i]):t[i]=e[i])}function m(t){if(t){var e=void 0;try{e=JSON.parse(t)}catch(e){return bo("parseJSON失败:"+t),!1}return e}}function y(t){return t.replace(/\r\n/gi,"").replace(/\r/gi,"").replace(/\n/gi,"")}function b(t){try{var e="(function(){"+y(t)+"})";return new Function("return "+e)()}catch(e){bo("解析json出错"+t)}}function x(t){if(t&&t.length){for(var e=t.length;--e;)t.lastIndexOf(t[e],e-1)>-1&&t.splice(e,1);return t}return t}function w(t,e,i,n){if(t.xutHandler){var a=t.xutHandler,o=lr[a];o&&(o[e]?"transitionend"!==e&&bo(e+"：事件重复绑定添加"):o[e]=[i,n])}else lr[ur]=go({},e,[i,n]),t.xutHandler=ur++}function k(t){var e=t.xutHandler,i=lr[e];if(!i)return void bo("移除所有事件出错");_.each(i,function(e,n){e&&(t.removeEventListener(n,e[0],e[1]),i[n]=null)}),delete lr[e]}function I(t,e){var i=t.xutHandler,n=lr[i];if(!n)return void bo("移除事件"+e+"出错");var a=n[e];a?(t.removeEventListener(e,a[0],a[1]),n[e]=null,delete n[e]):bo("移除事件"+e+"出错"),Object.keys(n).length||delete lr[i]}function P(t){return t.length&&(t=t[0]),t}function T(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];vr(e),fr(hr,P(t),e,i)}function S(t,e){return t?(t=P(t),1===arguments.length?void k(t):_.isArray(e)?(vr(e),void fr(pr,t,e)):void bo("移除的事件句柄参数，必须是数组")):void bo("移除事件对象不存在")}function C(t,e,i){switch(i.type){case"touchstart":case"mousedown":t.start&&t.start.call(e,i);break;case"touchmove":case"mousemove":t.move&&t.move.call(e,i);break;case"touchend":case"mouseup":case"mousecancel":case"touchcancel":case"mouseleave":t.end&&t.end.call(e,i);break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":t.transitionend&&t.transitionend.call(e,i)}}function M(t,e){var i=null;return ar&&(i=t.touches)&&i.length>0&&(t=i[0]),e?t:t.target}function X(t){return t.touches&&t.touches[0]?t.touches[0]:t}function N(t,e){var i,n=t.sheet;if(gr)n&&(i=!0);else if(n)try{n.cssRules&&(i=!0)}catch(t){"NS_ERROR_DOM_SECURITY_ERR"===t.name&&(i=!0)}setTimeout(function(){i?e():N(t,e)},20)}function B(t,e,i,n){function a(n){if(t.onload=t.onerror=t.onreadystatechange=null,!i){(document.getElementsByTagName("head")[0]||document.documentElement).removeChild(t)}t=null,e(n)}var o="onload"in t;if(i&&gr)return void setTimeout(function(){N(t,e)},1);o?(t.onload=a,t.onerror=function(){a(!0)}):t.onreadystatechange=function(){/loaded|complete/.test(t.readyState)&&a()}}function D(t,e,i){var n=/\.css(?:\?|$)/i,a=n.test(t),o=document.createElement(a?"link":"script");if(i){var r=$.isFunction(i)?i(t):i;r&&(o.charset=r)}B(o,e,a,t),a?(o.rel="stylesheet",o.href=t):(o.async=!0,o.src=t);var s=document.getElementsByTagName("head")[0]||document.documentElement,c=s.getElementsByTagName("base")[0];return c?s.insertBefore(o,c):s.appendChild(o),o}function A(t,e){if(!t)return console.log("loadFigure data有错误"),void(e&&e());var i=void 0;if("string"==typeof t?(i=new Image,i.src=t):(i=t.image,i.src=t.url),i.complete)return e&&e.call(i,!0,!0),i;var n=i.width,a=i.height,o=function(){i=i.onload=i.onerror=null},r=function t(r){var s=i.width,c=i.height;if(s!==n||c!==a||s*c>1024)return o(),e&&e(!0,r),t.end=!0,!0};return i.onerror=function(){r.end=!0,o(),e&&e(!1)},r(!0)?void 0:(i.onload=function(){o(),e&&e(!0)},i)}function E(t,e){var i;if(_.isObject(t))for(var n in t)t.hasOwnProperty(n)&&(i=br(n),yr.setItem(i,t[n]));else t=br(t),yr.setItem(t,e)}function O(t){return t=br(t),yr.getItem(t)||void 0}function H(t){t=br(t),yr.removeItem(t)}function R(){mr=null}function L(t,e,i){if(!i){var n=new Date;n.setTime(n.getTime()+2592e6),i=n.toGMTString()}document.cookie=t+"="+escape(e)+";expires="+i}function F(t){if(document.cookie.length>0){var e,i=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(i))?unescape(e[2]):null}return null}function G(t){var e=new Date;e.setTime(e.getTime()-1);var i=F(t);null!=i&&(document.cookie=t+"="+i+";expires="+e.toGMTString())}function z(t,e){t&&e&&wr(t,e)}function W(t){if(t)return kr(t)}function j(t){t||_r(t)}function V(){Ir()}function Y(t){return t&&Tr.test(t)?t.substring(0,t.length-1):t}function U(t,e){var i=No.launch.resource?No.launch.resource+"/gallery/"+t+".css":No.data.pathAddress+t+".css",n=D(i,e);n&&n.setAttribute("data-type",t)}function q(){Sr=null,No.launch.brModelType&&"delete"!==No.launch.brModelType&&(Sr=new RegExp("(\\w+["+No.launch.brModelType+"]?)([."+No.launch.baseImageSuffix+"]*)$","i"))}function K(t){var e=t,i=t,n=void 0;return Sr?(n=t.match(Sr),n&&n.length?(e=n[0],i=n[1]):bo("zoom-image-brModelType解析出错,result："+n)):No.launch.baseImageSuffix?(n=t.match(/(\w+)(\.\w+)(\.\w+)$/),n&&n.length?(e=n[0],i=n[1]+n[3]):bo("zoom-image-suffix解析出错,result："+n)):(n=t.match(/\w+\.\w+$/),n&&n.length?e=i=n[0]:bo("zoom-image解析出错,result："+n)),{original:i,suffix:e}}function Q(t,e){return t&&e?No.launch.brModelType&&"delete"!==No.launch.brModelType?t.replace(/\w+/gi,"$&."+e):t.replace(/\w+\./gi,"$&"+e+"."):t}function Z(t){return No.launch.useHDImageZoom&&No.launch.imageSuffix&&No.launch.imageSuffix[1440]?tt(Q(t,No.launch.imageSuffix[1440]),"getHDFilePath"):""}function J(t){return/\.[jpg|png|gif]+/i.test(t)}function tt(t,e,i){if(!t)return"";var n=No.launch;if(n.baseImageSuffix&&J(t)&&-1===t.indexOf("."+n.baseImageSuffix+".")){var a=t.match(/(\w+)\.(\w+)$/);a[1],a[2];t=a[1]+"."+n.baseImageSuffix+"."+a[2]}if(i)return No.data.pathAddress+t;if(n.brModelType&&J(t)&&!/\_[i|a]+\./i.test(t)){var o="",r=void 0;if(Xut.plat.isBrowser){var s=t.match(/\w+([.]?[\w]*)\1/gi);return 3===s.length?(r=s[0],o="."+s[1]):r=s[0],""+(No.data.pathAddress+r)+n.brModelType+o}return""+(No.data.pathAddress+r)+o}return No.data.pathAddress+t}function et(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),m(e.responseText)}function it(t,e,i){var n=t[e];n||(n=t[e]={}),i.call(n)}function nt(t,e){try{new Function(function(t){return t.replace(/\r\n/gi,"").replace(/\r/gi,"").replace(/\n/gi,"")}(t))()}catch(t){bo("加载脚本错误",e)}}function at(t){var e=Math.random().toString();return e=e.replace(/\b(0+)(\.+)/gi,""),e=parseInt(e),t+"?"+e}function ot(t){return 1===No.launch.lauchMode&&-1!==t.indexOf("content/gallery/")&&(t=t.replace(/content\/gallery/gi,No.data.pathAddress)),t}function rt(){return Cr.apply(void 0,arguments)}function st(t){var e=t.results,i=t.proportion,n=t.zoomMode,a=t.getStyle,o=Cr({proportion:i,zoomMode:n,getStyle:a,width:e.width,height:e.height,left:e.left,top:e.top}),r=Cr({proportion:i,zoomMode:n,getStyle:a,width:e.backwidth,height:e.backheight,left:e.backleft,top:e.backtop});return e.scaleWidth=o.width,e.scaleHeight=o.height,e.scaleLeft=o.left,e.scaleTop=o.top,o.isHide&&(e.isHide=o.isHide),e.scaleBackWidth=r.width,e.scaleBackHeight=r.height,e.scaleBackLeft=r.left,e.scaleBackTop=r.top,e}function ct(t){return No.launch.preload?t:t+"?r="+(new Date).getTime()}function lt(t,e,i){var n=void 0,a=void 0,o=void 0,r=void 0,s=function(i,n){D(ct(i),function(){o=window.HTMLCONFIG[n],o?(e(o),delete window.HTMLCONFIG[n]):(bo("js文件加载失败，文件名:"+t),e(""))})};return"js"===i?(n=No.getSvgPath()+t,a=t.replace(".js",""),void s(n,a)):"svg"===No.launch.convert?(t=t.replace(".svg",".js"),a=t.replace(".js",""),r=No.getSvgPath()+t,void s(r,a)):Xut.IBooks.CONFIG?(/.svg$/.test(t)&&(t=t.replace(".svg",".js")),n=No.getSvgPath().replace("svg","js")+t,a=t.replace(".js",""),void D(ct(n),function(){o=window.HTMLCONFIG[a]||window.IBOOKSCONFIG[a],o?(e(o),delete window.HTMLCONFIG[a],delete window.IBOOKSCONFIG[a]):(bo("编译:脚本加载失败，文件名:"+a),e(""))})):Xut.plat.isBrowser&&!No.isPlugin?(r=No.getSvgPath().replace("www/","")+t,No.launch.resource&&(r=No.getSvgPath()+t),void $.ajax({type:"get",dataType:"html",url:ct(r),success:function(t){e(t)},error:function(i,n){bo("svg文件解释出错，文件名:"+t),e("")}})):void Xut.Plugin.ReadAssetsFile.readAssetsFileAction(No.getSvgPath()+t,function(t){e(t)},function(t){e("")})}function ut(t,e,i){return No.launch.brModelType?"delete"===No.launch.brModelType?""+t+e:""+t+No.launch.brModelType+e:""+t+e+i}function dt(){if(!(Ar=window.SQLResult))return void bo("json数据库加载出错");if(!_.isObject(Ar))return void bo("json数据库必须是对象");if(!Ar.Setting)return void bo("json数据库必须要表");if(No.launch.resource&&Ar.FlowData){No.launch.columnCheck!==!1&&(No.launch.columnCheck=!0);var t=No.launch.baseImageSuffix?"."+No.launch.baseImageSuffix:"";Ar.FlowData=Ar.FlowData.replace(Dr,function(e,i,n,a){return i+'="'+No.launch.resource+"/gallery/"+ut(n,t,a)})}return window.SQLResult=null,Ar}function ht(t){var e=No.launch.database;e?(window.SQLResult=null,D(e,function(){t(dt())})):window.SQLResult?t(dt()):t()}function pt(){Ar.FlowData=null}function ft(){return Ar}function vt(){Ar=null}function gt(t,e){var i;if("string"==typeof t)e(i,t);else for(i in t)e(i,t[i])}function mt(t,e,i,n){var a=ft(),o=void 0,r=void 0;a?a[n]?(o=a[n],r={length:Object.keys(o).length,item:function(t){return o[t]}},e(r)):i({tName:":table not exist!!"}):$.ajax({url:No.data.onlineModeUrl,dataType:"json",data:{xxtsql:t},success:function(t){o=t,r={length:t.length,item:function(t){return o[t]}},e(r)},error:i})}function yt(t,e){function i(t,e){h--,u.push(r(t,e)),0===h&&n()}function n(){if(u.length){var t=u.shift();s=t.tableName,t.execute()}else e(l.results?l.results:l,d)}function a(){n()}function o(t){d.push(s),console.log("数据查询错误 "+t.message,"类型",s),n()}function r(t,e){return{tableName:t,execute:function(){c?c.transaction(function(i){i.executeSql(e,[],function(e,i){l[t]=i.rows})},o,a):mt(e,function(e){l[t]=e,a()},o,t)}}}var s,c=No.data.db,l={},u=[],d=[],h=function(){return"string"==typeof t?1:Object.keys(t).length}();gt(t,function(t,e){i(t||"results",e)})}function bt(t,e){yt("select * FROM "+t+" order by _id ASC",function(t,i){e(t,i)})}function xt(t){Xut.IBooks.CONFIG?t(Xut.IBooks.CONFIG.data):yt(Er,function(e,i){t(e,i)})}function wt(t,e,i,n){yt("delete from "+t+" where _id = "+e,function(t,e){t?t():e&&n()})}function kt(){return zr}function _t(t,e){zr=e||[],Xut.data=Lr=t}function It(){Lr=null,Fr=null,Gr=null,Xut.data=null}function Pt(){Or(Lr),Lr.Video&&(Gr=Hr(Lr)),Fr=Rr(Lr)}function Tt(t){Lr.novelId=t,Lr.preventContent=function(){return!Lr.Content.length}(),Lr.query=function(t,e,i,n){switch(i){case"activityId":for(var a,o=e,r=Lr[t],s=0,c=r.length;s<c;s++)if((a=r.item(s))&&a[i]==o)return a;return;case"chapterId":case"seasonId":var l=e,r=Lr[t];if(r)for(var a,s=0,c=r.length;s<c;s++)(a=r.item(s))&&a[i]==l&&n&&n(a);return}var u=function(){var i=Lr[t];if(e){var n=e-i.start;return i.item(n)}return i.length?i.item(0):null};switch(t){case"appPage":return Lr.Chapter;case"appSection":return Lr.Season;case"sectionRelated":return Fr["seasonId->"+e];case"Video":if(i)return u();var e=Gr[e];return Lr.query("Video",e,!0);default:return u()}},Lr.oneQuery=function(t,e){bt(t,function(t){e&&e(t)})},Lr.remove=function(t,e,i,n){wt(t,e,i,n)}}function St(t){xt(function(e,i){_t(e,i),Pt(),Tt(e.Novel.item(0)._id),t(e)})}function Ct(t){var e=void 0,i={},n={};_.each(t,function(n,a){e=t.item(a),i[e.name]=e.value}),_.defaults(i,Yr);for(var a in Yr)n[a]=Number(i[a]);return _.extend(No.data,{appId:i.adUpdateTime?i.appId+"-"+/\S*/.exec(i.adUpdateTime)[0]:i.appId,settings:n,delayTime:i.delayTime,Inapp:i.Inapp,shortName:i.shortName,visualMode:i.visualMode?Number(i.visualMode):0}),Xut.Presentation.AdsId=i.adsId,i}function $t(){if(!Kr){var t=No.visualSize.width,e=No.visualSize.height,i=Math.min(t,e)/4,n=Math.round((e-i)/2),a=[0,.9167,.833,.75,.667,.5833,.5,.41667,.333,.25,.1667,.0833],o=[0,30,60,90,120,150,180,210,240,270,300,330],r=12,s="";if(Jr)s+='<div class="xut-busy-middle fullscreen-background"\n                       style="background-image: url('+Jr+');">\n                  </div>';else{for(;r--;)s+='<div class="xut-busy-spinner"\n              style="'+Xut.style.transform+":rotate("+o[r]+"deg) translate(0,-142%);"+Xut.style.animationDelay+":-"+a[r]+'s">\n         </div>';s='<div class="xut-busy-middle">'+s+"</div>"}qr=$(".xut-busy-icon").html(String.styleFormat('<div style="width:'+i+"px;height:"+i+"px;margin:"+n+"px auto;margin-top:"+(No.visualSize.top+n)+'px;">\n        <div style="height:30%;"></div>\n          '+s+'\n        <div class="xut-busy-text"></div>\n     </div>'))}}function Mt(t){ls=t}function Xt(t,e,i){ls[t]&&ls[t][e]&&(ls[t][e]=i)}function Nt(){return ls}function Bt(t,e){if(ls&&(t||e)){var i=ls[t],n=0;for(var a in i)a<=e&&(n+=i[a],--n);return n>0?n:0}}function Dt(t,e){if(ls&&t&&e){var i=ls[t],n=0;for(var a in i)a<e&&(n+=i[a],--n);return n>0?n:0}}function At(t){if(ls)return Object.keys(ls[t]).length}function Et(t,e){if(ls){if(t){if(e)return ls[t]&&ls[t][e];var i=ls[t],n=0;for(var a in i)n+=i[a];return n}console.log("getCounts失败")}}function Ot(t,e){return!!Et(t,e)}function Ht(t,e,i,n){var a=[];Ft(t,function(t,i,o){us&&n>hs&&(o=ds),e[t][i]!==o&&(e[t][i]=o,a.push(vs(t,i,o)))}),--n,a.length&&gs(a),n?ps=setTimeout(function(){Ht(t,e,i,n)},500):(No.launch.columnCheck=!1,Lt(),i())}function Rt(t,e,i){Ht(t,e,i,fs)}function Lt(){Xut.Application.unWatch("change:number:total change:column"),clearTimeout(ps),ps=null}function Ft(t,e){t.each(function(i,n){var a=n.id,o=a.match(/\d/)[0];t.children().each(function(t,i){var n=i.id;if(n){var a=n.match(/\d+/)[0],r=void 0;"h"===No.launch.scrollMode?r=_s(i,"#columns-content"):"v"===No.launch.scrollMode&&(r=_s(i,"#scroller-section")),e(o,a,r)}})})}function Gt(t){var e=$("#xut-stream-flow");e.length&&e.remove();var i=function(t,e,i){t.css({width:e,height:i,display:"block"})},n=function(n,a){var o=e.children();if(!o.length)return void t();var r={};i(e,n,a),ks(r,o,n,a),setTimeout(function(){Ft(o,function(t,e,i){us&&No.launch.columnCheck&&(i=ds),r[t][e]=i}),Mt(r),No.launch.columnCheck?Rt(o,$.extend(!0,{},r),function(){e.hide()}):e.hide(),t(Object.keys(r).length)},100),$("body").append(e)},a=ft();if(a&&a.FlowData){var o=c(1),r=bs=o.height;U("xxtflow",function(){e=$(a.FlowData),pt(),n(o.width,r)})}else t()}function zt(t){function e(e){z(t||"aaron",JSON.stringify(e))}function i(){var e=W(t);return e?m(e):""}function n(e,i,n){return"transformFilter"===t&&void 0===n&&(n=i,i="transformFilter"),e(i,Number(n))}var a=function(){var t=i(),e=v();return t&&_.each(t,function(t,i){e[i]=t}),e}();return{add:function(t,i){n(function(t,i){a[t]||(a[t]=[]),-1===a[t].indexOf(i)&&(a[t].push(i),e(a))},t,i)},remove:function(t,i){n(function(t,i){var n=a[t]||[],o=n.indexOf(i);-1!==o&&(n.splice(o,1),e(a))},t,i)},has:function(t,e){return n(function(t,e){var i=a[t];return!!i&&-1!==i.indexOf(e)},t,e)},each:function(t){return n(function(t,e){var i;if(i=a[t])return function(t,e){_.each(i,function(i){var n=t.indexOf(i);-1!==n&&e(n)})}},t)},size:function(){return _.keys(a).length},empty:function(){j(t),a={}}}}function Wt(){if(Ps||(Ps=new Is),Ps){var t=Ps.get();if(t)return t}return new Audio}function jt(){Ps&&Ps.destory(),Ps=null}function Vt(t,e){function i(t){s&&(clearTimeout(s),s=null),r&&(r.removeEventListener("loadedmetadata",o,!1),r.removeEventListener("error",n,!1),r.src=null,r.removeAttribute("src"),Ps&&Ps.add(r),r=null)}function n(t){i(t),e()}function a(){function t(t){return!(!r.buffered.length||i!=r.buffered.end(r.buffered.length-1))}function e(){s=setTimeout(function(){if(t())return void n("isExit");e()},500)}if(t())return void n("isExit");r.play();var i=r.duration;e()}function o(){if(!r.buffered)return void n();a()}var r=Wt();r.src=t,r.preload="auto",r.autobuffer=!0,r.autoplay=!0,r.muted=!0;var s=null;return r.addEventListener("loadedmetadata",o,!1),r.addEventListener("error",n,!1),{destory:i}}function Yt(){if(Ts||(Ts=new Is),Ts){var t=Ts.get();if(t)return t}return new Image}function Ut(){Ts&&Ts.destory(),Ts=null}function qt(t,e){var i=No.launch.brModelType;i&&(t=t.replace(/.png$|.jpg$/,i));var n=A({image:Yt(),url:t},function(){Ts&&Ts.add(n),e()});return{destory:function(){n&&(n.src=null,n.removeAttribute("src"),n=null)}}}function Kt(t,e){$.ajax({url:t,complete:e})}function Qt(t,e){Es[t]||(Es[t]=e,e.reset(12e3,function(){Es[t].destory(),Es[t]=null,delete Es[t]}))}function Zt(){if(Es)for(var t in Es)Es[t].destory(),Es[t]=null;Es={}}function Jt(t,e){return qt(t,function(i,n){!Jt.url&&i&&(Jt.url=t),e()})}function te(t){Rs[t]=null}function ee(){return"number"==typeof No.launch.preload?No.launch.preload:5}function ie(t){var e=t,i=Rs[e];if(i)return function(t){oe(i,function(){te(e),t()})}}function ne(t,e,i){e=$s[t](e);e.length;return function(t){function n(){function o(){if(1===l){if(c)return void t();n()}--l}var r={},s=void 0,c=!1;e.fileNames.length>a?s=e.fileNames.splice(0,a):(s=e.fileNames,c=!0);for(var l=s.length,u=0;u<s.length;u++)!function(t){r[t]=new Os(i,t),r[t].start(2e3,function(e){e?r[t].destory():Qt(t,r[t]),r[t]=null,o()})}(s[u])}var a=ee();n()}}function ae(t,e,i){return"master"===t?ie(e):ne(t,e,i)}function oe(t,e){var i=new As;for(var n in t){var a=zs[n];a&&i.create(ae(n,t[n],a),"audio"===n?"unshift":"push")}i.exec().$$watch("complete",e)}function re(t,e){var i=function(){return t===Ls&&(bo("全部预加载完成"),z("preload",Jt.url),jt(),Ut(),!0)};if(e)return e(),void i();if(Gs){var n=Gs[0];if(t!==n)return void se(n);Gs[1](),Gs=null}i()||Hs&&se()}function se(t,e){t||(++Fs,t=Fs);var i=Rs[t],n=function(i){te(t),re(Fs,e)};i&&Object.keys(i).length?oe(i,function(){return n()}):n()}function ce(t,e){var i=W("preload");i?A(i,function(i,n){n?t():e()}):e()}function le(t,e){var i=function(){Rs=null,No.launch.preload=!1,e()},n=function(){se("",function(){bo("预加载资源总数："+t),ue(),e()})};D(No.data.pathAddress+"preload.js",function(){window.preloadData?(Ls=t,Rs=window.preloadData,window.preloadData=null,ce(i,n)):i()})}function ue(){if(Rs[Ls]){var t=null,e=2,i=function(i){2===e&&(clearTimeout(t),t=null,Hs=!0,se()),--e};Xut.Application.onceWatch("autoRunComplete",i),t=setTimeout(i,5e3)}}function de(t,e){var i=t.type,n=t.chapterId,a=t.direction,o=t.processed;if("linear"===i){var r=Xut.Presentation.GetPageId();n="next"===a?r+1:r-1}return!!Rs[n]&&(o||bo("预加载必须传递处理器，有错误"),Gs=[n,function(){o.call(e)}],!0)}function he(){Jt.url=null,Hs=!0,Ls=0,Fs=0,Rs=null,Gs=null,Zt()}function pe(t){"mini"===No.launch.platform&&Xut.plat.isTablet&&$("body").css("font-size","125%"),No.launch.imageSuffix&&Us(),q(),ht(function(i){Vr(i,function(i){var n=i.Novel.item(0),a=Ct(i.Setting);if(void 0===No.launch.visualMode&&(No.launch.visualMode=No.data.visualMode||1),5===No.launch.visualMode){var o=e();o.height<o.width&&(No.launch.visualMode=1)}qs(n,a),U("svgsheet",function(){Ks(function(){No.launch.preload?le(i.Chapter.length,function(){return t(n)}):t(n)})})})})}function fe(t,e){var i=e.width,n=e.height,a=e.zIndex,o=e.top,r=e.left,s="width:"+i+"px",c="height:"+n+"px";return"string"==typeof i&&~i.indexOf("%")&&(s="width:"+i),"string"==typeof n&&~n.indexOf("%")&&(c="height:"+n),$(String.styleFormat('<div data-type="'+t+'"\n          style="'+s+";\n                 "+c+";\n                 position:absolute;\n                 visibility:hidden;\n                 z-index:"+a+";\n                 top:"+o+"px;\n                 left:"+r+'px;">\n     </div>'))}function ve(t){return No.getVideoPath()+t}function ge(t){if(t.isfloat)return Xut.Presentation.GetFloatContainer(t.pageType);var e=t.container;return t.isColumn?$(e):e.length?e.children():e.children?$(e.children):$("body")}function me(){return ic.state}function ye(){ic.closeVideo()}function be(){ic.load()}function xe(){me()?ye():nc("back")}function we(){nc("pause")}function ke(){nc("resume")}function _e(){Xut.plat.hasPlugin&&(document.addEventListener("backbutton",xe,!1),document.addEventListener("pause",we,!1),document.addEventListener("resume",ke,!1))}function Ie(){Xut.plat.hasPlugin&&(document.removeEventListener("backbutton",xe,!1),document.removeEventListener("pause",we,!1),document.removeEventListener("resume",ke,!1))}function Pe(){window.GLOBALIFRAME?sc():Xut.plat.isBrowser?rc():(window.openDatabase(No.data.dbName,"1.0","Xxtebook Database",No.data.dbSize),document.addEventListener("deviceready",function(){Xut.plat.hasPlugin=!0,Xut.Plugin.XXTEbookInit.startup(No.data.dbName,sc,function(){})},!1))}function Te(t){var e=void 0,i=void 0,n=function(){e=document.querySelector("#Audio_"+t.audioId)},a=t.startImage&&tt(t.startImage,"audio-action"),o=t.stopImage&&tt(t.stopImage,"audio-action"),r=function(t){n(),e&&(e.style.backgroundImage="url("+t+")")};return n(),i=e.getAttribute("data-belong"),o&&A(o),{play:function(){o&&r(o),t.startScript&&Xut.Assist.Run(i,t.startScript.split(","))},pause:function(){a&&r(a),t.stopScript&&Xut.Assist.Stop(i,t.stopScript.split(","))},destroy:function(){this.pause(),e=null}}}function Se(){for(var t=0;t<wc.length;t++)wc[t].destroy&&wc[t].destroy(),wc[t]=null;wc=null}function Ce(){return wc.length}function $e(){var t=wc[bc++];return t?t:(bc=0,$e())}function Me(){return Ic}function Xe(t,e){var i=Me();if(i[cc]&&i[cc][t]){var n=i[cc][t][e];if(n&&"playing"===n.status)return!0}}function Ne(t,e,i){Dc({pageId:t,queryId:e,type:cc,action:"auto",data:i})}function Be(t){var e=t.data,i=t.columnData,n=t.activityId,a=t.chapterId;Dc({data:e,columnData:i,pageId:a,queryId:n,type:cc,action:"trigger"})}function De(t,e){Dc({pageId:t,queryId:e,type:lc})}function Ae(t,e){t&&void 0===e||Ac(t,e,function(i,n){i.destroy(),delete n[lc][t][e],Object.keys(n[lc][t]).length||delete n[lc][t]})}function Ee(){var t,e,i,n=Me();for(t in n)for(e in n[t])for(i in n[t][e])n[t][e][i].resetContext()}function Oe(){var t=Me();if(t&&t[cc]&&t[cc][dc]){var e=t[cc][dc];for(var i in e)e[i].destroy(),e[i]=null;delete t[cc][dc]}}function He(t,e){return t===lc||t===uc?Xut.data.query("Video",e,!0):Xut.data.query("Video",e)}function Re(){var t,e,i,n=Me();for(t in n)for(e in n[t])for(i in n[t][e])n[t][e][i].pause()}function Le(){var t,e,i,n=Me();for(t in n)for(e in n[t])for(i in n[t][e])n[t][e][i].destroy();Pc()}function Fe(t,e){if(zc[t])return zc[t][e]}function Ge(t){var e=Fe(t.chapterId,t.activityId);e?e.play():Uc(t)}function ze(){return zc}function We(){Ge.apply(void 0,arguments)}function je(){Ge.apply(void 0,arguments)}function Ve(t){var e=ze();if(e&&e[t]){for(var i in e[t])e[t][i].destroy(),e[t][i]=null;delete e[t]}}function Ye(){var t=ze(),e=!1;for(var i in t)for(var n in t[i])t[i][n].destroy(),e=!0;return Wc(),e}function Ue(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#xxtppt-app-container",e=arguments[1];t&&(Qc=$(t)),Qc.length||(t="",Qc=$("body"));var i=Kc(e);return t||(i='<div id="xxtppt-app-container" class="xut-fullscreen xut-overflow-hidden">'+i+"</div>"),Zc=$(String.styleFormat(i)),{$rootNode:Qc,$contentNode:Zc}}function qe(){Zc&&(Zc.remove(),Zc=null),Qc=null}function Ke(t,e){var i=Jc[t].length;if(!i)return void e();for(var n=i,a=function(){if(1===n)return void e();--n},o=void 0;o=Jc[t].shift();)o(a)}function Qe(){var t=Object.keys(Jc);if(t.length){var e=t.shift();e.length?Ke(e,function(){Jc[e].length||delete Jc[e],Qe()}):delete Jc[e]}else tl=!1}function Ze(t,e,i){t&&(t.style.display="none",Jc[e]||(Jc[e]=[]),Jc[e].push(function(e){A(i,function(i){i&&t&&t.style&&(t.style.display="block"),t=null,e()})}),tl||(tl=!0,Qe()))}function Je(t){Jc&&Jc[t]&&(Jc[t].length=0,delete Jc[t])}function ti(){Xut.plat.isBrowser&&!el&&(el=!0,$("body").on("touchmove",function(t){t.preventDefault&&t.preventDefault()}),$(document).keyup(function(t){switch(t.keyCode){case 37:Xut.View.GotoPrevSlide();break;case 39:Xut.View.GotoNextSlide()}}),setTimeout(function(){$(document).on("visibilitychange",function(t){"hidden"===document.visibilityState?Xut.Application.Original():window.GLOBALIFRAME||Xut.Application.Activate()})},1e3),$(window).on("beforeunload",function(){No.sendTrackCode("exit",{time:+new Date-No.launch.launchTime})}))}function ei(){el&&($("body").off(),$(document).off(),$(window).off(),el=!1)}function ii(t){var e=new Image;e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA",e.onload=e.onerror=function(){t(2===e.height)}}function ni(t){ii(function(e){Xut.plat.supportWebp=e,t()})}function ai(t){Xut.Contents.Canvas.Reset(),Xut.Contents.Canvas.SupportSwipe=t,Xut.Contents.Canvas.isTap=!0}function oi(){Xut.Contents.Canvas.isSwipe=!0}function ri(t,e,i,n){var a=al||"click"===t;e=e[0];var o=!1,r=void 0;o=!1;var s=function(t){var e=X(t);r=e.pageX,o=!0,ai(n)},c=function(t){if(o){var e=X(t),i=e.pageX-r;Math.abs(i)>10&&(o=!1,oi(n))}},l=function(){o&&i()};return"tap"===t?T(e,{start:s,move:c,end:l,cancel:l}):a&&(o=!0,T(e,{end:l})),{off:function(){e&&(S(e),e=null)}}}function si(t){var e=[];switch(t){case"swipeleft":case"swiperight":case"swipeup":case"swipedown":var i=Hammer.DIRECTION_HORIZONTAL;"swipeup"!==t&&"swipedown"!==t||(i=Hammer.DIRECTION_VERTICAL),e.push([Hammer.Swipe,{direction:i,velocity:.01}]);break;case"doubletap":e.push([Hammer.Tap]),e.push([Hammer.Tap,{event:"doubletap",taps:2},["tap"]]);break;case"press":return void e.push([Hammer.Press])}return e}function ci(t,e,i){var n=t[0],a=si(e);return a&&a.length?Hammer(n,{recognizers:a}):Hammer(n)}function li(t,e,i,n){var a=ci(t,e,n);return a.on(e,function(){i()}),a}function ui(t){Xut.plat.isBrowser&&t.domMode&&ll(t.eventName,t.eventContext);var e=t.eventDrop,i=ul(e,t);if(i.dragObj&&e.init)return void e.init(i.dragObj);t.eventHandler(i.reference,i.handler)}function di(t){return ol[Number(t)-1]||null}function hi(t){var e=t.supportSwipe=sl(t.eventName);t.domMode&&cl(e,t.eventContext),ui(t)}function pi(t,e){t.eventReference&&(t.eventReference.off(e||t.eventName,t.eventHandler),t.eventReference=null,t.eventHandler=null)}function fi(t,e){pl(t,e)}function vi(t){var e=t.divertorHooks.registerEvent;e&&(_.each(e,function(t){_.each(t,function(t){t.destroy&&t.destroy()})}),t.divertorHooks.registerEvent=null)}function gi(){this.remove()}function mi(t,e,i){switch(t){case"page":return wl(e,i);case"master":return gl(e,i);case"chapter":return vl(e);case"scenarioChapter":return fl(e)}}function yi(t,e){var i=t.pageType,n=function(e,i){var n=void 0;if(t.dataActionGroup[e])for(n in i)t.dataActionGroup[e][n]=i[n];else t.dataActionGroup[e]=i};mi(i,{pageIndex:t.chapterIndex,pageData:t.chapterData,pptMaster:t.pptMaster},function(t,a,o){n(i,t),n("activitys",a),n("auto",o),e(t)})}function bi(t,e){var i=t.parameter;if(i)try{i=JSON.parse(i),i&&(i.contentMode&&1==i.contentMode&&(No.debug.onlyDomMode||(e.canvasRelated.enable=!0)),i.lastPage&&"page"===e.pageType&&(e.runLastPageAction=function(){var t=Number(No.data.delayTime),e=void 0;return t&&(e=setTimeout(function(){Xut.Application.Notify("complete")},1e3*t)),function(){e&&(clearTimeout(e),e=null)}}))}catch(t){console.log("JSON错误,chpterId为",e.chapterId,i)}}function xi(t,e,i,n,a){e.taskCount++;var o=[],r=e.getStyle,s=void 0,c=void 0,l=void 0;if(i.ids.length){var u=i.zIndex,d="Content_"+e.chapterIndex+"_";i.ids=x(i.ids),_.each(i.ids,function(t){s=d+t,(c=e.contentsFragment[s])&&(l=u[t],o.push(c),delete e.contentsFragment[s])})}i.html.length&&(o=$(i.html.join(""))),l="page"===t&&0===r.offset?2001:2e3;var h="overflow:hidden;";"master"===t&&(h="");var p=void 0;if(n&&(p=n[t+"Container"]),!p){var f="float-"+t+"-li-"+e.chapterIndex;p=$(String.styleFormat('<ul id="'+f+'"\n         class="xut-float"\n         style="left:'+r.visualLeft+"px;\n                top:"+r.visualTop+"px;\n                "+Xut.style.transform+":"+r.translate+";\n                z-index:"+l+";"+h+'">\n       </ul>')),$(e.rootNode).after(p)}Br({container:p,content:o},function(){a(p)})}function wi(t,e){var i=e.imageLayer,n=(e.imageMask,e.backImage),a=e.backMask,o=e.master,r=e.md5,s=e.pptMaster;if(r&&!o&&!s&&!i&&!n)return t?String.styleFormat('<div data-multilayer ="true"class="multilayer"> '+t+" </div>"):"";Sl(e);var c="";o&&!s&&(c='<div class="multilayer-master" style="background-image:url('+tt(o,"multilayer-master")+')"></div>');var l="";if(i){var u=e.imageMask?Tl+":url("+tt(e.imageMask,"multilayer-maskLayer")+");":"",d=tt(i,"multilayer-maskImage");l='<div class="multilayer-imageLayer"\n            style="width:'+e.imageWidth+"px;\n                   height:"+e.imageHeight+"px;\n                   top:"+e.imageTop+"px;\n                   left:"+e.imageLeft+"px;\n                   background-image:url("+d+");"+u+'">\n       </div>'}var h="";if(n){var p=Cl(e.pageSide),f=p?p:"",v=p?"200%":"100%",g=tt(n,"multilayer-backImage"),m=tt(a,"multilayer-backMask")
;h=a?void 0!=Tl?'<div class="multilayer-backImage"\n                style="width:'+v+";\n                       background-image:url("+g+");\n                       "+Tl+":url("+m+");\n                       "+f+'">\n           </div>':'<canvas class="multilayer-backImage edges"\n                   height='+document.body.clientHeight+"\n                   width="+document.body.clientWidth+"\n                   src="+g+"\n                   mask="+m+'\n                   style="width:'+v+";\n                          opacity:0;\n                          "+Tl+":url("+g+");\n                          "+f+'">\n           </canvas>':'<div class="multilayer-backImage"\n                            style="width:'+v+";\n                                   background-image:url("+g+");\n                                   "+f+'">\n                       </div>'}var y=r?'<div class="multilayer-word"> '+t+" </div>":"";return String.styleFormat('<div data-multilayer ="true"\n          class="multilayer">\n        '+c+"\n        "+l+"\n        "+h+"\n        "+y+"\n    </div>")}function ki(t,e){for(var i=1,n=void 0,a=void 0,o=[],r={},s=void 0,c=void 0,l={};n=e.shift();)(a=t.contentsFragment[n.texteffectId])&&function(){var t=n._id;l[t]=new Xl(t),s=a.querySelectorAll("a[data-textfx]"),s.length&&s.forEach(function(e){c=e.parentNode,-1!=o.indexOf(c)?r[c.textFxId].push(e):(c.textFxId=i,r[i]=[],r[i++].push(e)),o.push(c),l[t].addQueue(e,e.getAttribute("data-textfx"))})}();return l}function _i(t,e){_.extend(e,{stopPropagation:!0,preventDefault:!1,bounce:!1,probeType:2});var i=new iScroll(t,e),n=!1;return i.on("beforeScrollStart",function(t){n=!1}),i.on("scroll",function(t){Xut.View.HasEnabledSwiper()&&(i.directionY===-1&&0===i.startY?(n=!0,Xut.View.SetSwiperMove({action:"flipMove",direction:"prev",distance:i.distY-10,speed:0})):1===i.directionY&&i.startY===i.maxScrollY?(n=!0,Xut.View.SetSwiperMove({action:"flipMove",direction:"next",distance:i.distY+10,speed:0})):i._execEvent("scrollContent",t))}),i.on("scrollEnd",function(t){if(n){var e=Xut.View.GetSwiperActionType(0,i.distY,i.endTime-i.startTime,"v");"flipOver"===e?1===i.directionY?(Xut.View.GotoNextSlide(),i._execEvent("scrollExit","down")):i.directionY===-1&&(Xut.View.GotoPrevSlide(),i._execEvent("scrollExit","up")):"flipRebound"===e&&(1===i.directionY?Xut.View.SetSwiperMove({action:"flipRebound",direction:"next",distance:0,speed:300}):i.directionY===-1&&Xut.View.SetSwiperMove({action:"flipRebound",direction:"prev",distance:0,speed:300}))}}),i}function Ii(t,e,i){return!i||"v"!==No.launch.scrollMode||e.scrollX&&!e.scrollY?new iScroll(t,e):new _i(t,e)}function Pi(t){var e=t[0],i=t[1],n=t[2],a='<div class="htmlbox_close_container">\n            <a class="htmlbox_close"></a>\n        </div>\n        <ul class="htmlbox_fontsizeUl">\n            <li>\n                <a class="htmlbox_small"\n                   style="width:'+e+"px;height:"+e+"px;margin-top:-"+e/2+'px"></a>\n            </li>\n            <li>\n                <a class="htmlbox_middle"\n                   style="width:'+i+"px;height:"+i+"px;margin-top:-"+i/2+'px"></a></li>\n            <li>\n                <a class="htmlbox_big"\n                   style="width:'+n+"px;height:"+n+"px;margin-top:-"+n/2+'px"></a>\n            </li>\n        </ul>';return String.styleFormat(a)}function Ti(t,e,i,n){var a='<div class="htmlbox-container">\n            <div class="htmlbox-toolbar" style="height:'+t+"px;line-height:"+t+'px;">'+e+'</div>\n            <div class="'+i+'" style="overflow:hidden;position:absolute;width:100%;height:92%;">\n                <ul>'+n+"</ul>\n            </div>\n        </div>";return String.styleFormat(a)}function Si(t){this.parent=t.parent,this.pageId=t.pageId,this.seasonId=t.seasonId,this.isStored=!1,this.init()}function Ci(t){this.parent=t.parent,this.tips=t.tips,this.init()}function $i(t,e){var i=1,n=void 0;"loop"==e.playerType&&(i="loop"),(n=Wl[t])?n.play(e.actList,i):console.log("error")}function Mi(t,e){var i=t.x-e.x,n=t.y-e.y;return Kl(Ql(i*i+n*n,.5))}function Xi(t,e){var i="";return t.y==e.y&&t.x>e.x?i="+x":t.y==e.y&&t.x<e.x?i="-x":t.x==e.x&&t.y>e.y?i="+y":t.x==e.x&&t.y<e.y?i="-y":t.x>e.x&&t.y<e.y?i="1":t.x>e.x&&t.y>e.y?i="2":t.x<e.x&&t.y>e.y?i="3":t.x<e.x&&t.y<e.y&&(i="4"),i}function Ni(t,e){if(t=t.toUpperCase(),Zl.test(t)){for(var i=new Array,n=1,a=1;a<=3;a++)t.length-2*a>3-a?(i.push(Number("0x"+t.substring(n,n+2))),n+=2):(i.push(Number("0x"+t.charAt(n)+t.charAt(n))),n+=1);return e&&e>0?"RGBA("+i.join(",")+","+e+")":"RGB("+i.join(",")+")"}return console.error("Hex Color string("+t+") format conversion error."),t}function Bi(t){var e,i,n;if(fu){e=0;try{i=fu.sheet,n=i.cssRules,e=n.length,i.insertRule(t,e)}catch(t){console.log(t)}}else fu=document.createElement("style"),fu.type="text/css",fu.innerHTML=t,fu.uuid="aaron",document.head.appendChild(fu)}function Di(t){if(fu){var e,i=fu.sheet,n=i.rules||i.cssRules,a=0,o=n.length;for(a;a<o;a++)if(e=n[a],e.name===t){i.deleteRule(a);break}0==n.length&&(document.head.removeChild(fu),fu=null)}}function Ai(t){var e=void 0,i=void 0,n=void 0,a=void 0,o=void 0,r=t.$contentNode.find(".sprite"),s=t.data,c=t.callback||function(){},l="sprite_"+t.id,u=s.thecount,d=s.fps,h=Math.round(1/d*u*10)/10,p=Math.ceil(s.scaleWidth*u),f=s.loop?"infinite":1;s.parameter&&(i=m(s.parameter))&&i.matrix&&(e=i.matrix.split("-")),n=function(t,i,n,a){var o;return e?(o="{0} {1}s step-start {2}",String.format(o,t,i,a)):(o="{0} {1}s steps({2}, end) {3}",String.format(o,t,i,n,a))}(l,h,u,f),a=function(t,i){if(e){var n=[],a=100/u,o=Number(e[0]);n.push("0% { background-position:0% 0%}");for(var r=0;r<u;r++){var s=Math.floor(r/o);i=100*(r-s*o);var c=100*s;i=0==i?i:"-"+i,c=0==c?c:"-"+c,n.push((r+1)*a+"% { background-position: "+i+"% "+c+"%}")}return t+"{"+n.join("")+"}"}return String.format("{0} {from { background-position:0 0; } to { background-position: -{1}px 0px}}",t,Math.round(i))}(l,p),function(t){pu&&r.css(pu,t).css(hu,"paused")}(n),function(t){uu&&Bi(uu+t)}(a),r.on(du,c);var v=function(){o&&(clearTimeout(o),o=null)};return{play:function(){o=setTimeout(function(){v(),r.css(hu,"running")},0)},stop:function(){v(),r.css(hu,"paused")},destroy:function(){Di(l),r.off(du,c),v(),r=null}}}function Ei(t){function e(){if(n)if(l>c.length/2-1){if(!(f>0))return;l=0,i()}else i();else if(l>h-1){if(!(f>0))return;l=0,i()}else i()}function i(){o=setTimeout(function(){n?(r=c[2*l],s=c[2*l+1],u.css("backgroundPositionX",r),u.css("backgroundPositionY",s)):(r=c[l],u.css("backgroundPositionX",r)),l++,e()},1e3/p)}var n=void 0,a=void 0,o=void 0,r=void 0,s=void 0,c=[],l=0,u=t.$contentNode.find(".sprite"),d=t.data,h=(t.callback,d.thecount),p=d.fps,f=d.loop,v=d.scaleWidth,g=d.scaleHeight;return d.parameter&&(a=m(d.parameter))&&a.matrix&&(n=a.matrix.split("-")),function(){if(n){for(var t=n[0],e=n[1],i=0;i<e;i++){s=-g*i+"px";for(var a=0;a<t;a++)r=-v*a+"px",c.push(r,s)}if(c.length/2>h)for(var o=c.length/2-h,l=2*o;l>0;l--)c.pop()}else for(var i=0;i<h;i++)r=-v*i+"px",c.push(r)}(),{play:function(){e()},stop:function(){clearTimeout(o)},destroy:function(){this.stop(),l=0,u=null,d=null,c=null}}}function Oi(t,e){var i=t.id,n=t.canvasMode,a=t.$contentNode,o=t.prepTag,r=t.prepVisible,s=t.prepScript;s&&(e.eventData.rewrite=!0,e.eventData.eventName="click",e.eventData.eventContentId=i);var c=void 0;if(o){try{b(o)()}catch(t){console.log("预处理截断执行脚本失败")}if(c=window.XXTAPI.PreCode){var l=e.getContextNode(e._findContentName(e.chapterIndex,i)),u=l.find("img");if(u.length){var d=void 0;_.isString(c)?d=c:_.isArray(c)&&(d=c[0]),u.replaceWith(String.styleFormat('<div class="inherit-size fullscreen-background fix-miaomiaoxue-img"\n                style="background-image:url('+u.attr("src")+');">\n              <a  data-id="'+i+'"\n                  data-page-id="'+e.pageId+'"\n                  data-type="hyperlink"\n                  href="'+d+'"\n                  class="inherit-size"\n                  style="display:block;"/>\n              </a>\n          </div>')),window.XXTAPI.PreCode=null,c[1]&&_.isFunction(c[1])?(e.eventData.eventContext=l.find("a"),e.eventData.rewrite=!0,e.eventData.eventName="tap",e.eventData.eventContentId=i):e.eventData.eventName=""}}}var h=function(){var t=e.relatedData.partContentRelated;if(t&&t.length&&-1!==t.indexOf(i));else{if(n)return void console.log("canvsa prepVisible");a&&!a.attr("data-iscroll")&&a.css("visibility")!=r&&a.css({visibility:r})}};return _.extend(t,{init:function(){r&&a.css({visibility:r})},play:function(t){if(r&&h(),c&&c[1])try{c[1]()}catch(t){console.log("快速处理脚本函数执行失败")}if(s)try{b(s)()}catch(t){console.log("快速处理执行脚本失败")}t&&t()},destroy:function(){c=null,a=null,o=null}})}function Hi(t){var e=t.$contentNode,i=t.action,n=t.property,a=t.pageIndex,o=t.targetProperty,r=void 0===o?{}:o,s=t.interaction,c=t.speed,l=void 0===c?0:c,u=t.pageOffset,d=void 0===u?0:u,h=t.opacityStart,p=void 0===h?0:h,f={},v={},g=0,m=0,y=0;if("init"===i){var b=n.special;b&&b[1]&&_.extend(n,b[1])}var x=void 0,w=void 0;if("master"===i){var k=r.special;k&&((x=k[a])||(w=k.lastProperty))}var I=d,P=void 0!==n.translateX,T=void 0!==n.translateY,S=void 0!==n.translateZ;P&&(g=Cu(n.translateX)||0,I+=g,v.translateX="translateX("+I+"px)"),T&&(m=Cu(n.translateY)||0,v.translateY="translateY("+m+"px)"),(P||T||S)&&(y=Cu(n.translateZ)||0,v.translateZ=Su(y)),void 0!==n.rotateX&&(v.rotateX="rotateX("+Cu(n.rotateX)+"deg)"),void 0!==n.rotateY&&(v.rotateY="rotateY("+Cu(n.rotateY)+"deg)"),void 0!==n.rotateZ&&(v.rotateZ="rotateZ("+Cu(n.rotateZ)+"deg)");var C=void 0!==n.scaleX,$=void 0!==n.scaleY,M=void 0!==n.scaleZ;C&&(g=Cu(100*n.scaleX)/100,v.scaleX="scaleX("+g+")"),$&&(m=Cu(100*n.scaleY)/100,v.scaleY="scaleY("+m+")"),M&&(y=Cu(100*n.scaleZ)/100,v.scaleZ="scaleZ("+y+")"),M||!C&&!$||(v.scaleZ="scaleZ(1)");var X=!1;if(void 0!==n.opacity&&("init"===i&&(f.opacity=Cu(100*(n.opacityStart+n.opacity))/100,X=!0),"master"===i&&(f.opacity=Cu(100*n.opacity)/100+p,X=!0)),v||X){if(v){w&&_.extend(v,w),f[Pu]=l+"ms";var N="";for(var B in v)N+=v[B];N&&(f[Tu]=N)}if(e&&(e.css(f),"flipOver"===s&&x))for(var D in x){var A=(x[D],v[D]);A&&(r.special.lastProperty[D]=A)}}return I}function Ri(t,e,i,n){var a={},o=-n.visualWidth,r=-n.visualHeight;for(var s in t)switch(i&&(i.special[s]=!0),s){case"special":a[s]={};for(var c in t[s]){var l=Ri(t[s][c],1,t);a[s][c]=l}break;case"scaleX":case"scaleY":case"scaleZ":a[s]=1+(t[s]-1)*e;break;case"translateX":case"translateZ":a[s]=t[s]*e*o;break;case"translateY":a[s]=t[s]*e*r;break;case"opacityStart":a[s]=t[s];break;default:a[s]=t[s]*e}return a}function Li(t){var e=t.nodes,i=t.isColumn,n=t.distance,a=t.pageIndex,o=(t.lastProperty,t.targetProperty),r={},s=o,c=void 0,l=void 0;o.special&&(c=o.special[a],l=o.special[a+1],c&&(s=_.extend({},o,c)));var u=i?No.screenSize:No.visualSize,d=u.width,h=u.height;for(var p in s)switch(p){case"scaleX":case"scaleY":case"scaleZ":if(c[p]){var f=-n/d;if(l[p]){var v=l[p]-c[p];v&&(r[p]=f*v)}}else r[p]=-1*n/d*(s[p]-1)*e;break;case"translateX":case"translateZ":r[p]=n*e*s[p];break;case"translateY":r[p]=n*(h/d)*e*s[p];break;case"opacityStart":r[p]=s.opacityStart;break;default:r[p]=-1*n/d*s[p]*e}return r}function Fi(t,e){var i={},n=t.opacityStart;for(var a in t)i[a]=t[a]+e[a];return n>-1&&(i.opacityStart=n),i}function Gi(){return Fi.apply(void 0,arguments)}function zi(t,e){var i={};for(var n in t)i[n]=e[n]||t[n];return i}function Wi(t,e){for(var i in t)e[i]=t[i]}function ji(t,e,i){var n=m(t.getParameter()[0].parameter);if(n){n=Mu(n);var a=t.chapterIndex,o=void 0,r=Nt()&&Xu(t.pageIndex);if(r){var s=Xut.Presentation.GetPageIndex();o=t.pageIndex==s||t.pageIndex>s?1:r}else{var c=e.pageOffset&&e.pageOffset.split("-");o=parseInt(c[0]),r=parseInt(c[1])}if(n.special){var l={},u=n.special;for(var d in u)for(var h in u[d])l[h]?l[h]<u[d][h]&&(l[h]=u[d][h]):l[h]=u[d][h];n.special.maxProperty=l,n.special.lastProperty={}}var p=(o-1)/(r-1)||0,f=Ri(n,p,"",i),v=1/(r-1),g=e.getTransformOffset(t.id),y=$u(t.$contentNode,f,g);return t.parallax={$contentNode:t.$contentNode,calculateRangePage:function(){return{start:a-o+1,end:r-o+a}},targetProperty:n,lastProperty:f,nodeRatio:v,parallaxOffset:y},t}}function Vi(t,e){var i=t.getParameter();if(i&&1===i.length){var n=t.contentData.category,a=i[0];if("EffectAppear"===a.animationName&&t.domMode&&"auto"===e&&!a.videoId&&!a.delay&&"Sprite"!==n&&"AutoCompSprite"!==n&&!/"inapp"/i.test(a.parameter)){if(!a.preCode&&!a.postCode)return t.prepVisible=/"exit":"False"/i.test(a.parameter)===!0?"visible":"hidden";if(a.preCode){if(-1!==a.preCode.indexOf("XXTAPI.PreCode"))return t.prepTag=a.preCode;if(["window.location.href","window.open"].forEach(function(e){if(-1!==a.preCode.indexOf(e))return t.prepScript=a.preCode}),t.prepScript)return t.prepScript}}}}function Yi(t,e){t&&t.dragDrop&&e(t.dragDrop)}function Ui(){return"autoRun-"+Math.random().toString(36).substring(2,15)}function qi(t,e,i,n){for(var a,o=e.$containsNode,r=e.eventRelated,s=e.chapterIndex,c=e.createActivitys,l=e.feedbackBehavior,u=e.pageBaseHooks,d=e.chapterId,h=n.master,p=function(t,e){return function(i){return t.length&&t[i]?e:0}}(h.ids,e.getStyle.offset),f={iscrollHooks:[],contentsHooks:u.contents,swipeDelegateContents:u.swipeDelegateContents},v={floatMasterDivertor:h,seasonId:e.chpaterData.seasonId,pageId:d,contentDataset:i,container:e.liRootNode,seasonRelated:e.seasonRelated,containerPrefix:e.containerPrefix,nodes:e.nodes,pageOffset:e.pageOffset,createContentIds:e.createContentIds,partContentRelated:e.partContentRelated,getTransformOffset:p,contentsFragment:e.contentsFragment,contentHtmlBoxIds:e.contentHtmlBoxIds},g=function(){r&&u.eventBinding&&u.eventBinding(r),delete f.contentsHooks,t(f)},m=[];a=c.shift();)m.push(function(t){return function(i){var n,a=t.imageIds,c=t.activity,h=c.eventType,p=c.para1,g=a;(n=r["eventContentId->"+a])&&_.each(n,function(t){t.eventType==c.eventType&&(h=p=void 0)}),u.cacheActivity(new Hu({noticeComplete:i,pageIndex:e.pageIndex,canvasRelated:e.canvasRelated,id:a||Ui(),type:"Content",pageId:d,getStyle:e.getStyle,activityId:c._id,$containsNode:o,pageType:t.pageType,dataset:t.dataset,chapterIndex:s,eventData:{eventContentId:g,eventType:h,dragdropPara:p,feedbackBehavior:l},relatedData:v,relatedCallback:f}))}}(a));!function t(){if(!m.length)return void g();m.shift()(function(){t()})}()}function Ki(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=Lu(e+4,i+8);return n.on("touchend mouseup",function(){t()}),n}function Qi(t,e){var i,n,a,o=t.width,r=t.height,s=e.width,c=e.height,l=!1,u=function(){i=s,a=o/s,(n=r/a)>c&&(l=!0,a=n/c,i/=a,n=c)};return o>r?u():c>s?u():function(){n=c,a=r/c,i=o/a,l=!0,i>s&&(l=!1,a=i/s,i=s,n/=a)}(),{width:i,height:n,left:(s-i)/2-e.left,top:(c-n)/2,checksource:l}}function Zi(t){var e=void 0,i=No.visualSize,n=i.overflowWidth&&Math.abs(i.right)||0,a=i.overflowHeight&&Math.abs(i.top)||0,o=n+4,r=a+4,s='<img class="xut-zoom-fly"\n                      src="'+t.originSrc+'"\n                      style="width:'+t.width+"px;\n                             height:"+t.height+"px;\n                             top:"+t.top+"px;\n                             left:"+t.left+'px;" />';return e=No.screenHorizontal?'<div class="xut-zoom-view">\n                <div class="xut-zoom-overlay"></div>\n                <div class="xut-zoom-close" style="right:'+o+"px;top:"+r+'px;">\n                    <div class="si-icon Flaticon flaticon-error" style="font-size:5vw;border-radius:50%;right:0">\n                    </div>\n                </div>\n                '+s+"\n            </div>":'<div class="xut-zoom-view">\n                <div class="xut-zoom-overlay"></div>\n                <div class="xut-zoom-close" style=";right:'+o+"px;top:"+r+'px;">\n                    <div class="si-icon Flaticon flaticon-error" style="font-size:5vh;border-radius:50%;right:0">\n                    </div>\n                </div>\n                '+s+"\n            </div>",String.styleFormat(e)}function Ji(t,e){e<=0&&(e=1);for(var i=0,n=t.length;i<n;++i){var a=t[i];if(e>a.width)return a}}function tn(t){var e=t.element,i=t.style,n=t.speed,a=void 0===n?100:n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e&&setTimeout(function(){e.stop().transition(i,a,"linear",o)},0)}function en(t){var e=t.sources,i=Ji(e,t.wrapper.width),n=Qi(t.image,t.wrapper);if(i.pos,!1){n.left=t.wrapper.width/2-n.width/2,n.top=t.wrapper.height/2-n.height/2}return{source:i,position:n}}function nn(){return'<div class="icon-maximize"style="font-size:'+(No.screenSize.width>No.screenSize.height?"2vw":"2vh")+';position:absolute;right:0;"></div>'}function an(t){var e={};return _.each(t.contentsFragment,function(i){var n=void 0;if(n=t.zoomBehavior[i.id]){n.prompt&&$(i).append(nn());var a=!1;T(i,{start:function(){a=!1},move:function(){a=!0},end:function(){if(!a){var t=$(i),n=t.find("img");if(n.length){var o=n[0].src;if(e[o])return e[o].play();var r=K(o);e[o]=new ju({element:n,originalSrc:tt(r.suffix,"pagebase-zoom"),hdSrc:Z(r.original)})}}}}),n.off=function(){S(i),i=null}}}),e}function on(t){return Vu[t.category]?"JsWidget":t.actType}function rn(t,e,i){var n=Object.keys(i);if(1!==n.length||!~n.indexOf("Animation")){var a=e.imageId,o=function(){t.seasonRelated[a]||(t.seasonRelated[a]={})};Yu.forEach(function(e){var n=i[e],r=void 0;if(void 0!==n)switch(o(),e){case"seasonId":r=i.chapterId||i.chapter,t.seasonRelated[a]={seasonId:n[0],chapterId:r?r[0]:""};break;case"Inapp":t.seasonRelated[a].Inapp=n[0];break;default:t.seasonRelated[a][e]=a}})}}function sn(t,e){var i=void 0,n=void 0,a=void 0,o=void 0,r={},s=[],c=[],l=Xut.data.query;_.each(e,function(e){(a=l(t,e))&&(o=a.contentId,-1===c.indexOf(o)&&c.push(o),n="contentId-"+o,r[n]?r[n].push(a):r[n]=[a])});for(i in r)s.push(r[i]);return{dataset:s,idset:c}}function cn(t,e){var i=void 0,n={};return _.each(t,function(t){(i=e[t])&&(n[t]?bo("未处理解析同一个表"):n[t]=sn(t,i))}),n}function ln(t){if(t){var e=void 0,i={};return t=m(t),t.length?_.each(t,function(t){e=t.actType,i[e]||(i[e]=[]),i[e].push(t.id)}):(e=t.actType,i[e]=[t.id||t.value]),i}}function un(t,e,i,n){function a(t){if(t&&l){var e=t.indexOf(l);-1!==e&&t.splice(e,1)}}var o,r,s,c="",l=e.imageId,u=ln(e.itemArray)||[],d=t(u);switch(Object.keys(d)[0]){case"Container":o=d.Container,a(o);break;case"Contents":return d.Contents;default:if(_.keys(d).length){var h=d.Animation,p=d.Parallax;"page"===i?h&&(o=h.idset,c=h.dataset):(h&&(o=h.idset,c=h.dataset),p&&(r=p.idset,s=p.dataset)),o&&r&&(o=o.concat(r)),!o&&r&&(o=r),a(o)}}return{pageType:i,activity:e,imageIds:l,dataset:{animation:c,parallax:s},idset:{content:o,parallax:r}}}function dn(t,e,i){function n(t,e,i){for(var n,a=e.length;a--;)n=Number(e[a]),t.push(n),i&&i(n)}for(var a,o,r,s,c,l,u=[],d=[],h=t.length;h--;)c=t[h],a=c.idset,o=a.content,l=a.parallax,s=c.imageIds,o&&o.length&&n(u,o),l&&l.length&&n(u,l),s&&d.push(Number(s));return e&&e.length&&_.each(e,function(t){t&&(u=u.concat(t))}),r=x(d.length?u.concat(d):u),r=r.sort(function(t,e){return t-e}),[d,r]}function hn(t,e){for(var i=void 0,n=void 0,a=(t.length,e.pageType),o=e.chapterIndex,r=[],s=[],c={seasonRelated:{},containerRelated:[],eventRelated:{},partContentRelated:[]},l=function(t){return un(function(e){return t(e)},i,a,o)},u={Container:function(){c.containerRelated.push(l(function(t){return{Container:t.Content}}))},Contents:function(){var t;if(t=l(function(t){return{Contents:[t]}})[0]){var e=i.imageId,n={eventContentId:e,activityId:i._id,registers:t.activity,eventType:i.eventType,dragdropPara:i.para1},a=c.eventRelated["eventContentId->"+e];a?a.push(n):c.eventRelated["eventContentId->"+e]=[n]}},JsWidget:function(){var t=m(i.itemArray);_.isArray(t)?_.each(t,function(t){c.partContentRelated.push(t.id)}):c.partContentRelated.push(t.id)}};i=t.shift();)if(n=on(i),!u[n]||u[n]&&u[n](c)){var d=l(function(t){return rn(c,i,t),"page"===a?cn(["Animation"],t):"master"===a?cn(["Animation","Parallax"],t):void 0});i.imageId?s.push(d):r.push(d)}s.length&&(r=r.concat(s),s=null);var h=dn(r,c.partContentRelated,a),p=h[0],f=h[1];if(Xut.CreateFilter.size()){var v=Xut.CreateFilter.each(e.chapterId);v&&(v(p,function(t){p.splice(t,1)}),v(f,function(t){f.splice(t,1)}),v=null)}return _.extend(e,c,{createEventIds:p,createContentIds:f,createActivitys:r})}function pn(t){var e=void 0,i=void 0,n=void 0,a=void 0,o=t.feedbackBehavior={},r=t.zoomBehavior={},s=void 0,c=t.chapterIndex,l=void 0,u=void 0;_.each(t.activitys,function(t){t.parameter&&(e=m(t.parameter))&&(n=t.imageId,(a=e.isButton)&&0!=a&&it(o,n,function(){this.isButton=!0}),(i=e.behaviorSound)&&0!=i&&it(o,n,function(){this.behaviorSound=i}),(s=e.zoom)&&s.length&&_.each(s,function(t){(u=t.content)&&(l="Content_"+c+"_"+u,it(r,l,function(){this.prompt=!!t.prompt}))}))})}function fn(t){var e=void 0,i=[];return _.each(t.activitys,function(t){if(e=t.actType||t.animation,!e&&t.note&&(t.actType=e="ShowNote"),t.itemArray||2!==t.autoPlay)switch(e){case"Container":case"Content":case"Parallax":case"Contents":i.push(t)}}),i}function vn(t,e){var i="";return i+=ed(t,e),i+=td(t,e),i+="</div></div>"}function gn(t,e){var i="";if(t.category){var n=t.category.split(","),a=n.length;if(a)for(;a--;)i+=n[a]}return String.format('<canvas id="{0}" data-ctype={1} width="{2}" height="{3}"></canvas>',e.makeId("canvas"),i.toLocaleLowerCase(),t.scaleWidth,t.scaleHeight)}function mn(t,e){var i,n=[];return t.forEach(function(t,a){i=Xut.data.query("Content",t),n.unshift(i),e&&e(i,t)}),n}function yn(t,e,i){var n,a,o,r={createUUID:[],containerName:[]};return t.forEach(function(t,s){a=t.imageIds,o="Container_"+e+"_"+a,n="aaron"+Math.random(),r[n]={start:[id(o,a,e,i)],end:"</div>"},r.createUUID.push(n),r.containerName.push(o),t.itemIds.forEach(function(t){r[t]=n})}),r}function bn(t,e){var i,n=e.data,a=t.split(","),o=a.length,r=0,s=a.indexOf("PPT");if(0==s&&(a=a.concat(a.splice(s,1))),o)for(var r=0;r<o;r++)i=a[r],ad[i]&&ad[i](e,n)}function xn(t,e,i,n){if(Xut.config.debug.onlyDomMode){if(e){var a=e.split(","),o=a.length;if(o>1){var r=a.indexOf("PPT");-1!=r&&a.splice(r,1)}i.category=a[0]}}else{i.actionTypes={};var s={contentId:t,conData:i,data:n};e&&bn(e,s)}}function wn(t,e,i){function n(t,i,n){_.each(t,function(t){t.filter&&t.filter.length&&(n.filterNames=m(t.filter)),t.trackCode&&(n.trackCode=!0),t.fixedPosition&&(n.fixedPosition=Number(t.fixedPosition)),t.qrCode&&(n.qrCode=!0),t.HeaderOrFooter&&(S[i]&&bo("页眉页脚对象重复设置,contentId:"+i),S[i]=Number(t.HeaderOrFooter)),t.fixRadio&&(n.fixRadio=!0);var a=t.topmost;a&&0!=a&&(x?(e.master.ids.push(i),e.master.zIndex[i]=a):(e.page.ids.push(i),e.page.zIndex[i]=a))})}function a(i,a){var o=void 0;if(x&&(o=b[a])&&o.BookMarks&&e.master.ids.push(a),i){i.category&&xn(a,i.category,i,t);var r=void 0;(r=i.parameter&&m(i.parameter))&&n(r.length?r:[r],a,i)}}function o(t,e){sd(e,function(e){var i=void 0,n=void 0,a=void 0,o=e.contentData;rd(e,o),a=o.canvasMode?gn(o,e):vn(o,e),u&&(i=u[t])?(n=u[i],n.start.push(a)):T.unshift(a),r()})}function r(){if(1===f){var t={contentDataset:P,idFix:k,textFx:I,contentHtmlBoxIds:w,headerFooterMode:S,containerPrefix:""};if(u){var e,n,a,o;o=[],u.createUUID.forEach(function(t){e=u[t].start.join(""),n=u[t].end,o.push(e.concat(n))}),o=o.join(""),a=u.containerName,u=null,t.contentStr=T.join("").concat(o),t.containerPrefix=a}else t.contentStr=T.join("");i(t)}f--}var s=void 0,c=void 0,l=void 0,u=void 0,d=void 0,h=void 0,p=void 0,f=void 0,v=t.chapterIndex,g=t.pageType,y=t.containerRelated,b=t.seasonRelated,x="master"===g,w=[],k=[],I=[],P={},T=[],S={},C=t.getStyle;for(y&&y.length&&(u=yn(y,v,C)),h=mn(t.createContentIds,a),p=f=h.length,t.canvasRelated.onlyCompSprite&&(t.canvasRelated.enable=!0);p--;)if(s=h[p]){c=s._id,l=od(c,s,g,v),k.push(l.containerName),s.texteffect&&s.texteffect.trim()&&(s.texteffectId=l.containerName,I.push(s)),l.isJs&&w.push(c);var $=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.pageProportion;d=st({results:l.contentData,getStyle:C,proportion:t,zoomMode:cd(s.fixRadio,S[c])})};$();var M=function(t){var e={};return _.each(C.pageProportion,function(i,n){e[n]=i*t}),e};if(s.fixedPosition&&3===C.pageVisualMode){var X=d.scaleTop,N=d.scaleHeight,B=C.visualLeftInteger,D=d.scaleWidth+d.scaleLeft,A="";B>d.scaleLeft&&(A="left");var E=C.visualWidth-B;if(D>E&&(A="left"===A?"all":"right"),"left"===A){var O=(d.scaleWidth-B)/d.scaleWidth;$(M(O));var H=(D-d.scaleWidth-B)/2;d.scaleLeft=B+H,d.scaleTop=X+(N-d.scaleHeight)/2}else if("right"===A){var R=E/D;$(M(R)),d.scaleTop=X+(N-d.scaleHeight)/2}else if("all"===A){var L=No.screenSize.width/d.scaleWidth;$(M(L)),d.scaleLeft=B,d.scaleTop=X+(N-d.scaleHeight)/2}}d.isHide&&S[c]&&(S[c]="hide"),function(t,e,i){P[i]=e,o(i,t)}(l,s,c)}else r()}function kn(t){var e={};return _.each($(t),function(t,i){e[t.id]=t}),e}function _n(t,e){var i=[],n=[];return _.each(t,function(t,a){var o=a.split("_").pop(),r=void 0;e&&(r=e[o])?"hide"!==r&&n.push(t):i.push(t)}),{bodyContent:i,headerFooterContent:n}}function In(t,e){if(1===arguments.length&&_.isFunction(t)?(e=t,t=Xut.Presentation.GetPageBase&&Xut.Presentation.GetPageBase()):t=t||Xut.Presentation.GetPageBase&&Xut.Presentation.GetPageBase(),t){var i=t.baseGetContent(),n=t.baseGetComponent(),a=t.pageType||"page";return e(t,i.length&&i,n.length&&n,a)}}function Pn(){dd.length=0,hd&&(clearTimeout(hd),hd=null)}function Tn(t){for(var e=0;e<t.length;e++){var i=t[e];i&&i()}t.length=0}function Sn(t,e){dd.push(e),hd||(hd=setTimeout(function(){Tn(dd),Pn()},500))}function Cn(){Pn()}function $n(){Cn()}function Mn(t,e,i){if(!Xut.IBooks.compileMode())return ud()?void In(t,function(t,n,a,o){if("master"===t.pageType){if(t.onceMaster)return;t.onceMaster=!0}i=i||pd;var r=t.baseAutoRun();r&&Sn("component",function(){vd(t,e,r,o)}),n?Sn("content",function(){fd(n,i)}):i()}):void i()}function Xn(t,e){var i=t.target,n=(t.attribute,t.rootNode),a=t.pageIndex,o=void 0,r=void 0,s=i.id;if(e)r=e.type,o=e.id;else if(s){var c=s.split("_");r=c[0],o=c[1]}if(r&&o){var l=Od[r];if(l&&l.trigger){var u=n&&n.id?/page/.test(n.id)?"page":"master":"page",d={id:o,key:s,type:r,rootNode:n,target:i,pageIndex:a,pageType:u,activityId:o,columnData:e};No.sendTrackCode("hot",{id:o,type:r,pageId:Xut.Presentation.GetPageId(u,a),eventName:"tap"});var h=Xut.Application.GetExistObject(u,d);if(h&&h.toggle)return h.toggle();l.trigger(d)}}}function Nn(t,e,i){In(t,function(t,n){$n(),void 0!==e&&(Ve(e),"master"===t.pageType&&Re()),n&&_.each(n,function(t){t.stop&&t.stop()}),i&&(Ye(),Le())})}function Bn(t){In(t,function(t,e,i){if("master"!==t.pageType){var n;(n=t.getContainsNode())&&(gd(function(){n.hide()}),e&&_.each(e,function(t){Xut.CreateFilter.has(t.pageId,t.id)||t.reset&&t.reset()}),i&&(_.each(i,function(t){t&&t.destroy()}),t.baseRemoveComponent()),gd(function(){setTimeout(function(){n.show(),n=null},0)}))}})}function Dn(){return Le(),Ye(),In(function(t,e,i){var n=!1;return e&&_.each(e,function(t){t.stop&&t.stop()&&(n=!0)}),i&&_.each(i,function(t){t.stop&&t.stop()&&(n=!0)}),n})}function An(t){var e=parseInt(t.id),i=Xut.data.query("Action",e,"activityId"),n=i.para1;0==parseInt(i.actionType)&&md(n)}function En(t,e){return No.getWidgetPath()+e+"/"+t}function On(){kd={}}function Hn(t,e){var i,n,a,o=e.widgetId,r=e.widgetName+".min.js",s="page"==e.widgetType||"js"==e.widgetType?"style.min.css":0,a=function(){var i=0;return r&&i++,s&&i++,function(){if(1===i)return t&&t.call(e);i--}}();s&&(n=En(s,o),_d(n,a)),r&&(i=En(r,o),_d(i,a))}function Rn(t,e,i){var n,a,o=[],r=Xut.data.Image,s=null,c=t.source;for(n in c)c.hasOwnProperty(n)&&(a={},s=r.item((parseInt(c[n])||1)-1),a.img=s.md5,a.thumb="",a.title=s.imageTitle,o.push(a));return t.source=o,t.scrollPaintingMode=e,t.calculate=i,t.rootPath=Xut.config.getWidgetPath(),t}function Ln(t){var e=[void 0],i=e[0],n=e[1],a=e[2],o=[],r=Xut.data.Image,s=t.source;for(i in s)s.hasOwnProperty(i)&&(n={},a=r.item((parseInt(s[i])||1)-1),n.img="../gallery/"+a.md5,n.thumb="",n.title=a.imageTitle,o.push(n));return t.source=o,t}function Fn(t){var e=Xd(_.extend({},t));e.id=e.activityId,e.inputPara=Bd(e),"page"===e.widgetType&&(e.inputPara.container=e.rootNode);var i=Xut.Presentation.GetPageStyle(t.pageIndex),n={width:i.visualWidth,height:i.visualHeight,left:i.visualLeft,top:i.visualTop};e.pageProportion=i.pageProportion,e=Nd(e,i),e.inputPara.uuid=No.data.appId+"-"+e.activityId,e.inputPara.id=e.activityId,e.inputPara.screenSize=n,e.inputPara.contentPrefix=Xut.Presentation.GetContentPrefix(e.pageIndex,e.pageType),e.scrollPaintingMode=4===No.launch.visualMode,e.calculate=n,Md[(e.widgetType||"widget").toLowerCase()](e)}function Gn(t,e){var i=void 0;if("v"===No.launch.scrollMode){var n=No.visualSize.height;i=Yd("prevEffect"===e?-n:n)}else{var a=No.visualSize.width;i=Yd("prevEffect"===e?-a:a)}t.css(Xut.style.transform,i)}function zn(t){return No.launch.doublePageMode?nh(t):ih(t)}function Wn(t,e,i){var n,a,o,r,s,c=0,l=[],u=[];for(n=0===t?[t,t+1]:t===i-1?[t-1,t]:[t-1,t,t+1],a=0===e?[e,e+1]:e===i-1?[e-1,e]:[e-1,e,e+1];c<a.length;c++)o=a[c],-1===n.indexOf(o)?u.push(o):l.push(o);return _.each(l,function(t){n.splice(n.indexOf(t),1)}),r=n,s=[].concat(u).concat(l).sort(function(t,e){return t-e}),{create:u,ruleOut:l,destroy:r,viewFlip:s,targetIndex:e,visualIndex:t}}function jn(t,e){var i={};return 0===t?(i.middleIndex=t,i.backIndex=t+1):t===e-1?(i.middleIndex=t,i.frontIndex=t-1):(i.frontIndex=t-1,i.middleIndex=t,i.backIndex=t+1),i}function Vn(t,e,i){var n=void 0,a=void 0;switch(t){case"prev":n=e-1,a=i;break;case"next":n=i+1,a=e}return{createIndex:n,destroyIndex:a}}function Yn(t,e){if(!t.button||2!=t.button){var i=e.getAttribute("data-type"),n=!1;"hyperlink"===i&&(n=!0,No.sendTrackCode("hot",{id:e.getAttribute("data-id"),pageId:e.getAttribute("data-page-id"),type:"hyperlink",eventName:"tap"}));var a=e.nodeName.toLowerCase();if(No.launch.supportQR&&Xut.plat.hasTouch&&"img"===a&&"qrcode"===i)return"qrcode";!Xut.plat.isBrowser||Xut.IBooks.Enabled||window.MMXCONFIG||window.DUKUCONFIG||"a"===a||"video"===a||n||t.preventDefault&&t.preventDefault()}}function Un(t,e){var i,n,a,o,r=t.target;if(r.nodeType){if(r===this)return{rootNode:this,elem:r,handlers:uh["data-container"]};try{for(;r!==this;r=r.parentNode||this){if(r.nodeName&&"canvas"===r.nodeName.toLowerCase())return!!Xut.Contents.Canvas.getSupportState();a=r.attributes;for(i in uh)if(n=a[i])return o=n.value,{rootNode:this,elem:r,attribute:o,pageType:e,handlers:uh[i]}}}catch(t){}}}function qn(t,e,i){if(t){var n=t.getAttribute("data-type"),a=void 0;"poster"!==n||o||(a=t,t=t.parentNode);var o=t.getAttribute("id"),r=o&&o.match(/(Audio|Video)_(\w+)/);if(r){var s=t.getAttribute("data-name");if(s){var c=r[1],l=r[2];s&&Xn({target:t,pageIndex:i},{id:l,type:c,startImage:t.getAttribute("data-startImage"),stopImage:t.getAttribute("data-stopImage"),container:a||t,track:8888,chapterId:"column",isColumn:!0,fileName:s})}else console.log("column中的媒体文件不存在")}}}function Kn(t){return{taskHangFn:null,tasksTimer:0,isTaskSuspend:!1,isPreCreateBackground:!1,assignTaskGroup:null,nextTaskName:"",preforkComplete:fh,createTasksComplete:fh}}function Qn(t){var e=t.threadTaskRelated=Kn(t);e.assignTaskGroup=gh(ph),e.nextTaskName="container";var i=function(t){e.nextTaskName=t},n=function(e,i){return ph[e](i,t)};t.threadtasks={container:function(){n("assign-container",function(n,a){t.$pageNode=n,t.$pseudoElement=a;var o=n.find(".page-scale > div:first-child");t.getContainsNode=function(){return a?a:o},t.getHeadFootNode=function(){return n.find(".page-scale > div:last-child")},t.getScaleNode=function(){return a?a:n.find(".page-scale")},i("background"),e.preforkComplete(),t.isMaster&&t.detectorTask({taskName:"外部Background",nextTask:function(){t.dispatchTasks()}})})},background:function(){n("assign-background",function(){e.isPreCreateBackground=!1,i("column"),e.taskHangFn&&!t.isMaster||t.detectorTask({taskName:"外部widgets",nextTask:function(){t.dispatchTasks()}}),e.taskHangFn&&e.taskHangFn()})},column:function(){var a="page"===t.pageType;a&&t.hasColumnData?n("assign-column",function(){i("complete"),e.createTasksComplete()}):(!function(){var e=No.launch.salePageType
;!a||"page"!==e&&"all"!==e||(t._pageScaleObj=vh(t.getScaleNode(),t.pageIndex))}(),i("component"),t.dispatchTasks())},component:function(){n("assign-component",function(){i("activity"),t.detectorTask({taskName:"外部contents",nextTask:function(){t.dispatchTasks()}})})},activity:function(){n("assgin-activity",function(){i("complete"),e.createTasksComplete()})}}}function Zn(t,e){if(e.launch.columnCheck){var i=t.columnGroup.get();i&&i.length&&(t.unWatchDep||(t.unWatchDep=[]),i.forEach(function(e){var i=Xut.Application.Watch("change:column",function(){e.resetColumnDep()});t.unWatchDep.push(function(){return Xut.Application.unWatch("change:column",i)})}))}}function Jn(t){t.unWatchDep&&(t.unWatchDep.forEach(function(t){t()}),t.unWatchDep=null)}function ta(t){var e,i,n=document.getElementsByTagName("canvas"),a=new Array,o=0,r=0;for(o=0;o<n.length;o++){e=n[o],i=e.className.split(" ");for(var r=0;r<i.length;r++)if(i[r]==t){a.push(e);break}}return a}function ea(t){function e(){r.clearRect(0,0,t.width,t.height),r.globalCompositeOperation="source-over",r.drawImage(n,0,0,t.width,t.height),a.src=t.getAttribute("mask"),n.removeEventListener("load",e),n.src=null,n=null}function i(){r.globalCompositeOperation="destination-atop",r.drawImage(a,0,0,t.width,t.height),t.style.opacity=1,a.removeEventListener("load",i),a.src=null,a=null,r=null,o=null,t.className=t.className.replace("edges","")}var n=new Image,a=new Image,o=t.className.split(" "),r=t.getContext("2d");n.addEventListener("load",e),a.addEventListener("load",i),n.src=t.getAttribute("src")}function ia(){var t,e=ta("edges");for(t=0;t<e.length;t++)ea(e[t])}function na(t,e){var i="v"===No.launch.scrollMode,n=void 0;return t<e?n=i?"top":"left":t>e?n=i?"bottom":"right":e==t&&(n="middle"),n}function aa(t,e,i){if(t.hasMultiScene){var n=t.sectionRang;if(!i&&_.isArray(e))return wh(e,n.start);e-=n.start,i+=n.start}else if(_.isArray(e))return e;return{pageIndex:e,visualChapterIndex:i}}function oa(t,e,i){function n(t){void 0!==t.frontIndex&&(a.frontIndex=t.frontIndex,o.push(t.frontIndex)),void 0!==t.middleIndex&&(a.middleIndex=t.middleIndex,o.push(t.middleIndex)),void 0!==t.backIndex&&(a.backIndex=t.backIndex,o.push(t.backIndex))}var a={},o=[];return n(1!==e&&i?0===t?{middleIndex:t,backIndex:t+1}:t===e-1?{middleIndex:t,frontIndex:t-1}:{middleIndex:t,frontIndex:t-1,backIndex:t+1}:{middleIndex:t}),{createPointer:o,initPointer:a}}function ra(t,e){var i={},n=0;if(void 0==t)return i;if(No.launch.doublePageMode){var a=void 0,o=void 0,r=void 0;t.length||(t=[t]),t.forEach(function(t){0===t?(i[t]=[0,1],n+=2):(a=2*t,o=a,r=a+1,n+=2,(i[t]=[]).push(o,r))})}return e?(i.total=n,i):i[t[0]]}function sa(t,e){if(void 0===t)return[];if(No.launch.doublePageMode){var i=ra(t);if(i.length)return i}return[t]}function ca(t,e,i,n){var a=_.extend([],e);if(a[0]!==n){var o=a.indexOf(n),r=a.splice(o,1);a=r.concat(a)}if(i.total){var s=[];a.forEach(function(t){var e=i[t];e.length&&(s.push(e[0]),e[1]&&s.push(e[1]))}),a=s}if(t.hasMultiScene){var c=t.sectionRang.start;a.forEach(function(t,e){a.splice(e,1,t+c)})}return a}function la(t){return mi("chapter",t)}function ua(){return!(-1!==kt().indexOf("Master")||!Xut.data.Master||!Xut.data.Master.length)}function da(t,e,i){Th(t,e.visualIndex),Sh(t,e,function(e){Ch(t,e),i.call(t,e)})}function ha(t){var e=t.pageVisualMode,i=(t.direction,t.doubleMainIndex),n=t.doublePosition,a=(t.visualChapterIndex,No.visualSize),o=!1;if((e&&e!==No.launch.visualMode||3===e)&&(a=c(e),o=!0),n&&void 0!==i){var r=ra(i);a.left="left"===n?r[0]*a.width:r[1]*a.width}return{visualWidth:a.width,visualHeight:a.height,visualTop:a.top,visualLeft:a.left,visualLeftInteger:Math.abs(a.left),hasRecalculate:o}}function pa(t){return t.hasRecalculate?l({width:t.visualWidth,height:t.visualHeight,top:t.visualTop,left:t.visualLeft}):No.proportion}function fa(t){var e=t.getPageStyle("middle","left"),i=t.getPageStyle("left");return e&&e.visualLeftInteger?i&&i.visualLeftInteger?-e.visualWidth:-(e.visualWidth-e.visualLeftInteger):i&&i.visualLeftInteger?-(i.visualWidth-i.visualLeftInteger):-i.visualWidth}function va(t){var e=t.getPageStyle("middle","right"),i=t.getPageStyle("right");return 5===i.pageVisualMode?i.visualWidth/2:e&&e.visualLeftInteger?i&&i.visualLeftInteger?i.visualWidth-i.visualLeftInteger:i.visualWidth+e.visualLeftInteger:i&&i.visualLeftInteger?i.visualWidth-i.visualLeftInteger:i.visualWidth+i.visualLeftInteger}function ga(t){return-t.getPageStyle("top").visualHeight}function ma(t){return t.getPageStyle("bottom").visualHeight}function ya(t,e){return Mh[t](e)}function ba(t){var e=t.position,i=t.styleDataset,n=void 0,a=void 0;switch(e){case"left":case"right":a=ya(e,i),n=Xh(a);break;case"top":case"bottom":a=ya(e,i),n=Xh(0,a);break;case"middle":n=Xh(),a=0}return{translate:n,offset:a}}function xa(t){return _.each(t,function(e,i){_.extend(e,ha(e)),e.pageProportion=pa(e),t["_"+e.position]||(t["_"+e.position]=[]),t["_"+e.position].push(e.chapterIndex)}),No.launch.doublePageMode||(t.getPageStyle=function(t,e){if(!this[this["_"+t]]&&"middle"===t){var i=this.getPageStyle(e);if("left"===e)return Nh(i.chapterIndex+1);if("right"===e)return Nh(i.chapterIndex-1)}return this[this["_"+t]]},_.each(t,function(e,i){e.position&&_.extend(e,ba({styleDataset:t,position:e.position}))})),t}function wa(t){if(1===No.launch.visualMode&&No.verticalToHorizontalVisual)return 1;if("flow"===t.note)return 1;var e=t.parameter;if(e){var i=e.match(/visualMode[":\s]*(\d)/);if(i)return Number(i[1])}return No.launch.visualMode||1}function ka(t,e){Xut.Presentation.GetPageIndex=function(){return e.getVisualIndex()},_.each(["GetPageId","GetPageNode","GetPageData","GetPageBase"],function(i){Xut.Presentation[i]=function(n,a){return t(function(t,n,a){return void 0===a&&(a=e.getVisualIndex()),t["$$"+i](a,n)},n,a)}}),_.each(["Section","Page"],function(t){Xut.Presentation["GetApp"+t+"Data"]=function(e){var i=0,n=[],a=Xut.data.query("app"+t),o=a.length;for(i;i<o;i++)n.push(a.item(i));return n}}),Xut.Presentation.GetFloatContainer=function(t){var e=Xut.Presentation.GetPageBase(t),i="page"===t?"pageContainer":"masterContainer";if(e.floatGroup[i].length)return e.floatGroup[i];bo(t+",浮动根节点没有找到")},Xut.Presentation.GetFirstPageId=function(t){var e=Xut.data.query("sectionRelated",t);return Xut.data.query("appPage").item(e.start)},Xut.Presentation.GetPageElement=function(){return Xut.Presentation.GetPageBase().$pageNode},Xut.Presentation.GetPageStyle=function(t){var e=Xut.Presentation.GetPageBase(t);if(e&&e.getStyle)return e.getStyle;bo("页面Style配置文件获取失败,pageIndex:"+t)},Xut.Presentation.GetPagePrefix=function(t,e){return Xut.Presentation.GetPageBase(t,e).chapterIndex},Xut.Presentation.GetContentPrefix=function(t){return Ah+Xut.Presentation.GetPagePrefix(t)+"_"},Xut.Presentation.GetContentName=function(t){return t?Ah+Xut.Presentation.GetPagePrefix()+"_"+t:Ah+Xut.Presentation.GetPagePrefix()}}function _a(t,e,i){var n=t.options;Xut.View.GetPageNodeIdName=function(t,e,i){return t+"-"+(e+1)+"-"+i},Xut.View.UpdatePage=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.$$emit.apply(t,["change:updatePage"].concat(i))},Xut.View.ShowPrevBar=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.$$emit.apply(t,["change:showPrev"].concat(i))},Xut.View.HidePrevBar=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.$$emit.apply(t,["change:hidePrev"].concat(i))},Xut.View.ShowNextBar=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.$$emit.apply(t,["change:showNext"].concat(i))},Xut.View.HideNextBar=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.$$emit.apply(t,["change:hideNext"].concat(i))},Xut.View.ToggleToolbar=function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];t.$$emit.apply(t,["change:toggleToolbar"].concat(i))},Xut.View.ShowToolBar=function(t){Xut.View.ToggleToolbar("show",t)},Xut.View.HideToolBar=function(t){Xut.View.ToggleToolbar("hide",t)},Xut.View.ResetToolbar=function(){t.$$emit("change:resetToolbar")},Xut.View.Toolbar=function(t){Xut.View.ToggleToolbar(t)};var a=function(t,e){var a=void 0,o=void 0,r=void 0,s=void 0;if(t&&(_.isFunction(t)?r=t:(a=t.seasonId,o=t.chapterId,r=t.callback,s=t.speed)),a&&o)return void Xut.View.LoadScenario({seasonId:a,chapterId:o},r);if(Xut.IBooks.Enabled&&Xut.IBooks.runMode()){var c="prev"===e?Xut.IBooks.pageIndex-1:Xut.IBooks.pageIndex+1;return location.href=c+".xhtml",void(r&&r())}n.hasMultiPage&&i[e]({callback:r,speed:s})};Xut.View.GotoPrevSlide=function(t){a(t,"prev")},Xut.View.GotoNextSlide=function(t){a(t,"next")},Xut.View.HasEnabledSwiper=function(){return i.hasEnabled()},Xut.View.SetSwiperDisable=function(){i.disable()},Xut.View.SetSwiperEnable=function(){i.enable()},Xut.View.SetSwiperFilpComplete=function(){i.setTransitionComplete.apply(i,arguments)},Xut.View.GetSwiperActionType=function(){return i.getActionType.apply(i,arguments)},Xut.View.GetSwpierBorderBounce=function(t){return i.isBorder(t)},Xut.View.GotoSlide=function(t,e){var a=function(t){return t=Number(t)-1,t<0&&(t=0),t};if(Xut.IBooks.Enabled&&Xut.IBooks.runMode()&&e)return void(location.href=e+".xhtml");if(t||e){if(1===arguments.length)return Xut.View.ShowNextBar(),i.scrollToPage(a(t));if(n.seasonId==t){var o=Xut.data.query("sectionRelated",t),r=e-o.start;return Xut.View.ShowNextBar(),i.scrollToPage(a(r))}return Xut.View.LoadScenario({seasonId:t,chapterId:e})}},Xut.View.SetSwiperMove=function(e){var a=e.action,o=e.direction,r=e.distance,s=e.speed,c=e.orientation;if(!(!n.hasMultiPage||i.getMoved()||"flipMove"===a&&i.isBorder(r))){var l=i.getPointer();i.setDirection(r),c=c||No.launch.scrollMode,t.$$scheduler.movePageBases({action:a,direction:o,distance:r,speed:s,orientation:c,frontIndex:l.frontIndex,middleIndex:l.middleIndex,backIndex:l.backIndex})}}}function Ia(t,e){Xut.Assist.FilterGradient=function(t,e){if(t&&e){var i=Xut.Contents.Get("page",t);if(!i&&(i=Xut.Contents.Get("master",t)))return;e.length&&(e=e.join(" ")),i.$contentNode.addClass(e)}},Xut.Assist.TriggerPoint=function(t,e){var i=Xut.data.query("Activity",t);if(i){var n=$("#"+i.actType+"_"+i._id);n.length&&("show"===e&&Xut.nextTick(function(){n.css("visibility","visible")}),"hide"===e&&n.css("visibility","hidden"))}},Xut.Assist.TextFx=function(t){var e=Xut.Presentation.GetPageBase(),i=e.getLetterObjs(t);i&&i.play()},_.each(["Run","Stop"],function(i){Xut.Assist[i]=function(n,a,o){t(function(t,n,a,o){if(_.isArray(a)){var r=function(){var t=a.length;return function(){1===t&&(o&&o(),r=null),t--}}();_.each(a,function(n){t.assistAppoint(n,e.getVisualIndex(),r,i)})}else t.assistAppoint(a,e.getVisualIndex(),o,i)},n,a,o)}})}function Pa(t,e){function i(t,e){var i=Xut.data.query("Content",t);if(i)return st({results:_.extend({},i),proportion:e})}function n(t){return!t||"string"!=typeof t}Xut.Contents.Get=function(e,i,n){return t(function(t,e,i,n){function a(e,i){var n;if(n=t.$$getPageBase(e))return n.baseGetContentObject(i)}var o,r,s=Xut.Presentation.GetPageIndex();if(_.isArray(i))return r=[],_.each(i,function(t){o=a(s,t),n?n(t,o):o&&r.push(o)}),r;if(/_/.test(i)){var c=i.split("_");if(c.length>1)return a(c[1],c[2])}if(o=a(s,i),!n)return o;n(o)},e,i,n)},Xut.Contents.GetPageWidgetData=function(t,e,n){if(-1===Eh.indexOf(t)&&(e=t,t="page"),e&&e.length){_.isString(e)&&(e=[e]);var a,o=[];return Xut.Contents.Get(t,e,function(t,e){if(e&&(a=e.contentData))o.push({id:e.id,idName:e.actName,element:e.$contentNode,theTitle:a.theTitle,scaleHeight:a.scaleHeight,scaleLeft:a.scaleLeft,scaleTop:a.scaleTop,scaleWidth:a.scaleWidth,contentData:a,source:"innerObjet"});else if(a=i(t,n)){var r,s=Xut.Presentation.GetContentName(t);r=e&&e.$contentNode?e.$contentNode:$("#"+s),o.push({id:t,idName:s,element:r,theTitle:a.theTitle,scaleHeight:a.scaleHeight,scaleLeft:a.scaleLeft,scaleTop:a.scaleTop,scaleWidth:a.scaleWidth,contentData:a,source:"dataBase"})}}),o}},_.each(["Show","Hide","StopAnim"],function(i){Xut.Contents[i]=function(a,o){t(function(t,a,o){if(!n(o)){var r;if(!(r=t.assistPocess(e.getVisualIndex())))return void console.log("注入互斥接口数据错误！");_.each(o.split(","),function(t){r.baseContentMutex(t,i)})}},a,o)}})}function Ta(t,e,i){Xut.Application.GetExistObject=function(e,i){return t(function(t,e){var n;if(n=t.$$getPageBase(i.pageIndex))return"Content"===i.type?n.baseSpecifiedContent(i):n.baseSpecifiedComponent(i)},e)},Xut.Application.GetScrollBarObject=function(){if(e.miniBar)if(e.miniBar.length){for(var t=0;t<e.miniBar.length;t++)if("Scrollbar"===e.miniBar[t].type)return e.miniBar[t]}else if("Scrollbar"===e.miniBar.type)return e.miniBar},Xut.Application.GetMiniBars=function(){return e.miniBar?e.miniBar.length:0}}function Sa(t,e){Xut.Camera.MoveX=function(t,i,n){5===No.launch.visualMode&&e.scrollToPosition(t,i,n)}}function Ca(t){return function(e,i,n,a){if(void 0!==i&&-1===Eh.indexOf(i)){var o=n;n=i,a=o,i="page"}if(-1!==Eh.indexOf(n)&&(i=n,n=null),i=i||"page",t[i])return e(t[i],i,n,a);bo("传递到access的pageType错误,pageType="+i)}}function $a(t){var e=t.$$globalSwiper,i=Ca({page:t.$$scheduler.pageMgr,master:t.$$scheduler.masterMgr});return Sa(i,e),ka(i,e),_a(t,i,e),Ia(i,e),Pa(i,e),Ta(i,t,e),function(){e=null,i=null,t=null}}function Ma(t){for(var e=t.length,i=Uh(e),n="",a=void 0,o=void 0,r=void 0,s=void 0,c=0;c<e;c++)r=t[c],a=r.seasonId,o=r._id,s=a+"-"+o,n+='<li style="'+i.contentstyle+'">\n                <div data-xxtlink="'+s+'">\n                    '+(c+1)+"\n                </div>\n           </li>";var l='<div id="xut-nav-wrapper" style="'+i.containerstyle+'">\n            <div style="width:'+i.overwidth+"px;\n                                           height:"+i.overHeigth+"px;\n                                           "+i.scroller+'">\n                <ul id="xut-nav-section-list">\n                    '+n+"\n                </ul>\n            </div>\n        </div>";return String.styleFormat(l)}function Xa(t){return'<div class="xut-control-backhome"\n                 style="float:left;text-indent:0.25em;height:'+t+"px;line-height:"+t+'px;color:#007aff">\n                主页\n            </div>'}function Na(t){return'<div class="xut-control-navbar"\n                 style="float:left;margin-left:4px;width:'+t+"px;height:"+t+'px;background-size:cover">\n            </div>'}function Ba(t,e){return'<div class="xut-control-title"\n                 style="z-index:-99;width:100%;position:absolute;line-height:'+t+'px;pointer-events:none">\n                '+e+"\n            </div>"}function Da(t,e,i){var n=.25*t,a=.5*t;return'<div class="xut-control-pageIndex"\n                 style="float:right;\n                        margin:'+n+"px 4px;\n                        padding:0 0.25em;\n                        height:"+a+"px;\n                        line-height:"+a+'px;\n                        border-radius:0.5em">\n                  <span class="control-current-page">'+e+"</span>/<span>"+i+"</span>\n            </div>"}function Aa(t){return'<div class="xut-control-hidebar"\n                 style="float:right;width:'+t+"px;height:"+t+'px;background-size:cover">\n            </div>'}function Ea(t){return'<div class="si-icon icon-close2"\n                 style="float:right;margin-right:4px;width:'+t+"px;height:"+t+'px">\n            </div>'}function Oa(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1],i=[];if(_.isArray(t.type))for(var n=0;n<t.type.length;n++)i.push(sp(t.type[n],t,e));else i.push(sp(t.type,t,e));return i}function Ha(){var t=No.layoutMode,e=No.iconHeight,i=No.proportion,n=No.screenSize,a=No.visualSize,o=No.originalVisualSize,r=a.sWidth,s=a.sHeight,c="horizontal"==t;i=c?i.width:i.height,e=up?e:cp(i*e);var l=c?"100%":Math.min(r,s)/(up?8:3)+"px",u=cp(c?s/lp:.96*(s-e-dp)),d=c?"":"top:"+(e+dp+2)+"px;",h=c?"":"left:"+e+"px;",p=c?"bottom:4px;":"",f=c?"hidden":"visible",v='<div class="xut-nav-bar"\n          style="width:'+l+";\n                 height:"+u+"px;\n                 "+d+"\n                 "+h+"\n                 "+p+"\n                 background-color:white;\n                 border-top:1px solid rgba(0,0,0,0.1);\n                 overflow:"+f+';">\n    </div>',g=No.launch.doublePageMode?No.screenSize.width:a.width;return String.styleFormat('<div id="xut-main-scene"\n          style="width:'+g+"px;\n                 height:"+n.height+"px;\n                 top:0;\n                 left:"+o.left+"px;\n                 position:absolute;\n                 z-index:"+Wu.createIndex()+';\n                 overflow:hidden;">\n\n        <div id="xut-control-bar" class="xut-control-bar"></div>\n        <ul id="xut-page-container" class="xut-flip"></ul>\n        <ul id="xut-master-container" class="xut-master xut-flip"></ul>\n        '+v+'\n        <div id="xut-tool-tip"></div>\n    </div>')}function Ra(t){var e=No.visualSize,i=No.originalVisualSize;return String.styleFormat('<div id="scenario-'+t+'"\n          style="width:'+e.width+"px;\n                 height:100%;\n                 top:0;\n                 left:"+i.left+"px;\n                 z-index:"+Wu.createIndex()+';\n                 position:absolute;\n                 overflow:hidden;">\n        <ul id="scenarioPage-'+t+'" class="xut-flip" style="z-index:2"></ul>\n        <ul id="scenarioMaster-'+t+'" class="xut-flip" style="z-index:1"></ul>\n    </div>')}function La(t){var e=Xut.data.query("sectionRelated",t),i=[1],n=e.length>1?2:0;return hp(e.toolbar,i,n)}function Fa(t,e){var i=[0],n=e>1?1:0;return hp(t,i,n)}function Ga(){var t=!1;g(Xut.View,{ShowBusy:es,HideBusy:is,ShowTextBusy:ns}),Xut.View.CloseScenario=function(){if(!t){t=!0;var e=Wu.takeOutPrevChainId();Xut.View.LoadScenario({seasonId:e.seasonId,chapterId:e.chapterId,createMode:"sysClose"},function(){t=!1})}};var e=function(t,e){var i=f(t.seasonId),n=f(t.chapterId),a=f(t.pageIndex),o=t.createMode;if(!t.main&&Xut.IBooks.Enabled&&Xut.IBooks.runMode())return void(location.href=n+".xhtml");var r=Wu.containerObj("current"),s=r&&r.$$mediator&&r.$$mediator.$curVmPage;if(s&&s.seasonId==i&&s.chapterId==n)return void bo("重复触发页面加载:seasonId:"+i+",chapterId:"+n);var c="sysClose"!==o;if(c&&r&&r.seasonId===i)return void Xut.View.GotoSlide(i,n);r&&r.$$mediator.$suspend(),r&&c&&Wu.checkToRepeat(i),t.main&&window.DUKUCONFIG?Xut.View.HideBusy():Xut.View.ShowBusy(),r&&!r.$$mediator.$hasMultiScene&&Xut.View.HideToolBar();var l=void 0;r&&(l=Xut.Presentation.GetPageId())&&Wu.rewrite(r.seasonId,l);var u=Xut.data.query("sectionRelated",i),d={seasonId:i,chapterId:n,sectionRang:u,isInApp:t.isInApp,history:t.history,barInfo:u.toolbar,pageIndex:a||function(){return n?function(){return"GotoSlide"===o?n:n-u.start-1}():0}(),pageTotal:u.length,complete:function(t){e&&e(),r&&r.destroy(),t&&t(),Xut.View.HideBusy()}};(t.main||Wu.mianId===i)&&(j("history"),Wu.mianId=i,d.isMain=!0),new vp(d)};Xut.View.LoadScenario=function(t,i){var n=f(t.chapterId);if(!t.main&&n&&No.launch.preload){if(de({chapterId:n,type:"nolinear",processed:function(){e(t,i),Xut.View.HideBusy()}}))return void Xut.View.ShowBusy()}e(t,i)},Xut.View.Open=function(t,e,i,n,a){Xut.Plugin.WebView.open(t,n,a,i,e,1)},Xut.View.Close=function(){Xut.Plugin.WebView.close()}}function za(){Xut.U3d.View=function(t,e){Xut.View.LoadScenario({seasonId:t,chapterId:e})},window.XXTAPI.ReadVar=function(t,e){var i;return(i=W(t))?i:(z(t,e),e)},window.XXTAPI.SaveVar=function(t,e){z(t,e)},window.XXTAPI.SetVar=function(t,e){z(t,e)}}function Wa(){Xut.Contents.contentsFragment={},Xut.Contents.Canvas={SupportSwipe:!0,isSwipe:!1,isTap:!1,Reset:function(){Xut.Contents.Canvas.SupportSwipe=!0,Xut.Contents.Canvas.isSwipe=!1},getSupportState:function(){var t;return t=!!Xut.Contents.Canvas.SupportSwipe,Xut.Contents.Canvas.Reset(),t},getIsSwipe:function(){var t;return t=!!Xut.Contents.Canvas.isSwipe,Xut.Contents.Canvas.Reset(),t},getIsTap:function(){return Xut.Contents.Canvas.isTap=!1,Xut.Contents.Canvas.isTap}},Xut.Contents.ResetDefaultControl=function(t,e,i){if(e){var n,a=function(t){i?t.attr("data-behavior",i):t.attr("data-behavior","disable")};(n=Xut.Contents.Get(t,e))&&n.$contentNode?a(n.$contentNode):(n=$("#"+e),n.length&&a(n))}},Xut.Contents.DisableControl=function(t){return{behavior:"data-behavior",value:"disable"}},Xut.Contents.EnableControl=function(t){return{behavior:"data-behavior",value:t||"click-swipe"}}}function ja(t){It()}function Va(t){vt()}function Ya(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"exit";if(Wu.destroyAllScene(),"destory"===t&&Se(),"destory"===t||"exit"===t){Va();var e=$("#xut-stream-flow");e.length&&(e.remove(),e=null)}ei(),o(),ja(),Le(),Ye(),Ie(),V(),Xut.TransformFilter.empty(),Xut.CreateFilter.empty(),qe(),he(),$("link[data-type]").each(function(t,e){var i=e.getAttribute("data-type");"svgsheet"!==i&&"xxtflow"!==i||e.parentNode.removeChild(e)}),Lt(),No.launch=null}function Ua(){var t=0,e=!1,i=new Ds;Xut.Application.Watch=function(t,e){var n=function(){e.apply(i,arguments)};return i.$$watch(t,n),n},Xut.Application.onceWatch=function(t,e){var n=function(){e.apply(i,arguments)};return i.$$once(t,n),n},Xut.Application.Notify=function(){i.$$emit.apply(i,arguments)},Xut.Application.unWatch=function(t,e){i.$$unWatch(t,e)},Xut.Application.IsBackStage=function(){return t},Xut.Application.Original=function(){t=1,Nn("","",!0),Bn()},Xut.Application.Activate=function(){t=0,Mn()},Xut.Application.Exit=function(){No.sendTrackCode("exit",{time:+new Date-No.launch.launchTime}),Ya("exit")},Xut.Application.Refresh=function(){Ya("refresh")},Xut.Application.Destroy=function(){Xut.Application.DropApp()},Xut.Application.DropApp=function(){var t=function(){i.$$unWatch(),Ya("destory"),window.GLOBALCONTEXT=null};if(1===No.launch.lauchMode)return void t();if(window.DUKUCONFIG){if(window.DUKUCONFIG.iframeDrop){var e=W("appId");window.DUKUCONFIG.iframeDrop(["appId-"+e,"novelId-"+e,"pageIndex-"+e])}return window.DUKUCONFIG=null,void t()}return window.CLIENTCONFIGT?(window.CLIENTCONFIGT.iframeDrop&&window.CLIENTCONFIGT.iframeDrop(),window.CLIENTCONFIGT=null,void t()):window.MMXCONFIG?(window.MMXCONFIG.iframeDrop&&window.MMXCONFIG.iframeDrop(),window.MMXCONFIG=null,void t()):void 0},Xut.Application.Suspend=function(t){var e=t.skipAudio,i=(t.dispose,t.processed);Dn(e),i&&i()},Xut.Application.Launch=function(){},Xut.Application.setAppState=function(){e=!0},Xut.Application.delAppState=function(){e=!1},Xut.Application.getAppState=function(){return e},Xut.Application.delayAppRun=function(){Xut.Application.setAppState()},Xut.Application.LaunchApp=function(){Xut.Application.delAppState()}}function qa(){Xut.extend=function(t){}}function Ka(){return Xut.plat.supportWebp?"_a":"_i"}function Qa(t){if(1===t){if(Xut.plat.isIOS)return Qa(2);if(Xut.plat.isAndroid)return Qa(3)}return 2===t?Xut.plat.isBrowser?Ka():"delete":3===t?Xut.plat.isBrowser?Ka():"delete":Xut.plat.isBrowser?Ka():""}function Za(){var t=No.launch,e=No.golbal;if(t){var i=t.cursor||t.cursor===!1?t.cursor:e.cursor;as(),i===!1?ss():i&&(i.time&&rs(i.time),i.url&&os(i.url))}var n=t&&t.trackCode||e.trackCode;if(No.sendTrackCode=function(){},No.hasTrackCode=function(){},n&&_.isArray(n)&&n.length){t.trackCode||(t.trackCode={}),n.forEach(function(e){t.trackCode[e]=!0});var a=Xut.guid();No.hasTrackCode=function(e){if(t&&t.trackCode&&t.trackCode[e])return!0};var o=["content","hot"],r=function(t){return~o.indexOf(t)?"action":t};No.sendTrackCode=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};No.hasTrackCode(t)&&Xut.Application.Notify("trackCode",r(t),_.extend(e||{},{uuid:a,appId:No.data.appId,appName:No.data.shortName}))}}t&&(!t.brModel&&e.brModel&&(t.brModel=e.brModel),t.brModel&&(t.brModelType=Qa(t.brModel)));for(var s in e)void 0===t[s]&&(t[s]=e[s]);"v"===t.scrollMode&&(t.visualMode=1)}var Ja=function(){return No.launch.resource?No.launch.resource+"/gallery/":"content/gallery/"},to=function(){return No.launch.resource?No.launch.resource+"/widget/":"content/widget/"},eo=Xut.plat.isIOS,io=Xut.plat.isAndroid,no={resources:function(t){return eo?Ja():io?parseInt(t.launch.storageMode)?"/sdcard/appcarrier/magazine/"+t.data.appId+"/"+Ja():"/android_asset/www/"+Ja():void 0},video:function(){return eo?Ja():io?"android.resource://#packagename#/raw/":void 0},audio:function(){return eo?Ja():io?"/android_asset/www/"+Ja():void 0},svg:function(){return"www/"+Ja()},jsWidget:function(){return eo?to():io?"/android_asset/www/"+to():void 0}},ao=Xut.plat.isIOS,oo=Xut.plat.isAndroid,ro=window.DUKUCONFIG,so=window.MMXCONFIG,co=window.CLIENTCONFIGT,lo=window.SUbCONFIGT;ro&&(ro.path=ro.path.replace("//","/"));var uo=location.href.replace(/^file:\/\/\/?/i,"/").replace(/[^\/]*$/,"");so&&so.path&&(uo=function(t){if("string"!=typeof t)return t;var e=t.length-1;return"/"===t.charAt(e)?t.substr(0,e):t}(so.path));var ho=function(){var t=void 0;return lo&&ro?t="iframeDuKuSubDoc":(lo&&(t="iframeSubDoc"),ro&&(t="iframeDuKu"),co&&(t="iframeClient"),so&&(t="iframeMiaomiaoxue")),t}(),po={resources:function(){if(ao)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return Ja();case"iframeDuKuSubDoc":return Ja();case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}if(oo)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return"/android_asset/www/content/subdoc/"+lo.path+"/content/gallery/";case"iframeDuKuSubDoc":return ro.path.replace("gallery","subdoc")+lo.path+"/content/gallery/";case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}},video:function(){if(ao)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return Ja();case"iframeDuKuSubDoc":return Ja();case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}if(oo)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return"android.resource://#packagename#/raw/";case"iframeDuKuSubDoc":return ro.path.replace("gallery","subdoc")+lo.path+"/content/gallery/";case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}},audio:function(){if(ao)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return Ja();case"iframeDuKuSubDoc":return Ja();case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}if(oo)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return"/android_asset/www/content/subdoc/"+lo.path+"/content/gallery/";case"iframeDuKuSubDoc":return ro.path.replace("gallery","subdoc")+lo.path+"/content/gallery/";case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}},svg:function(){if(ao)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return"www/content/subdoc/"+lo.path+"/content/gallery/";case"iframeDuKuSubDoc":return ro.path.replace("gallery","subdoc")+lo.path+"/content/gallery/";case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}if(oo)switch(ho){case"iframeDuKu":return ro.path;case"iframeSubDoc":return"www/content/subdoc/"+lo.path+"/content/gallery/";case"iframeDuKuSubDoc":return ro.path.replace("gallery","subdoc")+lo.path+"/content/gallery/";case"iframeClient":return co.path;case"iframeMiaomiaoxue":return uo+"/content/gallery/"}},jsWidget:function(){return uo+"/content/widget/"}},fo=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},vo=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),go=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},mo=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},yo=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},bo=function(){};Xut.$warn=bo;var xo=Math.ceil,wo=1024,ko=768,_o=void 0,Io={lauchMode:0,visualMode:_o,scrollMode:"h",banMove:_o,preload:_o,convert:_o,launchAnim:!0,doublePageMode:!1,trackCode:null,brModel:0,columnCheck:_o,pageBar:{type:"digital",mode:_o,position:_o},mouseWheel:_o,platform:_o,quickFlip:!0,supportQR:!1,visualHeight:_o,visualTop:0,cursor:{delayTime:_o,url:_o},imageSuffix:null,baseImageSuffix:"",useHDImageZoom:!0,salePicture:!0,salePictureMultiples:4,salePageType:_o,historyMode:_o,swipeDelegate:_o,storageMode:0},Po=void 0,To={devtools:!1,silent:!1,onlyDomMode:!1,toolType:{main:Po,deputy:Po,number:Po},deBugHistory:Po,pageMode:Po},So={novelId:null,pageIndex:null,dbSize:1,appId:null,iconHeight:Xut.plat.isIphone?32:44,dbName:window.xxtmagzinedbname||"magazine",onlineModeUrl:"lib/data/database.php",pathAddress:null},Co=Xut.plat.isBrowser,$o=window.GLOBALIFRAME,Mo=window.CLIENTCONFIGT,Xo=window.MMXCONFIG,No={},Bo=void 0,Do=void 0,Ao=void 0,Eo=1e3;Xut.zIndexlevel=function(){return++Eo},/xinxuetang/.test(window.location.href)&&(No.iframeFullScreen=!0);var Oo=!1,Ho=!1,Ro=!1,Lo=!1,Fo=void 0,Go=void 0,zo=void 0,Wo=void 0,jo=function(){return No.launch.resource?Ja():$o&&Mo?Mo.path:"undefined"!=typeof initGalleryUrl?Ja():Number(No.launch.storageMode)?"sdcard/"+No.data.appId+"/"+Ja():Ja()},Vo=function(){return!Xo&&Co}(),Yo=function(){return Co?jo():$o?po.resources(No):no.resources(No)},Uo=function(){return Vo?jo():$o?po.video():no.video()},qo=function(){return Vo?jo():$o?po.audio():no.audio()},Ko=function(){return Co?jo():$o?po.svg():no.svg()},Qo=function(){return Co?to():$o?po.jsWidget():no.jsWidget()};_.extend(No,{orientateMode:!!Xut.plat.isBrowser,getVideoPath:function(){return Oo&&Fo?Fo:(Oo=!0,Fo=Uo())},getAudioPath:function(){return Ho&&Go?Go:(Ho=!0,Go=qo())},getSvgPath:function(){return Ro&&zo?zo:(Ro=!0,zo=Ko())},getWidgetPath:function(){return Lo&&Wo?Wo:(Lo=!0,Wo=Qo())},isPlugin:window.DUKUCONFIG&&Xut.plat.isIOS,layoutMode:Bo,proportion:Do,data:So,debug:To,golbal:Io}),Xut.config=No;var Zo=function(e,i,o,r){Ao=n(No,e,i);var s=No.visualSize=t(No,Ao,o,r);s.overflowWidth=!1,s.left<0&&(s.overflowWidth=2*Math.abs(s.left)),s.overflowHeight=!1,s.top<0&&(s.overflowHeight=!0),Do=No.proportion=a(No,s,Ao)},Jo=function(t,n,a){No.screenSize=a||e(),No.screenHorizontal=No.screenSize.width>No.screenSize.height,No.screenVertical=!No.screenHorizontal,Bo=No.layoutMode=i(No.screenSize),t&&n&&(No.pptHorizontal=t>n,No.pptVertical=!No.pptHorizontal)},tr=function(t,e,i,n,a){Jo(t,e,i),Zo(t,e,n,a)},er=Object.defineProperty,ir=Xut.style.transitionEnd,nr=Xut.plat.isMouseTouch,ar=Xut.plat.hasTouch,or=["click","touchstart","touchmove","touchend","touchcancel",ir],rr=["click","mousedown","mousemove","mouseup","mousecancel",ir,"mouseleave"],sr={click:0,start:1,move:2,end:3,cancel:4,transitionend:5,leave:6},cr=function(){return nr?{touch:or,mouse:rr}:ar?or:rr}(),lr={},ur=1,dr=function(t,e,i,n){_.each(e,function(e,a){var o=void 0;n?(o=t[sr[e]])&&i(o):(o=t[sr[a]],e&&o&&i(o,e))})},hr=function(t,e,i,n){dr(e,i,function(e,i){w(t,e,i,n),t.addEventListener(e,i,n)})},pr=function(t,e,i){dr(e,i,function(e){I(t,e)},"remove")},fr=function(t,e,i,n){nr?_.each(cr,function(a){t(e,a,i,n)}):t(e,cr,i,n)},vr=function(t){t&&t.end&&!t.cancel&&(t.cancel=t.end)},gr=+navigator.userAgent.replace(/.*AppleWebKit\/(\d+)\..*/,"$1")<536,mr=void 0,yr=window.localStorage,br=function(t){if(mr)return t+mr;No.data.appId||(No.data.appId="aaron-"+(new Date).getDate());var e=window.SUbCONFIGT&&window.SUbCONFIGT.dbId?"-"+window.SUbCONFIGT.dbId:"";return mr="-"+No.data.appId+e,t+mr},xr=function(t,e){return Xut.plat.supportStorage?t:(Xut.plat.isWeiXin,e)},wr=xr(E,L),kr=xr(O,F),_r=xr(H,G),Ir=xr(R,R),Pr=Math.ceil,Tr=/\/$/,Sr=null,Cr=function(t){var e=t.width,i=t.height,n=t.left,a=t.top,o=t.padding,r=t.proportion,s=t.zoomMode,c=t.getStyle
;if(r||(bo("没有传递缩放比,取全局config"),r=No.proportion),1===s){var l=c.visualTop,u=Pr(i*r.width)||0;return{width:Pr(e*r.width)||0,height:u,left:Pr(n*r.left)||0,top:-l/2-u/2||0,padding:Pr(o*r.width)||0,isHide:u>l}}if(2===s){var d=c.visualTop,h=Pr(i*r.width)||0;return{width:Pr(e*r.width)||0,height:h,left:Pr(n*r.left)||0,top:c.visualHeight+d/2-h/2||0,padding:Pr(o*r.width)||0,isHide:h>d}}if(3===s){if(r.width>r.height){var p=Pr(e*r.width)||0,f=Pr(e*r.height)||0,v=Math.abs(f-p)/2;return n=Pr(n*r.left)+v,{width:f,height:Pr(i*r.height)||0,left:n,top:Pr(a*r.top)||0,padding:Pr(o*r.width)||0}}var g=Pr(i*r.height)||0,m=Pr(i*r.width)||0,y=Math.abs(m-g)/2;return a=Pr(a*r.top)+y,{width:Pr(e*r.width)||0,height:m,left:Pr(n*r.left)||0,top:a,padding:Pr(o*r.width)||0}}return{width:Pr(e*r.width)||0,height:Pr(i*r.height)||0,left:Pr(n*r.left)||0,top:Pr(a*r.top)||0,padding:Pr(o*r.width)||0}},$r=document,Mr=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,Xr=$r.implementation.hasFeature("MutationEvents","2.0"),Nr=function(){function t(){n=!1;var t=i.slice(0);i=[];for(var e=0;e<t.length;e++)t[e]()}var e,i=[],n=!1;if(void 0!==Mr&&Xut.plat.supportMutationObserver){var a=1,o=new Mr(t),r=document.createTextNode(a);o.observe(r,{characterData:!0}),e=function(){a=(a+1)%2,r.data=a}}else{var s=Xut.plat.isBrowser?window:"undefined"!=typeof global?global:{};e=s.setImmediate||setTimeout}return function(a,o){var r=o?function(){a.call(o)}:a;i.push(r),n||(n=!0,e(t,0))}}(),Br=function(t,e,i){var n=t.container,a=t.content,o=t.position,r=t.delay,s=void 0===r?0:r;if(1===arguments.length&&"function"==typeof arguments[0])return"function"==typeof(e=arguments[0])?Nr(e):void console.log("nextTick: 参数提供错误");if(n&&a){if(n instanceof $&&(n=n[0]),1!==n.nodeType)return void console.log("nextTick: container must be HTMLLIElement ");var c="T"+(1e4*Math.random()<<1),l=$r.createElement("input");if(l.setAttribute("value",c),"string"==typeof a){var u=$(a);u[0]||(u=$r.createTextNode(a),u=$(u)),a=u,u=null}var d=function(){n.removeChild(l),e.call(i),n=null,l=null,i=null},h=function(){for(var t=$r.createDocumentFragment(),e=a.length,i=0;i<e;i++)t.appendChild(a[i]);t.appendChild(l),"first"===o?n.insertBefore(t,n.firstChild):n.appendChild(t),t=null,l.setAttribute("value",c)};if(Mr){var p=new Mr(function(t){t.forEach(function(t){t.oldValue===c&&(d(),p=null)})});p.observe(l,{attributes:!0,attributeOldValue:!0,attributeFilter:["value"]}),h()}else if(Xr){var f=function t(a){a.target.value===c&&(n.removeEventListener("DOMNodeInserted",t,!1),e.call(i))};n.addEventListener("DOMNodeInserted",f,!1),h(),n.removeChild(l)}else h(),setTimeout(function(){d()},s)}};Xut.nextTick=Br;var Dr=/(img\s+src|xlink:href)=\"[\w\/]*gallery\/(\w+)(\.[png|jpg|gif]+)/gi,Ar=void 0,Er={};"Setting,Parallax,Master,Activity,Content,Video,Image,Action,Animation,Widget,Novel,Season,Chapter".replace(/[^, ]+/g,function(t){Er[t]="select * FROM "+t+" order by _id ASC"});var Or=function(t){for(var e in t)t[e].item&&function(e){var i=void 0,n=t[e];n.length&&n.item(0)&&(i=n.item(0)._id)&&(t[e].start=i)}(e);return t},Hr=function(t){var e=void 0,i={},n=t.Video;return _.each(n,function(t,a){(e=n.item(a))&&e.activityId&&(i[e.activityId]=e._id)}),i},Rr=function(t){var e,i,n,a,o,r,s,c={},l=t.Chapter,u=l.length;for(n=0;n<u;n++)(s=l.item(n))&&(a=s._id-1,e=s.seasonId,i="seasonId->"+e,c[i]?(c[i].end=a,c[i].length=c[i].length+1):((o=function(e){for(var i,n=t.Season.length;n--;)if((i=t.Season.item(n))&&i._id==e)return i}(e))&&(r=o.parameter),c[i]={start:a,length:1,end:a,toolbar:r}));return c},Lr=void 0,Fr=void 0,Gr=void 0,zr=void 0,Wr=function(t){if(window.openDatabase)try{No.data.db=window.openDatabase(No.data.dbName,"1.0","Xxtebook Database",No.data.dbSize)}catch(t){console.log("window.openDatabase出错")}No.data.db?No.data.db.transaction(function(e){e.executeSql("SELECT * FROM Novel",[],function(e,i){t()},function(){No.data.db=null,t()})}):t()},jr=function(t){St(function(e){return t(e)})},Vr=function(t,e){if(t)return No.data.db=null,void jr(e);Wr(function(){jr(e)})},Yr={ToolbarPos:0,NavbarPos:1,HomeBut:1,ContentBut:1,PageBut:1,NavLeft:1,NavRight:1,customButton:0,CloseBut:window.SUbDOCCONTEXT?1:0},Ur=500,qr=null,Kr=!1,Qr=!1,Zr=null,Jr=void 0,ts=function(){clearTimeout(Zr),Zr=null},es=function(){Kr||Xut.IBooks.Enabled||Zr||(Zr=setTimeout(function(){qr.show(),ts(),Qr&&(is(),Qr=!1)},Ur))},is=function(){Kr||Xut.IBooks.Enabled||es.lock||(Zr?Qr=!0:qr.hide())},ns=function(t){Kr||Xut.IBooks.Enabled||(qr.css("pointer-events","none").find(".xut-busy-text").html(t),es())},as=function(t){Jr=null,Ur=500},os=function(t){Jr=t},rs=function(t){Ur=t},ss=function(){Kr=!0},cs=function(){return Kr},ls=void 0,us=!1,ds=2,hs=13,ps=null,fs=20,vs=function(t,e,i){return function(){Xt(t,e,i)}},gs=function(t){if(t.length){for(var e=void 0;e=t.pop();)e();Xut.Application.Notify("change:number:total"),Xut.Application.Notify("change:column")}},ms=Xut.style.columnWidth,ys=Xut.style.columnGap,bs=0,xs=function(t,e,i,n,a){var o=Number(a[0]),r=Number(a[1]),s=Number(a[2]),c=Number(a[3]),l=i/100*(r+c),u=n/100*(o+s),d=i-l,h=n-u,p=l/2,f=n/100*o;if(/section-transform/.test(e)&&(e=$(e).find("#columns-content").html()),"v"===No.launch.scrollMode){var v='\n            <section id="wrapper-section" class="section-transform" data-flow="true" style="width:'+(i-p)+"px;height:"+(n-f)+"px;top:"+f+"px;left:"+p+'px;">\n                <div  id="scroller-section" class="page-flow-scale" data-role="margin" style="width:'+d+'px;height:auto;">\n                      '+e+"\n                </div>\n            </section>";return bs=n-f,String.styleFormat(v)}var g=ys+":"+l+"px",m=ms+":"+d+"px",y='\n            <section class="section-transform" data-flow="true">\n                <div class="page-flow-scale" data-role="margin" style="width:'+d+"px;height:"+h+"px;margin-top:"+f+"px;margin-left:"+p+'px;">\n                    <div data-role="column" id="columns-content" style="'+m+";height:100%;"+g+'">\n                        '+e+"\n                    </div>\n                </div>\n            </section>";return bs=h,String.styleFormat(y)},ws=function(t,e,i,n,a){for(var o=0;o<t.childNodes.length;o++){var r=t.childNodes[o];if(1==r.nodeType){var s=r.id;if(s){var c=/\d+/.exec(s)[0];if(c){var l=r.getAttribute("data-margin");l=l?l.split(","):[0,0,0,0],r.innerHTML=xs(0,r.innerHTML,i,n,l),a[e][c]=0}else bo("node tag is null on insertColumn")}else bo("node tag is null on insertColumn")}}},ks=function(t,e,i,n){e.each(function(a,o){var r=o.id,s=r.match(/\d/)[0];e.children();t[s]={},ws(o,s,i,n,t)})},_s=function(t,e){for(var i=$(t).find(e).children(),n=0,a=0;a<i.length;a++)n+=Math.max(i[a].scrollHeight,i[a].clientHeight);return Math.ceil(n/bs)},Is=function(){function t(e){fo(this,t),this.state="init",this.cache=[]}return vo(t,[{key:"add",value:function(t){this.cache.push(t)}},{key:"get",value:function(){if(this.cache.length)return this.cache.shift()}},{key:"destory",value:function(){for(var t=0;t<this.cache.length;t++)this.cache[t]&&(this.cache[t].src=null,this.cache[t].removeAttribute("src"),this.cache[t]=null)}}]),t}(),Ps=null,Ts=null,Ss=function(t,e){t=t.split(",");var i=void 0,n=[],a=[];return t.forEach(function(t){i=t.split("-"),1===i.length?a.push(e+t):(n.push(Number(i[0])),a.push(e+i[1]))}),{sizes:n,fileNames:a,length:t.length}},Cs=function(t,e){var i=void 0,n=[],a=[];for(var o in t)!function(o){t[o].split(",").forEach(function(t){i=t.split("-"),1===i.length?n.push(e+o+"/"+t):(a.push(Number(i[0])),n.push(e+o+"/"+i[1]))})}(o);return{sizes:a,fileNames:n,length:n.length}},$s={content:function(t){return Ss(t,No.data.pathAddress)},audio:function(t){return Ss(t,No.data.pathAddress)},video:function(t){return Ss(t,No.data.pathAddress)},svg:function(t){return Ss(t,No.data.pathAddress)},widget:function(t){return Ss(t,No.data.rootPath+"/widget/gallery/")},autoSprite:function(t){return Cs(t,No.data.pathAddress)},seniorSprite:function(t){return Cs(t,No.data.rootPath+"/widget/gallery/")}},Ms=Array.prototype,Xs=Ms.indexOf,Ns=Ms.slice,Bs=function(t,e){var i,n;if(Xs&&t.indexOf===Xs)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},Ds=function(){function t(){fo(this,t),this.$$watch=this.bind,this.$$unWatch=this.unbind,this.$$emit=this.trigger,this.$$once=this.one,this._handleName={}}return vo(t,[{key:"bind",value:function(t,e){var i,n,a=this.events=this.events||{},o=t.split(/\s+/),r=o.length;for(i=0;i<r;i++)a[n=o[i]]=a[n]||[],Bs(a[n],e)===-1&&a[n].push(e);var s;return(s=this._handleName[t])&&this.$$emit(t,s[0]),this}},{key:"one",value:function(t,e){var i=function i(){this.unbind(t,i),e.apply(this,Ns.call(arguments))};return this.bind(t,i),this}},{key:"unbind",value:function(t,e){var i,n,a,o,r,s=this.events;if(!s)return this;if(arguments.length)for(r=t.split(/\s+/),n=0,o=r.length;n<o;n++)(i=r[n])in s!=!1&&(e?(a=Bs(s[i],e))!==-1&&s[i].splice(a,1):s[i]=null,s[i]&&s[i].length||delete s[i]);else this.events=null;return this}},{key:"trigger",value:function(t){var e,i,n,a=this.events;if(e=Ns.call(arguments,1),!a||t in a==!1)return this._handleName[t]=e,this;for(n=a[t],i=0;i<n.length;i++)n[i].apply(this,e);return this}}]),t}(),As=function(t){function e(){fo(this,e);var t=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.asys=[],t}return mo(e,t),vo(e,[{key:"create",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push";t&&"function"==typeof t&&this.asys[e](t)}},{key:"exec",value:function(){var t=this;if(this.asys.length){!function e(){if(t.asys.length){t.asys.shift()(e)}else t.$$emit("complete")}()}return this}}]),e}(Ds),Es={},Os=function(){function t(e,i){fo(this,t),this.state=!1,this.timer=null,this.parser=e,this.filePath=i}return vo(t,[{key:"_clearDownload",value:function(){this._downObj&&(this._downObj.destory&&this._downObj.destory(),this._downObj=null)}},{key:"_downloadFile",value:function(){var t=this;this._downObj=this.parser(this.filePath,function(){t.state=!0,t.callback&&t.callback()})}},{key:"_clearWatcher",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"_createWather",value:function(t){var e=this;this.state||(this.timer=setTimeout(function(){e.callback&&e.callback()},t))}},{key:"_createExitFn",value:function(t){var e=this;this.callback=function(){e._clearWatcher(),e.callback=null,t(e.state)}}},{key:"start",value:function(t,e){this._createExitFn(e),this._downloadFile(),this._createWather(t)}},{key:"reset",value:function(t,e){this._createExitFn(e),this._createWather(t)}},{key:"destory",value:function(){this._clearDownload(),this._clearWatcher(),this.callback=null,this.parse=null}}]),t}(),Hs=!0,Rs=null,Ls=0,Fs=0,Gs=null,zs={content:Jt,widget:Jt,autoSprite:Jt,seniorSprite:Jt,audio:Vt,svg:Kt},Ws=function(t){if(void 0===No.launch.historyMode)return void 0!==t.recordHistory&&Number(t.recordHistory)?void(No.launch.historyMode=!0):void(No.debug.devtools&&(No.launch.historyMode=!0))},js=function(t){!No.launch.visualMode&&Number(t.scrollPaintingMode)&&(No.launch.visualMode=4)},Vs=function(){return No.visualSize?No.visualSize.width:window.screen.width>document.documentElement.clientWidth?window.screen.width:document.documentElement.clientWidth},Ys=function(){var t=document.documentElement;if(t.clientHeight>t.clientWidth){var e=window.devicePixelRatio||1,i=Vs()*e;i>=1080&&i<1439&&(No.launch.baseImageSuffix=No.launch.imageSuffix[1080]),i>=1440&&(No.launch.baseImageSuffix=No.launch.imageSuffix[1440]),No.debug.devtools&&No.launch.baseImageSuffix&&bo("css media匹配suffix失败，采用js采用计算. config.launch.baseImageSuffix = "+No.launch.baseImageSuffix)}},Us=function(){var t=$(".xut-adaptive-image");if(t.length){var e=t.width(),i=No.launch.imageSuffix[e];if(i)return void(No.launch.baseImageSuffix=i)}Ys()},qs=function(t,e){No.sendTrackCode("launch"),Xut.CreateFilter=zt("createFilter"),Xut.TransformFilter=zt("transformFilter"),s(t.pptWidth,t.pptHeight),Ws(e),js(e),Xut.IBooks.Enabled||$t(),r()},Ks=function(t){Gt(function(e){e&&No.launch.swipeDelegate!==!1&&(No.launch.swipeDelegate=!0),t()})},Qs=function(){if(No.launch.historyMode){var t=No.data;z({pageIndex:t.pageIndex,novelId:t.novelId})}else W("novelId")&&(j("pageIndex"),j("novelId"))},Zs=function(t){return{novelId:Number(t.novelId),pageIndex:Number(t.pageIndex),history:t.history}},Js=function(){var t=void 0;(t=Xut.data.query("Novel").preCode)&&nt(t,"novelpre脚本")},tc=function(t){t=Zs(t||{}),No.data.novelId=t.novelId,No.data.pageIndex=t.pageIndex,Qs(),Js();var e=void 0,i=void 0,n=void 0;for(n=0;n<Xut.data.Season.length;n++)if(i=Xut.data.Season.item(n),Xut.data.query("sectionRelated",i._id)){e=i._id;break}Xut.View.LoadScenario({main:!0,seasonId:e,pageIndex:t.pageIndex,history:t.history},function(){Xut.Application.Notify("initComplete"),No.sendTrackCode("init")})},ec=function(){function t(e,i){fo(this,t);var n=ve(e.url),a=e.width,o=e.height,r=e.top,s=e.left,c=e.zIndex;this.container=ge(e);var l=fe("video-flare",{width:a,height:o,top:r,left:s,zIndex:c}),u=this.fv=l.flareVideo({width:a,height:o,autoplay:!0,srcs:n});u.video.setAttribute("playsinline","playsinline"),Xut.plat.isAndroid&&Xut.plat.isWeiXin&&!e.isColumn&&(u.video.setAttribute("x5-video-player-type","h5"),u.video.setAttribute("x5-video-player-fullscreen",!0)),u.bind("ended",function(){e.startBoot&&e.startBoot(),"mini"!==No.launch.platform&&i(e.chapterId)}),u.bind("error",function(){e.startBoot&&e.startBoot(),i(e.chapterId)}),this.container.append(l),u.bind("close",function(){i(e.chapterId)})}return vo(t,[{key:"play",value:function(){this.fv.play()}},{key:"stop",value:function(){this.fv.pause()}},{key:"destroy",value:function(){this.fv.remove(),this.fv=null,this.container=null}}]),t}(),ic={state:!1,path:window.DUKUCONFIG?window.DUKUCONFIG.path+"duku.mp4":"android.resource://#packagename#/raw/duku",load:function(){this.play(),this.state=!0},play:function(){Xut.Application.delayAppRun(),Xut.Plugin.VideoPlayer.play(function(){ic.launchApp()},function(){ic.launchApp()},ic.path,1,0,0,window.innerHeight,window.innerWidth)},closeVideo:function(){Xut.Plugin.VideoPlayer.close(function(){ic.launchApp()})},launchApp:function(){this.state=!1,Xut.Application.LaunchApp()}},nc=function(t){if(Xut.isRunSubDoc)return void Xut.publish("subdoc:dropApp");"pause"===t&&Xut.Application.Original(),"resume"===t&&Xut.Application.Activate(),"back"===t&&window.GLOBALCONTEXT.navigator.notification.confirm("您确认要退出吗？",function(t){1==t&&Xut.Application.Suspend({processed:function(){window.GLOBALCONTEXT.navigator.app.exitApp()}})},"退出","确定,取消")},ac=function(t){return W(t)},oc=function(t){if(Xut.IBooks.Enabled)return $(".xut-cover").remove(),void tc({pageIndex:Xut.IBooks.CONFIG.pageIndex});if(t.parameter){var e=m(t.parameter);if(void 0===No.launch.banMove&&void 0!==e.pageflip)switch(Number(e.pageflip)){case 0:No.launch.banMove=!1;break;case 1:No.launch.banMove=!0}}void 0===No.launch.banMove&&(No.launch.banMove=!1);var i=Number(ac("pageIndex"));if(No.launch.historyMode&&void 0!==i){var n=parseInt(ac("novelId"));if(n)return tc({novelId:n,pageIndex:i,history:W("history")})}tc({novelId:t._id,pageIndex:0})},rc=function(){return pe(oc)},sc=function(){Xut.plat.isAndroid&&!Xut.plat.isBrowser&&(window.MMXCONFIG&&!window.DUKUCONFIG&&be(),window.SUbCONFIGT||Xut.Application.Watch("initComplete",function(){_e()})),window.DUKUCONFIG&&PMS.bind("MagazineExit",function(){PMS.unbind(),Xut.Application.DropApp()},"*"),rc()},cc="hot",lc="content",uc="season",dc="column",hc=function(t,e){return t.ownerDocument.defaultView.getComputedStyle(t,null).getPropertyValue(e)},pc=function(){function t(e,i,n){fo(this,t);var a=void 0,o=void 0,r={};this.getAudioTime=n,this.options=e,this.parents=i.parents,this.ancestors=i.ancestors,this.timer=0,this.cacheCreateDivs={},o=this.orgAncestorVisibility={},_.each(this.ancestors,function(t,e){(a=hc(t,"visibility"))&&(o[e]=a)}),this.recordRepart={},this.changeValue=0,_.each(e.subtitles,function(t){r[t.start+"-start"]=t,r[t.end+"-end"]=t}),this._createSubtitle(r)}return vo(t,[{key:"_createSubtitle",value:function(t){var e=this;this.timer=setTimeout(function(){e.getAudioTime(function(i){var n=void 0;_.each(t,function(t,a){n=a.split("-"),e._action(n[0],i,n[1],t)}),e._createSubtitle(t)})},50)}},{key:"_action",value:function(t,e,i,n){if(e>t-50&&e<t+50)if(this.recordRepart[n.start]||"start"!==i){if(!this.recordRepart[n.end]&&"end"===i){this.recordRepart[n.end]=!0;var a=this.ancestors[n.id];a&&(a.style.visibility="hidden")}}else this.recordRepart[n.start]=!0,this._createDom(n)}},{key:"_createDom",value:function(t){function e(t,e){var i=rt({width:e.width,height:e.height,left:e.left,top:e.top}),n="position:absolute;\n                 display:table;\n                 vertical-align:center;\n                 width:"+i.width+"px;\n                 height:"+i.height+"px;\n                 top:"+i.top+"px;\n                 left:"+i.left+"px;";t.style.cssText=String.styleFormat(n)}function i(t,e){var i="text-align:center;\n                 display:table-cell;\n                 vertical-align :middle;\n                 color:"+e.fontColor+";\n                 font-family:"+e.fontName+";\n                 font-bold:"+e.fontBold+";\n                 font-size:"+e.fontSize*o+"px;\n                 line-height:"+d+"%";t.style.cssText=String.styleFormat(i),t.innerHTML=e.title}function n(t,n,a){e(t,a),i(n,a)}var a=No.proportion,o=a.width,r=(a.height,t.id),s=this.parents[r],c=this.ancestors[r],l=this.cacheCreateDivs[r],u=l&&l.children[0],d=t.lineHeight?t.lineHeight:"100%";if(l)n(l,u,t);else{var h=document.createElement("div"),p=document.createElement("p");n(h,p,t),h.appendChild(p),s.appendChild(h),this.cacheCreateDivs[r]=h}if(c){"visible"!=hc(c,"visibility")&&(c.style.visibility="visible")}}},{key:"destroy",value:function(){var t=this;_.each(this.cacheCreateDivs,function(t){t.parentNode.removeChild(t)}),_.each(this.ancestors,function(e,i){var n=t.orgAncestorVisibility[i];hc(e,"visibility")!=n&&(e.style.visibility=n)}),this.ancestors=null,this.cacheCreateDivs=null,this.changeValue=0,this.parents=null,this.timer&&(clearTimeout(this.timer),this.timer=0)}}]),t}(),fc=function(){function t(e,i){fo(this,t),this.options=e,this.trackId=e.trackId,this.controlDoms=i,this._$$preRelated(e),this._init(),this._$$afterRelated(e)}return vo(t,[{key:"_$$preRelated",value:function(t){this.$$url=No.getAudioPath()+t.url,this.innerCallback=t.innerCallback,9999==this.trackId&&t.complete&&(this.outerCallback=t.complete)}},{key:"_$$afterRelated",value:function(t){var e=this;t.data&&t.data.repeat&&(this.repeatNumber=Number(t.data.repeat)),t.action&&(this.acitonObj=Te(t)),t.subtitles&&t.subtitles.length>0&&(this.subtitleObject=new pc(t,this.controlDoms,function(t){return e._getAudioTime(t)})),this.outerCallback&&this.outerCallback.call(this)}},{key:"_$$callbackProcess",value:function(t){if(this.outerCallback)this.destroy();else{if(!t)return void(this.innerCallback&&this.innerCallback(this));this.repeatNumber?(--this.repeatNumber,this.play()):this.innerCallback&&this.innerCallback(this)}}},{key:"getTrackId",value:function(){return this.trackId}},{key:"play",value:function(){var t=this;this._play&&this._play(),this.status="playing",this.audio&&(window.WeixinJSBridge?window.WeixinJSBridge.invoke("getNetworkType",{},function(e){t.audio&&t.audio.play()}):this.audio.play()),this.acitonObj&&this.acitonObj.play()}},{key:"pause",value:function(){this._pause&&this._pause(),this.status="paused",this.audio&&this.audio.pause&&this.audio.pause(),this.acitonObj&&this.acitonObj.pause()}},{key:"reset",value:function(){this._reset&&this._reset(),this.status="reseted"}},{key:"destroy",value:function(){this._destroy&&this._destroy(),this.status="ended",this.subtitleObject&&(this.subtitleObject.destroy(),this.subtitleObject=null),this.acitonObj&&(this.acitonObj.destroy(),this.acitonObj=null)}}]),t}(),vc=function(t){function e(t,i){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return mo(e,t),vo(e,[{key:"_init",value:function(){var t=this,e=new window.GLOBALCONTEXT.Media(t.$$url,function(){t._$$callbackProcess(!0)},function(){t._$$callbackProcess(!1)});this.audio=e,this.play()}},{key:"_reset",value:function(){this.audio.pause(),this.audio.seekTo(0)}},{key:"_getAudioTime",value:function(t){var e=this;this.audio.getCurrentPosition(function(i){var n=void 0;i*=1e3,e.changeValue||(e.changeValue=i),i-=e.changeValue,i>-1&&(n=Math.round(i)),t(n)},function(e){console.log("error:"+e),t()})}},{key:"_destroy",value:function(){this.audio&&(this.audio.release(),this.audio=null)}}]),e}(fc),gc=function(t){for(var e="",i=void 0,n=0;n<t;n++)i=parseInt(256*Math.random(),10).toString(16),1==i.length&&(i="0"+i),e+=i;return e},mc=function(){return[4,2,2,2,6].map(gc).join("-")},yc=function(t){function e(t,i){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return mo(e,t),vo(e,[{key:"_init",value:function(){var t=this;this.id=mc();var e={startPlayingAudio:function(){window.audioHandler.startPlayingAudio(t.id,t.$$url)},pausePlayingAudio:function(){window.audioHandler.pausePlayingAudio(t.id)},release:function(){window.audioHandler.release(t.id)},expansionCurrentPosition:function(){return window.getCurrentPosition(t.id)}};this.audio=e,this.play()}},{key:"_getAudioTime",value:function(t){t(Math.round(1e3*this.audio.expansionCurrentPosition()))}},{key:"_play",value:function(){this.audio&&this.audio.startPlayingAudio()}},{key:"_pause",value:function(){this.audio&&this.audio.pausePlayingAudio()}},{key:"_destroy",value:function(){this.audio&&(this.audio.release(),this.audio=null)}}]),e}(fc),bc=0,xc=10,wc=[],kc=function(t){function e(t,i){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return mo(e,t),vo(e,[{key:"_createContext",value:function(t){var e=this;this.audio=$e(),Xut.plat.isIOS&&this.options.isTrigger&&this.audio.play(),setTimeout(function(){e.audio&&(e.audio.src=e.$$url,e._initPlay(void 0==t||t))},150)}},{key:"_init",value:function(){this.trackId;Ce()?this._createContext():(this.audio=new Audio(this.$$url),window.WeixinJSBridge?this._startPlay():(this._needFix=!0,this._initPlay(!0)))}},{key:"_clearTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"_initPlay",value:function(t){var e=this;this._endBack=function(){e._clearTimer(),e._$$callbackProcess(!0)},this._errorBack=function(){e._clearTimer(),e._$$callbackProcess(!1)},this._startBack=function(){t&&(e.status="ready",e.timer=setTimeout(function(){e._clearTimer(),"ready"===e.status&&e._startPlay()},150))},this.audio.addEventListener("loadedmetadata",this._startBack,!1),this.audio.addEventListener("ended",this._endBack,!1),this.audio.addEventListener("error",this._errorBack,!1)}},{key:"_startPlay",value:function(){this.audio.autoplay="autoplay",this.play()}},{key:"_getAudioTime",value:function(t){t(Math.round(1e3*this.audio.currentTime))}},{key:"_reset",value:function(){this.audio.pause(),this.audio.currentTime=0}},{key:"_destroy",value:function(){this.audio&&(this.audio.pause(),window.WeixinJSBridge||(this.audio.removeEventListener("loadedmetadata",this._startBack,!1),this.audio.removeEventListener("ended",this._endBack,!1),this.audio.removeEventListener("error",this._errorBack,!1)),this.audio=null)}},{key:"resetContext",value:function(){this._needFix&&"ended"!==this.status&&(this._destroy(),this._createContext("playing"===this.status))}}]),e}(fc),_c=void 0;_c=Xut.plat.isAndroid&&!Xut.plat.isBrowser?vc:window.MMXCONFIG&&window.audioHandler?yc:kc;var Ic=void 0,Pc=function(){Ic=v()},Tc=function(t,e,i){var n,a,o=v(),r=v(),s=e-1;if(t){n=Xut.Contents.contentsFragment[e];e>9e3&&(s=Xut.Presentation.GetPageIndex()),_.each(t,function(t){if(!o[t.id]){a=n["Content_"+s+"_"+t.id],r[t.id]=a;var e=$(a);if(e.length){var i=e.find("div").last();i.length&&(o[t.id]=i[0])}}})}return{parents:o,ancestors:r}},Sc=function(t,e,i,n,a,o){var r={};if(o&&o.isColumn)_.extend(r,{trackId:o.track,url:o.fileName,audioId:i,data:t}),(o.startImage||o.stopImage)&&_.extend(r,{startImage:o.startImage,stopImage:o.stopImage,action:!0});else{var s=t.theTitle?m(t.theTitle):null;_.extend(r,{trackId:t.track,url:t.md5,subtitles:s,audioId:i,data:t}),a&&_.extend(r,a,{action:!0})}return r},Cc=function(t,e,i,n,a){if(a.isColumn)return Sc({},0,e,0,null,a);var o=He(i,e);return o&&o.md5?Sc(o,0,e,0,n):void 0},$c=function(t,e,i,n){var a=Ic[t][e][i],o=a.getTrackId(),r=n.trackId;return 0!=r&&0!=o&&r!=o||n.stetObj&&n.stetObj===a||(a.destroy(),delete Ic[t][e][i]),!1},Mc=function(t){var e=void 0,i=void 0,n=void 0;for(e in Ic)for(i in Ic[e])for(n in Ic[e][i])$c(e,i,n,t)},Xc=function(t,e){Ic[e]||(Ic[e]=v()),Ic[e][t]||(Ic[e][t]=v())},Nc=function(t,e,i,n){Mc(n),Xc(t,i);var a=void 0;n.subtitles&&(a=Tc(n.subtitles,t)),n.innerCallback=function(n){Ic[i]&&Ic[i][t]&&Ic[i][t][e]&&(n.destroy(),delete Ic[i][t][e])},Ic[i][t][e]=new _c(n,a)},Bc=function(t,e,i,n){var a=void 0,o=void 0;switch(Ic[i]&&Ic[i][t]&&Ic[i][t][e]&&(a=Ic[i][t][e],o=a.audio?a.status:null),o){case"playing":a.pause();break;case"paused":a.play();break;default:Nc(t,e,i,n)}},Dc=function(t){var e=t.pageId,i=t.queryId,n=t.type,a=t.action,o=t.data,r=t.columnData,s=void 0===r?{}:r;s.isColumn||(e=Number(e),i=Number(i));var c=Cc(0,i,n,o,s);"hot"===n&&"trigger"==a?(c.isTrigger=!0,Bc(e,i,n,c)):Nc(e,i,n,c)},Ac=function(t,e,i){var n=Me();if(n[lc]){var a=n[lc][t];if(a){var o=a[e];o&&i(o,n)}}},Ec=function(){function t(e){fo(this,t);var i=e.width,n=e.height,a=e.top,o=e.left,r=e.zIndex,s=e.url;this.options=e,this.$container=ge(e),this._initWrap(i,n,a,o,r,ve(s)),this._initEvent(e),(Xut.plat.isIOS||Xut.plat.isAndroid)&&this.play(),Xut.Application.PlayHTML5Video=!0}return vo(t,[{key:"_initWrap",value:function(t,e,i,n,a,o){this.$videoWrap=fe("video-h5",{width:t,height:e,top:i,left:n,zIndex:a}),this.video=document.createElement("video"),this.$videoNode=$(this.video).css({width:t,height:e,display:"block"}).attr({src:o,controls:"controls",autoplay:"autoplay",playsinline:"playsinline"}),this.$videoWrap.append(this.$videoNode),this.$container.append(this.$videoWrap)}},{key:"_initEvent",value:function(t){var e=this;this._start=function(){e.play(),e.$videoWrap.css("visibility","visible")},this._clear=function(){t.startBoot&&t.startBoot(),Ve(t.chapterId)},this.video.addEventListener("canplay",this._start,!1),this.video.addEventListener("ended",this._clear,!1),this.video.addEventListener("error",this._clear,!1)}},{key:"play",value:function(){this.$videoWrap.show(),this.video.play()}},{key:"stop",value:function(){this.video.pause(),window.MMXCONFIG||(this.$videoWrap.hide(),this.options.startBoot&&(this.options.startBoot(),this.destroy()))}},{key:"destroy",value:function(){this.stop(),this.video.removeEventListener("canplay",this._start,!1),this.video.removeEventListener("ended",this._clear,!1),this.video.removeEventListener("error",this._clear,!1),this.$videoWrap.remove(),this.$videoNode=null,this.$videoWrap=null,this.$container=null,this.options.container=null,this.video=null,setTimeout(function(){Xut.Application.PlayHTML5Video=!1},1e3)}}]),t}(),Oc=window.devicePixelRatio,Hc=window.screen,Rc=function(){function t(e){fo(this,t);var i=window.MMXCONFIG||window.DUKUCONFIG?e.url:e.url.substring(0,e.url.lastIndexOf("."));this.url=ve(i),window.DUKUCONFIG?(this.width=Hc.width,this.height=Hc.height,this.top=0,this.left=0):(this.width=e.width*Oc,this.height=e.height*Oc,this.left=e.left*Oc||0,this.top=e.top*Oc||0),this.play()}return vo(t,[{key:"play",value:function(){Xut.Plugin.VideoPlayer.play(function(){console.log("success")},function(){console.log("fail")},this.url,1,this.left,this.top,this.height,this.width)}},{key:"stop",value:function(){Xut.Plugin.VideoPlayer.close()}},{key:"destroy",value:function(){this.stop()}}]),t}(),Lc=function(){function t(e){fo(this,t);var i=e.pageUrl;if(this.container=ge(e),2==e.hyperlink)window.open(i),$.get("http://www.appcarrier.cn/index.php/adplugin/recordads?aid=16&esbId=ios");else{var n,a,o=e.padding||0,r=e.width,s=e.height,c=e.videoId,l=e.left,u=e.top;o?(n=r-2*o,a=s-2*o):(n=r,a=s),this.$videoNode=$('<div id="videoWrap_'+c+'" style="position:absolute;left:'+l+"px;top:"+u+"px;width:"+r+"px;height:"+s+"px;z-index:"+Xut.zIndexlevel()+'"><div style="position:absolute;left:'+o+"px;top:"+o+"px;width:"+n+"px;height:"+a+'px;"><iframe src="'+i+'" style="position:absolute;left:0;top:0;width:100%;height:100%;"></iframe></div></div>'),this.container.append(this.$videoNode),this.play()}}return vo(t,[{key:"play",value:function(){this.$videoNode&&this.$videoNode.show()}},{key:"stop",value:function(){this.$videoNode&&this.$videoNode.hide()}},{key:"destroy",value:function(){this.$videoNode&&(this.$videoNode.remove(),this.$videoNode=null),this.container=null}}]),t}(),Fc=void 0;Xut.plat.isBrowser?Fc=Xut.plat.isIOS||Xut.plat.isAndroid?ec:Ec:Xut.plat.isIOS||top.EduStoreClient?Fc=(Xut.IBooks.Enabled,ec):Xut.plat.isAndroid&&(Fc=window.MMXCONFIG?ec:Rc);var Gc=function(){function t(e){switch(fo(this,t),e.category){case"video":this.video=new Fc(e,Ve);break;case"webpage":this.video=new Lc(e,Ve);break;default:console.log("options.category must be video or webPage ")}Xut.View.Toolbar("hide")}return vo(t,[{key:"play",value:function(){Xut.View.Toolbar("hide"),this.video.play()}},{key:"stop",value:function(){Xut.View.Toolbar("show"),this.video.stop()}},{key:"destroy",value:function(){this.video.destroy()}}]),t}(),zc=void 0,Wc=function(){zc=v()},jc=function(t,e,i){var n={},a=e.chapterId,o=e.activityId,r=e.pageIndex,s=e.pageType;if(i)_.extend(n,{width:"100%",height:"100%",top:0,left:0,zIndex:1,chapterId:a,container:i.container,url:i.fileName,isColumn:i.isColumn,position:i.position,category:"video"});else{var c=Xut.Presentation.GetPageStyle(r),l=rt({getStyle:c,proportion:c.pageProportion,width:t.width||No.visualSize.width,height:t.height||No.visualSize.height,left:t.left,top:t.top,padding:t.padding});_.extend(n,l,{pageType:s,chapterId:a,isfloat:t.isfloat,videoId:o,url:t.md5,pageUrl:t.url,zIndex:t.zIndex||2147483647,background:t.background,category:t.category,hyperlink:t.hyperlink})}return n},Vc=function(t){if(t.columnData&&t.columnData.isColumn)return jc({},t,t.columnData);var e=Xut.data.query("Video",t.activityId);return jc(e,t)},Yc=function(t,e){var i=t.chapterId,n=t.activityId,a=t.rootNode;zc[i]&&zc[i][n]?zc[i][n].play():(_.isObject(zc[i])||(zc[i]={}),a&&(e.container=a),zc[i][n]=new Gc(e))},Uc=function(t){var e=Vc(t);Yc(t,e)},qc=function(){return cs()?"":'<div class="xut-busy-icon xut-fullscreen"></div>'},Kc=function(t){var e="";if("mini"===No.launch.platform);else{var i="./content/gallery/cover.jpg";No.launch.resource&&(i=No.launch.resource+"/gallery/cover.jpg"),e='style="background-image: url('+i+');"'}return qc()+'\n            <div class="xut-adaptive-image"></div>\n            <div class="xut-cover xut-fullscreen" '+e+'></div>\n            <div class="xut-scene-container xut-fullscreen xut-overflow-hidden"></div>'},Qc=void 0,Zc=void 0,Jc={},tl=!1;window.fixNodeError=function(t,e,i,n){"image"===t&&Ze(e,i,n)},Xut.plat.hasAutoPlayAudio||function(t,e,i){T(document,{end:function(){var t=void 0,e=void 0;for(e=0;e<xc;e++)t=new Audio,t.play(),wc.push(t);Ee(),S(document)}})}();var el=!1,il=function(){function t(){fo(this,t),this._group={},this.$$GetPageId=this.$$getPageId,this.$$GetPageNode=this.$$getPageNode,this.$$GetPageData=this.$$getPageData,this.$$GetPageBase=this.$$getPageBase}return vo(t,[{key:"_$$addBaseGroup",value:function(t,e){this._group[t]=e}},{key:"_$$getBaseGroup",value:function(){return this._group}},{key:"_$$removeBaseGroup",value:function(t){delete this._group[t]}},{key:"_$$destroyBaseGroup",value:function(){var t=void 0,e=this._group;for(t in e)e[t].baseDestroy();this._group=null}},{key:"assistPocess",value:function(t,e){var i;if(i=this.$$getPageBase(t,this.pageType)){if(!e)return i;e(i)}}},{key:"assistAppoint",value:function(t,e,i,n){var a;if(a=this.$$getPageBase(e))return a.baseAssistRun(t,i,n)}},{key:"$$getPageId",value:function(t,e){var i="page"===e?"_id":"pptMaster";return this.$$getPageData(t,i,e)}},{key:"$$getPageNode",
value:function(t,e){return this.$$getPageData(t,"nodes",e)}},{key:"$$getPageBase",value:function(t,e){return e=e||this.pageType,"master"===e&&(/-/.test(t)||(t=this.converMasterId(t))),this._group&&this._group[t]}},{key:"$$getPageData",value:function(t,e,i){var n;if((!i&&"page"==e||"master"==e)&&(i=e,e=null),n=this.$$getPageBase(t,i))return e?n.chapterData[e]:n.chapterData}}]),t}(),nl=function(){function t(e,i,n,a,o,r,s){fo(this,t),this.dragElement=e,this.defaultPoint=null,this.dropElement=i,this.autoReturn=n>=1,this.dragCallback="function"==typeof a?a:null,this.dropCallback="function"==typeof o?o:null,this.throwProps=0!=s&&!this.autoReturn,this.container=r,this.dragElement.attr("data-defaultindex",this.dragElement.css("z-index")),null==this.dragElement.attr("data-DragDrop")?(this.init(),this.dragElement.attr("data-DragDrop",!0)):console.log("This element has binding DragDropClass.")}return vo(t,[{key:"init",value:function(){if(null==this.dragObject)var t=this,e=this.dragObject=Draggable.create(this.dragElement,{bounds:this.container,dragResistance:0,edgeResistance:.8,type:"left,top",force3D:!1,throwProps:this.throwProps,snap:{left:function(t){return t},top:function(t){return t}},onDragStart:function(e){var i=t.dragElement.offset();t.defaultPoint={x:i.left,y:i.top,left:Number(t.dragElement.css("left").replace("px","")),top:Number(t.dragElement.css("top").replace("px",""))},t.dragCallback&&t.dragCallback()},onDragEnd:function(i){var n=t.dropElement,a=!1;if(n&&"hidden"!=n[0].style.visibility){var o=t.dragElement.offset(),r={x:o.left,y:o.top,w:t.dragElement.width(),h:t.dragElement.height()},s=n.offset(),c={x:s.left,y:s.top,w:n.width(),h:n.height()},l={pointerX:c.x+c.w/2,pointerY:c.y+c.h/2};if(e.pointerX>c.x&&e.pointerX<c.x+c.w&&e.pointerY>c.y&&e.pointerY<c.y+c.h?(a=!0,e.disable()):l.pointerX>r.x&&l.pointerX<r.x+r.w&&l.pointerY>r.y&&l.pointerY<r.y+r.h&&(a=!0,e.disable()),1==a){var u=l.pointerX-(t.defaultPoint.x+r.w/2),d=l.pointerY-(t.defaultPoint.y+r.h/2),h=t.defaultPoint.left+u,p=t.defaultPoint.top+d;TweenLite.to(t.dragElement,.3,{css:{left:h,top:p},ease:Expo.easeOut})}else t.autoReturn&&TweenLite.to(t.dragElement,.7,{css:{left:t.defaultPoint.left,top:t.defaultPoint.top}})}else t.autoReturn&&TweenLite.to(t.dragElement,.7,{css:{left:t.defaultPoint.left,top:t.defaultPoint.top}});t.dragElement.css("z-index",t.dragElement.attr("data-defaultindex")),t.dropCallback&&t.dropCallback(a)}})[0]}},{key:"reset",value:function(){var t,e=this;(t=this.dragObject)&&(t.enable(),e.defaultPoint&&(e.dragElement.css("left",e.defaultPoint.left),e.dragElement.css("top",e.defaultPoint.top)))}},{key:"disable",value:function(){var t;(t=this.dragObject)&&t.disable()}},{key:"destroy",value:function(){this.dragObject&&this.dragObject.kill(),this.dropElement=null,this.dragElement=null,this.dragObject=null}}]),t}(),al=10===document.documentMode,ol=["null","auto","tap","drag","dragTag","swipeleft","swiperight","swipeup","swipedown","doubletap","press","pinchout","pinchin","rotate","assist"],rl=["drag","dragTag","swipeleft","swiperight","swipeup","swipedown"],sl=function(t){return rl.indexOf(t)===-1},cl=function(t,e){t?e.attr("data-behavior","swipe"):e.attr("data-behavior","disable")},ll=function(t,e){e&&(e.prop("setCursor")||("drag"===t?e.css("cursor","Move"):e.css("cursor","Pointer"),e.prop("setCursor","true")))},ul=function(t,e){var i=void 0,n=void 0,a=void 0,o=e.eventContext,r=e.eventName,s=e.supportSwipe;return"drag"===r?i=new nl(o,null,e.parameter,t.startRun,t.stopRun):"dragTag"===r?i=new nl(o,e.target,1,t.startRun,t.stopRun):(n=function(){e.eventRun.call(o)},a="tap"===r||"click"===r?ri(r,o,n,s):li(o,r,n,s)),{dragObj:i,reference:a,handler:n}},dl=function(t,e){var i;(i=this.activityGroup)&&_.each(i.get(),function(i,n){if(t==i.activityId)return void e(i)},this)},hl=function(t){var e,i=this.registers;return function(){var n=i[0];dl.call(t,n,function(t){t.runAnimation(function(){e=i.shift(),i.push(e)})})}},pl=function(t,e){var i,n;_.each(e,function(a){_.each(a,function(e){(i=t.baseGetContentObject(e.eventContentId))&&(n=di(e.eventType),e.runAnimation=hl.call(e,t),e.destroy=function(){pi(e,n),e.registers=null,e.runAnimation=null},hi({eventRun:function(){e.runAnimation()},eventHandler:function(t,i){e.eventReference=t,e.eventHandler=i},eventContext:i.$contentNode,eventName:n,parameter:e.dragdropPara,target:null,domMode:!0}))}),t.divertorHooks.registerEvent=e})};gi.prototype={add:function(t){this._group?this._group.push(t):this._group=[t]},get:function(){return this._group},isExist:function(){return this._group.length},specified:function(t){for(var e=void 0,i=this._group.length;i;)if(i--,(e=this._group[i])&&e.type===t.type&&e.id===t.id)return e},remove:function(){this._group=[]},reset:function(){this.remove()}};var fl=function(t){return Xut.data.chapterSection["seasonId->"+t]},vl=function(t){var e=t.length,i=void 0,n=void 0,a=Xut.data.Chapter;if(e){for(var o=[];e--;)n=t[e],(i=a.item(n))&&o.unshift(i);return o}return a.item(t)},gl=function(t,e){var i=t.pptMaster,n=Xut.data.query("Master",i);bl(n,function(t,i){e(n,t,i)})},ml=function(t){if(t&&t.length){var e=void 0,i=[];return t.forEach(function(t,n){t.autoPlay&&"Content"!==t.actType&&(e={id:t._id,actType:t.actType,category:t.category,autoPlay:t.autoPlay},i.push(e))}),i.length&&i}},yl=function(t,e){t.note&&e.push(t)},bl=function(t,e){t||e();var i=[],n=t._id;Xut.data.query("Activity",n,"chapterId",function(t){i.push(t)}),yl(t,i);var a=ml(i);e(i,a)},xl=function(t,e){bl(t,function(i,n){e(t,i,n)})},wl=function(t,e){var i=t.pageIndex,n=t.pageData;n?xl(n,e):vl(i,function(t){xl(t.length?t[0]:t,e)})},kl=function(t){var e=t.base,i=t.prefix,n=t.translate,a=t.customStyle,o=(t.pageData,t.background),r=e.getStyle,s=n?Xut.style.transform+":"+n:"";return String.styleFormat('<li id="'+i+'"\n         data-type="'+e.pageType+'"\n         data-chapter-index="'+e.chapterIndex+'"\n         data-container="true"\n         class="xut-flip preserve-3d"\n         style="width:'+r.visualWidth+"px;\n                height:"+r.visualHeight+"px;\n                left:"+r.visualLeft+"px;\n                top:"+r.visualTop+"px;\n                "+s+";\n                "+o+"\n                "+a+'">\n        <div class="page-scale">\n            <div data-type="main-content"></div>\n            <div data-type="header-footer"></div>\n        </div>\n    </li>')},_l=function(t,e,i,n){var a="";/.svg$/i.test(e.md5)||(a="background-image:url("+tt(e.md5,"container-bg")+");");var o="",r=i.userStyle;return void 0!==r&&_.each(r,function(t,e){o+=e+":"+t+";"}),$(kl({base:t,prefix:n,translate:i.translate,customStyle:o,pageData:e,background:a}))},Il=function(t,e,i){var n=void 0,a=Xut.View.GetPageNodeIdName(t.pageType,t.pageIndex,t.chapterId),o=t.getStyle;if(Xut.IBooks.runMode())return n=$("#"+a),void i(n,void 0);n=_l(t,e,o,a),Xut.nextTick({container:t.rootNode,content:n,position:"left"===o.position||"top"===o.position?"first":"last"},function(){i(n,void 0)})},Pl=function(){function t(e){fo(this,t),this.$$detector=e,this.$$suspendQueues=[],this._$$initFloat()}return vo(t,[{key:"_$$initFloat",value:function(){var t=this;this.$$floatDivertor={},_.each(["page","master"],function(e){t.$$floatDivertor[e]={ids:[],html:[],zIndex:{},container:null}})}},{key:"_$$createFloatLayer",value:function(t,e,i){var n=this,a=this.$$floatDivertor.page,o=this.$$floatDivertor.master,r=function(t){t.html.length&&(t.html=null)};(a.ids.length||a.html.length)&&xi("page",e,a,i,function(e){a.container=e,n.pageBaseHooks.floatPages(a),r(a),t()}),(o.ids.length||o.html.length)&&xi("master",e,o,i,function(e){o.container=e,n.pageBaseHooks.floatMasters(o),r(o),t()})}},{key:"_$$checkNextTask",value:function(t,e,i){var n=this,a=function(){n.$$suspendQueues.push(function(){e()})};this.$$detector&&this.$$detector({suspendTask:a,nextTask:e,interrupt:i,taskName:t})}},{key:"rerunTask",value:function(){if(this.$$suspendQueues&&this.$$suspendQueues.length){var t=void 0;(t=this.$$suspendQueues.pop())&&t(),this.$$suspendQueues=[]}}},{key:"destroy",value:function(){this._destroy&&this._destroy(),this.$$detector=null,this.$$suspendQueues=null}}]),t}(),Tl=Xut.style.maskBoxImage,Sl=function(t){var e=No.proportion;t.imageWidth&&(t.imageWidth=t.imageWidth*e.width),t.imageHeight&&(t.imageHeight=t.imageHeight*e.height),t.imageLeft&&(t.imageLeft=t.imageLeft*e.left),t.imageTop&&(t.imageTop=t.imageTop*e.top)},Cl=function(t){var e=void 0;switch(Number(t)){case 1:e="background-position:0";break;case 2:e="background-position:"+No.screenSize.width+"px"}return e},$l=function(t,e){/.svg$/i.test(t)?lt(t,function(t){e(t)}):e("")},Ml=function(t){function e(t,i,n,a){fo(this,e);var o=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a)),r=o,s=t.md5;return o.success=n,Xut.IBooks.runMode()?(n(),yo(o)):($l(s,function(e){e=ot(e);var a=wi(e,t);a?(e=null,r._checkNextTask($(a),i)):n()}),o)}return mo(e,t),vo(e,[{key:"_checkNextTask",value:function(t,e){var i=this;this._$$checkNextTask("内部background",function(){i._render(t,e)})}},{key:"_render",value:function(t,e){var i=this;Xut.nextTick({content:t,container:e},function(){i.destroy(),i.success()})}}]),e}(Pl),Xl=function(){function t(e){fo(this,t),this.contentId=e,this.queueLength=0,this.queueIndex=0,this.fxQueue=[]}return vo(t,[{key:"_makeFn",value:function(t,e){var i=new TextFx(t);return function(t){i.show("fx"+e,t)}}},{key:"addQueue",value:function(t,e){this.queueLength++,this.fxQueue.push("fx"+e,new TextFx(t))}},{key:"_animate",value:function(t){var e=this,i=this.fxQueue[this.queueIndex],n=this.fxQueue[++this.queueIndex];i&&n&&n[t](i,function(){++e.queueIndex,e._animate(t)})}},{key:"play",value:function(){this.queueIndex=0,this._animate("show")}},{key:"stop",value:function(){}},{key:"destroy",value:function(){}}]),t}(),Nl=document.documentElement,Bl=void 0;try{Bl=parseInt(getComputedStyle(Nl).fontSize)}catch(t){Bl=16}var Dl,Al=void 0,El={"rgb(255, 255, 255)":!0,"#ffffff":!0,"#FFFFFF":!0,"#fff":!0,"#FFF":!0},Ol=["1","1.5","2.0"],Hl=function(){return Al=Bl*No.proportion.width,[Math.floor(1.5*Al),Math.floor(2*Al),Math.floor(2.5*Al)]},Rl=function(){function t(e,i){fo(this,t),this.contentId=e,this.$contentNode=i;var n=this,a=function(t,e){n.eventReference=t,n.eventHandler=e};hi({eventRun:function(){Xut.View.HideToolBar("pageNumber"),n._init(e,i)},eventHandler:a,eventContext:i,eventName:"tap",domMode:!0})}return vo(t,[{key:"_init",value:function(t,e){var i=this;i._adjustColor();var n=e.find(">").html();n=n.replace(/translate\(0px, -\d+px\)/g,"translate(0px,0px)");var a="htmlbox-iscroll-"+t;this.storageName=a+No.data.appId;var o=Hl(),r=o[2]+2,s=Math.floor(r/2),c=W(this.storageName);c?this._adjustSize(c):this._adjustSize(Al),this.$htmlbox=$(Ti(r,Pi(o),a,n)),e.after(this.$htmlbox),document.styleSheets[0].addRule(".htmlbox_close::before","top:"+s+"px"),document.styleSheets[0].insertRule(".htmlbox_close::before { top:"+s+"px }",0),document.styleSheets[0].addRule(".htmlbox_close::after","top:"+s+"px"),document.styleSheets[0].insertRule(".htmlbox_close::after { top:"+s+"px }",0),this._relocateToolbar(a),this._createIscroll(this.$htmlbox,a),this.eventContext=this.$htmlbox.find(".htmlbox-toolbar")[0];var l=function(t){i._adjustSize(t*Al,!0),i.iscroll&&i.iscroll.refresh()},u=function(){i._restoreColor(),i._adjustSize(Bl),i.removeBox(),Xut.View.ShowToolBar("pageNumber")},d={htmlbox_close_container:u,htmlbox_close:u,htmlbox_small:function(){l(Ol[0])},htmlbox_middle:function(){l(Ol[1])},htmlbox_big:function(){l(Ol[2])}};T(this.eventContext,{start:function(t){var e=t.target.className;d[e]&&d[e]()}})}},{key:"_adjustColor",value:function(){this.textLabelArray=["p","span"];var t=this;_.each(t.textLabelArray,function(e){_.each(t.$contentNode.find(e),function(t){var e=getComputedStyle(t).color;El.hasOwnProperty(e)&&(t.hasFormerColor=!0,t.style.color="black")})})}},{key:"_adjustSize",value:function(t,e){t=parseInt(t),Nl.style.fontSize=t+"px",e&&z(this.storageName,t)}},{key:"_restoreColor",value:function(){var t=this;_.each(t.textLabelArray,function(e){_.each(t.$contentNode.find(e),function(t){t.hasFormerColor&&(t.style.color="white",t.hasFormerColor=!1)})})}},{key:"_relocateToolbar",value:function(t){var e=No.visualSize,i=e.overflowWidth&&Math.abs(e.left)||0,n=e.overflowHeight&&Math.abs(e.top)||0;this.$htmlbox[0].style.cssText+="margin-top:"+n+"px",document.styleSheets[0].addRule(".htmlbox_close::before","left:2%"),document.styleSheets[0].insertRule(".htmlbox_close::before { left:2% }",0),document.styleSheets[0].addRule(".htmlbox_close::after","left:2%"),document.styleSheets[0].insertRule(".htmlbox_close::after { left:2% }",0);var a=window.getComputedStyle(this.$htmlbox.find(".htmlbox_close")[0],"::before").getPropertyValue("left"),o=parseInt(a)+i;document.styleSheets[0].addRule(".htmlbox_close::before","left:"+o+"px"),document.styleSheets[0].insertRule(".htmlbox_close::before { left:"+o+"px }",0),document.styleSheets[0].addRule(".htmlbox_close::after","left:"+o+"px"),document.styleSheets[0].insertRule(".htmlbox_close::after { left:"+o+"px }",0),this.$htmlbox.find(".htmlbox_fontsizeUl")[0].style.cssText+="margin-right:"+i+"px",this.$htmlbox.find("."+t)[0].style.cssText+="margin-left:"+i+"px;";var r=window.getComputedStyle(this.$htmlbox.find("."+t)[0]).getPropertyValue("width"),s=parseInt(r)-2*i;this.$htmlbox.find("."+t).width(s)}},{key:"_createIscroll",value:function(t,e){var i=t.find("."+e+" >ul").css("height"),n=t.find("."+e).css("height");parseInt(i)>parseInt(n)&&(this.iscroll=Ii("."+e,{scrollbars:"custom",fadeScrollbars:!0}))}},{key:"removeBox",value:function(){this.eventContext&&(S(this.eventContext),this.eventContext=null),this.$htmlbox&&this.$htmlbox.remove(),this.iscroll&&(this.iscroll.destroy(),this.iscroll=null)}},{key:"destroy",value:function(){_.each(this.eventReference,function(t){t("tap")}),this.removeBox()}}]),t}(),Ll={hide:"images/icons/arrowDown.svg"},Fl=parseInt($("body").css("font-size"))||16;Si.prototype.init=function(){var t=this.createBookMark(),e=this;this.parent.append(t),this.bookMarkMenu=t.eq(0),setTimeout(function(){e.restore()},20),Dl=this.getHistory(),T(this.parent,{end:this,cancel:this})},Si.prototype.createBookMark=function(){var t=Xut.config.visualSize.height,e=3*Fl,i='<div class="xut-bookmark-menu" style="width:100%;height:{0}px;left:0;top:{1}px;"><div class="xut-bookmark-wrap"><div class="xut-bookmark-add">加入书签</div><div class="xut-bookmark-off" style="background-image:url({2})"></div><div class="xut-bookmark-view">书签记录</div></div></div><div class="xut-bookmark-list" style="display:none;width:100%;height:{3}px;"><ul class="xut-bookmark-head"><li class="xut-bookmark-back">返回</li><li>书签</li></ul><ul class="xut-bookmark-body"></ul></div>';return i=String.format(i,e,t,Ll.hide,t),this.markHeight=e,$(i)},Si.prototype.createMarkList=function(){var t,e,i,n="",a=this;return _.each(Dl,function(o){t=o.split("-"),e=t[0],i=t[1],o=a.getMarkId(e,i),n+='<li><a data-mark="'+o+'" class="xut-bookmark-id" href="javascript:0">第'+i+'页</a><a class="xut-bookmark-del" data-mark="'+o+'" href="javascript:0">X</a></li>'}),n},Si.prototype.getMarkId=function(t,e){return t+"-"+e},Si.prototype.getHistory=function(){var t=W("bookMark");return t?t.split(","):[]},Si.prototype.addBookMark=function(){var t;this.updatePageInfo(),t=this.getMarkId(this.seasonId,this.pageId),Dl.indexOf(t)>-1||(Dl.push(t),z("bookMark",Dl))},Si.prototype.updatePageInfo=function(){var t=Xut.Presentation.GetPageData();this.pageId=t._id,this.seasonId=t.seasonId},Si.prototype.delBookMark=function(t){if(t&&t.dataset){var e=t.dataset.mark,i=Dl.indexOf(e);Dl.splice(i,1),z("bookMark",Dl),0==Dl.length&&j("bookMark"),$(t).parent().remove()}},Si.prototype.viewBookMark=function(t){var e,i=this.createMarkList();e=this.bookMarkList?this.bookMarkList:$(t).parent().parent().next(),e.find(".xut-bookmark-body").html(i),this.bookMarkList=e,e.fadeIn()},Si.prototype.iconManager=function(t){var e=this.bookMarkIcon=$(t),i=this.iconRestore;e.css({transform:"scale(1.2)","transition-duration":"500ms"})[0].addEventListener(Xut.style.transitionEnd,i.bind(this),!1)},Si.prototype.iconRestore=function(){this.bookMarkIcon.css("transform","")},Si.prototype.goBookMark=function(t){if(t&&t.dataset){var e=t.dataset.mark.split("-"),i=Number(e[0]),n=Number(e[1]);this.updatePageInfo(),this.backBookMark(),this.pageId==n&&this.seasonId==i||Xut.View.LoadScenario({seasonId:i,chapterId:n})}},Si.prototype.backBookMark=function(){this.bookMarkList.fadeOut()},Si.prototype.handleEvent=function(t){var e=t.target;switch(e.className){case"xut-bookmark-add":this.addBookMark(),this.iconManager(e);break;case"xut-bookmark-view":this.viewBookMark(e),this.iconManager(e);break;case"xut-bookmark-off":this.closeBookMark(e);break;case"xut-bookmark-back":this.backBookMark();break;case"xut-bookmark-del":this.delBookMark(e);break;case"xut-bookmark-id":this.goBookMark(e)}},Si.prototype.closeBookMark=function(){Xut.style.setTranslate({node:this.bookMarkMenu,speed:1e3})},Si.prototype.restore=function(){Xut.style.setTranslate({y:-this.markHeight,node:this.bookMarkMenu,speed:1e3})},Si.prototype.destroy=function(){S(this.parent),this.bookMarkMenu&&(this.bookMarkMenu.remove(),this.bookMarkMenu=null),this.bookMarkList&&(this.bookMarkList.remove(),this.bookMarkList=null),this.bookMarkIcon&&(this.bookMarkIcon[0].removeEventListener(Xut.plat.transitionEnd,this.iconRestore,!1),this.bookMarkIcon=null),this.parent=null};var Gl={search:"images/icons/search.svg",clear:"images/icons/clear.svg",exit:"images/icons/exit.svg"};Ci.prototype.init=function(){var t=this.searchForm(),e=this.parent[0];this.parent.append(t),this.searchBox=t,this.resultBox=t.find(".xut-search-result"),this.input=t.find(".xut-search-input"),this.searchBtn=t.find(".xut-search-btn"),T(e,{end:this,cancel:this}),e.addEventListener("keyup",this,!1)},Ci.prototype.searchForm=function(){var t=.3*window.innerWidth,e=window.innerHeight,i=this.tips||"请在搜索框中输入要搜索的关键字",n='<div class="xut-form-search"><div class="xut-form-search-wrap"><div style="height:17%;"><div style="height:20%"></div><div class="xut-search-row"><input type="text" class="xut-search-input"><div class="xut-search-btn" style="background-image: url('+Gl.search+')"></div></div><p class="xut-search-tips" style="line-height:'+Math.round(.06*e)+'px">'+i+'</p></div><div style="height:76%"><ul class="xut-search-result"></ul></div><div style="height:7%"><div class="xut-search-exit" style="background-image: url('+Gl.exit+')"></div></div></div></div>',a=$(n);return a.css("width",t<200?200:t),a},Ci.prototype.search=function(t){var e,i,n,a=Xut.data.Chapter,o=a.length,r="";if(!t)return void this.resultBox.html("");for(var s=0;s<o;s++)e=a.item(s),e.chapterTitle.indexOf(t)>-1&&(i=e._id,n=e.seasonId,r+='<li><a class="xut-search-link" data-mark="'+n+"-"+i+'" href="javascript:0">'+e.chapterTitle+"</a></li>");this.resultBox.html(r)},Ci.prototype.iconManager=function(t){this.isChange&&this.searchBtn.css("background-image","url("+t+")")},Ci.prototype.searchLink=function(t){if(t&&t.dataset){var e=t.dataset.mark.split("-"),i=e[0],n=e[1];Xut.View.LoadScenario({seasonId:i,chapterId:n})}},Ci.prototype.handleEvent=function(t){var e=t.target;switch(e.className){case"xut-search-btn":this.search(this.input.val()),this.isChange=!0,this.iconManager(Gl.clear);break;case"xut-search-input":this.search(e.value),this.iconManager(Gl.search),this.isChange=!1;break;case"xut-search-exit":this.exit();break;case"xut-search-link":this.searchLink(e)}},Ci.prototype.exit=function(){this.input.val(""),this.resultBox.empty(),this.searchBox.hide()},Ci.prototype.restore=function(){var t=this.searchBox;t&&t.show()},Ci.prototype.destroy=function(){var t=this.parent[0];S(t),t.removeEventListener("keyup",this,!1),this.searchBox.remove(),this.searchBox=null,this.resultBox=null,this.searchBtn=null,this.input=null,this.parent=null};var zl=function(){function t(e,i){fo(this,t),this.data=e,"seniorSprite"==i.type&&(this.contentPrefix=i.contentPrefix,this.obj=$("#"+this.contentPrefix+this.data.framId),this.resourcePath=i.resourcePath),"autoSprite"===i.type&&(this.contentId=i.contentId,this.obj=$(i.ele),this.resourcePath=tt(i.resourcePath,"autoSprite")+"/"),this.curFPS=0,this.loop=1,this.resetCount=0;var n=this.data.params,a=this.action=n.actList.split(",")[0],o=n[a];this.FPS=parseInt(o.fps),this.playerType=o.playerType,this.isSports=parseInt(o.isSports),this.originalImageList=o.ImageList;var r=No.launch.brModelType;r&&_.each(this.originalImageList,function(t){t.name&&(t.name=t.name.replace(/.png|.jpg/,r))}),this.totalFPS=this.originalImageList.length,this._imgArray=[],this.sprObj=null,"loop"==this.playerType&&(this.loop="loop"),this._init()}return vo(t,[{key:"_init",value:function(){this._initImage(),this.isSports&&this._initPosition(),this._initStructure()}},{key:"_checkNextAction",value:function(t){this._initImageState?t():(this._waitTask=[],this._waitTask.push(t))}},{key:"_initPosition",value:function(){var t=this.obj,e=this.data.params,i=this.action;this.startPoint={x:this.originalImageList[0].X,y:this.originalImageList[0].Y,w:parseInt(e[i].width),h:parseInt(e[i].height)},this.xRote=parseInt(t.css("width"))/this.startPoint.w,this.yRote=parseInt(t.css("height"))/this.startPoint.h}},{key:"_initImage",value:function(){var t=this,e=0,i=this.qualified=this.totalFPS>=10?10:this.totalFPS,n=function(){return function(){1==i?(t._initImageState=!0,t._waitTask&&t._waitTask.length&&t._waitTask.pop()()):i--}}();for(e;e<this.qualified;e++)this._preloadImage(e,n)}},{key:"_initStructure",value:function(){var t=this.resourcePath+this.originalImageList[0].name,e=void 0;e=Xut.plat.isIOS?"<img src="+t+' class="inherit-size fullscreen-background" style="position:absolute;"/>':'<div class="inherit-size fullscreen-background"\n                            style="position:absolute;background-image: url('+t+');"></div>';var i=$(String.styleFormat(e));this.sprObj=i[0],this.obj.html(this.sprObj)}},{key:"_getFilename",value:function(t){return t.substr(0,t.indexOf("."))}},{key:"_preloadImage",value:function(t,e){if(!(t>=this.totalFPS)){var i=this,n=function(){i._imgArray&&i._imgArray.push(this),e&&e()},a=this.originalImageList;A(this.resourcePath+a[t].name,n)}}},{key:"_changePosition",value:function(){var t=this.originalImageList,e=t[this.curFPS],i=e.X-this.startPoint.x,n=e.Y-this.startPoint.y;return{left:i*this.xRote,top:n*this.yRote}}},{key:"_changeImage",value:function(){var t=this.originalImageList,e=t[this.curFPS],i=this.resourcePath;if(0===this.resetCount&&this._preloadImage(this.curFPS+this.qualified),this.isSports){var n=this._changePosition();Xut.style.setTranslate({node:this.sprObj,x:n.left,y:n.top})}Xut.plat.isIOS?this.sprObj.setAttribute("src",i+e.name):this.sprObj.style.backgroundImage="url("+(i+e.name)+")"}},{key:"_change",value:function(){this.originalImageList&&this._changeImage()}},{key:"_time",value:function(){var t=this;this.timer=setTimeout(function(){clearTimeout(t.timer),t.timer=null,t._change(),t.curFPS++,t._set()},1e3/this.FPS)}},{key:"_set",value:function(){var t=this;if(this.curFPS>=this.totalFPS&&(this.curFPS=0,this.resetCount++),"loop"!==this.loop&&this.loop==this.resetCount)return void this._stop();this._checkNextAction(function(){t._time()})}},{key:"_stop",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.curFPS=0,this.resetCount=0}},{key:"play",value:function(t,e){if(this.action=t,!this.data.params[t])return void console.log(" Function changeSwitchAni  parameters "+t+" error");e&&(this.loop=e),this._stop(),this._set()}},{key:"stop",value:function(){this._stop()}},{key:"destroy",value:function(){this._stop(),this.obj=null,this.sprObj=null,this.data.params=null,this.data=null,this._imgArray.forEach(function(t){null}),this.originalImageList=null,this._imgArray=null}}]),t}(),Wl={},jl=function(t,e){var i=void 0,n=No.getWidgetPath()+"gallery/"+t.id+"/",a=new XMLHttpRequest;a.open("GET",n+"app.json",!1),a.send(null);try{i=m(a.responseText)}catch(t){console.log("app.json get error:"+t)}return i},Vl=function(t,e,i){var n=$("#"+t+e),a=$("#"+t+i),o=$("#spirit_parent_"+i);0==o.length&&a.append("<div style='position:absolute; width:100%; height:100%'  id='spirit_parent_"+i+"'></div>"),o.append(n)},Yl=function(t,e){return _.isObject(t)?e+t.framId:t},Ul=function(t,e){var i=jl(t),n=No.getWidgetPath()+"gallery/"+t.id+"/",a=t.contentPrefix,o=[],r={};if(r.contentPrefix=a,r.resourcePath=n,r.type="seniorSprite",i.spiritList)for(var s=0;s<i.spiritList.length;s++){var c=i.spiritList[s],l=Yl(c,a),u=c.framId,d=c.parentId;_.isObject(t)?("0"!=d&&Vl(a,u,d),Wl[l]=new zl(c,r),o.push(l)):console.log("inputPara undefine Spirit")}else console.log("没有高级精灵动画数据");return{stop:function(){o.forEach(function(t){Wl[t].stop()})},destroy:function(){o.forEach(function(t){Wl[t]&&(Wl[t].destroy(),Wl[t]=null,delete Wl[t])})}}},ql=Xut.style.filter,Kl=Math.ceil,Ql=Math.pow,Zl=/^#[0-9a-fA-F]{3,6}$/,Jl=Xut.plat.hasTouch,tu=function(){function t(e,i,n,a,o,r){if(fo(this,t),this.hasTouch=Jl,this.parent=document.getElementById(i),this.scroller=document.getElementById(n),this.startCallback=a,this.moveCallback=o,this.endCallback=r,null==this.scroller)return void console.error("The control area of the object is empty.");Xut.Contents.ResetDefaultControl&&Xut.Contents.ResetDefaultControl(e,i),this.scroller.bindMoveMent&&this.scroller.bindMoveMent.destroy(),T(this.scroller,{start:this}),this.scroller.bindMoveMent=this}return vo(t,[{key:"handleEvent",value:function(t){C({start:function(t){this._start(t)},move:function(t){this._move(t)},end:function(t){this._end(t)},cancel:function(t){this._end(t)}},this,t)}},{key:"_start",value:function(t){t.preventDefault(),"function"==typeof this.startCallback&&this.startCallback(t),T(this.scroller,{move:this,end:this,cancel:this})}},{key:"_move",value:function(t){"function"==typeof this.moveCallback&&this.moveCallback(t)}},{key:"_end",value:function(t){S(this.scroller),"function"==typeof this.endCallback&&this.endCallback(t)}},{key:"destroy",value:function(t,e,i){S(this.scroller),this.scroller=null}}]),t}(),eu=Xut.plat.hasTouch,iu=Xut.style.transformOrigin,nu=Xut.style.filter,au=Math.round,ou=Math.ceil,ru=Xut.plat.isMacOS,su=Xut.plat.isDesktop,cu=function(){function t(e,i,n,a,o,r,s){if(fo(this,t),!_.isArray(o)||!o.length)return void console.log("Animation options error is not Array.");this.options=o,this.visualWidth=s.visualWidth,this.visualHeight=s.visualHeight,this.container=r||$(document.body),this.isDebug=!1,this.pageIndex=e,this.pageType=i,this.chapterId=n,this.element=a,this.elementStyle="",this.elementVisibility="visible",this.useMask=!(!su&&!ru),this.parameter0=null,this.isExit0=!1,this.preCode="",this.postCode="",this.codeDelay=0,this.isCompleted=!1,this._initElement()}return vo(t,[{key:"_parseCode",value:function(t,e){return t&&t.length>0?b(t):e&&e.length>0?b(e):void 0}},{key:"_parseDelayCode",value:function(t,e){return t&&t.length>0?t:e&&e.length>0?e:void 0}},{key:"_initElement",value:function(){var t=this.options[0];if(this.parameter0=m(t.parameter),this.parameter0.pageType=this.pageType,this.parameter0.pageIndex=this.pageIndex,this.isExit0=!!this.parameter0.exit&&"true"==this.parameter0.exit.toLowerCase(),this.preCode=this._parseCode(t.preCode,this.parameter0.preCode),this.postCode=this._parseCode(t.postCode,this.parameter0.postCode),this.codeDelay=this._parseDelayCode(t.codeDelay,this.parameter0.codeDelay),!this.element.attr("data-pptAnimation")){var e=t.animationName;if(0==e.indexOf("EffectPath")||"EffectCustom"==e)this.element.css("visibility","visible");else switch(e){case"EffectFlashBulb":case"EffectFlicker":case"EffectTeeter":case"EffectSpin":case"EffectGrowShrink":case"EffectDesaturate":case"EffectDarken":case"EffectLighten":case"EffectTransparency":case"EffectColorBlend":case"EffectComplementaryColor":case"EffectChangeLineColor":case"EffectChangeFillColor":case"EffectFlashOnce":this.element.css("visibility","visible");break;case"EffectCredits":this.element.css("visibility","hidden");break;default:this.isExit0?this.element.css("visibility","visible"):this.element.css("visibility","hidden")}this.element.attr("data-pptAnimation",!0),this.elementStyle=this.element[0].style.cssText,this.elementVisibility=this.element.css("visibility")}}},{key:"_getObjectInfo",value:function(t){var e=au(t.width()),i=au(t.height()),n=au(parseInt(t.css("top"))),a=au(parseInt(t.css("left"))),o=au(t.offset().top);t.attr("offsetTop")?o=parseInt(t.attr("offsetTop")):t.attr("offsetTop",o);var r=ou(this.visualHeight-o-i),s=au(t.offset().left);return t.attr("offsetLeft")?s=parseInt(t.attr("offsetLeft")):t.attr("offsetLeft",s),{width:e,height:i,top:n,left:a,offsetTop:o,offsetLeft:s,offsetBottom:r,offsetRight:ou(this.visualWidth-s-e)}}},{key:"_startHandler",value:function(t,e,i){for(var n in i)switch(n){case"x":TweenLite.set(e,{x:i[n]});break;case"y":TweenLite.set(e,{y:i[n]});break;case"rotation":TweenLite.set(e,{rotation:i[n]});break;case"rotationX":TweenLite.set(e,{rotationX:i[n]});break;case"rotationY":TweenLite.set(e,{rotationY:i[n]});break;case"scale":TweenLite.set(e,{scale:i[n]});break;default:e.css(n,i[n])}if(t.videoId>0&&De(t.chapterId,t.videoId),t.pptanimation&&t.pptanimation.pptapi){var i=t.pptanimation.parameters?t.pptanimation.parameters:{};switch(t.pptanimation.pptapi){case"bonesWidget":bonesWidget.updateAction(e.attr("id"),i.actList);break;case"spiritWidget":$i(e.attr("id"),i)}}}},{key:"_completeHandler",value:function(t,e,i){for(var n in i)switch(n){case"x":TweenLite.set(e,{x:i[n]});break;case"y":TweenLite.set(e,{y:i[n]});break;case"rotation":TweenLite.set(e,{rotation:i[n]});break;case"rotationX":TweenLite.set(e,{rotationX:i[n]});break;case"rotationY":TweenLite.set(e,{rotationY:i[n]});break;case"scale":TweenLite.set(e,{scale:i[n]});break;default:e.css(n,i[n])}}},{key:"_getTimeline",value:function(t,e){var i=this.element,n=this.parameter0,a=this.isExit0;(e>0||null==this.parameter0)&&(n=m(t.parameter),a=!!n.exit&&"true"==n.exit.toLowerCase(),0==e&&(this.parameter0=n,this.isExit0=a));var o=t.speed/1e3,r=t.delay/1e3;navigator.epubReadingSystem&&(r+=.15);var s=t.repeat>=0?t.repeat-1:0;n.pageType=this.pageType,n.chapterId=this.chapterId,n.animationName=t.animationName,n.videoId=t.videoId;var c=n.animationName;if("xxtTextEffect"==c)return this.getTextAnimation(n,i,o,r,s);if(0==c.indexOf("EffectPath")||"EffectCustom"==c)return this.getPathAnimation(n,i,o,r,s);switch(c){case"EffectFade":return this.getEffectFade(n,i,a,o,r,s);case"EffectFly":return this.getEffectFly(n,i,a,o,r,s);case"EffectAscend":return this.getEffectAscend(n,i,a,o,r,s);case"EffectDescend":return this.getEffectDescend(n,i,a,o,r,s);case"EffectSplit":return this.getEffectSplit(n,i,a,o,r,s);case"EffectWipe":return this.getEffectWipe(n,i,a,o,r,s);case"EffectCircle":return this.getEffectCircle(n,i,a,o,r,s);case"EffectBox":return this.getEffectBox(n,i,a,o,r,s);case"EffectDiamond":return this.getEffectDiamond(n,i,a,o,r,s);case"EffectPlus":return this.getEffectPlus(n,i,a,o,r,s);case"EffectGrowAndTurn":return this.getEffectGrowAndTurn(n,i,a,o,r,s);case"EffectZoom":return this.getEffectZoom(n,i,a,o,r,s);case"EffectFadedZoom":return this.getEffectFadedZoom(n,i,a,o,r,s);case"EffectSwivel":return this.getEffectSwivel(n,i,a,o,r,s);case"EffectFadedSwivel":return this.getEffectFadedSwivel(n,i,a,o,r,s);case"EffectBounce":return this.getEffectBounce(n,i,a,o,r,s);case"EffectBlinds":return this.getEffectBlinds(n,i,a,o,r,s);case"EffectPeek":return this.getEffectPeek(n,i,a,o,r,s);case"EffectExpand":return this.getEffectExpand(n,i,a,o,r,s);case"EffectRiseUp":return this.getEffectRiseUp(n,i,a,o,r,s);case"EffectCenterRevolve":return this.getEffectCenterRevolve(n,i,a,o,r,s);case"EffectSpinner":return this.getEffectSpinner(n,i,a,o,r,s);case"EffectFloat":return this.getEffectFloat(n,i,a,o,r,s);case"EffectSpiral":return this.getEffectSpiral(n,i,a,o,r,s);case"EffectPinwheel":return this.getEffectPinwheel(n,i,a,o,r,s);case"EffectCredits":return this.getEffectCredits(n,i,a,o,r,s);case"EffectBoomerang":return this.getEffectBoomerang(n,i,a,o,r,s)
;case"EffectArcUp":return this.getEffectArcUp(n,i,a,o,r,s);case"EffectFlashBulb":return this.getEffectFlashBulb(n,i,o,r,s);case"EffectFlicker":return this.getEffectFlicker(n,i,o,r,s);case"EffectTeeter":return this.getEffectTeeter(n,i,o,r,s);case"EffectSpin":return this.getEffectSpin(n,i,o,r,s);case"EffectGrowShrink":return this.getEffectGrowShrink(n,i,o,r,s);case"EffectDesaturate":return this.getEffectDesaturate(n,i,o,r,s);case"EffectDarken":return this.getEffectDarken(n,i,o,r,s);case"EffectLighten":return this.getEffectLighten(n,i,o,r,s);case"EffectTransparency":return this.getEffectTransparency(n,i,o,r,s);case"EffectColorBlend":return new TimelineMax;case"EffectComplementaryColor":return this.getEffectComplementaryColor(n,i,o,r,s);case"EffectChangeLineColor":return new TimelineMax;case"EffectChangeFillColor":return new TimelineMax;case"EffectFlashOnce":return this.getEffectFlashOnce(n,i,o,r,s);default:case"EffectAppear":return this.getEffectAppear(n,i,a,o,r,s)}}},{key:"_initAnimation",value:function(t){for(var e=this,i=function(){t&&_.isFunction(t)&&t()},n=new TimelineLite({paused:!0,onStartParams:[this.preCode],onCompleteParams:[this.postCode,this.codeDelay],onStart:function(t){if(t&&_.isFunction(t)){e.animation.pause();var n=!1;try{n=t()}catch(t){console.log("Run preCode is error in startHandler:"+t)}1==n?e.animation.resume():(e.animation.stop(),i())}},onComplete:function(t,n){if(e.isCompleted=!0,t)try{_.isFunction(t)&&(n>0?setTimeout(t,n):t())}catch(t){console.log("Run postCode is error in completeHandler:"+t)}i()}}),a=0;a<this.options.length;a++)if(0==a)n.add(this._getTimeline(this.options[a],a),"shape0");else{var o=this.options[a].invokeMode;2==o?n.add(this._getTimeline(this.options[a],a)):n.add(this._getTimeline(this.options[a],a),"shape0")}return n}},{key:"play",value:function(t){this.isCompleted&&this.reset(),this.animation?(this.stop(),t&&t()):this.animation=this._initAnimation(t),this.animation.play()}},{key:"stop",value:function(){this.animation&&(this.animation.stop(),this.animation.kill(),this.animation.clear(),this.animation.vars=null),this.animation=null}},{key:"reset",value:function(){if(this.animation&&this.stop(),this.elementStyle&&this.elementStyle.length){var t=this.element.css(Xut.style.transformOrigin);null==this.element.attr("data-iscroll")&&(this.element[0].style.cssText=this.elementStyle),this.element.css(Xut.style.transformOrigin,t),this.element.css("visibility",this.elementVisibility),this.element.css(Xut.style.transform,"none"),this.element[0]._gsTransform=null}this.isCompleted=!1}},{key:"destroy",value:function(){this.stop(),this.container=null,this.options=null,this.element=null}}]),t}();!function(t){t.getEffectAppear=function(t,e,i,n,a,o){var r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]});return 0==i?r.to(e,.001,{autoAlpha:1}):r.to(e,.001,{css:{visibility:"hidden"}}),r},t.getEffectFade=function(t,e,i,n,a,o){var r=null;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,ease:t.tweenEase,immediateRender:!1})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1}]}),r.to(e,n,{autoAlpha:0,ease:t.tweenEase})),r},t.getEffectFlashOnce=function(t,e,i,n,a){var o=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r=i/3;return o.to(e,.001,{css:{visibility:"hidden"}}).to(e,2*r,{}).to(e,r,{css:{visibility:"visible"}}),o},t.getEffectDesaturate=function(t,e,i,n,a){function o(){var t=s.progress(),i=t<=.5?2*t:1,n=1+(r-1)*i;e.css(ql,"saturate("+n+")")}if(!(ql in e[0].style))return new TimelineMax;var r=t.saturation?t.saturation:.5,s=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{filter:"none"}]});return s.to(e,i,{onUpdate:o}),s},t.getEffectDarken=function(t,e,i,n,a){function o(){var t=s.progress(),i=t<=.5?2*t:1,n=1+(r-1)*i;e.css(ql,"brightness("+n+")")}if(!(ql in e[0].style))return new TimelineMax;var r=t.brightness&&t.brightness<1?r.saturation:.5,s=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{filter:"none"}]});return s.to(e,i,{onUpdate:o}),s},t.getEffectLighten=function(t,e,i,n,a){function o(){var t=s.progress(),i=t<=.5?2*t:1,n=1+(r-1)*i;e.css(ql,"brightness("+n+")")}if(!(ql in e[0].style))return new TimelineMax;var r=t.brightness&&t.brightness>1?t.brightness:1.5,s=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{filter:"none"}]});return s.to(e,i,{onUpdate:o}),s},t.getEffectTransparency=function(t,e,i,n,a){var o=t.amount?t.amount:.5,r=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]});return r.to(e,i,{autoAlpha:o,ease:t.tweenEase}),r}}(cu.prototype),function(t){t.getEffectFly=function(t,e,i,n,a,o){var r,s,c=t.direction,l=null,u=this._getObjectInfo(e),d=Expo.easeOut;if(t.tweenEase&&t.tweenEase.length>0&&(d=t.tweenEase),1!=t.smoothStart&&1!=t.smoothEnd&&1!=t.bounceEnd||(d=1==i?Power4.easeOut:Elastic.easeOut),0==i)switch(l=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e,{visibility:"visible"}]}),c){case"DirectionDown":s=Math.abs(u.offsetBottom+u.height),l.from(e,n,{y:s,ease:d,immediateRender:!1});break;case"DirectionLeft":r=-Math.abs(u.offsetLeft+u.width),l.from(e,n,{x:r,ease:d,immediateRender:!1});break;case"DirectionUp":s=-Math.abs(u.offsetTop+u.height),l.from(e,n,{y:s,ease:d,immediateRender:!1});break;case"DirectionRight":r=Math.abs(u.offsetRight+u.width),l.from(e,n,{x:r,ease:d,immediateRender:!1});break;case"DirectionDownLeft":r=-Math.abs(u.offsetLeft+u.width),s=u.offsetBottom+u.height,l.from(e,n,{x:r,y:s,ease:d,immediateRender:!1});break;case"DirectionDownRight":r=Math.abs(u.offsetRight+u.width),s=Math.abs(u.offsetBottom+u.height),l.from(e,n,{x:r,y:s,ease:d,immediateRender:!1});break;case"DirectionUpLeft":r=-Math.abs(u.offsetLeft+u.width),s=-Math.abs(u.offsetTop+u.height),l.from(e,n,{x:r,y:s,ease:d,immediateRender:!1});break;case"DirectionUpRight":r=Math.abs(u.offsetRight+u.width),s=-Math.abs(u.offsetTop+u.height),l.from(e,n,{x:r,y:s,ease:d,immediateRender:!1});break;default:console.log("getEffectFly:parameter error.")}else switch(l=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{x:0,y:0,visibility:"hidden"}]}),c){case"DirectionDown":s=Math.abs(u.offsetBottom+u.height),l.to(e,n,{y:s,ease:d});break;case"DirectionLeft":r=-Math.abs(u.offsetLeft+u.width),l.to(e,n,{x:r,ease:d});break;case"DirectionUp":s=-Math.abs(u.offsetTop+u.height),l.to(e,n,{y:s,ease:d});break;case"DirectionRight":r=Math.abs(u.offsetRight+u.width),l.to(e,n,{x:r,ease:d});break;case"DirectionDownLeft":r=-Math.abs(u.offsetLeft+u.width),s=u.offsetBottom+u.height,l.to(e,n,{x:r,y:s,ease:d});break;case"DirectionDownRight":r=Math.abs(u.offsetRight+u.width),s=Math.abs(u.offsetBottom+u.height),l.to(e,n,{x:r,y:s,ease:d});break;case"DirectionUpLeft":r=-Math.abs(u.offsetLeft+u.width),s=-Math.abs(u.offsetTop+u.height),l.to(e,n,{x:r,y:s,ease:d});break;case"DirectionUpRight":r=Math.abs(u.offsetRight+u.width),s=-Math.abs(u.offsetTop+u.height),l.to(e,n,{x:r,y:s,ease:d});break;default:console.log("getEffectFly:parameter error.")}return l},t.getEffectAscend=function(t,e,i,n,a,o){var r=null;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,y:100,ease:t.tweenEase,immediateRender:!1})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1,y:0}]}),r.to(e,n,{autoAlpha:0,y:100,ease:t.tweenEase})),r},t.getEffectDescend=function(t,e,i,n,a,o){var r=null;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,y:-100,ease:t.tweenEase,immediateRender:!1})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1}]}),r.to(e,n,{autoAlpha:0,y:-100,ease:t.tweenEase,clearProps:"y"})),r},t.getEffectPeek=function(t,e,i,n,a,o){var r=t.direction,s=null,c=this._getObjectInfo(e);if(0==i)switch(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r){case"DirectionUp":s.from(e,n,{y:-c.height,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionDown",c]});break;case"DirectionDown":s.from(e,n,{y:c.height,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionUp",c]});break;case"DirectionLeft":s.from(e,n,{x:-c.width,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionRight",c]});break;case"DirectionRight":s.from(e,n,{x:c.width,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionLeft",c]});break;default:console.log("getEffectPeek:parameter error.")}else switch(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r){case"DirectionUp":s.to(e,n,{y:-c.height,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionUp",c]});break;case"DirectionDown":s.to(e,n,{y:c.height,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionDown",c]});break;case"DirectionLeft":s.to(e,n,{x:-c.width,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionLeft",c]});break;case"DirectionRight":s.to(e,n,{x:c.width,ease:Linear.easeNone,onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,"DirectionRight",c]});break;default:console.log("getEffectPeek:parameter error.")}return s},t.getEffectSpiral=function(t,e,i,n,a,o){var r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),s=Power1.easeInOut;return t.tweenEase&&t.tweenEase.length>0&&(s=t.tweenEase),0==i?r.from(e,n,{scale:0,bezier:{type:"cubic",values:[{x:0,y:0},{x:200,y:-200},{x:0,y:-400},{x:-500,y:-600}]},ease:s}):r.to(e,n,{scale:0,bezier:{type:"cubic",values:[{x:0,y:0},{x:200,y:-200},{x:0,y:-400},{x:-500,y:-600}]},ease:s}),r},t.getEffectArcUp=function(t,e,i,n,a,o){var r=null,s=Power1.easeInOut;return t.tweenEase&&t.tweenEase.length>0&&(s=t.tweenEase),0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,scale:2,bezier:{type:"cubic",values:[{x:0,y:0},{x:200,y:200},{x:0,y:400},{x:-500,y:600}]},ease:s})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1,scale:1}]}),r.to(e,n,{autoAlpha:0,scale:2,bezier:{type:"cubic",values:[{x:0,y:0},{x:200,y:200},{x:0,y:400},{x:-500,y:600}]},ease:s,clearProps:"x,y"})),r},t.getEffectRiseUp=function(t,e,i,n,a,o){var r=null,s=this._getObjectInfo(e),c=s.offsetBottom+s.height,l=Back.easeInOut;return t.tweenEase&&t.tweenEase.length>0&&(l=t.tweenEase),0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,y:c,ease:l})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1}]}),r.to(e,n,{autoAlpha:0,y:c,ease:l})),r}}(cu.prototype),function(t){t.getPathAnimation=function(t,e,i,n,a){function o(t,e){_=t,I=e}function r(){if(0!=h){var t=x;x=e.offset(),""==w?x.left>t.left?w="left":x.left<t.left&&(w="right"):x.left>t.left?"right"==w&&(b=0==b?180:0,TweenLite.set(e.children(),{rotationY:b}),w="left"):x.left<t.left&&"left"==w&&(b=0==b?180:0,TweenLite.set(e.children(),{rotationY:b}),w="right")}}var s=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),c=t.path?t.path:"";if(!c||""==c)return s;var l=1==t.autoReverse,u=1==l?1:0,d=1==t.objFollow,h=2==t.objFollow,p=0,f=0,v=null;t.attrAlongPath&&(p=t.attrAlongPath.axis?t.attrAlongPath.axis:0,f=Math.abs(t.attrAlongPath.degree)>0?Number(t.attrAlongPath.degree):0,v=t.attrAlongPath.scaleFactor>0?t.attrAlongPath.scaleFactor:null);for(var g,m,y=0,b=0,x=e.offset(),w="",k={top:x.top,left:x.left,oX:x.left+e.width()/2,oY:x.top+e.height()/2},_=0,I=0,P=c.indexOf("C")<0&&c.indexOf("c")<0,T=c.split(" "),S="",C=[],$=0;$<T.length;$++)switch(T[$]){case"M":case"m":g=Math.round(T[$+1]*this.visualWidth),m=Math.round(T[$+2]*this.visualHeight),C.push({x:g,y:m}),$+=2,o(g,m),S+="M "+(k.oX+g)+" "+(k.oY+m);break;case"C":case"c":var M=0+Math.round(T[$+1]*this.visualWidth),X=0+Math.round(T[$+2]*this.visualHeight),N=0+Math.round(T[$+3]*this.visualWidth),B=0+Math.round(T[$+4]*this.visualHeight),D=0+Math.round(T[$+5]*this.visualWidth),A=0+Math.round(T[$+6]*this.visualHeight);C.push({x:M,y:X},{x:N,y:B},{x:D,y:A}),$+=6,o(D,A),S+=" C "+(k.oX+M)+" "+(k.oY+X)+" "+(k.oX+N)+" "+(k.oY+B)+" "+(k.oX+D)+" "+(k.oY+A);break;case"L":case"l":if(g=0+Math.round(T[$+1]*this.visualWidth),m=0+Math.round(T[$+2]*this.visualHeight),g==_&&m==I){$+=2;break}C.push({x:g,y:m}),$+=2,o(g,m),S+=" L "+(k.oX+g)+" "+(k.oY+m);break;case"Z":C[0].x==C[C.length-1].x&&C[0].y==C[C.length-1].y||C.push({x:C[0].x,y:C[0].y}),S+=" Z";break;case"E":}if(t.gesture){s=new TimelineMax({paused:!0,useFrames:!0}),t.tweenEase="Linear.easeNone";var E=e[0].id;1==t.gesture.controlType&&(E=t.pathContent>0?E.replace(/\d+$/,t.pathContent):"Cont_"+e[0].id);for(var O=0,H=[],R=1;R<C.length;R++)O+=Mi(C[R],C[R-1]),H.push({start:0,end:O,quadrant:Xi(C[R],C[R-1])});i=Math.floor(O);var L=[];if(t.gesture.cuePoints)for(var F=0;F<t.gesture.cuePoints.length;F++)L.push({cueStart:Math.floor(t.gesture.cuePoints[F].cueStart*i),cueEnd:Math.floor(t.gesture.cuePoints[F].cueEnd*i),valueStart:t.gesture.cuePoints[F].valueStart,valueEnd:t.gesture.cuePoints[F].valueEnd,mouseEnter:!1,mouseLeave:!1});var G=null,z=function(t){G={x:eu?t.changedTouches[0].pageX:t.clientX,y:eu?t.changedTouches[0].pageY:t.clientY}},W=function(){G=null,t.gesture.afterTouch>0&&Xut.Assist.Run(t.pageType,t.gesture.afterTouch,null)},j=function(e){var n,a={x:eu?e.changedTouches[0].pageX:e.clientX,y:eu?e.changedTouches[0].pageY:e.clientY},o=Mi(a,G),c=0;for(n=0;n<H.length;n++)if(y<=H[n].end){c=H[n].quadrant;break}var l=Xi(a,G);switch(c){case"1":case"2":"1"==l||"2"==l?y+=o:"3"==l||"4"==l?y-=o:"+x"==l||"-x"==l?y+=a.x-G.x:"1"!=c||"+y"!=l&&"-y"!=l?"2"!=c||"+y"!=l&&"-y"!=l||(y+=a.y-G.y):y-=a.y-G.y;break;case"3":case"4":"3"==l||"4"==l?y+=o:"1"==l||"2"==l?y-=o:"+x"==l||"-x"==l?y-=a.x-G.x:"3"!=c||"+y"!=l&&"-y"!=l?"4"!=c||"+y"!=l&&"-y"!=l||(y-=a.y-G.y):y+=a.y-G.y;break;case"+x":"1"==l||"2"==l?y+=o:"3"==l||"4"==l?y-=o:"+x"!=l&&"-x"!=l||(y+=a.x-G.x);break;case"-x":"1"==l||"2"==l?y-=o:"3"==l||"4"==l?y+=o:"+x"!=l&&"-x"!=l||(y-=a.x-G.x);break;case"+y":"1"==l||"4"==l?y-=o:"2"==l||"3"==l?y+=o:"+y"!=l&&"-y"!=l||(y+=a.y-G.y);break;case"-y":"1"==l||"4"==l?y+=o:"2"==l||"3"==l?y-=o:"+y"!=l&&"-y"!=l||(y-=a.y-G.y)}for(y<=0&&(y=0),y>=i&&(y=i),s.seek(y),r(),G=a,n=0;n<L.length;n++){if(0==L[n].mouseEnter&&y>=L[n].cueStart&&y<=L[n].cueEnd){L[n].mouseEnter=!0,L[n].mouseLeave=!1,L[n].valueStart>0&&Xut.Assist.Run(t.pageType,L[n].valueStart,null);break}if(1==L[n].mouseEnter&&0==L[n].mouseLeave&&(y<L[n].cueStart||y>L[n].cueEnd)){L[n].mouseEnter=!1,L[n].mouseLeave=!0,L[n].valueEnd>0&&Xut.Assist.Run(t.pageType,L[n].valueEnd,null);break}}},V=e[0].id;1==t.gesture.controlType&&(V=E),new tu(t.pageType,E,V,z,j,W)}var Y={type:"soft",values:C,autoRotate:d};if(1==P&&(Y={curviness:0,values:C,autoRotate:d}),0==f)s.to(e,i,{scale:v,bezier:Y,repeat:u,yoyo:l,onUpdate:r,ease:t.tweenEase});else switch(p){default:case 0:s.to(e,i,{scale:v,rotation:f+"deg",bezier:Y,repeat:u,yoyo:l,onUpdate:r,ease:t.tweenEase});break;case 1:s.to(e,i,{scale:v,rotationX:f+"deg",bezier:Y,repeat:u,yoyo:l,onUpdate:r,ease:t.tweenEase});break;case 2:s.to(e,i,{scale:v,rotationY:f+"deg",bezier:Y,repeat:u,yoyo:l,onUpdate:r,ease:t.tweenEase})}return t.gesture&&t.gesture.initPos>0&&(y=i*t.gesture.initPos,s.seek(y)),s}}(cu.prototype),function(t){t.getEffectSwivel=function(t,e,i,n,a,o){var r=t.direction,s=null,c=Linear.easeNone;if(t.tweenEase&&t.tweenEase.length>0&&(c=t.tweenEase),0==i)switch(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r){case"DirectionHorizontal":s.from(e,n,{rotationY:"480deg",ease:c});break;case"DirectionVertical":s.from(e,n,{rotationX:"480deg",ease:c});break;default:console.log("getEffectSwivel:parameter error.")}else switch(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{visibility:"hidden"}]}),r){case"DirectionHorizontal":s.to(e,n,{rotationY:"480deg",ease:c});break;case"DirectionVertical":s.to(e,n,{rotationX:"480deg",ease:c});break;default:console.log("getEffectSwivel:parameter error.")}return s},t.getEffectSpin=function(t,e,i,n,a){var o=t.amount?t.amount:360;switch(Math.abs(t.degree)>0&&(o=t.degree),0==t.clockWise&&(o=0-o),t.centerPos){case 1:e.css(iu,"left top");break;case 2:e.css(iu,"center top");break;case 3:e.css(iu,"right top");break;case 4:e.css(iu,"left cneter");break;case 5:e.css(iu,"right center");break;case 6:e.css(iu,"left bottom");break;case 7:e.css(iu,"center bottom");break;case 8:e.css(iu,"right bottom");break;case 0:default:e.css(iu,"center")}var r=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]});switch(t.axis){case 1:r.to(e,i,{rotationX:"+="+o+"deg",ease:t.tweenEase});break;case 2:r.to(e,i,{rotationY:"+="+o+"deg",ease:t.tweenEase});break;case 0:default:r.to(e,i,{rotation:"+="+o+"deg",ease:t.tweenEase})}return r},t.getEffectBoomerang=function(t,e,i,n,a,o){var r=null,s=n/3;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.add(TweenMax.to(e,.01,{x:300,y:-200,rotation:"-60deg"}),"first"),r.add(TweenMax.to(e,s,{autoAlpha:1,x:0,y:0,rotation:"0deg"}),"second"),r.add(TweenMax.to(e,s,{rotationY:"-80deg"}),"second"),r.add(TweenMax.to(e,s,{rotationY:"0deg"}))):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1,x:0,y:0,rotation:"0deg"}]}),r.add(TweenMax.to(e,s,{rotationY:"-80deg"}),"frist"),r.add(TweenMax.to(e,s,{autoAlpha:0,x:300,y:-200,rotation:"-60deg"}),"second"),r.add(TweenMax.to(e,s,{rotationY:"0deg"}),"second")),r},t.getEffectCenterRevolve=function(t,e,i,n,a,o){var r=null,s=Power1.easeInOut;return t.tweenEase&&t.tweenEase.length>0&&(s=t.tweenEase),0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{bezier:{type:"cubic",values:[{x:0,y:0},{x:200,y:100},{x:200,y:200},{x:0,y:300}]},ease:s})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{visibility:"hidden"}]}),r.to(e,n,{bezier:{type:"cubic",values:[{x:0,y:0},{x:200,y:100},{x:200,y:200},{x:0,y:300}]},ease:s})),r},t.getEffectSpinner=function(t,e,i,n,a,o){var r=null,s=Expo.easeOut;return t.tweenEase&&t.tweenEase.length>0&&(s=t.tweenEase),0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{scale:0,rotation:"180deg",ease:s})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{visibility:"hidden",scale:1,rotation:"0deg"}]}),r.to(e,n,{scale:0,rotation:"180deg",ease:s})),r},t.getEffectFadedSwivel=function(t,e,i,n,a,o){var r=null,s=Linear.easeNone,c=Math.abs(t.degree)>0?Number(t.degree):90;switch(0==t.clockWise&&(c=0-c),t.centerPos){case 1:e.css(iu,"left top");break;case 2:e.css(iu,"center top");break;case 3:e.css(iu,"right top");break;case 4:e.css(iu,"left cneter");break;case 5:e.css(iu,"right center");break;case 6:e.css(iu,"left bottom");break;case 7:e.css(iu,"center bottom");break;case 8:e.css(iu,"right bottom");break;case 0:default:e.css(iu,"center")}if(t.tweenEase&&t.tweenEase.length>0&&(s=t.tweenEase),0==i)switch(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),t.axis){case 0:r.from(e,n,{autoAlpha:0,rotation:c+"deg",ease:s,immediateRender:!1});break;case 1:r.from(e,n,{autoAlpha:0,rotationX:c+"deg",ease:s,immediateRender:!1});break;case 2:default:r.from(e,n,{autoAlpha:0,rotationY:c+"deg",ease:s,immediateRender:!1})}else switch(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1}]}),t.axis){case 0:r.to(e,n,{autoAlpha:0,rotation:c+"deg",ease:s});break;case 1:r.to(e,n,{autoAlpha:0,rotationX:c+"deg",ease:s});break;case 2:default:r.to(e,n,{autoAlpha:0,rotationY:c+"deg",ease:s})}return r}}(cu.prototype),function(t){t.getTextAnimation=function(t,e,i,n,a){0==n&&(n=.1);var o=t.effectType?t.effectType:"text1",r=t.startColor?t.startColor:"",s=e.find("svg").children(),c=new TimelineMax({repeat:a,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]});switch(o){default:case"text5":case"text1":c.staggerFrom(s.children(),i,{css:{opacity:0}},n);break;case"text2":c.staggerFrom(s.children(),i,{css:{opacity:0,"font-size":120},ease:"Strong.easeOut"},n);break;case"text3":c.staggerFrom(s.children(),i,{css:{opacity:0,"font-size":0},ease:"Power1.easeIn"},n);break;case"text4":c.staggerFrom(s.children(),i,{css:{opacity:0,fill:r},ease:"Power1.easeIn"},n)}return c},t.getEffectFlashBulb=function(t,e,i,n,a){var o=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r=Number(t.range)?t.range:.1,s=i/2;return o.to(e,s,{autoAlpha:.5,scale:"+="+r}).to(e,s,{autoAlpha:1,scale:"-="+r}),o},t.getEffectBlinds=function(t,e,i,n,a,o){function r(){var t=c.progress(),n=t/6,a="";if(0==i){switch(s){case"DirectionHorizontal":a="-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)),color-stop("+n+",rgba(0,0,0,1)),color-stop("+(n+.01)+",rgba(0,0,0,0))";for(var o=1;o<6;o++)a+=",color-stop("+o*(1/6)+",rgba(0,0,0,0)),color-stop("+(o*(1/6)+.01)+",rgba(0,0,0,1))",a+=",color-stop("+(o*(1/6)+n)+",rgba(0,0,0,1)),color-stop("+(o*(1/6)+n+.01)+",rgba(0,0,0,0))";a+=")";break;case"DirectionVertical":a="-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)),color-stop("+n+",rgba(0,0,0,1)),color-stop("+(n+.01)+",rgba(0,0,0,0))";for(var r=1;r<6;r++)a+=",color-stop("+r*(1/6)+",rgba(0,0,0,0)),color-stop("+(r*(1/6)+.01)+",rgba(0,0,0,1))",a+=",color-stop("+(r*(1/6)+n)+",rgba(0,0,0,1)),color-stop("+(r*(1/6)+n+.01)+",rgba(0,0,0,0))";a+=")";break;default:console.log("getEffectBlinds:parameter error.")}e.css("-webkit-mask",a),n>=1/6-.01&&e.css("-webkit-mask","none")}else{switch(s){case"DirectionHorizontal":a="-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)),color-stop("+(1-n)+",rgba(0,0,0,0)),color-stop("+(1-n-.01)+",rgba(0,0,0,1))";for(var l=1;l<6;l++)a+=",color-stop("+l*(1/6)+",rgba(0,0,0,1)),color-stop("+(l*(1/6)-.01)+",rgba(0,0,0,0))",a+=",color-stop("+(l*(1/6)-n)+",rgba(0,0,0,0)),color-stop("+(l*(1/6)-n-.01)+",rgba(0,0,0,1))";a+=")";break;case"DirectionVertical":a="-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,0)),color-stop("+(1-n)+",rgba(0,0,0,0)),color-stop("+(1-n-.01)+",rgba(0,0,0,1))";for(var u=1;u<6;u++)a+=",color-stop("+u*(1/6)+",rgba(0,0,0,1)),color-stop("+(u*(1/6)-.01)+",rgba(0,0,0,0))",a+=",color-stop("+(u*(1/6)-n)+",rgba(0,0,0,0)),color-stop("+(u*(1/6)-n-.01)+",rgba(0,0,0,1))";a+=")";break;default:console.log("getEffectBlinds:parameter error.")}e.css("-webkit-mask",a),n>=1/6-.01&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"))}}if(0==this.useMask)return this.getEffectAppear(t,e,i,n,a,o);var s=t.direction,c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]});return c.to(e,n,{onUpdate:r}),c},t.getEffectSplit=function(t,e,i,n,a,o){function r(){var t=c.progress(),n=t/2;if(0==i){if(t>.9)return void e.css("-webkit-mask","none");switch(s){case"DirectionVerticalIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(n-.05)+",rgba(0,0,0,1)),color-stop("+n+",rgba(0,0,0,0)),color-stop("+(1-n)+",rgba(0,0,0,0)),color-stop("+(1-n+.05)+",rgba(0,0,0,1)))");break;case"DirectionHorizontalIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(n-.05)+",rgba(0,0,0,1)),color-stop("+n+",rgba(0,0,0,0)),color-stop("+(1-n)+",rgba(0,0,0,0)),color-stop("+(1-n+.05)+",rgba(0,0,0,1)))");break;case"DirectionHorizontalOut":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+(.5-n)+",rgba(0,0,0,0)),color-stop("+(.55-n)+",rgba(0,0,0,1)),color-stop("+(.5+n)+",rgba(0,0,0,1)),color-stop("+(n+.55)+",rgba(0,0,0,0)))");break;case"DirectionVerticalOut":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+(.5-n)+",rgba(0,0,0,0)),color-stop("+(.55-n)+",rgba(0,0,0,1)),color-stop("+(.5+n)+",rgba(0,0,0,1)),color-stop("+(n+.55)+",rgba(0,0,0,0)))");break;default:console.log("getEffectSplit:parameter error.")}}else{if(t<.1)return;switch(s){case"DirectionVerticalIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+(n-.05)+",rgba(0,0,0,0)),color-stop("+n+",rgba(0,0,0,1)),color-stop("+(1-n)+",rgba(0,0,0,1)),color-stop("+(1-n+.05)+",rgba(0,0,0,0)))");break;case"DirectionHorizontalIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+(n-.05)+",rgba(0,0,0,0)),color-stop("+n+",rgba(0,0,0,1)),color-stop("+(1-n)+",rgba(0,0,0,1)),color-stop("+(1-n+.05)+",rgba(0,0,0,0)))");break;case"DirectionHorizontalOut":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(.5-n)+",rgba(0,0,0,1)),color-stop("+(.55-n)+",rgba(0,0,0,0)),color-stop("+(.5+n)+",rgba(0,0,0,0)),color-stop("+(n+.55)+",rgba(0,0,0,1)))");break;case"DirectionVerticalOut":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(.5-n)+",rgba(0,0,0,1)),color-stop("+(.55-n)+",rgba(0,0,0,0)),color-stop("+(.5+n)+",rgba(0,0,0,0)),color-stop("+(n+.55)+",rgba(0,0,0,1)))");break;default:console.log("getEffectSplit:parameter error.")}n>=.5&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"))}}if(0==this.useMask)return this.getEffectAppear(t,e,i,n,a,o);var s=t.direction,c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]});return c.to(e,n,{onUpdate:r}),c},t.getEffectWipe=function(t,e,i,n,a,o){var r=t.direction,s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),c=this._getObjectInfo(e);return s.to(e,n,{onUpdate:this._updateClipRect,onUpdateParams:[s,e,i,r,c]}),s},t.getEffectGrowAndTurn=function(t,e,i,n,a,o){var r=null;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,scale:0,rotation:"90deg",ease:t.tweenEase,clearProps:"scale,rotation"})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1,scale:1,rotation:"0deg"}]}),r.to(e,n,{autoAlpha:0,scale:0,rotation:"90deg",ease:t.tweenEase})),r},t.getEffectPinwheel=function(t,e,i,n,a,o){var r=null;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,scale:0,rotation:"540deg",ease:t.tweenEase})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1,scale:1,rotation:"0deg"}]}),r.to(e,n,{autoAlpha:0,scale:0,rotation:"540deg",ease:t.tweenEase})),r},t.getEffectExpand=function(t,e,i,n,a,o){var r=null;return 0==i?(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r.from(e,n,{autoAlpha:0,rotationY:"45deg",ease:t.tweenEase})):(r=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1,rotationY:"0deg"}]}),r.to(e,n,{autoAlpha:0,rotationY:"45deg",ease:t.tweenEase})),r},t.getEffectFloat=function(t,e,i,n,a,o){var r,s,c=null,l=this._getObjectInfo(e);return 0==i?(r=l.offsetRight+l.width,s=0-(l.offsetTop+l.height),c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),c.from(e,n,{autoAlpha:0,rotation:"-45deg",x:r,y:s,ease:t.tweenEase})):(r=l.offsetRight+l.width,s=0-(l.offsetTop+l.height),c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1}]}),c.to(e,n,{autoAlpha:0,rotation:"-45deg",x:r,y:s,ease:t.tweenEase})),c},t.getEffectCredits=function(t,e,i,n,a,o){var r=this._getObjectInfo(e),s=0,c=0;0==i?(s=0-(this.visualHeight+r.height),c=r.top+r.offsetBottom+r.height):(s=this.visualHeight+r.height,c=r.top-(r.offsetTop+r.height));var l=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible",top:c+"px"}],onComplete:this._completeHandler,onCompleteParams:[t,e]});return l.to(e,n,{y:s,ease:t.tweenEase}),l},t.getEffectBounce=function(t,e,i,n,a,o){var r,s,c,l,u,d,h,p,f,v,g,m,y,b=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),x=this._getObjectInfo(e);return 0==i?(m=n,g=m/5,r=m/10,s=m/20,c=m/40,l=m/80,y=89.3,v=this.visualHeight/4,u=v/2,d=v/4,h=v/8,p=v/16,f=x.offsetBottom-v+x.height,b.to(e,.01,{x:-y,y:-v}).to(e,g,{x:"+=50",y:"+="+v,ease:Circ.easeIn}).to(e,g,{x:"+=20",y:"-="+u,scaleY:.8,ease:Circ.easeOut}).to(e,g,{x:"+=10",y:"+="+u,scaleY:1,ease:Circ.easeIn}).to(e,r,{x:"+=5",y:"-="+d,scaleY:.85,ease:Circ.easeOut}).to(e,r,{x:"+=2.5",y:"+="+d,scaleY:1,ease:Circ.easeIn}).to(e,s,{x:"+=1",y:"-="+h,scaleY:.9,ease:Circ.easeOut}).to(e,s,{x:"+=0.5",
y:"+="+h,scaleY:1,ease:Circ.easeIn}).to(e,c,{x:"+=0.2",y:"-="+p,scaleY:.95,ease:Circ.easeOut}).to(e,c,{x:"+=0.1",y:"+="+p,scaleY:1,ease:Circ.easeIn,clearProps:"x,y"}),b):(m=n,g=m/5,r=m/10,s=m/20,c=m/40,l=m/80,v=this.visualHeight/4,u=v/2,d=v/4,h=v/8,p=v/16,f=x.offsetBottom-v+x.height,b.to(e,g,{x:"+=50",y:"+="+v,ease:Circ.easeIn}).to(e,g,{x:"+=20",y:"-="+u,scaleY:.8,ease:Circ.easeOut}).to(e,g,{x:"+=10",y:"+="+u,scaleY:1,ease:Circ.easeIn}).to(e,r,{x:"+=5",y:"-="+d,scaleY:.85,ease:Circ.easeOut}).to(e,r,{x:"+=2.5",y:"+="+d,scaleY:1,ease:Circ.easeIn}).to(e,s,{x:"+=1",y:"-="+h,scaleY:.9,ease:Circ.easeOut}).to(e,s,{x:"+=0.5",y:"+="+h,scaleY:1,ease:Circ.easeIn}).to(e,c,{x:"+=0.2",y:"-="+p,scaleY:.95,ease:Circ.easeOut}).to(e,c,{x:"+=0.1",y:"+="+p,scaleY:1,ease:Circ.easeIn}).to(e,l,{x:"+=0.1",y:"+="+f,ease:Circ.easeIn}),b)},t.getEffectFlicker=function(t,e,i,n,a){function o(){var t=v.progress(),i=parseInt(t*(u-d));t>.5&&(i=parseInt((1-t)*(u-d))),e.css(nu,"drop-shadow("+f+" "+p+"px "+p+"px "+(d+i)+"px)")}if(!(nu in e[0].style))return new TimelineMax;var r=t.color2?t.color2:"#fff",s=t.maxGlowSize?t.maxGlowSize:.1,c=t.minGlowSize?t.minGlowSize:.05,l=e.width()>e.height()?e.height():e.width(),u=s*l,d=c*l,h=Number(t.opacity)?t.opcity:.75,p=Number(t.distance)?t.distance*l:0,f=Ni(r,h),v=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{filter:"none"}]});return v.to(e,i,{onUpdate:o}),v},t.getEffectTeeter=function(t,e,i,n,a){var o=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r=Number(t.range)?t.range:.02,s=i/8;switch(t.mode){case 1:r*=e.width(),o.to(e,s,{x:-r}).to(e,2*s,{x:r}),o.to(e,2*s,{x:-r}),o.to(e,2*s,{x:r}),o.to(e,s,{x:0});break;case 2:r*=e.height(),o.to(e,s,{y:-r}).to(e,2*s,{y:r}),o.to(e,2*s,{y:-r}),o.to(e,2*s,{y:r}),o.to(e,s,{y:0});break;case 3:o.to(e,s,{scaleX:1+r}).to(e,2*s,{scaleX:1-r}),o.to(e,2*s,{scaleX:1+r}),o.to(e,2*s,{scaleX:1-r}),o.to(e,s,{scaleX:1});break;case 4:o.to(e,s,{scaleY:1+r}).to(e,2*s,{scaleY:1-r}),o.to(e,2*s,{scaleY:1+r}),o.to(e,2*s,{scaleY:1-r}),o.to(e,s,{scaleY:1});break;case 0:default:r*=100,o.to(e,s,{rotation:r+"deg"}).to(e,2*s,{rotation:-r+"deg"}),o.to(e,2*s,{rotation:r+"deg"}),o.to(e,2*s,{rotation:-r+"deg"}),o.to(e,s,{rotation:"0deg"})}return o},t.getEffectComplementaryColor=function(t,e,i,n,a){var o=Number(e.css("z-index"));isNaN(o)&&(o=10,console.log("The Z-index property for this object to get error."));var r=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e,{"z-Index":o+100}],onComplete:this._completeHandler,onCompleteParams:[t,e,{"z-Index":o}]});return r.to(e,i,{autoAlpha:1}),r},t._updateClipRect=function(t,e,i,n,a){var o,r,s,c,l=t.progress(),u=l;if(0==i)switch(s=a.height*(1-u),c=a.height-s,r=a.width*(1-u),o=a.width-r,n){case"DirectionUp":e.css("clip","rect(0px "+a.width+"px "+c+"px 0px)");break;case"DirectionDown":e.css("clip","rect("+s+"px "+a.width+"px "+a.height+"px 0px)");break;case"DirectionLeft":e.css("clip","rect(0px "+o+"px "+a.height+"px 0px)");break;case"DirectionRight":e.css("clip","rect(0px "+a.width+"px "+a.height+"px "+r+"px)");break;default:console.log("_updateClipRect:parameter error.")}else switch(s=a.height*u,c=a.height-s,r=a.width*u,o=a.width-r,n){case"DirectionUp":e.css("clip","rect("+s+"px "+a.width+"px "+a.height+"px 0px)");break;case"DirectionDown":e.css("clip","rect(0px "+a.width+"px "+c+"px 0px)");break;case"DirectionLeft":e.css("clip","rect(0px "+a.width+"px "+a.height+"px "+r+"px)");break;case"DirectionRight":e.css("clip","rect(0px "+o+"px "+a.height+"px 0px)");break;default:console.log("_updateClipRect:parameter error.")}}}(cu.prototype),function(t){t.getEffectZoom=function(t,e,i,n,a,o){var r,s=t.direction,c=null;if(e.css(Xut.style.transformOrigin,"center"),0==i)switch(c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),s){case"DirectionIn":c.from(e,n,{scale:0,ease:t.tweenEase});break;case"DirectionInCenter":r=this._getDirectionInCenter(e),c.from(e,n,{scale:0,x:r.x,y:r.y,ease:t.tweenEase});break;case"DirectionInSlightly":c.from(e,n,{scale:.7,ease:t.tweenEase});break;case"DirectionOut":c.from(e,n,{scale:3,ease:t.tweenEase});break;case"DirectionOutBottom":c.from(e,n,{scale:2,top:this.visualWidth+"px",ease:t.tweenEase});break;case"DirectionOutSlightly":c.from(e,n,{scale:1.5,ease:t.tweenEase});break;default:console.log("getEffectZoom:parameter error.")}else switch(c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{visibility:"hidden"}]}),s){case"DirectionIn":c.to(e,n,{scale:0,ease:t.tweenEase});break;case"DirectionInCenter":r=this._getDirectionInCenter(e),c.to(e,n,{scale:0,x:r.x,y:r.y,ease:t.tweenEase});break;case"DirectionInSlightly":c.to(e,n,{scale:.7,ease:t.tweenEase});break;case"DirectionOut":c.to(e,n,{scale:3,ease:t.tweenEase});break;case"DirectionOutBottom":c.to(e,n,{scale:2,top:this.visualHeight+"px",ease:t.tweenEase});break;case"DirectionOutSlightly":c.to(e,n,{scale:1.5,ease:t.tweenEase});break;default:console.log("getEffectZoom:parameter error.")}return c},t.getEffectFadedZoom=function(t,e,i,n,a,o){var r=t.direction,s=null;e.css(Xut.style.transformOrigin,"center");var c=e.find("svg");c&&Xut.style.setTranslate({node:c,x:0,y:0});var l,u=0!=t.keepRatio,d=1==t.fullScreen,h=t.scaleX?t.scaleX:1,p=t.scaleY?t.scaleY:1;if(1==d){var f=this.visualWidth/e.width(),v=this.visualHeight/e.height(),g=f;f>v&&(g=v),l=this._getDirectionInCenter(e),0==i?(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{opacity:0}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),s.to(e,n,{x:l.x,y:l.y,autoAlpha:1,scale:g,ease:t.tweenEase})):(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),s.to(e,n,{x:l.x,y:l.y,autoAlpha:0,scale:g,ease:t.tweenEase}))}else if(0==i)switch(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]}),r){case"DirectionIn":1==u?s.from(e,n,{autoAlpha:0,scale:0,ease:t.tweenEase}):s.from(e,n,{autoAlpha:0,scaleX:h,scaleY:p,ease:t.tweenEase});break;case"DirectionInCenter":l=this._getDirectionInCenter(e),1==u?s.from(e,n,{x:l.x,y:l.y,autoAlpha:0,scale:0,ease:t.tweenEase}):s.from(e,n,{x:l.x,y:l.y,autoAlpha:0,scaleX:h,scaleY:p,ease:t.tweenEase});break;default:console.log("getEffectFadedZoom:parameter error.")}else switch(s=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e,{opacity:1}]}),r){case"DirectionOut":1==u?s.to(e,n,{autoAlpha:0,scale:0,ease:t.tweenEase,clearProps:"scale"}):s.to(e,n,{autoAlpha:0,scaleX:h,scaleY:p,ease:t.tweenEase});break;case"DirectionOutCenter":l=this._getDirectionInCenter(e),1==u?s.to(e,n,{x:l.x,y:l.y,autoAlpha:0,scale:0,ease:t.tweenEase}):s.to(e,n,{x:l.x,y:l.y,autoAlpha:0,scaleX:h,scaleY:p,ease:t.tweenEase});break;default:console.log("getEffectFadedZoom:parameter error.")}return s},t.getEffectGrowShrink=function(t,e,i,n,a){var o=t.scaleX?t.scaleX:1,r=t.scaleY?t.scaleY:1,s=1==t.fullScreen,c=1==t.resetSize,l=Linear.easeNone;t.tweenEase&&t.tweenEase.length>0&&(l=t.tweenEase);var u=new TimelineMax({delay:n,repeat:a,onStart:this._startHandler,onStartParams:[t,e],onComplete:this._completeHandler,onCompleteParams:[t,e]});if(1==s){var d=this.visualWidth/e.width(),h=this.visualHeight/e.height(),p=d;d>h&&(p=h);var f=this._getDirectionInCenter(e);u.to(e,i,{x:f.x,y:f.y,scale:p,ease:t.tweenEase})}else 1==c?u.to(e,i,{scaleX:1,scaleY:1,ease:l}):u.to(e,i,{scaleX:o,scaleY:r,ease:l});return u},t._getDirectionInCenter=function(t){var e=this._getObjectInfo(t);return{x:Math.round(this.visualWidth/2-e.offsetLeft-e.width/2),y:Math.round(this.visualHeight/2-e.offsetTop-e.height/2)}}}(cu.prototype),function(t){t.getEffectCircle=function(t,e,i,n,a,o){function r(){var t=c.progress(),n=parseInt(t*u);if(0==i)switch(s){case"DirectionIn":e.css("-webkit-mask","-webkit-gradient(radial,center center,"+(u-n)+",center center,0,from(rgba(0,0,0,1)),to(rgba(0,0,0,0)),color-stop(10%,rgba(0,0,0,0)))"),n==u&&e.css("-webkit-mask","none");break;case"DirectionOut":e.css("-webkit-mask","-webkit-gradient(radial,center center,0,center center, "+n+",from(rgba(0,0,0,1)), to(rgba(0,0,0,0)), color-stop(90%, rgba(0,0,0,1)))"),n==u&&e.css("-webkit-mask","none")}else switch(s){case"DirectionIn":e.css("-webkit-mask","-webkit-gradient(radial,center center,"+(u-n)+",center center,0,from(rgba(0,0,0,0)),to(rgba(0,0,0,1)),color-stop(10%,rgba(0,0,0,1)))"),n==u&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"));break;case"DirectionOut":e.css("-webkit-mask","-webkit-gradient(radial,center center,0,center center, "+n+",from(rgba(0,0,0,0)), to(rgba(0,0,0,1)), color-stop(90%, rgba(0,0,0,0)))"),n==u&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"))}}if(0==this.useMask)return this.getEffectAppear(t,e,i,n,a,o);var s=t.direction,c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),l=this._getObjectInfo(e),u=Math.ceil(Math.sqrt(l.width*l.width/4+l.height*l.height/4));switch(s){case"DirectionIn":case"DirectionOut":c.to(e,n,{onUpdate:r});break;default:console.log("getEffectCircle:parameter error.")}return c},t.getEffectBox=function(t,e,i,n,a,o){function r(){var t,n,a,o,r=c.progress(),u=r/2;if(0==i){switch(s){case"DirectionIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+u+",rgba(0,0,0,1)),color-stop("+u+",transparent),color-stop("+(1-u)+",transparent),color-stop("+(1-u)+",rgba(0,0,0,1))),-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+u+",rgba(0,0,0,1)),color-stop("+u+",transparent),color-stop("+(1-u)+",transparent),color-stop("+(1-u)+",rgba(0,0,0,1)))");break;case"DirectionOut":o=l.height*(.5-u),n=l.height-o,a=l.width*(.5-u),t=l.width-a,e.css("clip","rect("+o+"px "+t+"px "+n+"px "+a+"px)");break;default:console.log("getEffectBox:parameter error.")}u>=.5&&e.css("-webkit-mask","none")}else{switch(s){case"DirectionIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(.5-u)+",rgba(0,0,0,1)),color-stop("+(.5-u)+",transparent),color-stop("+(.5+u)+",transparent),color-stop("+(.5+u)+",rgba(0,0,0,1))),-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(.5-u)+",rgba(0,0,0,1)),color-stop("+(.5-u)+",transparent),color-stop("+(.5+u)+",transparent),color-stop("+(.5+u)+",rgba(0,0,0,1)))");break;case"DirectionOut":o=l.height*u,n=l.height-o,a=l.width*u,t=l.width-a,e.css("clip","rect("+o+"px "+t+"px "+n+"px "+a+"px)");break;default:console.log("getEffectBox:parameter error.")}u>=.5&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"))}}var s=t.direction;0==this.useMask&&(s="DirectionOut");var c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]}),l=this._getObjectInfo(e);return c.to(e,n,{onUpdate:r}),c},t.getEffectDiamond=function(t,e,i,n,a,o){function r(){var t=c.progress(),n=t/2;if(0==i){switch(s){case"DirectionOut":case"DirectionIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 100% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+n+",rgba(0,0,0,1)),color-stop("+n+",transparent),color-stop("+(1-n)+",transparent),color-stop("+(1-n)+",rgba(0,0,0,1))),-webkit-gradient(linear,0% 100%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+n+",rgba(0,0,0,1)),color-stop("+n+",transparent),color-stop("+(1-n)+",transparent),color-stop("+(1-n)+",rgba(0,0,0,1)))");break;default:console.log("getEffectBox:parameter error.")}n>=.5&&e.css("-webkit-mask","none")}else{switch(s){case"DirectionOut":case"DirectionIn":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 100% 100%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(.5-n)+",rgba(0,0,0,1)),color-stop("+(.5-n)+",transparent),color-stop("+(.5+n)+",transparent),color-stop("+(.5+n)+",rgba(0,0,0,1))),-webkit-gradient(linear,0% 100%, 100% 0%, from(rgba(0,0,0,1)), to(rgba(0,0,0,1)),color-stop("+(.5-n)+",rgba(0,0,0,1)),color-stop("+(.5-n)+",transparent),color-stop("+(.5+n)+",transparent),color-stop("+(.5+n)+",rgba(0,0,0,1)))");break;default:console.log("getEffectBox:parameter error.")}n>=.5&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"))}}if(0==this.useMask)return this.getEffectAppear(t,e,i,n,a,o);var s=t.direction,c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]});return c.to(e,n,{onUpdate:r}),c},t.getEffectPlus=function(t,e,i,n,a,o){function r(){var t=c.progress(),n=t/2;if(0==i){switch(s){case"DirectionIn":case"DirectionOut":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+(.5-n)+",transparent),color-stop("+(.5-n)+",rgba(0,0,0,1)),color-stop("+(.5+n)+",rgba(0,0,0,1)),color-stop("+(.5+n)+",transparent)),-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+(.5-n)+",transparent),color-stop("+(.5-n)+",rgba(0,0,0,1)),color-stop("+(.5+n)+",rgba(0,0,0,1)),color-stop("+(.5+n)+",transparent))");break;default:console.log("getEffectPlus:parameter error.")}n>=.5&&e.css("-webkit-mask","none")}else{switch(s){case"DirectionIn":case"DirectionOut":e.css("-webkit-mask","-webkit-gradient(linear,0% 0%, 0% 100%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+n+",transparent),color-stop("+n+",rgba(0,0,0,1)),color-stop("+(1-n)+",rgba(0,0,0,1)),color-stop("+(1-n)+",transparent)),-webkit-gradient(linear,0% 0%, 100% 0%, from(rgba(0,0,0,0)), to(rgba(0,0,0,0)),color-stop("+n+",transparent),color-stop("+n+",rgba(0,0,0,1)),color-stop("+(1-n)+",rgba(0,0,0,1)),color-stop("+(1-n)+",transparent))");break;default:console.log("getEffectPlus:parameter error.")}n>=.5&&(e.css("visibility","hidden"),e.css("-webkit-mask","none"))}}if(0==this.useMask)return this.getEffectAppear(t,e,i,n,a,o);var s=t.direction,c=new TimelineMax({delay:a,repeat:o,onStart:this._startHandler,onStartParams:[t,e,{visibility:"visible"}],onComplete:this._completeHandler,onCompleteParams:[t,e]});return c.to(e,n,{onUpdate:r}),c}}(cu.prototype);var lu=Xut.style,uu=lu.keyframes,du=lu.animationEnd,hu=lu.animationPlayState,pu=lu.animation,fu=null,vu=Xut.style.animationPlayState,gu=function(t){return"css"===(t.mode||"css")&&vu?Ai(t):Ei(t)},mu=function(t,e,i){var n=$("#"+t+e),a=$("#"+t+i),o=$("#spirit_parent_"+i);0==o.length&&a.append("<div style='position:absolute; width:100%; height:100%'  id='spirit_parent_"+i+"'></div>"),o.append(n)},yu=function(){function t(e){fo(this,t),this.options=e,this.ids=[]}return vo(t,[{key:"play",value:function(){var t=this.options.data,e=t.resource,i=void 0,n=void 0,a=void 0,o=void 0,r=void 0,s=void 0,c={};this.spiritObjs={},c.contentId=this.options.id,c.ele=this.options.$contentNode,c.resourcePath=t.md5,c.type="autoSprite";var l=0;t.loop&&(l="loop");for(var u=0;u<e.spiritList.length;u++){if(a=e.spiritList[u],i=t.containerName,o=a.framId,r=a.parentId,this.ids.push(i),"0"!=r){var d=i.split("_"),h=d[0]+"_"+d[1];mu(h,o,r)}this.spiritObjs[i]=new zl(a,c),s=a.params,n=s.actList.split(",")[0],this.spiritObjs[i].play(n,l)}}},{key:"stop",value:function(){var t=this;this.ids.forEach(function(e){t.spiritObjs[e].stop()})}},{key:"reset",value:function(){this.stop()}},{key:"destroy",value:function(){var t=this;this.ids.forEach(function(e){t.spiritObjs[e]&&(t.spiritObjs[e].destroy(),t.spiritObjs[e]=null,delete t.spiritObjs[e])}),this.options.data=null,this.options.$contentNode=null,this.options=null,this.ids=null}}]),t}(),bu={},xu={},wu=function(t,e,i){e&&_.each(e,function(e){e.videoId&&t(i,e.videoId)})},ku=["pptObj","pixiObj","comSpriteObj","autoSpriteObj"],_u=function(t){ku.forEach(function(e){t(e)})},Iu=function(){function t(e){fo(this,t),_.extend(this,e)}return vo(t,[{key:"_createCanvas",value:function(t,e,i,n){var a=this,o=void 0,r=this.contentData.actionTypes,s={data:this.contentData,renderer:this.$contentNode,pageIndex:this.pageIndex},c=function(){(e||r.pptId)&&a.$contentNode.view&&(a.pptObj=n(cu,$(a.$contentNode.view)),a.pptObj.contentId=t)},l=this.$contentNode.view;l&&(o=l.getAttribute("data-init"));var u=function(){l.setAttribute("data-init",!0)};r.spiritId&&(o?c():(this.nextTask.context.add(t),this.pixiObj=new bu(s),this.pixiObj.$$once("load",function(){c(),a.nextTask.context.remove(t)}),u())),r.compSpriteId&&(o?c():(this.pixiObj=new xu(s),u(),c()))}},{key:"_createDom",value:function(t,e){if(t){var i={id:this.id,data:this.contentData,$contentNode:this.$contentNode};switch(t){case"Sprite":this.comSpriteObj=gu(i);break;case"AutoCompSprite":this.autoSpriteObj=new yu(i)}}this.pptObj=e(cu)}},{key:"init",value:function(t,e,i,n,a,o){var r=this,s=this.contentData.category,c=this.pageIndex,l=function(t,s){var l=s||e;if(l.length)return new t(c,o,n,l,a,i,r.getStyle);console.log("创建:"+t+"失败")};this.domMode?this._createDom(s,l):this._createCanvas(t,a,s,l)}},{key:"play",value:function(t){var e=this,i=this.$contentNode;i&&i.view&&(i=this.$contentNode.view),_u(function(n){e[n]&&("pptObj"===n&&i.prop&&i.prop("mutex")&&i.css({display:"block"}),e[n].play&&e[n].play(t))})}},{key:"stop",value:function(t){var e=this;_u(function(i){e[i]&&("pptObj"===i&&wu(Ae,e[i].options,t),e[i].stop&&e[i].stop())})}},{key:"reset",value:function(){var t=this;_u(function(e){t[e]&&t[e].reset&&t[e].reset()})}},{key:"destroy",value:function(t){var e=this;_u(function(t){e[t]&&e[t].destroy&&e[t].destroy()}),this.canvasMode&&this.$contentNode.view&&this.$contentNode.destroy(),this.contentData.$contentNode&&(this.contentData.$contentNode=null),_u(function(t){e[t]=null}),this.$contentNode=null,this.getParameter=null}}]),t}(),Pu=Xut.style.transitionDuration,Tu=Xut.style.transform,Su=Xut.style.setTranslateZ,Cu=Math.round,$u=function(t,e,i){return Hi({$contentNode:t,action:"init",property:e,pageOffset:i})},Mu=function(t){return t.opacityStart>-1&&(t.opacity=(t.opacityEnd||1)-t.opacityStart,delete t.opacityEnd),t},Xu=function(t){var e=Xut.Presentation.GetPageBase("page",t);if(e&&"flow"===e.chapterData.note){return Et(e.chapterData.seasonId,e.chapterId)}},Nu=function(t,e,i,n,a,o){var r,s,c,l={type:"dom",canvasMode:!1,domMode:!0},u=t.pageType,d=t.relatedData.contentDataset[e];if(t.canvasRelated.enable&&-1!==t.canvasRelated.contentIdset.indexOf(e)&&(s="canvas_"+i+"_"+e,c=t.getContextNode(s)[0],d.$contentNode&&(r=d.$contentNode),l.type="canvas",l.canvasMode=!0,l.domMode=!1),r||(r=t.getContextNode(n))){if(_.extend(l,{base:t,id:e,actName:n,contentData:d,$contentNode:r,pageType:u,canvasDom:c,chapterIndex:i,pageIndex:t.pageIndex,canvasRelated:t.canvasRelated,nextTask:t.nextTask}),l.processType=o&&"master"===u?"parallax":"animation",l.getParameter=function(){var t="parameter-"+u+"-"+l.processType;return l[t]=a,function(){return l[t]}}(),"parallax"===l.processType)return ji(l,t.relatedData,t.getStyle);return Vi(l,t.eventData.eventName)?Oi(l,t):(l.getStyle=t.getStyle,new Iu(l))}},Bu=function(t,e){var i=e[0],n=i.contentId,a=t.chapterIndex,o=t.makePrefix("Content",a,n);return Nu(t,n,a,o,e,i.masterId)},Du=function(t){return function(e,i){var n,a;if(e&&e.length)for(;n=e.shift();)(a=Bu(t,n))&&i(a)}},Au=function(t,e){var i;for(i in e)void 0===t[i]&&(t[i]=e[i])},Eu=function(t){var e=t.dataset.animation,i=t.dataset.parallax,n=[],a=Du(t);switch(t.pageType){case"page":a(e,function(t){n.push(t)});break;case"master":var o={},r={},s=[];a(i,function(t){o[t.id]=t}),a(e,function(t){r[t.id]=t});var c=_.keys(o).length,l=_.keys(r).length;c&&l&&(_.each(r,function(t){var e=t.id,i=o[e];i&&(Au(t,i),t.processType="both",delete o[e])}),_.keys(o).length&&_.extend(r,o),o=null),_.each(l?r:o,function(t){s.push(t)}),n=s}return a=null,n},Ou=function(t){return{context:{wait:!1,statas:!1,_ids:[],event:[],pre:{},check:function(){if(this.length().length||(this.statas=!0),this.wait)return void(t&&t())},add:function(t){-1===this._ids.indexOf(t)&&this._ids.push(t)},remove:function(t){if(t){var e=this._ids.indexOf(t),i=this._ids.splice(e,1);return this.check(i),i}},length:function(){return this._ids.length}}}},Hu=function(){function t(e){if(fo(this,t),_.extend(this,e),this.nextTask=Ou(this.noticeComplete),this._initEvents(),this._contentGroup=Eu(this),this._htmlTextBox(),this._bindEvents(),this._initContents(),this._fixAudio=[],this._cacheBehaviorAudio={},this.nextTask.context.length())return this.nextTask.context.wait=!0,this;this.noticeComplete()}return vo(t,[{key:"_initContents",value:function(){var t=this,e=this.relatedData.pageId,i=this.$containsNode,n=this.relatedCallback.contentsHooks,a=this.pageType;this.eachAssistContents(function(o){var r=o.id,s=o.$contentNode;if("parallax"===o.processType)return void n(o.chapterIndex,o.id,o);o.init(r,s,i,e,o.getParameter(),a),t._toRepeatBind(r,s,o,n)})}},{key:"_toRepeatBind",value:function(t,e,i,n){var a=this.relatedData,o=a.createContentIds.indexOf(t);-1!==o&&(a.createContentIds.splice(o,1),n(i.chapterIndex,t,i),this._iscrollBind(i,e))}},{key:"_iscrollBind",value:function(t,e){var i=this,n=this,a=t.contentData,o=function(e){var i=n.getContextNode(n.makePrefix("Content",t.chapterIndex,t.id)),a=i.css("visibility"),o=function(){};if("hidden"==a){var r=i.css("opacity"),s=function(t,e){arguments.length>1?i.css(t,e):i.css(t)};0==r?(s("visibility","visible"),o=function(){return s("visibility",a)}):(s({opacity:0,visibility:"visible"}),o=function(){return s({opacity:r,visibility:a})})}return function(){var t={scrollbars:"custom",fadeScrollbars:!0};"mini"===No.launch.platform&&(t.fadeScrollbars=!1),n.iscroll=Ii(e,t,"delegate"),e.setAttribute("data-iscroll","true"),o(),o=null,i=null,e=null}},r=function(){e.css("overflow","hidden"),e.children().css("height",""),i.relatedCallback.iscrollHooks.push(o(e[0]))};if(a.isScroll){var s=e.find("svg");s?s.text()&&r():r()}a.mask&&a.isGif||e.find&&e.find("img").css({height:a.scaleHeight})}},{key:"makePrefix",value:function(t,e,i){return t+"_"+e+"_"+i}},{key:"getContextNode",value:function(t,e){var i=void 0,n=void 0,a=void 0,o=void 0;return o=this.relatedData.contentsFragment,(i=o[t])?n=$(i):(a=this.relatedData.containerPrefix)&&_.each(a,function(e){i=o[e],n=$(i).find("#"+t),n.length}),n}},{key:"_resetAloneAnim",value:function(){Yi(this.eventData,function(t){t.reset()})}},{key:"_relevantOperation",value:function(){var t,e;if(this.eventData&&(e=this.eventData.eventContentId),e&&(t=this.relatedData.seasonRelated[e])){if(t.SearchBar)return void this.createSearchBar();if(t.BookMarks)return void this.createBookMark();if(t.seasonId||t.chapterId)return void setTimeout(function(){Xut.View.LoadScenario({seasonId:t.seasonId,chapterId:t.chapterId})},Ce()?500:0)}}},{key:"eachAssistContents",value:function(t){_.each(this._contentGroup,function(e){t.call(this,e)},this)}},{key:"runAnimation",value:function(t,e){var i=this,n=this.relatedData.pageId;if(e&&(this.preventRepeat=!1),this.preventRepeat)return!1;if(this.preventRepeat=!0,!this.dataset.animation)return this.preventRepeat=!1,void this._relevantOperation();var a=this.captureAnimComplete=function(e){return function(a){a&&a.$contentNode&&a.$contentNode.removeProp&&a.$contentNode.removeProp("animOffset");var o=n!=Xut.Presentation.GetPageId();o&&a&&(a.stop&&a.stop(n),a.reset&&a.reset()),1===e?(o&&i._resetAloneAnim(),i.preventRepeat=!1,i._relevantOperation(),t&&t(),i.captureAnimComplete=null):--e}}(this._contentGroup.length);this.eachAssistContents(function(t){t.$contentNode&&t.$contentNode.prop&&t.$contentNode.prop({animOffset:t.$contentNode.offset()}),t.play(function(){a(t)})}),this.runState=!0}},{key:"stopAnimation",value:function(){var t=this.relatedData.pageId;this.runState=!1,this.eachAssistContents(function(e){e.stop&&e.stop(t)})}},{key:"_destroyAnimation",value:function(t){var e=this;Yi(this.eventData,function(t){t.destroy()}),this.eachAssistContents(function(i){i.destroy&&i.destroy(e.relatedData.pageId),t&&t(i)})}},{key:"autoPlay",value:function(t){var e=this.eventData;e&&"auto"===e.eventName?this.runAnimation(t):t()}},{key:"reset",value:function(){this.eachAssistContents(function(t){t.reset&&t.reset()}),this._resetAloneAnim()}},{key:"stop",value:function(){this.runState&&this.stopAnimation(),this.preventRepeat=!1,this.htmlBoxInstance.length&&_.each(this.htmlBoxInstance,function(t){t.removeBox()}),this._fixAudio.length&&(_.each(this._fixAudio,function(t){setTimeout(function(){t.destroy()},5e3)}),this._fixAudio=[])}},{key:"destroy",value:function(t){if(this.eventData.eventContext&&(pi(this.eventData),this.eventData.eventContext=null),this.htmlBoxInstance.length&&(_.each(this.htmlBoxInstance,function(t){t.destroy()}),this.htmlBoxInstance=null),this._destroyAnimation(t),this._contentGroup=null,this.iscroll&&(this.iscroll.destroy(),this.iscroll=null),this.searchBar&&(this.searchBar.destroy(),this.searchBar=null),this.bookMark&&(this.bookMark.destroy(),this.bookMark=null),Object.keys(this._cacheBehaviorAudio).length)for(var e in this._cacheBehaviorAudio){var i=this._cacheBehaviorAudio[e];i&&(i.destroy(),this._cacheBehaviorAudio[e]=null)}this.$containsNode=null}}]),t}(),Ru=Hu.prototype;!function(t){t._htmlTextBox=function(){var t,e,i,n=this,a=this.relatedData,o=a.contentHtmlBoxIds;this.htmlBoxInstance=[],o.length&&a.contentDataset&&_.each(a.contentDataset,function(a){~o.indexOf(a._id)&&(t=a._id,e=n.makePrefix("Content",n.chapterIndex,t),i=n.getContextNode(e),i.attr("data-htmlbox")||(n.htmlBoxInstance.push(new Rl(t,i)),i.attr("data-htmlbox","true")))})}}(Ru),function(t){t.createBookMark=function(){var t,e,i,n;"master"===this.pageType?(n=Xut.Presentation.GetPageData(),t=this.relatedData.floatMasterDivertor.container,i=n._id,e=n.seasonId):(t=this.$containsNode,e=this.relatedData.seasonId,i=this.pageId);var a={parent:t,seasonId:e,pageId:i};this.bookMark?this.bookMark.restore():this.bookMark=new Si(a)}}(Ru),function(t){t.createSearchBar=function(){var t={parent:this.$containsNode};this.searchBar?this.searchBar.restore():this.searchBar=new Ci(t)}}(Ru),function(t){t._initEvents=function(){this.eventData.eventName=di(this.eventData.eventType)},t._findContentName=function(t,e,i){var n=this,a=void 0,o=this.eventData;return i&&-1!==this.canvasRelated.contentIdset.indexOf(i)?function(){a=n.makePrefix("canvas",t,e),o.type="canvas",o.canvasMode=!0,o.domMode=!1}():function(){a=n.makePrefix("Content",t,e),o.type="dom",o.canvasMode=!1,o.domMode=!0}(),a},t._parseEventContext=function(){var t=this.eventData,e=t.eventContentId,i=t.eventContext;if(e){if(!i){var n=t.rewrite?e:this.id,a=this._findContentName(this.chapterIndex,n,e);i=this.getContextNode(a),t.eventContext=i}i?this.relatedCallback.contentsHooks(this.chapterIndex,e,{$contentNode:i,isBindEventHooks:!0,type:t.type}):t.parent=this}return i},t._bindEvents=function(t){var e=this,i=this.eventData,n=i.eventName,a=this._parseEventContext(),o=function(){var t=void 0;if(i.domMode&&(t=a.prop("animOffset"))){var n=t.left,o=t.top,r=a.offset(),s=r.left,c=r.top;(n>s-5&&n<s+5||o>c-5&&o<c+5)&&e.runAnimation()}else e.runAnimation()},r=function(t){var n=void 0;if(n=t.behaviorSound)if(window.MMXCONFIG&&window.audioHandler)e._fixAudio.push(new _c({url:n,trackId:9999,complete:function(){this.play()}}));else{var r=e._cacheBehaviorAudio[n];r?r.play():(r=new _c({url:n}),e._cacheBehaviorAudio[n]=r)}t.isButton?i.domMode?(a.addClass("xut-behavior"),setTimeout(function(){a.removeClass("xut-behavior"),o()},500)):console.log("feedbackBehavior"):o()},s={init:function(t){i.dragDrop=t},startRun:function(){},stopRun:function(t){t&&e.runAnimation()}},c=function(){var t=e.relatedData.contentDataset[e.id];if(t&&t.trackCode&&No.sendTrackCode("content",{pageId:e.pageId,id:e.id,type:e.type,eventName:i.eventName}),i.rewrite)return void e.runAnimation();var n=i.feedbackBehavior[i.eventContentId];n?r(n):o()},l=function(t,e){i.eventReference=t,i.eventHandler=e};if(a&&n)if(!No.launch.swipeDelegate||"swiperight"!==n&&"swipeleft"!==n){var u=void 0,d=void 0,h=void 0;h=i.dragdropPara,"dragTag"===n&&(u=this.makePrefix("Content",this.chapterIndex,h),d=this.getContextNode(u)),i.isBind=!0,hi({target:d,eventName:n,eventRun:c,eventDrop:s,eventHandler:l,eventContext:a,parameter:h,domMode:i.domMode})}else e.relatedCallback.swipeDelegateContents(n,function(t){e.runAnimation(t)})}}(Ru);var Lu=function(t,e){var i=void 0,n=Xut.config.screenSize;return i=n.width>n.height?'<div class="page-scale-close" style="position: absolute;right:'+t+"px;top:"+e+'px;">\n           <div class="si-icon Flaticon flaticon-error" style="font-size:5.3vw;border-radius:50%;right:0">\n           </div>\n        </div>':'<div class="page-scale-close" style="position: absolute;right:'+t+"px;top:"+e+'px;">\n             <div class="si-icon Flaticon flaticon-error" style="font-size:5.3vh;border-radius:50%;right:0;"></div>\n        </div>',$(String.styleFormat(i))},Fu=function(){function t(e){var i=e.rootNode,n=e.hasButton,a=void 0===n||n,o=e.updateHook,r=e.tapClose,s=void 0!==r&&r,c=e.tapCallabck;fo(this,t),this.hasButton=a,this.updateHook=o,this.tapClose=s,this.tapCallabck=c,this.rootNode=i instanceof $?i[0]:i,this._offsetWidth=this.rootNode.offsetWidth,this._offsetHeight=this.rootNode.offsetHeight,this._initState(),this._initEvent()}return vo(t,[{key:"_initState",value:function(){this.maxScale=No.launch.salePictureMultiples||4,this.overflowValue=.3,this.hasZoom=!1,this.scaleing=!1,this.lastScale=1,this.ticking=!1,this.currentX=0,this.currentY=0,this.data={translate:{x:0,y:0},scale:1},this._buttonHide()}},{key:"_initEvent",value:function(){var t=this;this.hammer=new Hammer.Manager(this.rootNode),this.hammer.add(new Hammer.Pan({threshold:0,pointers:0,enable:!1})),this.hammer.add(new Hammer.Pinch({threshold:0})).recognizeWith(this.hammer.get("pan")),this.hammer.add(new Hammer.Tap);var e={pinchstart:"_onPinchStart",pinchmove:"_onPinchMove",pinchend:"_onPinchEnd","panstart panmove":"_onPan",panend:"_onPanEnd",pinchcancel:"_onPinchEnd"};this.tapClose&&(e.tap="_onTap"),_.each(e,function(e,i){t.hammer.on(i,function(i){i.preventDefault(),i.srcEvent.stopPropagation(),t[e](i)})})}},{key:"_onTap",value:function(){this.tapCallabck?this.tapCallabck():this.tapClose&&1!=this.data.scale&&this.reset()}},{key:"_onDoubletap",value:function(){this.reset()}},{key:"_onPinchStart",value:function(t){this.lastScale=this.data.scale||1}},{key:"_onPinchMove",value:function(t){if(!this.scaleing){if(t.scale<this.overflowValue+1)return;this.scaleing=!0}var e=t.scale-this.overflowValue;(e=this.lastScale*e)>this.maxScale||(this.data.scale=e,this._buttonShow(),this._isBoundry(),this._updateNodeStyle())}},{key:"_onPinchEnd",value:function(t){var e=this;this.data.scale<=1?Xut.nextTick(function(){e._initState(),e._updateNodeStyle(500)}):this.overflowValue=0}},{key:"_onPan",value:function(t){this._isRunning&&(0!=this.currentX||0!=this.currentY?this.data.translate={x:this.currentX+t.deltaX,y:this.currentY+t.deltaY}:this.data.translate={x:0+t.deltaX,y:0+t.deltaY},this._isBoundry(),this._updateNodeStyle())}},{key:"_onPanEnd",value:function(){this.currentX=this.data.translate.x,this.currentY=this.data.translate.y}},{key:"_isBoundry",value:function(){if(this._isRunning){var t=(this.data.scale-1)/2*this._offsetWidth,e=(this.data.scale-1)/2*this._offsetHeight;this.data.translate.x>=t&&(this.data.translate.x=t),this.data.translate.x<=-t&&(this.data.translate.x=-t),this.data.translate.y>=e&&(this.data.translate.y=e),this.data.translate.y<=-e&&(this.data.translate.y=-e)}else this.data.scale=1,this.data.translate.x=0,this.data.translate.y=0}},{key:"_updateNodeStyle",value:function(){
var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.ticking||(Xut.nextTick(function(){var i=t.data,n={translate:{x:i.translate.x,y:i.translate.y},scale:{x:i.scale,y:i.scale}};Xut.style.setTransform({speed:e,translate:n.translate,scale:n.scale,node:t.rootNode}),t.updateHook&&t.updateHook(n,e),t.ticking=!1}),this.ticking=!0)}},{key:"reset",value:function(){this._initState(),this._updateNodeStyle(500)}},{key:"_createPinchButton",value:function(){var t=this,e=No.visualSize,i=e.overflowWidth&&Math.abs(e.left)||0,n=e.overflowHeight&&Math.abs(e.top)||0,a=Ki(function(){t.reset()},i,n);return $(this.rootNode).after(a),a}},{key:"_buttonShow",value:function(){var t=this;this._isRunning||this.data.scale>1&&(this.hasButton&&(this.$buttonNode?Xut.nextTick(function(){t.$buttonNode.show()}):this.$buttonNode=this._createPinchButton()),Xut.View.SetSwiperDisable(),this._isRunning=!0,this.hammer.get("pan").set({enable:!0}))}},{key:"_buttonHide",value:function(){this._isRunning&&(this.hasButton&&this.$buttonNode.hide(),this._isRunning=!1,Xut.View.SetSwiperEnable(),this.hammer.get("pan").set({enable:!1}))}},{key:"destroy",value:function(){this.$buttonNode&&(this.$buttonNode.off(),this.$buttonNode=null),this.hammer&&(this.hammer.destroy(),this.hammer=null),this.$buttonNode&&this.$buttonNode.off(),this.update=null,this.rootNode=null}}]),t}(),Gu=999999,zu={scenarioStack:[],scenarioChain:[]},Wu={createIndex:function(){return--Gu},add:function(t,e,i){return zu.scenarioStack.push(t),zu["seasonId->"+t]=i,zu.scenarioChain.push({seasonId:t,chapterId:e}),i},takeOutPrevChainId:function(){zu.scenarioChain.pop();return zu.scenarioChain.length>1?zu.scenarioChain.pop():zu.scenarioChain[0]},checkToRepeat:function(t){var e,i=zu.scenarioChain.length;if(e=i>1?zu.scenarioChain[i-2]:zu.scenarioChain[i-1],e.seasonId==t&&this.takeOutPrevChainId(),zu.scenarioStack[0]==t){var n=zu.scenarioChain.shift();zu.scenarioChain.length=0,zu.scenarioChain.push(n)}},containerObj:function(t){if("current"===t){var e=zu.scenarioStack;t=e[e.length-1]}return zu["seasonId->"+t]},findIndexOfId:function(t){return zu.scenarioStack.lastIndexOf(t)},remove:function(t){var e=this.findIndexOfId(t);zu.scenarioStack.splice(e,1),delete zu["seasonId->"+t]},destroyAllScene:function(){var t=_.clone(zu.scenarioStack);_.each(t,function(t){zu["seasonId->"+t].destroy()}),zu.scenarioChain=[]},rewrite:function(t,e){_.each(zu.scenarioChain,function(i){i.seasonId==t&&(i.chapterId=e)})},expose:function(){return zu},sequence:function(t,e){var i=zu.scenarioChain;if(i.length>1){var n=[];return _.each(i,function(i){i.seasonId==t?n.push(i.seasonId+"-"+i.chapterId+"-"+e):n.push(i.seasonId+"-"+i.chapterId)}),n}},seqReverse:function(t){var t=t.split(","),e=t.length;return 1!==e&&(2===e?t[1]:(_.each(t,function(t,i){if(i>=1&&i<e-1){var t=t.split("-");zu.scenarioChain.push({seasonId:t[0],chapterId:t[1],pageIndex:t[2]})}}),t[e-1]))}},ju=function(){function t(e){var i=e.element,n=e.originalSrc,a=e.hdSrc,o=e.hasButton,r=void 0!==o&&o;fo(this,t);var s=Wu.containerObj("current");if(s&&(this.$container=s.getSceneNode()),!this.$container.length)return void bo("图片缩放依赖的容器不存在");var c=0,l=0,u=No.visualSize;u.left&&(c=u.left,l=u.top),this.$imgNode=i,this.originSrc=n,this.hdSrc=a,this.hasButton=r,this.originImgWidth=i.width(),this.originImgHeight=i.height();var d=i.offset();this.originImgLeft=d.left-c,this.originImgTop=d.top-l-No.launch.visualTop,this.isCloseAniming=!1,this.source=[{pos:0,src:a?a:n,width:200}],this._init()}return vo(t,[{key:"_init",value:function(){this._initSingleView(),this._bindTapClose(),this.targetSize||(this.targetSize=this._getData()),this._startZoom()}},{key:"_initSingleView",value:function(){var t=this;this.$singleView=$(Zi({width:this.originImgWidth,height:this.originImgHeight,left:this.originImgLeft,top:this.originImgTop,originSrc:this.originSrc})),this.$overlay=this.$singleView.find(".xut-zoom-overlay"),this.$flyNode=this.$singleView.find(".xut-zoom-fly"),this.hasButton&&(this.$closeButton=this.$singleView.find(".xut-zoom-close"),this.callbackEnd=function(){t._closeSingleView()},T(this.$closeButton,{end:this.callbackEnd,cancel:this.callbackEnd}),this.$closeButton.show()),this.$singleView.appendTo(this.$container)}},{key:"_getData",value:function(){var t=No.screenSize,e=0;return No.visualSize.left&&(t=No.visualSize),3===No.launch.visualMode&&(t=No.screenSize,e=No.visualSize.left),en({sources:this.source,wrapper:{width:t.width,height:t.height,left:e},image:{width:this.originImgWidth,height:this.originImgHeight}})}},{key:"_startZoom",value:function(){var t=this,e=this.targetSize.source,i=this.targetSize.position;tn({element:this.$flyNode,style:{width:i.width,height:i.height,left:i.left,top:i.top},speed:300},function(){t._replaceHQIMG(i,e.src)}),tn({element:this.$overlay,style:{opacity:1},speed:300})}},{key:"_createHQIMG",value:function(t,e,i,n){function a(){r||(r=!0,o=null,n())}if(this.$hQNode)return this.$hQNode.show(),void i();var o=new Image,r=!1,s=this;o.onload=function(){if(s.isCloseAniming)return void a();s.$hQNode=$(o),s.$hQNode.css({width:t.width,height:t.height,left:t.left,top:t.top}).addClass("xut-zoom-hd").appendTo(s.$singleView),o=null,i(500)},o.onerror=function(){a()},o.src=e}},{key:"_bindPan",value:function(t){var e=this;if(!this.slideObj&&Xut.plat.hasTouch&&No.launch.salePicture){var i=function(){return e._closeSingleView()};this.slideObj=new Fu({hasButton:!1,rootNode:t,tapClose:!0,tapCallabck:i})}}},{key:"_addPinchPan",value:function(){this.$hQNode?(this._hasBindFlyPan&&(this._hasBindFlyPan=!1,this._destroyRelated()),this._bindPan(this.$hQNode)):this.$flyNode&&(this._hasBindFlyPan=!0,this._bindPan(this.$flyNode))}},{key:"_stopDefault",value:function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}},{key:"_bindTapClose",value:function(t){var e=this,i=!1,n=function(t){e._stopDefault(t),i=!1},a=function(t){e._stopDefault(t),i=!0},o=function(t){e._stopDefault(t),i||e.slideObj||e._closeSingleView()};T(this.$singleView,{start:n,move:a,end:o,cancel:o})}},{key:"_replaceHQIMG",value:function(t,e){var i=this;this.hdSrc?this._createHQIMG(t,e,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;tn({element:i.$flyNode,style:{opacity:0},speed:t},function(){i.$flyNode.hide(),i._addPinchPan()})},function(){i._addPinchPan()}):this._addPinchPan()}},{key:"_reset",value:function(){if(this.$flyNode.css({width:this.originImgWidth,height:this.originImgHeight,left:this.originImgLeft,top:this.originImgTop,opacity:1,display:"block"}),this.$hQNode){var t=this.targetSize.position;this.$hQNode.css({width:t.width,height:t.height,left:t.left,top:t.top,display:"none"})}this.hasButton&&this.$closeButton.show(),this.$overlay.css("opacity",0),this.slideObj&&this.slideObj.reset()}},{key:"_closeSingleView",value:function(){var t=this;if(!this.isCloseAniming){this.isCloseAniming=!0;var e=this.$hQNode?this.$hQNode:this.$flyNode;this.hasButton&&this.$closeButton.hide(),tn({element:e,style:{width:this.originImgWidth,height:this.originImgHeight,left:this.originImgLeft,top:this.originImgTop},speed:300},function(){t.$singleView.hide(),t._reset(),t.isCloseAniming=!1}),tn({element:this.$overlay,style:{opacity:0},speed:200})}}},{key:"play",value:function(){this.$singleView.show(),this._startZoom()}},{key:"_destroyRelated",value:function(){this.slideObj&&(this.slideObj.destroy(),this.slideObj=null)}},{key:"destroy",value:function(){this._destroyRelated(),S(this.$singleView),this.hasButton&&(S(this.$closeButton),this.$closeButton=null),this.$hQNode=null,this.$overlay=null,this.$container=null,this.$flyNode=null,this.$imgNode=null,this.$singleView.remove(),this.$singleView=null}}]),t}(),Vu={};_.each("jsWidget content svgWidget canvasWidget path".split(" "),function(t,e){Vu[t]=!0});var Yu=["seasonId","Inapp","SearchBar","BookMarks"],Uu=Xut.style.maskBoxImage,qu=Math.floor,Ku=function(t,e){var i=t.mask?Uu+":url("+tt(t.mask,"content-mask")+");":"",n=e.resourcePath,a="";if(t.mask||e.isGif)a+=void 0!=Uu?String.styleFormat('<img data-type="'+(t.qrCode?"qrcode":"mask")+'"\n              class="inherit-size fullscreen-background edges"\n              src="'+n+"\"\n              onerror=\"fixNodeError('image',this,'"+e.chapterIndex+"','"+n+'\')"\n              style="'+i+'"/>'):String.styleFormat('<canvas class="inherit-size fullscreen-background edges"\n                 src="'+n+'"\n                 mask="'+i+'"\n                 width="'+t.scaleWidth+'"\n                 height="'+t.scaleHeight+'"\n                 style="opacity:0;'+(No.data.pathAddress.replace(/\//g,"/")+t.mask)+'"/>');else if("Sprite"==t.category){var o=100*t.thecount,r=100;if(t.parameter){var s=m(t.parameter);if(s&&s.matrix){var c=s.matrix.split("-");o=100*Number(c[0]),r=100*Number(c[1])}}a+=String.styleFormat('<div data-type="sprite-images"\n            class="sprite"\n            style="height:'+t.scaleHeight+"px;\n                   background-image:url("+n+");\n                   background-size:"+o+"% "+r+'%;">\n      </div>')}else a+=String.styleFormat('<img data-type="'+(t.qrCode?"qrcode":"ordinary")+'"\n            class="inherit-size fullscreen-background fix-miaomiaoxue-img"\n            src="'+n+"\"\n            onerror=\"fixNodeError('image',this,'"+e.chapterIndex+"','"+n+'\')"\n            style="'+i+'"/>');return a},Qu=function(t){return String.styleFormat('<div id="'+t._id+'"\n          style="background-size:100% 100%;height:auto">\n          '+t.content+"\n    </div>")},Zu=function(t,e){return ot(e.htmlstr)},Ju=function(t,e){var i="",n=e.svgstr,a=t.scaleWidth;if(void 0!=n){n=ot(n);var o=n.search('viewBox="'),r=n.substring(o,o+64).replace('viewBox="',"").replace("0 0 ",""),s=r.search('"'),c=r.substring(0,s),l=c.split(" "),u=l[0],d=l[1],h=qu(a*d/u);if(h>t.scaleHeight+1){var p=qu(a),f=e.backMode?t.scaleLeft-t.scaleBackLeft:0,v=e.backMode?t.scaleTop-t.scaleBackTop:0;i=t.isScroll?String.styleFormat('<div data-type="svg"\n                style="width:'+p+"px;\n                       height:"+h+"px;\n                       margin-left:"+f+"px;\n                       margin-top:"+v+'px;">\n                '+n+"\n          </div>"):String.styleFormat('<div data-type="svg"\n                class="inherit-size"\n                style="margin-left:'+f+"px;\n                       margin-top:"+v+'px;">\n              '+n+"\n          </div>")}else i+=n}return i},td=function(t,e){var i="";return i+=e.fileName?e.isSvg?Ju(t,e):e.isJs?Zu(0,e):Ku(t,e):Qu(t)},ed=function(t,e){var i=void 0,n=void 0,a=void 0,o=void 0,r=void 0,s=t.zIndex,c=(t._id,e.containerName);t.scaleBackWidth&&t.scaleBackHeight?(n=t.scaleBackWidth,a=t.scaleBackHeight,o=t.scaleBackLeft,r=t.scaleBackTop,e.backMode=!0):(n=t.scaleWidth,a=t.scaleHeight,o=t.scaleLeft,r=t.scaleTop);var l="visible";t.visible&&(l="hidden");var u=t.filterNames?t.filterNames.join(" "):"";return e.isJs?(i='<div id="'+c+'"\n                   data-behavior="click-swipe"\n                   class="fullscreen-background '+u+'"\n                   style="width:'+n+"px;\n                          height:"+a+"px;\n                          top:"+r+"px;\n                          left:"+o+"px;\n                          position:absolute;\n                          z-index:"+s+";\n                          visibility:"+l+';\n                          {10}">\n               <div data-type="scroller"\n                    style="width:'+n+'px;\n                           position:absolute;">',String.styleFormat(i)):(i='<div id="'+c+'"\n                   data-behavior="click-swipe"\n                   class="'+u+'"\n                   style="width:'+n+"px;\n                          height:"+a+"px;\n                          top:"+r+"px;\n                          left:"+o+"px;\n                          position:absolute;\n                          z-index:"+s+";\n                          visibility:"+l+'">\n              <div data-type="scroller"\n                   class="fullscreen-background "\n                   style="width:'+n+"px;\n                          height:"+a+"px;\n                          position:absolute;\n                          "+(t.background?"background-image: url("+tt(t.background,"content-container")+");":"")+'">',String.styleFormat(i))},id=function(t,e,i,n){var a=mn([e]),o=st({results:a[0],proportion:n.pageProportion}),r='<div  id="'+t+'"\n               data-behavior="click-swipe"\n               style="width:'+o.scaleWidth+"px;\n                      height:"+o.scaleHeight+"px;\n                      top:"+o.scaleTop+"px;\n                      left:"+o.scaleLeft+"px;\n                      position:absolute;\n                      z-index:"+o.zIndex+';">';return String.styleFormat(r)},nd=function(t,e){var i=e.data,n=e.contentId,a=e.conData;i.canvasRelated[t].indexOf(n)==-1&&(i.canvasRelated[t].push(n),a.actionTypes[t]=!0),i.canvasRelated.contentIdset.indexOf(n)==-1&&i.canvasRelated.contentIdset.push(n),a.canvasMode=!0,a.zIndex&&a.zIndex>i.canvasRelated.containerIndex&&(i.canvasRelated.containerIndex=a.zIndex)},ad={Sprite:function(t,e){e.canvasRelated.enable&&nd("spiritId",t)},PPT:function(t,e){e.canvasRelated.enable&&t.conData.canvasMode&&nd("pptId",t)},SeniorSprite:function(t,e){e.canvasRelated.enable&&nd("widgetId",t)},CompSprite:function(t){var e=t.data;t.conData;if(/\./i.test(t.conData.md5))return void console.log("复杂精灵动画数据错误");e.canvasRelated.enable||e.canvasRelated.onlyCompSprite||(e.canvasRelated.onlyCompSprite=!0),nd("compSpriteId",t)}},od=function(t,e,i,n){var a="_"+n+"_"+t;return{pageType:i,contentId:t,isJs:/.js$/i.test(e.md5),isSvg:/.svg$/i.test(e.md5),contentData:e,chapterIndex:n,containerName:"Content"+a,makeId:function(t){return t+a}}},rd=function(t,e){var i=void 0,n=e.md5,a=/.gif$/i.test(n);if("AutoCompSprite"===e.category)try{i=tt(n,"content-autoCompSprite",a);var o=et(i+"/app.json"),r=o.spiritList[0],s=r.params.actList;i+="/"+r.params[s].ImageList[0].name,e.resource=o,e.containerName=t.containerName}catch(t){console.log("AutoCompSprite获取数据失败")}else{var c=tt(n,"content",a);i=No.launch.preload?c:a?at(c):c}t.fileName=n,t.isGif=a,t.resourcePath=i},sd=function(t,e){t.isSvg?lt(t.contentData.md5,function(i){t.svgstr=i,e(t)}):t.isJs?lt(t.contentData.md5,function(i){t.htmlstr=i,e(t)},"js"):e(t)},cd=function(t,e){return t&&e&&No.debug.devtools&&bo("content缩放模式fixRadio与headerFooterMode重叠,优先选择headerFooterMode模式"),e?e:t?3:void 0},ld=function(t){function e(t,i,n){fo(this,e);var a=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));_.extend(a,t),a.success=i;var o=fn(t);return o?(t=hn(o,t),t.createContentIds.length?a._dataAfterCheck(t):a._loadComplete()):a._loadComplete(),a}return mo(e,t),vo(e,[{key:"_checkNextTask",value:function(t,e){var i=void 0;this.base.hasAutoRun&&"strAfter"===t&&(i=!0),this._$$checkNextTask("内部contents",function(){e()},i)}},{key:"_dataAfterCheck",value:function(t){var e=this;this._checkNextTask("dataAfter",function(){pn(t),wn(t,e.$$floatDivertor,function(i){t.contentHtmlBoxIds=i.contentHtmlBoxIds,t.contentsFragment={},Xut.IBooks.runMode()?_.each(i.idFix,function(e){t.contentsFragment[e]=t.$containsNode.find("#"+e)[0]}):(t.contentsFragment=kn(i.contentStr),delete i.contentStr),t.containerPrefix=i.containerPrefix,Xut.Contents.contentsFragment[t.chapterId]||Xut.Contents.contentsFragment[t.chapterId],Xut.Contents.contentsFragment[t.chapterId]=t.contentsFragment,e._dataStrCheck(t,i)})})}},{key:"_dataStrCheck",value:function(t,e){var i=this;this._checkNextTask("strAfter",function(){Object.keys(t.zoomBehavior).length&&(i.zoomObjs=an(t),i.zoomBehavior=t.zoomBehavior),e.textFx.length&&(i.textFxObjs=ki(t,e.textFx)),Wu.seasonRelated=t.seasonRelated,qi(function(n){i._eventAfterCheck(t,n,e.headerFooterMode)},t,e.contentDataset,i.$$floatDivertor)})}},{key:"_eventAfterCheck",value:function(t,e,i){var n=this;this._checkNextTask("eventAfter",function(){t.taskCount=1;var a=function(){var t=e.iscrollHooks,i=void 0;if(t.length)for(;i=t.shift();)i()},o=function(){return function(){if(1===t.taskCount)return e&&a(),void n._applyAfterCheck();--t.taskCount}}();if(n._$$createFloatLayer(o,t,n.base.floatGroup),Xut.IBooks.runMode())o();else{var r=_n(t.contentsFragment,i),s=r.bodyContent,c=r.headerFooterContent,l=0;if(c.length&&++l,s.length&&++l,!l)return void o();var u=function(){return function(){if(1===l)return void o();--l}}();c.length&&Br({container:t.$headFootNode,content:r.headerFooterContent},u),s.length&&Br({container:t.$containsNode,content:r.bodyContent},u)}})}},{key:"_applyAfterCheck",value:function(){var t=this;this._checkNextTask("applyAfter",function(){t._loadComplete(!0)})}},{key:"_loadComplete",value:function(){this.success&&this.success()}},{key:"_destroy",value:function(){this.textFxObjs&&(_.each(this.textFxObjs,function(t){t.destroy()}),this.textFxObjs=null),Xut.Contents.contentsFragment[this.chapterId]&&delete Xut.Contents.contentsFragment[this.chapterId],this.zoomBehavior&&Object.keys(this.zoomBehavior).length&&(_.each(this.zoomBehavior,function(t){t.off&&t.off()}),this.zoomBehavior=null,_.each(this.zoomObjs,function(t){t.destroy()}),this.zoomObjs=null),this.canvasRelated=null,this.pageBaseHooks=null,this.$containsNode=null,this.rootNode=null,this.contentsFragment=null}}]),e}(Pl),ud=function(){return window.MMXCONFIG?function(){return!(window.MMXCONFIG.back||Xut.Application.IsBackStage())}:function(){return!0}}(),dd=[],hd=null,pd=function(){},fd=function(t,e){var i=function(){var n=t.length;return function(){1===n&&(e&&e(),i=null),n--}}();_.each(t,function(t,e){Xut.CreateFilter.has(t.pageId,t.id)?i():t.autoPlay(i)})},vd=function(t,e,i,n){void 0===e&&(e=Xut.Presentation.GetPageIndex());var a=t.baseGetPageId(e),o=void 0;_.each(i,function(i,r){(o=Od[i.actType])&&o.autoPlay&&o.autoPlay({id:i.id,pageType:n,rootNode:t.getContainsNode(),chapterId:a,category:i.category,autoPlay:i.autoPlay,pageIndex:e})})},gd=function(t){4!==!No.launch.visualMode&&t&&t()},md=function(t){t=JSON.parse(t),t.seasonId?Xut.View.GotoSlide(t.seasonId,t.chapterId):Xut.View.GotoSlide(t)},yd={createDom:function(t,e,i,n,a,o){var r=t._id,s=t.md5,c=t.actType,l=t.scaleWidth,u=t.scaleHeight,d=t.scaleTop,h=t.scaleLeft;return String.styleFormat('<div id="'+c+"_"+r+'"\n            data-belong="'+o+'"\n            data-delegate="action"\n            style="cursor:pointer;\n                   width:'+l+"px;\n                   height:"+u+"px;\n                   left:"+h+"px;\n                   top:"+d+"px;\n                   background-size:100% 100%;\n                   position:absolute;\n                   z-index:"+a+";\n            "+(s?"background-image: url("+tt(s,"hot-action")+");":"")+'">\n      </div>')},trigger:function(t){An(t)}},bd={},xd=function(t){var e=bd[t];if(e)return delete bd[t],e},wd={createDom:function(t,e,i,n,a,o){var r=t._id,s=(t.md5,t.actType,t.category),c=t.itemArray,l=t.scaleWidth,u=t.scaleHeight,d=t.scaleTop,p=t.scaleLeft;if(!l||!u)return"";var f=void 0,v=void 0,g=void 0,y=void 0,b=void 0,x="";if(c){if(c=m(c),c.length){var w=c[0],k=c[1];w&&(v=w.startImg?w.startImg:"",g=w.script?w.script:""),k&&(y=w.stopImg?w.stopImg:"",b=k.script?w.script:"")}else a=c.zIndex,f=c.display,v=c.startImage,g=c.startScript,y=c.stopImage,b=c.stopScript;bd[r]={},v&&(bd[r].startImage=v,v="background-image:url("+tt(v,"hot-media")+");"),g&&(bd[r].startScript=g),y&&(bd[r].stopImage=y,y="background-image:url("+tt(y,"hot-media")+");"),b&&(bd[r].stopScript=b)}"webpage"==s&&l>200&&u>100&&l<=No.visualSize.width&&u<=No.visualSize.height&&(x='<div id="icon_'+r+'"\n              type="icon"\n              style="width:74px;\n                     height:74px;\n                     top:'+(u-74)/2+"px;\n                     left:"+(l-74)/2+'px;\n                     position:absolute;background-image:url(images/icons/web_hotspot.png)">\n         </div>');var _=h(s),I=v||"";Xe(i,r)&&(I=y);var P=!1,T=He(_,r);T&&T.isfloat&&(P=!0);var S="hidden"===f?"visibility:hidden;":"";return{html:String.styleFormat('<div id="'+_+"_"+r+'"\n            data-belong="'+o+'"\n            data-delegate="'+s+'"\n            style="width:'+l+"px;\n                   height:"+u+"px;\n                   left:"+p+"px;\n                   top:"+d+"px;\n                   z-index:"+a+";\n                   "+S+"\n                   "+I+'\n                   background-size:100% 100%;\n                   position:absolute;">\n            '+x+"\n       </div>"),hasFloat:P}},autoPlay:function(t){var e=t.id,i=t.pageType,n=t.category,a=t.rootNode,o=t.pageIndex,r=t.chapterId;n&&("audio"==n?Ne(r,e,xd(e)):(a=a.closest("#"+Xut.View.GetPageNodeIdName(i,o,r)),a.length||(a=a.closest("li")),We({pageType:i,rootNode:a,chapterId:r,pageIndex:o,activityId:e})))},trigger:function(t){var e=t.id,i=t.target,n=t.rootNode,a=t.pageIndex,o=t.activityId,r=t.columnData,s=void 0===r?{}:r;if(s.isColumn)return void("Audio"===s.type?Be({activityId:o,columnData:s,chapterId:s.chapterId,data:xd(e)}):je({chapterId:s.chapterId,columnData:s,activityId:o,rootNode:n,pageIndex:a}));var c=i.getAttribute("data-delegate");if(c){var l=i.getAttribute("data-belong"),u=Xut.Presentation.GetPageId(l,a);"audio"==c?Be({chapterId:u,activityId:o,data:xd(e)}):je({chapterId:u,activityId:o,rootNode:n,pageIndex:a,pageType:l})}},destory:function(){}},kd={},_d=function(t,e){kd[t]||(kd[t]=[]),kd[t].push(e),kd[t].length>1||D(t,function(){_.each(kd[t],function(t){t&&t()}),kd[t]=null,delete kd[t]})},Id=function(){function t(e,i){fo(this,t),this.data=e,this.options=i,this.scrolls=[],this._init()}return vo(t,[{key:"_init",value:function(){for(var t=this.options,e=this.data.contentPrefix,i=0;i<t.length;i++){var n=this._create(t[i],e);n&&this.scrolls.push(n)}}},{key:"_createWrapper",value:function(){return String.styleFormat('<div data-type="area-wrapper"\n                  style="position:absolute;width:100%; height:100%;overflow:hidden;">\n                <ul data-type="area-scroller"\n                     data-behavior="disable"\n                     style="position:absolute; width:100%; height:100%;overflow:hidden;">\n                </ul>\n             </div>')}},{key:"_create",value:function(t,e){var i=t.id,n=e+i,a=m(t.theTitle),o=a["data-widgetscrollareaList"].split(",");if(0!=o.length){var r=$("#"+n);if(0==r.length)return void console.log(i+"not find obj");var s=a["data-widgetscrollareascrolltype"]?a["data-widgetscrollareascrolltype"]:"xy";s=s.toLowerCase();var c=s.indexOf("x")>-1,l=s.indexOf("y")>-1,u=void 0,d=r.attr("data-iscroll");if(d){if("visible"===d)return u=r.children('div[data-type="area-wrapper"]'),this._bindIscroll(u[0],c,l,i)}else{Xut.Contents.ResetDefaultControl("page",n,"");var h={x:parseInt(r.css("left")),y:parseInt(r.css("top")),w:parseInt(r.css("width")),h:parseInt(r.css("height"))},p=this._getSize(o,e),f=p.min,v=p.max;u=$(this._createWrapper());var g=u.children();r.append(u),this._setScrollerStyle(v,f,h,c,l,g);var y=this._resetContents(o,e,h,c,l,f),b=this._createSnapContainer(y,g,i,c,l);if(c)for(var x=0;x<o.length;x++){var w=e+o[x],k=$("#"+w);k.appendTo(b[Math.floor(x/y.contentsPerSnapX)])}if(l)for(var x=0;x<o.length;x++){var w=e+o[x],k=$("#"+w);k.appendTo(b[Math.floor(x/y.contentsPerSnapY)])}var _=b.parent();if(c){parseInt(_.css("width"))<h.w&&(c=!1)}if(l){parseInt(_.css("height"))<h.h&&(l=!1)}if(l||c)return r.attr("data-iscroll","visible"),1==b.length?this._bindIscroll(u[0],c,l):this._bindIscroll(u[0],c,l,i);r.attr("data-iscroll","hidden")}}}},{key:"_bindIscroll",value:function(t,e,i,n){return n?Ii(t,{scrollX:!!e,scrollY:!!i,snap:".contentsContainer"+n,scrollbars:"custom"}):Ii(t,{scrollX:!!e,scrollY:!!i,scrollbars:"custom"})}},{key:"_getSize",value:function(t,e){for(var i={l:null,t:null},n={l:null,t:null},a=void 0,o=0;o<t.length;o++)if(a=$("#"+e+t[o]),0!=a.length){var r=parseInt(a.css("width")),s=parseInt(a.css("left")),c=parseInt(a.css("height")),l=parseInt(a.css("top")),u=s,d=l;(null==n.l||n.l>u)&&(n.l=u),(null==n.t||n.t>d)&&(n.t=d);var h=r+s,p=c+l;(null==i.l||i.l<h)&&(i.l=h),(null==i.t||i.t<p)&&(i.t=p)}else console.log(t[o]+" not find");return{min:n,max:i}}},{key:"_setScrollerStyle",value:function(t,e,i,n,a,o){var r=0,s=0,c={x:0,y:0},l={x:0,y:0};e.l<i.x?c.x=e.l:c.x=i.x,e.t<i.y?c.y=e.t:c.y=i.y,t.l>i.x+i.w?l.x=t.l:l.x=i.x+i.w,t.t>i.y+i.h?l.y=t.t:l.y=i.y+i.h,r=!n&&l.x-c.x>i.w?i.w:l.x-c.x,s=!a&&l.y-c.y>i.h?i.h:l.y-c.y,o.css({width:r+"px",height:s+"px"})}},{key:"_resetContents",value:function(t,e,i,n,a,o){for(var r=void 0,s=void 0,c=void 0,l=void 0,u=void 0,d=void 0,h=0,p=0,f=new Array,v=new Array,g=t.length,m=0;m<g;m++){var y=e+t[m],b=$("#"+y);if(Xut.Contents.ResetDefaultControl("page",y,""),"true"!=b.attr("data-iscroll")){var x=parseInt(b.css("left")),w=parseInt(b.css("top"));parseInt(b.css("width"));x-=o.l<i.x&&n?o.l:i.x,w-=o.t<i.y&&a?o.t:i.y,b.css("left",x),b.css("top",w),f.push(x),v.push(w),b.css("visibility","inherit"),b.attr("data-iscroll","true")}}if(f=this._bubbleSort(f),v=this._bubbleSort(v),n){for(var k=0;k<f.length;k++){var _=f[k];_<i.w?h++:r||(r=h,u=_)}r?c=Math.ceil(t.length/r):(r=t.length,c=1,u=i.w)}if(a){for(var k=0;k<v.length;k++){var _=v[k];_<i.h?p++:s||(s=p,d=_)}for(var I=1,P=0;P<g;P++){var y=e+t[P],b=$("#"+y),w=parseInt(b.css("top"));if(P>0){var T=e+t[P-1],S=$("#"+T);if(!(w<parseInt(S.css("top"))+10))break;I++}}s?l=Math.ceil(t.length/s):(s=Math.floor(t.length/I)+1,l=1,d=i.h)}return{contentsPerSnapX:r,snapXCount:c,snapContainerWidth:u,contentsPerSnapY:s,snapYCount:l,snapContainerHeight:d}}},{key:"_bubbleSort",value:function(t){for(var e=0;e<t.length-1;e++)for(var i=0;i<t.length-1-e;i++)if(t[i]>t[i+1]){var n=t[i];t[i]=t[i+1],t[i+1]=n}return t}},{key:"_createSnapContainer",value:function(t,e,i,n,a){var o="";if(n)for(var r=parseInt(e.css("width")),s=t.snapXCount,c=t.snapContainerWidth,l=r-(s-1)*c,u=void 0,d=0;d<t.snapXCount;d++)u=d==t.snapXCount-1?l:c,o+='<li class="contentsContainer'+i+"\"\n                                      style='width:"+u+"px;height:100%;float:left;'>\n                                  </li>";else if(a)for(var h=(parseInt(e.css("height")),t.snapYCount,t.snapContainerHeight),d=0;d<t.snapYCount;d++)o+='<li class="contentsContainer'+i+"\"\n                                      style='height:"+h+"px;width:100%;float:left;'>\n                                  </li>";return o=$(o),o.appendTo(e),o}},{key:"destroy",value:function(){if(this.scrolls.length){for(var t=0;t<this.scrolls.length;t++){var e=this.scrolls[t];e&&(e.scrollTo(0,0),e.destroy()),this.scrolls[t]=null}this.scrolls=null}this.data.container=null,this.options=null}}]),t}(),Pd=function(t,e,i){var n=[];return e.content&&_.each(e.content,function(t){n.push(t)}),Xut.Contents.GetPageWidgetData(t,n,i)},Td=function(){function t(e){fo(this,t),_.extend(this,e),this.pageObj=null,this._init()}return vo(t,[{key:"_getOptions",value:function(){return[Rn(this.inputPara,this.scrollPaintingMode,this.calculate),Pd(this.pageType,this.inputPara,this.pageProportion)]}},{key:"_resetOpacityVisibility",value:function(t,e){for(var i=new Array,n=0;n<e.length;n++)!function(){var a=e[n],o=$("#"+a.idName),r=o.css("visibility");if("hidden"==r){if(0==n){var s=e[0],c=t.contentPrefix,l=void 0,u=void 0,d=void 0,h=m(s.theTitle),p=h["data-widgetscrollareaList"].split(",");p[0]&&(l=c+p[0],u=$("#"+l),d=u.css("visibility"),u.css("visibility","hidden"));var f=function(){u.css("visibility",d)};i.push(f)}var v=o.css("opacity"),g=function(t,e){arguments.length>1?o.css(t,e):o.css(t)};if(0==v){g("visibility","visible");var y=function(){g("visibility",r)};i.push(y)}else{g({opacity:0,visibility:"visible"});var b=function(){g({visibility:r,opacity:v})};i.push(b)}}}();return i}},{key:"_init",value:function(){if(60==this.widgetId&&"scrollarea"==this.widgetName){var t=this._getOptions(),e=this._resetOpacityVisibility(t[0],t[1]);this.pageObj=new Id(t[0],t[1]),_.each(e,function(t,e){t()}),e=null}else if(72==this.widgetId&&"spirit"==this.widgetName){var t=this._getOptions();this.pageObj=Ul(t[0],t[1])}else"function"!=typeof window[this.widgetName+"Widget"]?(this.hasload=!0,Hn(this._executive,this)):this._executive()}},{key:"_executive",value:function(){if("function"==typeof window[this.widgetName+"Widget"]){var t=this._getOptions();this.pageObj=new window[this.widgetName+"Widget"](t[0],t[1])}else console.error("Function ["+this.widgetName+"Widget] does not exist.")}},{key:"play",value:function(){return this.pageObj.play()}},{key:"toggle",value:function(){this.pageObj&&this.pageObj.toggle&&this.pageObj.toggle()}},{key:"stop",value:function(){this.pageObj&&this.pageObj.stop&&this.pageObj.stop()}},{key:"destroy",value:function(){this.hasload&&On(),this.pageObj&&this.pageObj.destroy&&this.pageObj.destroy()}}]),t}(),Sd=function(){function t(e){var i=this;return fo(this,t),_.extend(this,e),this._$wapper=this._createWapper(),Xut.nextTick({container:this.rootNode,content:this._$wapper},function(){i.rootNode=null,i._bindMessage()}),this}return vo(t,[{key:"_createWapper",value:function(){return 0!==this.zIndex&&(this.zIndex=this.zIndex||Xut.zIndexlevel()),this._$iframe=this._createIframe(),$(String.styleFormat('<div id="widget_iframe_'+this.id+'"\n            style="z-index:'+this.zIndex+";\n                   width:"+this.width+"px;\n                   height:"+this.height+"px;\n                   top:"+this.top+"px;\n                   left:"+this.left+'px;\n                   position:absolute;">\n       </div>')).append(this._$iframe)}},{key:"_createIframe",value:function(){var t=this,e=document.createElement("iframe"),i=No.data.rootPath+"/widget/"+this.widgetId+"/index.html?xxtParaIn="+this.key;return e.id="iframe_"+this.id,e.src=i,e.style.width="100%",e.style.height="100%",e.sandbox="allow-scripts allow-same-origin",e.frameborder=0,e.attachEvent?e.attachEvent("onload",function(){t._iframeComplete()}):e.onload=function(){t._iframeComplete()},e}},{key:"_iframeComplete",value:function(){var t=Ln(this.inputPara),e=this._$iframe.offsetWidth,i=this._$iframe.offsetHeight;.98*t.screenSize.width<=e&&.98*t.screenSize.height<=i?Xut.View.Toolbar({show:"button",hide:"controlBar"}):.7*t.screenSize.width<=e&&.7*t.screenSize.height<=i&&Xut.View.Toolbar({show:"button"}),PMS.send({target:this._$iframe.contentWindow,origin:"*",type:"loadData",data:t,success:function(){},error:function(){}}),this.state=!0}},{key:"_bindMessage",value:function(){var t=this,e=this.id,i=this._$wapper,n=$(this._$iframe);PMS.bind("onHideWapper"+e,function(){i.hide(),t.state=!1},"*"),PMS.bind("onFullscreen"+e,function(e){if(n.length){if(Ye(),i.css({width:"100%",height:"100%",zIndex:Xut.zIndexlevel(),top:0,left:0}),0==e.full){var a=document.body,o=parseInt(a.clientWidth),r=parseInt(a.clientHeight),s=t.width/t.height,c=function(t,e,i){var n=t,a=t/i;return a>e&&(a=e,n=a*i),{w:parseInt(n),h:parseInt(a)}}(o,r,s),l=(o-c.w)/2,u=(r-c.h)/2;n.css({width:c.w,height:c.h,position:"absolute",top:u,left:l})}Xut.View.Toolbar("hide")}},"*"),PMS.bind("onReset"+e,function(){n.length&&(i.css({zIndex:t.zIndex,width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px"}),n.css({width:"100%",height:"100%",position:"",top:"0",left:"0"}),Xut.View.Toolbar("show"))},"*"),PMS.bind("onHideToolbar"+e,function(){Xut.View.HideToolBar()},"*"),PMS.bind("scrollToPage"+e,function(t){Xut.View.GotoSlide(t.ppts,t.pageIndex)},"*")}},{key:"_send",value:function(t){PMS.send({type:t,origin:"*",target:this._$iframe.contentWindow,url:this._$iframe.src,success:function(){}})}},{key:"_perform",value:function(t,e){var i=this;this.state?this._$wapper.hide():this._$wapper.show(),this._send(t),setTimeout(function(){i.state=e},0)}},{key:"_start",value:function(){this._perform("onShow",!0)}},{key:"_stop",value:function(){this._perform("onHide",!1)}},{key:"stop",value:function(){this._stop()}},{key:"toggle",value:function(){this.state?this._stop():this._start()}},{key:"destroy",value:function(){var t=this;this._send("onDestory"),PMS.unbind(),setTimeout(function(){t._$iframe=null,t._$wapper.remove(),t._$wapper=null},0)}}]),t}(),Cd=function(t){Wu.containerObj("current").$$mediator.$injectionComponent=t},$d=function(t,e,i){Cd({
pageType:e.pageType,pageIndex:e.pageIndex,widget:new i(e)})},Md={iframe:function(t){$d(0,t,Sd)},widget:function(t){$d(0,t,Sd)},js:function(t){$d(0,t,Td)},page:function(t){$d(0,t,Td)},svg:function(t){$d(0,t,Td)},canvas:function(t){$d(0,t,Td)},webgL:function(t){$d(0,t,Td)}},Xd=function(t){return t.widgetId?_.extend(t,Xut.data.query("Widget",t.widgetId)):_.extend(t,Xut.data.query("Widget",t.activityId,"activityId")),t},Nd=function(t,e){st({results:t,getStyle:e,proportion:e.pageProportion});return t.width=t.scaleWidth,t.height=t.scaleHeight,t.top=t.scaleTop,t.left=t.scaleLeft,t},Bd=function(t){var e=void 0;return(e=t.inputPara)?m(e):{}},Dd={createDom:function(t,e,i,n,a,o){var r=t._id,s=t.md5,c=t.autoPlay,l=t.actType,u=t.scaleWidth,d=t.scaleHeight,h=t.scaleTop,p=t.scaleLeft;return c?"":String.styleFormat('<div id="'+l+"_"+r+'"\n            data-belong="'+o+'"\n            data-delegate="'+l+'"\n            style="cursor:pointer;\n                   background-size:100% 100%;\n                   position:absolute;\n                   width:'+u+"px;\n                   height:"+d+"px;\n                   left:"+p+"px;\n                   top:"+h+"px;\n                   z-index:"+a+";\n            "+(s?"background-image: url("+tt(s,"hot-widget")+");":"")+'">\n      </div>')},autoPlay:function(t){var e=t.id;Fn({rootNode:t.rootNode,pageType:t.pageType,pageIndex:t.pageIndex,activityId:e,isAutoPlay:!0})},trigger:function(t){return Fn(t)}},Ad=function(){function t(e){fo(this,t),e.id=parseInt(e.id),e.actType=e.type,_.extend(this,e),this.setup()}return vo(t,[{key:"setup",value:function(){var t=this,e=this.data.note,i=Xut.config.proportion,n=Math.round((i.width+i.height)/2*No.data.iconHeight),a=Math.round(n/2),o='<div class="xut-shownote-box" style="z-index:'+Xut.zIndexlevel()+'"><div class="close" style="width:'+n+"px;height:"+n+"px;top:-"+a+"px;right:-"+a+'px"></div><div class="content">'+e+"</div></div>";return this._dom=$(o),this._dom.find(".close").on("touchend mouseup",function(){t.toggle()}),$(this.rootNode).append(this._dom),this.show(),this.iscroll=Ii(this._dom.find(".content")[0],{scrollbars:"custom",fadeScrollbars:!0}),!0}},{key:"toggle",value:function(){this.isAutoPlay||(this.state?this.hide():this.show())}},{key:"stop",value:function(){return!!this.state&&(this.toggle(),!0)}},{key:"hide",value:function(){this.state=!1,$("#ShowNote_"+this.id).css("background-image","url(images/icons/hideNote.png)"),this._dom.hide()}},{key:"show",value:function(){this.state=!0,$("#ShowNote_"+this.id).css("background-image","url(images/icons/showNote.png)"),this._dom.show()}},{key:"destroy",value:function(){this._dom&&(this._dom.find(".close").off(),this._dom&&this._dom.hide().remove()),this.iscroll&&(this.iscroll.destroy(),this.iscroll=null)}}]),t}(),Ed={createDom:function(t,e,i,n,a,o){var r=t._id,s=(t.md5,t.actType,t.category,t.itemArray,t.scaleWidth),c=t.scaleHeight,l=(t.scaleTop,t.scaleLeft,(s+c)/2*No.data.iconHeight);return String.styleFormat('<div id="ShowNote_'+r+'"\n            class="xut-showNote"\n            data-belong ="'+o+'"\n            data-delegate="shownote"\n            style="width:'+l+"px;height:"+l+'px">\n       </div>')},trigger:function(t){t.data=Xut.Presentation.GetPageData(t.pageIndex),new Ad(t)},autoPlay:function(){},destroy:function(t){this&&this.destroy()}},Od={Video:wd,Audio:wd,Webpage:wd,Action:yd,Widget:Dd,ShowNote:Ed},Hd=function(t){function e(t,i,n){fo(this,e);var a=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,n));return Xut.IBooks.runMode()?(i(),yo(a)):(t.activitys&&t.activitys.length?(a.success=i,a.$containsNode=t.$containsNode,a.pageBaseHooks=t.pageBaseHooks,a.pipeData=t,a._checkNextTask(a._create(t))):i(),a)}return mo(e,t),vo(e,[{key:"_create",value:function(){var t=this,e=this.pipeData,i=e.pageType,n=e.activitys,a=e.chpaterData,o=e.chapterId,r=e.chapterIndex,s=[],c=function(e,n){n=st({results:n,proportion:t.pipeData.getStyle.pageProportion});var c=Od[e].createDom(n,a,o,r,Xut.zIndexlevel(),i);_.isString(c)?s.push(c):c.hasFloat?t.$$floatDivertor[i].html.push(c.html):s.push(c.html)};return n.forEach(function(t,e){var i=t.actType||t.animation;switch(!i&&t.note&&(t.actType=i="ShowNote"),i){case"ShowNote":case"Action":case"Widget":case"Audio":case"Video":c(i,t)}}),s.join("")}},{key:"_checkNextTask",value:function(t){var e=this;this._$$checkNextTask("内部Component",function(){e._float(function(){e._render(t)})})}},{key:"_float",value:function(t){var e=this;this.pipeData.taskCount=0;var i=function(){return function(){if(1===e.pipeData.taskCount)return void t();--e.pipeData.taskCount}}();this._$$createFloatLayer(i,this.pipeData),0===this.pipeData.taskCount&&(i=null,t())}},{key:"_render",value:function(t){var e=this;t?Xut.nextTick({container:this.$containsNode,content:$(t)},function(){e._destroy(),e.success()}):(this._destroy(),this.success())}},{key:"_destroy",value:function(){this.$containsNode=null}}]),e}(Pl),Rd=Xut.style.transitionDuration,Ld=function(t,e,i,n){t&&("v"===No.launch.scrollMode?Xut.style.setTranslate({node:t,speed:i,y:e}):Xut.style.setTranslate({node:t,speed:i,x:e}),n&&n())},Fd=function(t,e){t&&("v"===No.launch.scrollMode?Xut.style.setTranslate({node:t,y:e}):Xut.style.setTranslate({node:t,x:e}))},Gd=function(t){t&&(Xut.style.setTranslate({node:t,x:0,y:0}),t.style[Rd]="")},zd=function(){Ld.apply(void 0,arguments)},Wd=function(){Ld.apply(void 0,arguments)},jd=function(){Ld.apply(void 0,arguments)},Vd={set:Fd,reset:Gd,flipMove:zd,flipRebound:Wd,flipOver:jd},Yd=function(t){return"v"===No.launch.scrollMode?Xut.style.setTranslateStyle(0,t):Xut.style.setTranslateStyle(t,0)},Ud={flipMove:{prev:function(t,e){var i=t("middle"),n=t("left");return i&&i.visualLeftInteger?n&&n.visualLeftInteger?-n.visualWidth+e:e-n.visualWidth-i.visualLeftInteger:n&&n.visualLeftInteger?e-n.visualWidth+n.visualLeftInteger:e-n.visualWidth},next:function(){}},flipRebound:{prev:function(t){var e=t("middle"),i=t("left");return e&&e.visualLeftInteger?i&&i.visualLeftInteger?-i.visualWidth:-(i.visualWidth+e.visualLeftInteger):i&&i.visualLeftInteger?-(i.visualWidth-i.visualLeftInteger):-i.visualWidth},next:function(){}},flipOver:{prev:function(t,e){return 0},next:function(){}}},qd={flipMove:{prev:function(){},next:function(){}},flipOver:{prev:function(t,e){var i=t("middle"),n=t("left");return i&&i.visualLeftInteger?n&&n.visualLeftInteger?i.visualWidth:i.visualWidth-i.visualLeftInteger:n&&n.visualLeftInteger?i.visualWidth+n.visualLeftInteger:i.visualWidth},next:function(t){var e=t("middle"),i=t("right");return e&&e.visualLeftInteger?i&&i.visualLeftInteger?-e.visualWidth:-(e.visualWidth-e.visualLeftInteger):i&&i.visualLeftInteger?-(e.visualWidth+i.visualLeftInteger):-i.visualWidth}}},Kd={flipMove:{prev:function(){},next:function(t,e){var i=t("middle"),n=t("right");return i&&i.visualLeftInteger?n&&n.visualLeftInteger?e+n.visualWidth:e+i.visualWidth-i.visualLeftInteger:n&&n.visualLeftInteger?e+i.visualWidth+n.visualLeftInteger:e+n.visualWidth}},flipRebound:{prev:function(){},next:function(t){var e=t("right");if(e&&5===e.pageVisualMode)return e.visualWidth/2;var i=t("middle");return i&&i.visualLeftInteger?e&&e.visualLeftInteger?e.visualWidth:i.visualWidth-i.visualLeftInteger:e&&e.visualLeftInteger?i.visualWidth+e.visualLeftInteger:i.visualWidth}},flipOver:{prev:function(){},next:function(){return 0}}},Qd={flipMove:{prev:function(t,e){return e-t("top").visualHeight}},flipRebound:{prev:function(t){return-t("top").visualHeight}},flipOver:{prev:function(){return 0}}},Zd={flipOver:{prev:function(t){return t("middle").visualHeight},next:function(t){return-t("middle").visualHeight}}},Jd={flipMove:{next:function(t,e){return e+t("bottom").visualHeight}},flipRebound:{next:function(t){return t("bottom").visualHeight}},flipOver:{next:function(){return 0}}},th=function(t){if(void 0===t)return{};var e=Xut.Presentation.GetPageBase(t);return e&&e.getStyle||{}},eh=function(t,e,i,n){return function(a){return a&&a[t]&&a[t][e]&&a[t][e](n,i)}},ih=function(t){var e=t.action,i=t.distance,n=t.direction,a=t.frontIndex,o=t.middleIndex,r=t.backIndex,s=t.orientation;s||(s=No.launch.scrollMode);var c=0,l=0,u=0,d=void 0,h=function(t){var e=void 0;switch(t){case"left":case"top":e=a;break;case"right":case"bottom":e=r;break;case"middle":e=o}return th(e)},f=eh(e,n,i,h);return p(e,["flipMove","flipRebound"])&&("h"===s?(c=f(Ud),u=f(Kd)):(c=f(Qd),u=f(Jd)),l=i),"flipOver"===e&&("h"===s?(c=f(Ud),l=f(qd),u=f(Kd)):(c=f(Qd),l=f(Zd),u=f(Jd)),d="prev"===n?c:u),[c,l,u,d]},nh=function(t){var e=t.action,i=t.distance,n=t.direction,a=(t.frontIndex,t.middleIndex),o=t.backIndex,r=0,s=a,c=No.screenSize.width;return"next"===n&&("flipMove"!==e&&"flipRebound"!==e||(r=-(c*a)+i),"flipOver"===e&&(r=-(c*o))),[0,r,0,s]},ah="data-linearVisual",oh=600,rh=Xut.style.transitionDuration,sh=Math.abs,ch=function(t){return t.touches&&t.touches.length>1},lh=function(t){function e(t){var i=t.scope,n=void 0===i?"child":i,a=t.snap,o=void 0===a||a,r=t.snapSpeed,s=void 0===r?800:r,c=t.banMove,l=void 0!==c&&c,u=t.momentum,d=void 0===u||u,h=t.scrollX,p=void 0===h||h,f=t.scrollY,v=void 0!==f&&f,g=t.mouseWheel,m=void 0!==g&&g,y=t.hasHook,b=void 0!==y&&y,x=t.borderBounce,w=void 0===x||x,k=t.stopPropagation,_=void 0!==k&&k,I=t.preventDefault,P=void 0===I||I,T=t.insideScroll,S=void 0!==T&&T,C=t.container,$=t.visualIndex,M=t.totalIndex,X=t.actualWidth,N=t.actualHeight,B=t.hasMultiPage,D=t.sectionRang,A=t.visualWidth;fo(this,e);var E=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return S&&(!A||A&&X<A)&&(S=!1,bo("启动了insideScroll，但是条件还不成立")),e.mixProperty(E,{container:C,visualIndex:$,totalIndex:M,actualWidth:X,actualHeight:N,visualWidth:A}),E.options={scope:n,snap:o,banMove:l,scrollX:p,scrollY:v,momentum:d,mouseWheel:m,insideScroll:S,hasHook:b,borderBounce:w,stopPropagation:_,preventDefault:P,hasMultiPage:B,sectionRang:D},E.direction="",E.enabled=!0,E._defaultFlipTime=l?0:s,E._speedRate=E._originalRate=E._defaultFlipTime/(p?X:N),E.pagePointer=jn($,M),E._recordRreTick={ation:null,time:null},E._init(),E.keepDistX=0,E.keepDistY=0,E.insideScrollRange={min:.01*A,max:A-.01*A},E}return mo(e,t),vo(e,null,[{key:"mixProperty",value:function(t,e){for(var i in e)t[i]=e[i]}},{key:"getDate",value:function(){return+new Date}},{key:"getConfig",value:function(){var t=!0,e=!1;return"v"===No.launch.scrollMode&&(t=!1,e=!0),{scrollY:e,scrollX:t,banMove:No.launch.banMove}}}]),vo(e,[{key:"handleEvent",value:function(t){this.options.stopPropagation&&t.stopPropagation(),C({start:function(t){this.options.hasHook||this._stopDefault(t),this._onStart(t)},move:function(t){this._stopDefault(t),this._onMove(t)},end:function(t){this.options.hasHook||this._stopDefault(t),this._onEnd(t)},transitionend:function(t){this._stopDefault(t),this._onComplete(t)}},this,t)}},{key:"_onStart",value:function(t){if(this.enabled&&!ch(t)){var i=e.getDate();if(!(this._clickTime&&i-this._clickTime<350)){this._clickTime=i;var n=void 0,a=X(t);if(!a)return void(this._stopped=!0);this.$$emit("onFilter",function(){n=!0},a,t),n||(this._stopped=!1,this._banBounce=!1,this._hasTap=!0,this._isInvalid=!1,this._moved=!1,this._behavior="swipe",this._directionBan=!1,this.orientation="",this.distX=0,this.distY=0,this.touchX=0,this.touchY=0,this.pointX=a.pageX,this.pointY=a.pageY,this.firstMovePosition=0,this.startTime=e.getDate())}}}},{key:"_onMove",value:function(t){if(this.enabled&&this._hasTap&&!this._stopped){this._moved=!0;var e=X(t),i=e.pageX-this.pointX,n=e.pageY-this.pointY,a=sh(i),o=sh(n),r=void 0;a>o?(this.orientation||(this.orientation="h"),i,r=a):o>=a&&(this.orientation||(this.orientation="v"),n,r=o),this.options.scrollX&&"v"===this.orientation?(r>80&&(this._behavior="reverse"),this._directionBan="v"):this.options.scrollY&&"h"===this.orientation&&(r>80&&(this._behavior="reverse"),this._directionBan="h");var s=void 0;if("h"===this.orientation?(this.touchX=this._getDist(i,a),s=this.distX=this.touchX+this.keepDistX,this.setDirection(i)):"v"===this.orientation&&(this.touchY=this._getDist(n,o),s=this.distY=this.touchY+this.keepDistY,this.setDirection(n)),!this._directionBan){var c=s;if(!(r<=10)){"prev"===this.direction?c=this.distX=this.distY=s-10:"next"===this.direction&&(c=this.distX=this.distY=s+10);var l=this;this._distributeMove({distance:c,speed:0,action:"flipMove",setPageBanBounce:function(t){if(!l.options.borderBounce&&(l._banBounce=l._borderBounce(t)))return!0;if(l.options.insideScroll){var e=Math.abs(t);if(l.firstMovePosition||(l.firstMovePosition=e),"next"===l.direction){if(e>=l.visualWidth)return l.firstMovePosition>l.insideScrollRange.max?!l.options.hasMultiPage&&(l._setKeepDist(-l.visualWidth,0),l._banBounce=!0,!0):(l._setKeepDist(-l.visualWidth,0),l._banBounce=!0,!0)}else if("prev"===l.direction&&t>=0)return!(l.firstMovePosition<l.insideScrollRange.min)&&(l._setKeepDist(0,0),l._banBounce=!0,!0)}},setSwipeInvalid:function(){l._isInvalid=!0}})}}}}},{key:"_onEnd",value:function(t){if(this.enabled&&!this._banBounce&&!this._stopped&&!ch(t)){this._hasTap=this._moved=!1;var i=void 0;this.startTime&&(i=e.getDate()-this.startTime);var n=sh(this.distX),a=sh(this.distY),o=this.orientation;if(!n&&!a){var r=!1;if(this.$$emit("onTap",this.visualIndex,function(){return r=!0},t,i),r)return}if("reverse"===this._behavior&&"mouseleave"!==t.type&&No.sendTrackCode("swipe",{direction:o,pageId:this.visualIndex+1}),("v"!==this._directionBan||this.distX)&&("h"!==this._directionBan||this.distY)){if(this._isInvalid){var s=void 0;return"h"===o?s=i<200&&n>this.actualWidth/10:"v"===o&&(s=i<200&&a>this.actualHeight/10),s&&this._distributeMove({action:"swipe"}),void this._setRestore()}var c=this.getActionType(this.touchX,this.touchY,i);if("flipOver"===c&&No.launch.preload){de({type:"linear",direction:this.direction,processed:function(){this._nextAction("flipOver"),Xut.View.HideBusy()}},this)&&(Xut.View.ShowBusy(),c="flipRebound")}this._nextAction(c)}}}},{key:"_nextAction",value:function(t){if(this._isFirstOrEnd()){if(this.options.insideScroll){if("next"===this.direction){if("flipMove"===t)this._setKeepDist(this.distX,this.distY);else if("flipOver"===t||"flipRebound"===t){var e=-(this.actualWidth/2);this._setRebound({distance:e}),this._setKeepDist(e)}}else if("prev"===this.direction){this._setRebound({distance:0}),this._setKeepDist(0)}return}this._setKeepDist(),this._setRebound()}else if("flipOver"===t)this._setKeepDist(),this._slideTo({action:"inner"});else if("flipRebound"===t)if(this.options.insideScroll){if("next"===this.direction){var i=-(this.actualWidth/2);this._setRebound({distance:i}),this._setKeepDist(i)}else if("prev"===this.direction){this._setRebound({distance:0}),this._setKeepDist(0)}}else this._setRebound();else"flipMove"===t&&this._setKeepDist(this.distX,this.distY)}},{key:"_setKeepDist",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.keepDistX=t,this.keepDistY=e}},{key:"_isFirstOrEnd",value:function(t){return!!this.options.snap&&("h"===this.orientation?!this.visualIndex&&this.distX>0||this.visualIndex==this.totalIndex-1&&this.distX<0:"v"===this.orientation?!this.visualIndex&&this.distY>0||this.visualIndex==this.totalIndex-1&&this.distY<0:void 0)}},{key:"_onWheel",value:function(t){t.preventDefault(),t.stopPropagation();var e=void 0;if("deltaX"in t)-t.deltaX,e=-t.deltaY;else if("wheelDeltaX"in t)t.wheelDeltaX,e=t.wheelDeltaY;else if("wheelDelta"in t)e=t.wheelDelta;else{if(!("detail"in t))return;e=-t.detail}this.orientation="v",this.$$emit("onWheel",t,e)}},{key:"_onComplete",value:function(t){var e=t.target,i=e.getAttribute("data-type"),n=e.getAttribute("data-visual"),a=e.getAttribute(ah);return this._removeDuration(e),a&&!n?void this._distributeComplete(e,n):n?void this._distributeComplete(e,n):void(i||this.$$emit("onMasterMove",this.visualIndex,e))}},{key:"_getDist",value:function(t,e){return t/(!this.visualIndex&&t>0||this.visualIndex==this.totalIndex-1&&t<0?e/this.actualWidth+1:1)}},{key:"_borderBounce",value:function(t){return 0===this.visualIndex&&t>0?(this._setKeepDist(0,0),!0):this.visualIndex===this.totalIndex-1&&t<0||void 0}},{key:"_setRebound",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.distance,i=void 0===e?0:e,n=t.direction,a=t.isAppBoundary;this._distributeMove({direction:n||this.direction,distance:i,isAppBoundary:a,speed:300,action:"flipRebound"})}},{key:"_removeDuration",value:function(t){t&&(t.style[rh]="")}},{key:"_setRestore",value:function(t,e){this._stopped=!0,this._hasTap=!1,this._resetRate(),e&&t&&t.removeAttribute("data-visual")}},{key:"_updateVisualIndex",value:function(t){this.visualIndex=t}},{key:"_updatePointer",value:function(t,e,i){if(3===arguments.length)return void(this.pagePointer={frontIndex:t,middleIndex:e,backIndex:i});if(1===arguments.length){var n=t,a=n.viewFlip;return this._updateVisualIndex(n.targetIndex),3===a.length&&this._updatePointer(a[0],a[1],a[2]),void(2===a.length&&(0===a[0]?(this.pagePointer.backIndex=a[1],this.pagePointer.middleIndex=a[0],delete this.pagePointer.frontIndex):(this.pagePointer.frontIndex=a[0],this.pagePointer.middleIndex=a[1],delete this.pagePointer.backIndex)))}}},{key:"_off",value:function(){S(this.container)}}]),e}(Ds);!function(t){t.prototype.setDirection=function(t){void 0!==t&&(this.direction=t>0?"prev":"next")},t.prototype.getActionType=function(t,e,i,n){if("h"===(n=n||this.orientation)){if(this.options.insideScroll){if("prev"===this.direction&&this.distX<0)return"flipMove";if("next"===this.direction&&Math.abs(this.distX)<this.visualWidth)return"flipMove";if(!this.options.hasMultiPage)return"flipRebound"}return t=Math.abs(t),i<200&&t>30||t>this.actualWidth/6?"flipOver":"flipRebound"}if("v"===n)return e=Math.abs(e),i<200&&e>30||e>this.actualHeight/6?"flipOver":"flipRebound"},t.prototype.setLinearTotal=function(t,e){if("middle"===e){var i=void 0;this.totalIndex>1&&this.visualIndex==this.totalIndex-1&&(i=this.visualIndex),this.totalIndex=t,void 0!==i&&(this.setPointer(i-1,t),this._updatePointer())}"left"===e&&(this.totalIndex=t,this.visualIndex=t-1,this.setPointer(this.visualIndex,t),this._updatePointer(),this._setTransform()),"right"===e&&(this.totalIndex=t),this._setContainerValue()},t.prototype.getInitDistance=function(){return this._initDistance},t.prototype.simulationComplete=function(){var t=this;setTimeout(function(){t._setRestore(),t.enable()})},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.hasEnabled=function(){return this.enabled},t.prototype.isBorder=function(){this._borderBounce.apply(this,arguments)},t.prototype.getMoved=function(){return this._moved},t.prototype.prev=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.speed,n=e.callback;if(this._borderBounce(1))this._setRebound({direction:"next"}),n&&n();else{var a=function(){t._slideTo({speed:i,callback:n,direction:"prev",action:"outer"})};if(No.launch.preload&&de({type:"linear",direction:"prev",processed:function(){a(),Xut.View.HideBusy()}},this))return void Xut.View.ShowBusy();a()}},t.prototype.next=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.speed,n=e.callback;if(this._borderBounce(-1))this._setRebound({direction:"prev",isAppBoundary:!0}),n&&n();else{var a=function(){t._slideTo({speed:i,callback:n,direction:"next",action:"outer"})};if(No.launch.preload&&de({type:"linear",direction:"next",processed:function(){a(),Xut.View.HideBusy()}},this))return void Xut.View.ShowBusy();a()}},t.prototype.getVisualIndex=function(){return this.visualIndex},t.prototype.setPointer=function(t,e){this.pagePointer=jn(t,e||this.totalIndex)},t.prototype.getPointer=function(){return this.pagePointer},t.prototype.scrollToPage=function(t){if(this.enabled){var e=this.visualIndex;switch(this._setKeepDist(0,0),t){case e-1:if(this.options.hasMultiPage)return this.prev();break;case e:return void(0==e&&this.$$emit("onDropApp"));case e+1:if(this.options.hasMultiPage)return this.next()}var i=Wn(e,t,this.totalIndex);this._updatePointer(i),i.pagePointer=this.pagePointer,this.$$emit("onJumpPage",i)}},t.prototype._setPageMove=function(t,e){var i=this.actualWidth*(t/100)/2;if(0!=i){this.distX=this.distY=-i,this._setKeepDist(this.distX,this.distY);var n=this;this._distributeMove({distance:this.distX,speed:e,action:"flipMove",setSwipeInvalid:function(){n._isInvalid=!0}})}},t.prototype.clearDelayTimer=function(){this.delayTimer&&(clearTimeout(this.delayTimer),this.delayTimer=null)},t.prototype.scrollToPosition=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(this.clearDelayTimer(),n)return void(this.delayTimer=setTimeout(function(){e.clearDelayTimer(),e._setPageMove(t,i)},n));this._setPageMove(t,i)},t.prototype.destroy=function(){this._off(),this.$$unWatch(),this.clearDelayTimer(),this._childNodes&&(this._childNodes.page=null,this._childNodes.master=null),this.options.mouseWheel&&(this.container.removeEventListener("wheel",this._onWheel,!1),this.container.removeEventListener("mousewheel",this._onWheel,!1),this.container.removeEventListener("DOMMouseScroll",this._onWheel,!1)),this.container=null},t.prototype.setTransitionComplete=function(){this._distributeComplete.apply(this,arguments)},t.prototype.findBubbleRootNode=function(t,e){for(var i=void 0,n=void 0,a=this.visualIndex,o=this.options.sectionRang,r=this._childNodes[e].childNodes,s=r.length;s--;){if(i=r[s],n=i.getAttribute("data-chapter-index"),o&&(a+=o.start),n==a)return i;a=this.visualIndex}}}(lh),function(t){t.prototype._init=function(){this._initMode(),this._initEvents(),this._initPrevent(),this.options.mouseWheel&&this._initWheel()},t.prototype._initMode=function(){if(this.options.snap){var t=this.container.querySelectorAll("ul");t.length?this._childNodes={page:t[0],master:t[1]}:bo(" ul element don't found !")}"parent"===this.options.scope&&(this.options.scrollX?(this.container.setAttribute(ah,!0),this._setTransform(),this._setContainerValue()):this.options.scrollY&&(this.options.scrollerMode=!0,this.scroller=this.container.children[0],this.scrollerStyle=this.scroller.style,this.wrapperHeight=this.container.clientHeight,this.maxScrollY=this.wrapperHeight-this.scroller.offsetHeight,this._setTransform(this.scroller),this._setContainerValue(this.scroller)))},t.prototype._initPrevent=function(){this._stopDefault=this.options.preventDefault?function(t){t.preventDefault&&t.preventDefault()}:function(){}},t.prototype._setTransform=function(t){this._initDistance=-this.visualIndex*this._getRollVisual(),t?Xut.style.setTranslate({y:this._initDistance,node:t}):Xut.style.setTranslate({x:this._initDistance,node:this.container})},t.prototype._setContainerValue=function(t){t?t.style.height=this.actualHeight*this.totalIndex+"px":this.container.style.width=this.actualWidth*this.totalIndex+"px"},t.prototype._initEvents=function(){var t={start:this,end:this,cancel:this,leave:this};this.options.banMove||this.options.hasMultiPage&&(t.move=this,t.transitionend=this),!t.move&&this.options.insideScroll&&(t.move=this),T(this.container,t)},t.prototype._initWheel=function(){this.container.addEventListener("wheel",this._onWheel.bind(this),!1),this.container.addEventListener("mousewheel",this._onWheel.bind(this),!1),this.container.addEventListener("DOMMouseScroll",this._onWheel.bind(this),!1)}}(lh),function(t){t.prototype._transitionTime=function(t){t=t||0;var e=Xut.style.transitionDuration;e&&(this.scrollerStyle[e]=t+"ms")},t.prototype._transitionTimingFunction=function(t){this.scrollerStyle[Xut.style.transitionTimingFunction]=t},t.prototype._translate=function(t,e){"parent"===this.options.scope&&this.options.scrollY&&Xut.style.setTranslate({y:e,node:this.scroller}),this.x=t,this.y=e},t.prototype._getRollVisual=function(){return this.orientation?"h"===this.orientation?this.actualWidth:this.actualHeight:this.options.scrollX?this.actualWidth:this.actualHeight},t.prototype._getRollDist=function(){var t="h"===this.orientation?this.distX:this.distY,e=this._getRollVisual();return void 0===t?e/1.2:(t=Math.abs(t),t>e&&(t=e/2),Math.abs(t))},t.prototype._setRate=function(){this._speedRate=50/this._getRollVisual(),this._isQuickTurn=!0},t.prototype._resetRate=function(){this._speedRate=this._originalRate,this._isQuickTurn=!1},t.prototype._setQuick=function(){var e=t.getDate();this._preTapTime&&e-this._preTapTime<oh&&this._setRate(),this._preTapTime=t.getDate()},t.prototype._isBorder=function(t){var e=void 0,i=this.pagePointer,n=Object.keys(i).length;switch(t){case"prev":e=0===i.middleIndex&&2===n;break;case"next":e=i.middleIndex===this.totalIndex-1&&2===n}return e},t.prototype._getFlipOverSpeed=function(){var t=(this._getRollVisual()-this._getRollDist())*this._speedRate;return void 0===t&&(t=this._defaultFlipTime),t},t.prototype._getOuterSpeed=function(e){var i=void 0;if("outer"===e){if(e===this._recordRreTick.action){var n=t.getDate()-this._recordRreTick.time;i=n<=this._defaultFlipTime?n:this._defaultFlipTime}this._recordRreTick.time=t.getDate(),void 0===i&&(i=this._defaultFlipTime)}return this._recordRreTick.action=e,i},t.prototype._slideTo=function(t){var e=this,i=t.speed,n=t.action,a=t.direction,o=t.callback;if(this.enabled){a?this.direction=a:a=this.direction;var r=i||this._getOuterSpeed(n),s=void 0!==r;if(!this.options.snap||!this._isBorder(a)){this.disable(),this._setQuick(),o&&this.$$once("_slideFlipOver",o);var c=0;this.options.insideScroll&&"prev"===this.direction&&(c=-(this.actualWidth/2)),this._distributeMove({distance:c,speed:r||this._getFlipOverSpeed(),action:"flipOver",direction:a,outerCallFlip:s}),setTimeout(function(){e._updateActionPointer(),e.$$emit("onEnd",e.pagePointer),e._updateVisualIndex(e.pagePointer.middleIndex)},0)}}},t.prototype._updateActionPointer=function(){var t=this.pagePointer,e=Vn(this.direction,t.frontIndex,t.backIndex),i=e.createIndex,n=t.middleIndex;switch(this.direction){case"prev":-1<i&&this._updatePointer(i,t.frontIndex,t.middleIndex),-1===i&&(this.pagePointer.backIndex=t.middleIndex,this.pagePointer.middleIndex=t.frontIndex,delete this.pagePointer.frontIndex);break;case"next":this.totalIndex>i&&this._updatePointer(t.middleIndex,t.backIndex,i),this.totalIndex===i&&(this.pagePointer.frontIndex=t.middleIndex,this.pagePointer.middleIndex=t.backIndex,delete this.pagePointer.backIndex)}this.pagePointer.createIndex=i,this.pagePointer.destroyIndex=e.destroyIndex,this.pagePointer.stopIndex=n}}(lh),function(t){t.prototype._distributeMove=function(t){t.direction=this.direction,t.orientation=this.orientation;var e=this.pagePointer;t.frontIndex=e.frontIndex,t.backIndex=e.backIndex,t.middleIndex=this.visualIndex,this.$$emit("onMove",t)},t.prototype._distributeComplete=function(){var t=this;this._setRestore.apply(this,arguments),this.$$emit("_slideFlipOver");var e=function(){return t.enable()};setTimeout(function(){t.$$emit("onComplete",{unlock:e,direction:t.direction,pagePointer:t.pagePointer,isQuickTurn:t._isQuickTurn})},50)}}(lh);var uh={"data-xxtlink":function(t,e,i,n){try{var a=e.split("-");a.length>1?Xut.View.GotoSlide(a[0],a[1]):Xut.View.GotoSlide(a[0])}catch(t){console.log("跳转错误")}},"data-delegate":function(t,e,i,n){Xn({target:t,attribute:e,rootNode:i,pageIndex:n})},"data-flow":function(){},"data-canvas":function(t){}},dh=function(){function t(e){var i=this,n=e.rootNode,a=e.pptMaster,o=e.pageIndex,r=e.seasonId,s=e.chapterId,c=e.callback;fo(this,t),this._scaleObjs={},this.pptMaster=a,this.chapterId=s,this.seasonId=r,this.initIndex=o,this.$container=$($("#chapter-flow-"+s).html()),Xut.nextTick({container:n,content:this.$container},function(){"h"===No.launch.scrollMode?i._initX():"v"===No.launch.scrollMode&&i._initY(),c()})}return vo(t,[{key:"_zoomPicture",value:function(t){var e=t.src;if(e){var i=K(e),n=i.original,a=this._scaleObjs[n];if(a)return a.play();this._scaleObjs[n]=new ju({element:$(t),originalSrc:tt(i.suffix,"column-zoom"),hdSrc:Z(n)})}}},{key:"_getNodes",value:function(){if(this.pptMaster){for(var t=[],e=1/(this.columnCount-1),i=1;i<this.columnCount;i++)t.push(i*e);return t.push(0)}}},{key:"_getMasterObj",value:function(){if(this._masterObj)return this._masterObj;this.pptMaster&&(this._masterObj=Xut.Presentation.GetPageBase("master",this.initIndex))}},{key:"_moveParallax",value:function(t,e,i,n,a,o){var r=this._getMasterObj();r&&r.moveParallax({speed:e,action:t,direction:a,pageIndex:n+1,moveDistance:o,nodes:"next"===a?i[n]:""})}},{key:"_updataPageNumber",value:function(t,e){var i=this.initIndex;e&&(t="right"===e?"prev":"next","middle"===e&&i>0&&--i),Xut.View.UpdatePage({parentIndex:i,sonIndex:this.swipe.getVisualIndex()+1,hasSon:!0,direction:t})}},{key:"_initX",value:function(){var t=this.$container[0],e=this,i=c(1).width;this.columnCount=Et(this.seasonId,this.chapterId),e.minBorder=0,e.maxBorder=this.columnCount-1;var n=this._getNodes(),a={container:t,scope:"parent",snap:!1,hasHook:!0,hasMultiPage:!0,stopPropagation:!0,visualIndex:Xut.Presentation.GetPageIndex()>e.initIndex?e.maxBorder:e.minBorder,totalIndex:this.columnCount,actualWidth:i};_.extend(a,lh.getConfig());var o=this.swipe=new lh(a),r=0;e.lastDistance=o.getInitDistance();var s=void 0;o.$$watch("onFilter",function(t,e,i){s=!1,"qrcode"===Yn(i,e.target)&&(s=!0)}),o.$$watch("onTap",function(t,i,n,a){var r=n.target;s||(r&&"img"===r.nodeName.toLowerCase()&&e._zoomPicture(r),Xut.Contents.Canvas.getIsTap()||Xut.View.Toolbar()),qn(r,e.chapterId,o.visualIndex)}),o.$$watch("onMove",function(a){var s=a.action,c=a.speed,l=a.distance,u=a.direction;if(o.visualIndex===e.minBorder&&"prev"===o.direction)"flipOver"===s?(Oe(),Ye(),Xut.View.GotoPrevSlide({speed:c}),o.simulationComplete()):Xut.View.SetSwiperMove({speed:c,action:s,distance:l,direction:o.direction});else if(o.visualIndex===e.maxBorder&&"next"===o.direction)"flipOver"===s?(Oe(),Ye(),Xut.View.GotoNextSlide({speed:c}),o.simulationComplete()):Xut.View.SetSwiperMove({speed:c,action:s,distance:l,direction:o.direction});else{var d=Xut.Presentation.GetPageIndex(),h=zn({action:s,distance:l,direction:u,frontIndex:d,middleIndex:d,backIndex:d})[1];switch(r=h,u){case"prev":r+=e.lastDistance;break;case"next":r+=e.lastDistance}"flipRebound"===s&&(r="next"===u?-i*o.visualIndex:-(i*o.visualIndex)),"flipOver"===s&&(Oe(),Ye(),e._updataPageNumber(u)),Vd[s](t,r,c),e._moveParallax(s,c,n,o.visualIndex,u,h)}}),o.$$watch("onComplete",function(t){var i=t.unlock;e.lastDistance=r,i()})}},{key:"_initY",value:function(){var t=this,e=this.$container[0];this.columnCount=Et(this.seasonId,this.chapterId);var i=this.iscroll=_i(e,{});this.scrollBar=Xut.Application.GetScrollBarObject(),this.wheelEntryDirection="",this.touchEntryDirection="",this.initEntryDirection="",this.entryWay="";var n=!1;this.initIndex===Xut.Presentation.GetPageIndex()&&(n=!0,this.entryWay="init"),Xut.Presentation.GetPageIndex()>this.initIndex?(i.scrollTo(0,i.maxScrollY),this.visualIndex=this.columnCount-1,this.touchEntryDirection="up",n&&(this.initEntryDirection="up")):(this.visualIndex=0,this.touchEntryDirection="down",n&&(this.initEntryDirection="down"));var a=void 0;i.on("beforeScrollStart",function(t){a=!1,"qrcode"===Yn(t,t.target)&&(a=!0)}),i.on("scrollCancel",function(e){var i=e.target;a||(i&&"img"===i.nodeName.toLowerCase()&&t._zoomPicture(i),Xut.Contents.Canvas.getIsTap()||Xut.View.Toolbar()),qn(i,t.chapterId,0)}),i.on("scroll",function(e){t.scrollBar.showBar()}),i.on("intermit",function(e){t._updatePosition(e)}),i.on("scrollContent",function(e){t.entryWay||(t.entryWay="touch"),t._updatePosition(t.iscroll.y)}),i.on("momentum",function(e,i){t._updatePosition(e,i)}),i.on("scrollExit",function(e){t._leave(e)}),this.sizeRatioY=this.scrollBar.ratio*(this.columnCount-1)/this.iscroll.maxScrollY,this.wheellook=!1}},{key:"_leave",value:function(t){"down"===t?this.touchEntryDirection="up":"up"===t&&(this.touchEntryDirection="down"),this.wheelEntryDirection="",this.entryWay="",Oe(),Ye()}},{
key:"_updatePosition",value:function(t,e,i){var n="";if("init"===this.entryWay?n=this.initEntryDirection:"touch"===this.entryWay?n=this.touchEntryDirection:"wheel"===this.entryWay&&(n=this.wheelEntryDirection),"up"===n)return t=Math.round((this.iscroll.maxScrollY-t)*this.sizeRatioY),void this.scrollBar.updatePosition(t,e,"up");"down"===n&&(t=Math.round(this.sizeRatioY*t)||0,this.scrollBar.updatePosition(t,e,"down"))}},{key:"onWheel",value:function(t,e,i){var n=this;if(void 0!==e&&(this.entryWay||(this.entryWay="wheel"),this.wheelEntryDirection||(this.wheelEntryDirection=i),!this.wheellook)){if(0===this.iscroll.y&&"up"===i)return this.wheellook=!0,void Xut.View.GotoPrevSlide(function(){n.iscroll.scrollTo(0,0),n.wheellook=!1,n._leave("up")});if(this.iscroll.y===this.iscroll.maxScrollY&&"down"===i)return this.wheellook=!0,void Xut.View.GotoNextSlide(function(){n.iscroll.scrollTo(0,n.iscroll.maxScrollY),n.wheellook=!1,n._leave("down")});this.iscroll._wheel(t)}}},{key:"getEntry",value:function(){return this.entryWay}},{key:"_resetX",value:function(t){this.columnCount=t,this.maxBorder=t-1;var e=Xut.Presentation.GetPageId(),i=this.chapterId,n=void 0;e>i?n="left":e<i?n="right":e===i&&(n="middle"),this.swipe.setLinearTotal(t,n),this.lastDistance=this.swipe.getInitDistance(),this._updataPageNumber("",n)}},{key:"_resetY",value:function(t){console.log("竖版数据丢失，需要添加功能，补全")}},{key:"resetColumnDep",value:function(){var t=Et(this.seasonId,this.chapterId);t>this.columnCount&&("h"===No.launch.scrollMode?this._resetX(t):"v"===No.launch.scrollMode&&this._resetY(t))}},{key:"destroy",value:function(){var t=this;Object.keys(this._scaleObjs).length&&_.each(this._scaleObjs,function(e,i){e.destroy(),t._scaleObjs[i]=null}),this.iscroll&&this.iscroll.destroy(),this.swipe&&this.swipe.destroy()}}],[{key:"getScrollYIndex",value:function(t,e){var i=void 0,n=Math.abs(t);for(var a in e){var o=e[a];if(n>=o.min&&n<=o.max){i=a;break}}return Number(i)}},{key:"getScrollYRange",value:function(t,e){for(var i=Math.abs(t/e),n=e,a={};n--;)a[n]={min:Math.abs(n*i),max:Math.abs((n+1)*i)};return a}}]),t}(),hh=function(t,e){var i=t.chapterData;"page"===t.pageType&&Ot(i.seasonId,t.chapterId)?t.columnGroup.add(new dh({pptMaster:t.chapterData.pptMaster,pageIndex:t.pageIndex,rootNode:t.getContainsNode(),seasonId:t.chapterData.seasonId,chapterId:t.chapterId,callback:e})):e()},ph={"assign-container":function(t,e){yi(e,function(){var i=e.baseData();bi(i,e),Il(e,i,t)})},"assign-background":function(t,e){if(!e.rerunInstanceTask("assign-background")){var i=e.baseData(e.chapterIndex),n=e.getContainsNode();e.threadTaskRelated.assignTaskGroup["assign-background"]=new Ml(i,n,t,function(){e.detectorTask.apply(e,arguments)})}},"assign-column":function(t,e){hh(e,t)},"assign-component":function(t,e){if(!e.rerunInstanceTask("assign-component")){var i=e.chapterData,n=e.baseData();e.threadTaskRelated.assignTaskGroup["assign-component"]=new Hd({rootNode:e.rootNode,$containsNode:e.getContainsNode(),nodes:i.nodes,pageOffset:i.pageOffset,activitys:e.baseActivits(),chpaterData:n,chapterId:n._id,chapterIndex:e.chapterIndex,pageType:e.pageType,pageBaseHooks:e.divertorHooks,getStyle:e.getStyle},t,function(){e.detectorTask.apply(e,arguments)})}},"assgin-activity":function(t,e){if(Xut.data.preventContent)return t();if(!e.rerunInstanceTask("assgin-activity")){var i=e.chapterData,n=e.baseData();e.threadTaskRelated.assignTaskGroup["assgin-activity"]=new ld({base:e,canvasRelated:e.canvasRelated,rootNode:e.rootNode,$containsNode:e.getContainsNode(),$headFootNode:e.getHeadFootNode(),pageType:e.pageType,nodes:i.nodes,pageOffset:i.pageOffset,activitys:e.baseActivits(),chpaterData:n,chapterId:n._id,pageIndex:e.pageIndex,chapterIndex:e.chapterIndex,pageBaseHooks:e.divertorHooks,getStyle:e.getStyle},t,function(){e.detectorTask.apply(e,arguments)})}}},fh=function(){},vh=function(t,e){return new Fu({rootNode:t,hasButton:!0,tapClose:!0,updateHook:function(t,i){if(t){var n=Xut.Presentation.GetPageBase("master",e);if(n){var a=n.getContainsNode()[0];Xut.style.setTranslate({speed:i,translate:t.translate,scale:t.scale,node:a})}}}})},gh=function(t){var e={};return Object.keys(t).forEach(function(t){e[t]=!1}),e},mh=function(t){function e(){fo(this,e);var t=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.enable=!1,t.onlyCompSprite=!1,t.failCid=[],t.contentIdset=[],t.pptId=[],t.spiritId=[],t.widgetId=[],t.compSpriteId=[],t.containerIndex=1,t.collections={},t}return mo(e,t),e}(Ds),yh=function(t){var e=t.$contentNode,i=t.scope,n=t.direction,a=t.pageIndex,o=t.action,r=t.speed,s=t.nodes,c=t.distance,l=t.isColumn,u=i.lastProperty,d=i.targetProperty;if("prev"===n){var h=i.nodeRatio;s=s==h?0:h}var p=Li({nodes:s,isColumn:l,distance:c,lastProperty:u,pageIndex:a,targetProperty:d});switch(o){case"flipMove":p=Fi(p,u);break;case"flipRebound":p=zi(p,u);break;case"flipOver":"prev"===n&&(p=Gi(p,u)),"next"===n&&(void 0!==p.scaleX&&(p.scaleX=p.scaleX+1),void 0!==p.scaleY&&(p.scaleY=p.scaleY+1),void 0!==p.scaleZ&&(p.scaleZ=p.scaleZ+1)),Wi(p,u)}Hi({$contentNode:e,action:"master",interaction:o,pageIndex:a,targetProperty:d,property:p,speed:r,opacityStart:u.opacityStart})},bh=function t(e){fo(this,t),this.init(e)},xh=bh.prototype;!function(t){t.init=function(t){var e=this;_.extend(e,t),this.dataActionGroup={},this.seasonId=this.chapterData.seasonId,this.chapterId=this.chapterData._id,this.hasMultithread=!!this.hasMultiPage,"master"===e.pageType&&(this.isMaster=!0),this.canvasRelated=new mh,"flow"===e.chapterData.note&&(this.hasColumnData=!0),this.contentGroup={},this.activityGroup=new gi,this.componentGroup=new gi,this.columnGroup=new gi,No.launch.swipeDelegate&&(this.swipeSequence={swipeleft:[],swiperight:[],swipeleftTotal:0,swiperightTotal:0,swipeleftIndex:0,swiperightIndex:0});var i=this.floatGroup={pageContainer:null,pageGroup:{},masterContainer:null,masterGroup:{}};this.divertorHooks={threadtaskComplete:function(){Zn(e,No)},cacheActivity:function(t){e.activityGroup.add(t)},contents:function(t,i,n){var a=e.baseGetContentObject[i];a&&a.isBindEventHooks&&(e.contentGroup[i]=n),a||(e.contentGroup[i]=n)},floatPages:function(t){if(t&&i.pageContainer?bo("floatPages重复pageContainer","info"):i.pageContainer=t.container,t.ids.length){var n=void 0;_.each(t.ids,function(t){(n=e.baseGetContentObject(t))?(n.parallax&&(n.parallaxOffset=n.parallax.parallaxOffset),i.pageGroup[t]=n):console.log("页面浮动对象找不到")})}},floatMasters:function(t){if(t&&i.masterContainer?bo("floatMasters重复masterContainer","info"):i.masterContainer=t.container,t.ids.length){var n=void 0,a=void 0;_.each(t.ids,function(t){if(n=e.baseGetContentObject(t))n.parallax&&(n.parallaxOffset=n.parallax.parallaxOffset),i.masterGroup[t]=n;else{Xut.plat.isBrowser&&console.log("浮动母版对象数据不存在原始对象,制作伪对象母版移动",t);var o=e.threadTaskRelated["assgin-activity"],r=o.contentsFragment;if(r){var s="Content_"+e.chapterIndex+"_";_.each(r,function(e){var i=s+t;e.id==i&&(a=e)})}i.masterGroup[t]={id:t,chapterIndex:e.chapterIndex,$contentNode:$(a),empty:!0}}})}},eventBinding:function(t){fi(e,t)},swipeDelegateContents:function(t,i){++e.swipeSequence[t+"Total"],e.swipeSequence[t].push(i)}},Qn(e)}}(xh),function(t){t._checkNextTaskCreate=function(t){var e=this;if("complete"===this.threadTaskRelated.nextTaskName)return t();this._cancelTaskSuspend(),this.threadTaskRelated.createTasksComplete=function(){e.divertorHooks&&e.divertorHooks.threadtaskComplete(),t()},this.detectorTask({nextTask:function(){this.dispatchTasks()}})},t.dispatchTasks=function(){var t=this.threadtasks[this.threadTaskRelated.nextTaskName];t&&t.apply(void 0,arguments)},t.detectorTask=function(t){this._asyTasks({suspendCallback:function(){t.suspendTask&&t.suspendTask.call(this)},nextTaskCallback:function(){t.nextTask&&t.nextTask.call(this)}},t.interrupt)},t._asyTasks=function(t,e){if(!this.hasMultithread)return t.nextTaskCallback.call(this);this._multithreadCheck(t,e)},t._multithreadCheck=function(t,e){var i=this,n=function(){i._checkTaskSuspend()?(i.tasksTimeOutId&&clearTimeout(i.tasksTimeOutId),t.suspendCallback.call(i)):t.nextTaskCallback.call(i)},a=function(){i.tasksTimeOutId=setTimeout(function(){n()},i.canvasRelated.tasksTimer)};this.hasAutoRun?e?a():n():a()},t._cancelTaskSuspend=function(){this.canvasRelated.isTaskSuspend=!1},t._checkTaskSuspend=function(){return this.canvasRelated.isTaskSuspend}}(xh),function(t){t.startThreadTask=function(t,e){var i=this;this.threadTaskRelated.preforkComplete=function(){return function(){No.launch.quickFlip&&t?e():i._checkNextTaskCreate(e)}}(),this.dispatchTasks()},t.checkThreadTaskComplete=function(t){var e=this;this.hasAutoRun=!0,this._checkNextTaskCreate(function(){e.hasAutoRun=!1,t()})},t.setTaskSuspend=function(){this.hasAutoRun=!1,this.canvasRelated.isTaskSuspend=!0,this.threadTaskRelated.isPreCreateBackground=!1,this.threadTaskRelated.taskHangFn=null},t.createPreforkTask=function(t,e){var i=this;if(this.threadTaskRelated.isPreCreateBackground)return void(this.threadTaskRelated.taskHangFn=function(t){return function(){i._checkNextTaskCreate(t)}}(t));e&&(this.threadTaskRelated.isPreCreateBackground=!0),this._checkNextTaskCreate(t)},t.createPageAction=function(){this.runLastPageAction&&(this.stopLastPageAction=this.runLastPageAction())},t.destroyPageAction=function(){this.stopLastPageAction&&(this.stopLastPageAction(),this.stopLastPageAction=null)}}(xh),function(t){t.setPageContainerHierarchy=function(t){this.$pageNode.css(t)},t.getLetterObjs=function(t){var e=this.threadTaskRelated.assignTaskGroup["assgin-activity"];if(e&&e.textFxObjs)return e.textFxObjs[t]},t._converSequenceName=function(t){return"next"===t?"swipeleft":"swiperight"},t.hasSwipeSequence=function(t){var e=this._converSequenceName(t),i=this.swipeSequence;return i[e+"Index"]!==i[e+"Total"]&&i[e].length},t.callSwipeSequence=function(t){if(this.swipeSequence){var e=this._converSequenceName(t),i=this.swipeSequence[e],n=i[this.swipeSequence[e+"Index"]];n&&(++this.swipeSequence[e+"Index"],n())}},t.resetSwipeSequence=function(){this.swipeSequence&&(this.swipeSequence.swipeleftIndex=0,this.swipeSequence.swiperightIndex=0)},t.rerunInstanceTask=function(t){var e;if(e=this.threadTaskRelated.assignTaskGroup[t])return e.rerunTask&&e.rerunTask(),!0},t.baseData=function(){return this.dataActionGroup[this.pageType]},t.baseActivits=function(){return this.dataActionGroup.activitys},t.baseAutoRun=function(){var t=this.dataActionGroup.auto;return t&&t},t.baseGetPageId=function(t){return this.baseData(t)._id},t.baseGetContentObject=function(t){var e=this.contentGroup[t];return e?e:this.floatGroup.masterGroup[t]},t.baseContentMutex=function(t,e){var i=void 0;if(i=this.baseGetContentObject(t)){var n=i.$contentNode.view?i.$contentNode.view:i.$contentNode;({Show:function(){"dom"===i.type?n.css({display:"blcok",visibility:"visible"}).prop("mutex",!1):n.visible=!0},Hide:function(){"dom"===i.type?n.css({display:"none",visibility:"hidden"}).prop("mutex",!0):n.visible=!1},StopAnim:function(){i.stopAnims&&i.stopAnims()}})[e]()}},_.each(["Get","Specified"],function(e){t["base"+e+"Content"]=function(t){switch(e){case"Get":return this.activityGroup.get();case"Specified":return this.activityGroup.specified(t)}}}),_.each(["Get","Remove","Add","Specified"],function(e){t["base"+e+"Component"]=function(t){switch(e){case"Add":return this.componentGroup.add(t);case"Get":return this.componentGroup.get();case"Specified":return this.componentGroup.specified(t);case"Remove":return this.componentGroup.remove()}}}),t.baseAssistRun=function(t,e,i){var n;(n=this.activityGroup)&&_.each(n.get(),function(n,a){t==n.activityId&&("Run"==i&&n.runAnimation(e,!0),"Stop"==i&&n.stopAnimation(e))},this)}}(xh),function(t){t.movePage=function(t,e,i,n,a){var o=this.$pageNode[0];if("page"===this.pageType){var r=this.floatGroup.pageContainer;r&&Vd[t](r[0],e,i)}if("master"===this.pageType){this.onceMaster=!1;var s=this.floatGroup.masterContainer;s&&Vd[t](s[0],e,i)}var c=!1,l=!1,u=null,d=null;"flipOver"===t&&(a&&i<100&&(i=0,l=!0),"page"===this.pageType&&e===n&&(c=!0,o.setAttribute("data-visual",!0),u=setTimeout(function(){clearTimeout(u),u=null,o.getAttribute("data-visual")&&(bo("翻页translate回调丢失了，通过定时器手动调用修复"),d=null,Xut.View.SetSwiperFilpComplete(o,!0))},i+500))),d=function(){if(c&&(l||No.launch.banMove))return Xut.View.SetSwiperFilpComplete(o,!0),!0},Vd[t](o,e,i,d)}}(xh),function(t){t.moveParallax=function(t){var e=t.action,i=t.direction,n=t.moveDistance,a=t.pageIndex,o=t.speed,r=t.nodes,s=t.parallaxProcessedContetns,c=this,l=this.baseGetContent();if(l){var u=1===c.getStyle.pageVisualMode,d=n.length?n[1]:n;_.each(l,function(t){t.eachAssistContents(function(t){if(t.parallax){var n=t.parallax.$contentNode;if(s){var l=c.baseGetContentObject(t.id);if(l&&"flipMove"===e&&l.pptObj&&!l.parallaxProcessed){var h=l.actName;l.stop&&l.stop(),l.parallaxProcessed=!0,n.attr("data-parallaxProcessed",h),s[h]=l}}yh({pageIndex:a,$contentNode:n,scope:t.parallax,direction:i,action:e,speed:o,nodes:r,distance:d,isColumn:u})}})})}}}(xh),function(t){t.baseDestroy=function(){this.destroyPageAction(),this._pageScaleObj&&(this._pageScaleObj.destroy(),this._pageScaleObj=null);var t=this.columnGroup.get();t&&t.length&&t.forEach(function(t){t.destroy()}),Je(this.chapterIndex);var e=this.threadTaskRelated.assignTaskGroup;if(e)for(var i in e){var n=e[i];n&&n.destroy&&n.destroy()}var a=this.floatGroup.masterGroup,o=!_.isEmpty(a),r=this.activityGroup.get();r&&r.length&&r.forEach(function(t){t.destroy(function(t){(!o||t&&!a[t.id])&&(t.$contentNode=null)})}),o&&this.floatGroup.masterContainer&&this.floatGroup.masterContainer.remove(),this.floatGroup.pageGroup&&this.floatGroup.pageContainer&&this.floatGroup.pageContainer.remove();var s=this.baseGetComponent();s&&s.length&&s.forEach(function(t){t.destroy&&t.destroy()}),vi(this),this.$pseudoElement&&(this.$pseudoElement=null),Jn(this),this.$pageNode.remove(),this.rootNode=null,this.$pageNode=null}}(xh);var wh=function(t,e){return t.map(function(t){return t-e})},kh=function(t,e){var i=t.chapterData[e];i&&nt(i,e)},_h=function(t){function e(t){fo(this,e);var i=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.rootNode=t,i.pageType="page",No.launch.doublePageMode&&T(t,{transitionend:function(){Xut.View.SetSwiperFilpComplete()}}),i}return mo(e,t),vo(e,[{key:"setInitTranslate",value:function(t){if(No.launch.doublePageMode){var e=No.screenSize.width*t;Xut.style.setTranslate({x:-e,node:this.rootNode})}}},{key:"create",value:function(t,e){var i=new bh(_.extend(t,{pageType:this.pageType,rootNode:this.rootNode}));return this._$$addBaseGroup(e,i),i}},{key:"_moveContainer",value:function(t,e){Xut.style.setTranslate({speed:e,x:t,node:this.rootNode})}},{key:"move",value:function(t){var e=t.speed,i=t.action,n=t.outerCallFlip,a=t.moveDistance,o=t.frontIndex,r=t.middleIndex,s=t.backIndex;No.launch.doublePageMode?this._moveContainer(a[1],e):_.each([this.$$getPageBase(o),this.$$getPageBase(r),this.$$getPageBase(s)],function(t,o){var r=a[o];t&&void 0!==r&&t.movePage(i,r,e,a[3],n)})}},{key:"suspend",value:function(t,e,i,n){var a=this.$$getPageBase(n),o=a.baseGetPageId(n);a.startupTime&&No.sendTrackCode("flip",{pageId:a.chapterId,time:+new Date-a.startupTime}),kh(a,"postCode"),this._suspendInnerCreateTasks(t,e,i),a.destroyPageAction(),a.resetSwipeSequence(),Nn(a,o)}},{key:"resetOriginal",value:function(t){var e=this;sa(t,"resetOriginal").forEach(function(t){var i=e.$$getPageBase(t);if(i){var n=i.floatGroup.pageContainer;n&&n.css({zIndex:2e3,overflow:"hidden"}),Bn(i)}})}},{key:"autoRun",value:function(t){var e=this,i=t.createPointer,n=t.frontIndex,a=t.middleIndex,o=t.backIndex,r=t.suspendIndex,s=t.isQuickTurn,c=t.direction,l=this,u=function(t){var a=void 0;a=s||!c?[n,o]:i||o||n,e._checkPreforkTasks(a,t)},d=function(t,e){var i=function(){e.processComplete(),u()},n=function(){Mn(t,a,i)};if(!t.getContainsNode())return i();e.suspendCallback?e.suspendCallback(n):n()};this._checkTaskCompleted(a,function(e){No.hasTrackCode("flip")&&(e.startupTime=+new Date),e.createPageAction();var i=e.floatGroup.pageContainer;i&&i.css({zIndex:2001,overflow:""}),Xut.style.noMaskBoxImage&&ia(),t.buildComplete(e.seasonId),kh(e,"preCode"),l.resetOriginal(r),u("background"),d(e,t)})}},{key:"clearPage",value:function(t){var e=this.$$getPageBase(t);e&&(e.baseDestroy(),this._$$removeBaseGroup(t))}},{key:"destroyManage",value:function(){Ve(Xut.Presentation.GetPageId(Xut.Presentation.GetPageIndex())),this._$$destroyBaseGroup(),No.launch.doublePageMode&&S(this.rootNode),this.rootNode=null}},{key:"_suspendInnerCreateTasks",value:function(t,e,i){var n=this,a=function(t){if(void 0!==t){t.length||(t=[t]);var e=void 0;t.forEach(function(t){(e=n.$$getPageBase(t))&&e.setTaskSuspend()})}};a(t),a(e),a(i)}},{key:"_checkTaskCompleted",value:function(t,e){var i=this.$$getPageBase(t);i&&i.checkThreadTaskComplete(function(){e(i)})}},{key:"_checkPreforkTasks",value:function(t,e){var i,n;for(t.length||(t=[t]),n=t.length;n--;)(i=this.$$getPageBase(t[n]))&&i.createPreforkTask(function(){},e)}}]),e}(il),Ih=function(t){var e=[];if(!t.length){for(var i in t)e.push(t[i]);t=e}return t},Ph=function(t){function e(t){fo(this,e);var i=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.visualWidth=No.visualSize.width,i.visualHeight=No.visualSize.height,i.pageType="master",i.rootNode=t,i.recordMasterRange={},i.recordMasterId={},i.currMasterId=null,i.parallaxProcessedContetns={},i}return mo(e,t),vo(e,[{key:"register",value:function(t,e,i){var n=this.$$getPageBase(this.converMasterId(t));n&&n.registerCotents.apply(n,arguments)}},{key:"create",value:function(t,e,i,n){var a=void 0,o=t.chapterData.pptMaster,r=t.chapterData.pageOffset,s=r&&r.split("-");if(a=s&&3===s.length?o+"-"+s[2]:o,!this._hasMaster(a,r,e)){i();var c=new bh(_.extend(t,{pptMaster:o,pageType:this.pageType,rootNode:this.rootNode}));return this._$$addBaseGroup(a,c),c}if(No.debug.devtools){var l=this.$$getPageBase(a);l&&n(l)}}},{key:"move",value:function(t,e){var i=this,n=t.nodes,a=t.speed,o=t.action,r=t.moveDistance,s=t.direction,c=t.frontIndex,l=t.middleIndex,u=t.backIndex,d=!1,h=this._findMaster(c,l,u,s,o,e);if(_.each(h,function(t,e){t&&(d=!0,t.movePage(o,r[e],a,r[3]))}),this.isBoundary=d,!d){var p=function(t){var e=i.converMasterId(l),n=i.$$getPageBase(e);n&&n.moveParallax({action:o,direction:s,speed:a,nodes:t,moveDistance:r,parallaxProcessedContetns:i.parallaxProcessedContetns})};switch(s){case"prev":p();break;case"next":n&&p(n)}}}},{key:"suspend",value:function(t){if(this.isBoundary){var e=void 0;if(e=this.$$getPageBase(t)){Nn(e,e.baseGetPageId(t))}}}},{key:"resetOriginal",value:function(t){var e;(e=this.$$getPageBase(t))&&Bn(e)}},{key:"autoRun",value:function(t){var e,i=t.middleIndex,n=t.suspendIndex;(e=this.$$getPageBase(i))&&(this.resetOriginal(n),Mn(e,i))}},{key:"reactivation",value:function(t){if(this.parallaxProcessedContetns){var e=t.id,i=this.parallaxProcessedContetns[e];i&&(i.runAnimations(),i.parallaxProcessed=!1,t.removeAttribute("data-parallaxProcessed"),delete this.parallaxProcessedContetns[e])}}},{key:"makeJumpPocesss",value:function(t){var e,i=this;return{pre:function(){var n=i.converMasterId(t);e=i._scanBounds(t,n),i._checkClear(e,!0),i.currMasterId=n},clean:function(t,n){i._fixPosition(e),i._checkParallaxPox(t,n)}}}},{key:"destroyManage",value:function(){this.rootNode=null,this._$$destroyBaseGroup()}},{key:"_findMaster",value:function(t,e,i,n,a,o){var r=void 0,s=void 0,c=void 0,l=void 0,u=void 0,d=void 0,h=void 0,p=this.converMasterId(e);switch(n){case"prev":c=this.converMasterId(t),r=p!==c,(r||o)&&(d=this.$$getPageBase(p)),c&&r&&("flipOver"===a&&this._checkClear([p,c]),u=this.$$getPageBase(c));break;case"next":l=this.converMasterId(i),s=p!==l,s&&(d=this.$$getPageBase(p)),l&&s&&("flipOver"===a&&this._checkClear([p,l]),h=this.$$getPageBase(l))}return[u,d,h]}},{key:"_scanBounds",value:function(t,e){for(var i,n,a=this.converMasterId(t),o={},r=t;r--;)if((i=this.converMasterId(r))&&i!==e){o.prev=i;break}return n=this.converMasterId(t+1),n&&n!==e&&(o.next=n),a&&(o.curr=a),o}},{key:"_fixPosition",value:function(t){var e=this,i=function(t,i){var n=function(e,i){var n=t.$pageNode;n&&Xut.style.setTranslate({speed:i,x:e,node:n})};"prev"===i?n(-e.visualWidth):"next"===i?n(e.visualWidth):"curr"===i&&n(0)};for(var n in t)switch(n){case"prev":i(this.$$getPageBase(t[n]),"prev");break;case"curr":i(this.$$getPageBase(t[n]),"curr");break;case"next":i(this.$$getPageBase(t[n]),"next")}}},{key:"_checkParallaxPox",value:function(t,e){var i,n,a=this._$$getBaseGroup();for(i in a)n=a[i],this._fixParallaxPox(n,t,e)}},{key:"_toRepeat",value:function(t,e){var i;return!!(i=this.recordMasterRange[t])&&i}},{key:"_updataMasterscope",value:function(t,e){var i;(i=this.recordMasterRange[t])?-1===i.indexOf(e)&&i.push(e):this.recordMasterRange[t]=[e]}},{key:"_updatadParallaxMaster",value:function(t,e){this.recordMasterId[e]=t,this.currMasterId=this.converMasterId(Xut.Presentation.GetPageIndex())}},{key:"_hasMaster",value:function(t,e,i){var n=this._toRepeat(t,i);return this._updataMasterscope(t,i),this._updatadParallaxMaster(t,i),n}},{key:"_fixParallaxPox",value:function(t,e,i){var n=this,a=void 0,o=void 0,r=function(t){var a=t.calculateRangePage(),r=t.lastProperty;i>e?i>a.end&&(o=1):i<a.start&&(o=0);var s=Li({targetProperty:t.targetProperty,distance:-n.visualWidth,nodes:o});Hi({$contentNode:t.$contentNode,action:"master",property:s,speed:300,opacityStart:r.opacityStart}),Wi(s,r)};(a=t.baseGetContent())&&(o=Xut.Presentation.GetPageNode(i-1),a.forEach(function(t){t.eachAssistContents(function(t){t.parallax&&r(t.parallax)})}))}},{key:"_checkClear",value:function(t,e){var i,n=_.keys(this._$$getBaseGroup());(n.length>2||e)&&(t=Ih(t),_.each(t,function(t){void 0!==t&&-1!==(i=n.indexOf(t.toString()))&&n.splice(i,1)}),this._clearMemory(n))}},{key:"_clearMemory",value:function(t){var e,i=this;_.each(t,function(t){(e=i.$$getPageBase(t))&&(e.baseDestroy(),i._$$removeBaseGroup(t),i._removeRecordMasterRange(t)),delete i.recordMasterRange[t]})}},{key:"converMasterId",value:function(t){return this.recordMasterId?this.recordMasterId[t]:void 0}},{key:"_removeRecordMasterRange",value:function(t){var e=this;e.recordMasterRange[t].forEach(function(t){delete e.recordMasterId[t]})}}]),e}(il),Th=function(t,e){t.pageMgr.assistPocess(e,function(t){t.setPageContainerHierarchy({"z-index":9997})}),t.getMasterContext(function(){t.masterMgr.assistPocess(e,function(t){t.setPageContainerHierarchy({"z-index":1})})})},Sh=function(t,e,i){for(var n=void 0,a=0,o=[],r=e.create,s=e.targetIndex;a<r.length;a++)n=r[a],o.push(function(t,e){return function(i){this.createPageBase([e],t,"toPage",i,{opacity:0})}}(s,n));e.pageBaseCollect=[];var c=void 0,l=void 0,u=0;if(c=l=o.length,o&&l)for(;u<l;u++)o[u].call(t,function(t){1===c&&(o=null,setTimeout(function(){i(e)},100)),e.pageBaseCollect.push(t),c--})},Ch=function(t,e){var i=e.visualIndex,n=t.pageMgr,a=e.targetIndex;t.suspendPageBases({stopIndex:i}),_.each(e.destroy,function(t){t!==i&&n.clearPage(t)}),_.each(e.ruleOut,function(t){t>a&&n.assistAppoint(t,function(t){Gn(t.$pageNode,"nextEffect")}),t<a&&n.assistAppoint(t,function(t){Gn(t.$pageNode,"prevEffect")})});var o=void 0;t.getMasterContext(function(){o=this.makeJumpPocesss(a),o.pre()}),n.clearPage(i),o&&o.clean(i,a),_.each(e.pageBaseCollect,function(t){_.each(t,function(t){t&&t.setPageContainerHierarchy({opacity:1})})}),e.pageBaseCollect=null,o=null},$h=function(){function t(){fo(this,t),this._cache=[]}return vo(t,[{key:"shift",value:function(t){this._cache.unshift(t)}},{key:"push",value:function(t){this._cache.push(t)}},{key:"shiftAll",value:function(){if(this._cache.length)for(var t=void 0;t=this._cache.shift();)t.apply(null,arguments);return this}},{key:"popAll",value:function(){if(this._cache.length)for(var t=void 0;t=this._cache.pop();)t.apply(null,arguments);return this}},{key:"destroy",value:function(){this._cache=null}}]),t}(),Mh={left:fa,right:va,top:ga,bottom:ma},Xh=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Xut.style.setTranslateStyle(t,e)},Nh=function(t){var e=Xut.Presentation.GetPageBase(t);return e&&e.getStyle},Bh=function(t,e){if(e.total)for(var i in e)if("total"!==i){var n=e[i],a=n.indexOf(t);if(~a)return{doubleMainIndex:Number(i),doublePosition:0==a?"left":"right"}}return{doubleMainIndex:void 0,doublePosition:void 0}},Dh=function(){function t(e){fo(this,t),this.$$mediator=e,this.pageMgr=new _h(e.options.scenePageNode),ua()&&(this.masterMgr=new Ph(e.options.sceneMasterNode))}return vo(t,[{key:"initCreate",value:function(){var t=this.$$mediator.options,e=oa(t.initIndex,t.pageTotal,t.hasMultiPage);this.pagePointer=e.initPointer,this.createPageBase(e.createPointer,t.initIndex,"init","","")}},{key:"createPageBase",value:function(t,e,i,n,a){if(void 0!==t[0]){var o=this,r=this.$$mediator.options,s=r.hasMultiPage,c="toPage"===i,l="flipOver"===i,u=ra(t,!0),d=u.total||t.length,h=ca(r,t,u,e),p=[],f=!1,g=function(){var t=0;return function(e){++t===d&&e()}}(),m={init:function(){g(function(){o._initPage("init")})},flipOver:function(){g(function(){o._runPageBase({createPointer:h,createMaster:f})})},toPage:function(){g(function(){n(p)})}},y=new $h,b=v();"init"===i&&this.pageMgr.setInitTranslate(e),_.each(h,function(t){y.push(function(){var n=Bh(t,u),h=n.doubleMainIndex,v=n.doublePosition,g=la(t);if(void 0===g)return void bo("创建页面出错,chapterIndex:"+t);var y=aa(r,t,e),x=y.visualChapterIndex,w=y.pageIndex;return 1===d&&(r.chapterId=g._id),c&&x!==t&&(a=void 0),b[t]={userStyle:a,chapterIndex:t,visualChapterIndex:x,doublePosition:v,doubleMainIndex:h,position:na(void 0!==h?h:t,x),pageVisualMode:wa(g)},function(e){var n=function(n){var o=e[t],r=this.create({pageIndex:w,chapterData:g,chapterIndex:t,hasMultiPage:s,getStyle:o},w,n,function(t){No.debug.devtools&&t.getStyle.pageVisualMode!==o.pageVisualMode&&bo("母版与页面VisualMode不一致,错误页码:"+(w+1)+",母版visualMode:"+t.getStyle.pageVisualMode+",页面visualMode:"+o.pageVisualMode)});r&&(r.startThreadTask(l,function(){m[i]()}),a&&p.push(r))};g.pptMaster&&o.masterMgr&&n.call(o.masterMgr,function(){++d,f=!0}),n.call(o.pageMgr)}}())}),y.shiftAll(xa(b)).destroy()}}},{key:"movePageBases",value:function(t){var e=t.action,i=t.speed,n=t.outerCallFlip,a=t.distance,o=t.frontIndex,r=t.middleIndex,s=t.backIndex,c=t.direction,l=t.orientation,u=t.isAppBoundary,d=t.setSwipeInvalid;if(!No.launch.banMove||"flipMove"!=e){var h=this.pageMgr.$$getPageBase(r);if(No.launch.swipeDelegate&&h){if("swipe"===e)return void h.callSwipeSequence(c);if(h.hasSwipeSequence(c))return void(d&&d())}var p=void 0;if(h){var f=h.chapterData;p=f&&f.nodes?f.nodes:void 0}var v=zn({action:e,distance:a,direction:c,frontIndex:o,middleIndex:r,backIndex:s,orientation:l});if(!t.setPageBanBounce||!t.setPageBanBounce(v[1])){var g={nodes:p,speed:i,action:e,outerCallFlip:n,moveDistance:v,direction:c,frontIndex:o,middleIndex:r,backIndex:s};this.pageMgr.move(g),this.getMasterContext(function(){this.move(g,u)}),"flipOver"===e&&Xut.nextTick(function(){Xut.View.UpdatePage({action:e,parentIndex:"next"===c?s:o,direction:c})})}}}},{key:"suspendPageBases",value:function(t){var e=this,i=t.frontIndex,n=t.middleIndex,a=t.backIndex,o=t.stopIndex,r=function(t,i,n,a){e.pageMgr.suspend(t,i,n,a),e.getMasterContext(function(){this.suspend(a)})},s=ra(o);if(s&&s.length){var c=ra(i),l=ra(n),u=ra(a),d=!1;s.forEach(function(t){d?r("","","",t):(r(c,l,u,t),d=!0)})}else r(i,n,a,o);Xut.View.ResetToolbar()}},{key:"completePageBases",value:function(t){var e=t.direction,i=t.pagePointer,n=t.unlock,a=t.isQuickTurn;this.direction=e,this.isQuickTurn=a||!1,this.unlock=n,this._clearPage(i.destroyIndex),this._updatePointer(i),this._createNextPage(e,i)}},{key:"_runPageBase",value:function(t){var e=(this.$$mediator,this.$$mediator.options),i=this.pagePointer,n=i.frontIndex,a=i.middleIndex,o=i.backIndex,r=t?t.action:"",s=t?t.createPointer:"",c=this.direction;s&&(s=aa(e,s));var l={frontIndex:n,middleIndex:a,backIndex:o,direction:c,createPointer:s,isQuickTurn:this.isQuickTurn,suspendIndex:"init"===r?"":"next"===c?n:o,suspendCallback:e.suspendAutoCallback,buildComplete:function(t){if(No.launch.historyMode&&!e.isInApp&&e.hasMultiScene){var i=Wu.sequence(t,a);i&&z("history",i)}},processComplete:function(){Xut.Application.Notify("autoRunComplete")}};this.pageMgr.autoRun(l),this.getMasterContext(function(){(r||this.isBoundary)&&this.autoRun(l)});var u=function(){0==a?Xut.View.HidePrevBar():a==e.pageTotal-1?(Xut.View.HideNextBar(),Xut.View.ShowNextBar()):(Xut.View.ShowNextBar(),Xut.View.ShowPrevBar())};switch(r){case"init":Xut.View.UpdatePage({action:r,parentIndex:a,direction:c}),u.call(this);break;case"toPage":Xut.View.UpdatePage({action:r,parentIndex:a,direction:c}),u.call(this)}No.launch&&No.launch.historyMode&&!e.hasMultiScene&&z("pageIndex",a),this.unlock&&(this.unlock(),this.unlock=null),this.isQuickTurn=!1}},{key:"_clearPage",value:function(t){var e=this;sa(t,"clearPage").forEach(function(t){e.pageMgr.clearPage(t)})}},{key:"_updatePointer",value:function(t){this.pagePointer=t}},{key:"_createNextPage",value:function(t,e){var i=this,n=this.$$mediator.options.pageTotal,a=e.createIndex,o=e.middleIndex,r=function(){e.createIndex=null,e.destroyIndex=null},s=function(){return i.createPageBase([a],o,"flipOver")};if("prev"===t){if(0===o)return this._runPageBase(),2==n&&Xut.View.ShowNextBar(),void Xut.View.HidePrevBar();if(o>-1)return s(),r(),void Xut.View.ShowNextBar()}if("next"===t){if(o===n-1)return this._runPageBase(),2==n&&Xut.View.ShowPrevBar(),void Xut.View.HideNextBar();if(a<n)return s(),r(),void Xut.View.ShowPrevBar()}r()}},{key:"gotoPageBases",value:function(t){Xut.View.ShowBusy(),this.$$mediator.options.hasMultiPage||(t.create=[t.targetIndex],t.destroy=[t.visualIndex],t.ruleOut=[t.targetIndex],t.pagePointer={middleIndex:t.targetIndex}),da(this,t,function(t){this._updatePointer(t.pagePointer),this._runPageBase({action:"toPage",createPointer:t.create}),Xut.View.HideBusy()})}},{key:"getMasterContext",value:function(t){this.masterMgr&&t.call(this.masterMgr)}},{key:"destroyManage",value:function(){this.pageMgr.destroyManage(),this.getMasterContext(function(){this.destroyManage()})}},{key:"_initPage",value:function(t){var e=this,i=function(){return e._runPageBase({action:t})},n=function(){var t=$(".xut-cover");if(t.length){var e=function(){t&&t.remove(),t=null,i()};No.launch.launchAnim===!1?e():t.transition({opacity:0,duration:1e3,easing:"in",complete:e})}else t=null,i()};this.$$mediator.$$emit("change:createComplete",function(){if(e.$$mediator.options.hasMultiScene)n();else{if(window.GLOBALIFRAME)return void n();if(Xut.Application.getAppState()){var t=Xut.Application.LaunchApp;Xut.Application.LaunchApp=function(){t(),n()}}else n()}})}}]),t}(),Ah="Content_",Eh=["page","master"],Oh=function(t){if(Xut.IBooks.Enabled)t.hasMultiPage=!1;else{var e=Number(t.pageMode);No.launch.banMove?(t.hasMultiPage=!1,e>0&&(t.hasMultiPage=!0)):t.hasMultiPage=0!==e}},Hh=function(t){var e="page";return t.dataset&&t.dataset.belong&&(e=t.dataset.belong),e},Rh=function(t){function e(t){fo(this,e);var i=yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this)),n=i,a=n.options=_.extend({hasMultiScene:!1,hasMultiPage:!1},t);Oh(a);var o=!1;5===No.launch.visualMode&&(o=!0);var r={insideScroll:o,scope:"child",snap:!0,hasHook:!0,container:a.sceneNode,visualIndex:a.initIndex,totalIndex:a.pageTotal,actualWidth:No.visualSize.width,actualHeight:No.visualSize.height,visualWidth:No.screenSize.width,hasMultiPage:a.hasMultiPage,sectionRang:a.sectionRang};No.launch.mouseWheel!==!1&&"v"===No.launch.scrollMode&&(r.mouseWheel=!0),5===No.launch.visualMode&&(r.borderBounce=!1),_.extend(r,lh.getConfig());var s=n.$$globalSwiper=new lh(r),c=n.$$scheduler=new Dh(n);a.hasMultiPage&&i.addTools(n);var l=null;s.$$watch("onFilter",function(t,e,i){var n=e.target;Yn(i,n);var a=Hh(n),o=s.findBubbleRootNode(e,a);if(!(l=Un.call(o,e,a))){if(2===No.launch.visualMode)return;if(5===No.launch.visualMode)return}
l&&"disable"!==l.attribute||t()}),s.$$watch("onTap",function(t,e){l&&(l.handlers?l.handlers(l.elem,l.attribute,l.rootNode,t):Xut.Contents.Canvas.getIsTap()||Xut.View.ToggleToolbar(),l=null,e())}),s.$$watch("onMove",function(t){c.movePageBases(t)}),s.$$watch("onEnd",function(t){c.suspendPageBases(t)}),s.$$watch("onComplete",function(){c.completePageBases.apply(c,arguments)});var u=!1;return s.$$watch("onWheel",function(t,e){var i=Xut.Presentation.GetPageBase(s.visualIndex);if(i&&i.hasColumnData){var n=i.columnGroup.get()[0];if(n&&("touch"===n.getEntry()&&(u=!1),!u)){var a=e>0?"up":"down";n&&n.onWheel(t,e,a)}}else u=!0,e>0?s.prev({speed:Xut.plat.isMacOS?600:300,callback:function(){u=!1}}):s.next({speed:Xut.plat.isMacOS?600:300,callback:function(){u=!1}})}),s.$$watch("onJumpPage",function(t){c.gotoPageBases(t)}),s.$$watch("onDropApp",function(t){window.GLOBALIFRAME&&Xut.publish("magazine:dropApp")}),s.$$watch("onMasterMove",function(t,e){/Content/i.test(e.id)&&e.getAttribute("data-parallaxProcessed")&&c.masterMgr&&c.masterMgr.reactivation(e)}),i.destorySceneApi=$a(i),i}return mo(e,t),vo(e,[{key:"addTools",value:function(t){_.extend(uh,{"data-container":function(){Xut.View.ToggleToolbar()},"data-multilayer":function(){Xut.View.ToggleToolbar()},"data-behavior":function(t,e,i,n){"click-swipe"==e&&Xut.View.ToggleToolbar()}})}}]),e}(Ds);d(Rh.prototype,"$hasMultiScene",{get:function(){return this.options.hasMultiScene}}),d(Rh.prototype,"$injectionComponent",{set:function(t){var e;(e=this.$$scheduler[t.pageType+"Mgr"])?e.assistPocess(t.pageIndex,function(e){e.baseAddComponent.call(e,t.widget)}):console.log("注册injection失败,regData="+t)}}),d(Rh.prototype,"$curVmPage",{get:function(){return this.$$scheduler.pageMgr.$$getPageBase(this.$$globalSwiper.getVisualIndex())}}),u(Rh.prototype,"$bind",function(t,e){var i=this;i.$$watch("change:"+t,function(){e.apply(i,arguments)})}),u(Rh.prototype,"$init",function(){this.$$scheduler.initCreate()}),u(Rh.prototype,"$run",function(){var t=this;t.$$scheduler.pageMgr.activateAutoRuns(t.$$globalSwiper.getVisualIndex(),Xut.Presentation.GetPageBase())}),u(Rh.prototype,"$reset",function(){return this.$$scheduler.pageMgr.resetOriginal(this.$$globalSwiper.getVisualIndex())}),u(Rh.prototype,"$suspend",function(){Xut.Application.Suspend({skipAudio:!0})}),u(Rh.prototype,"$destroy",function(){this.$$unWatch(),this.$$globalSwiper.destroy(),this.$$scheduler.destroyManage(),this.$$scheduler=null,this.$$globalSwiper=null,this.destorySceneApi()});var Lh=Xut.plat.isIOS,Fh=Xut.plat.isBrowser,Gh=function(){var t=No.data.iconHeight,e="height:"+t+"px;width:"+t+"px",i=No.data.settings;if(i)switch(i.NavbarPos){case 0:e+=";top:0";break;case 1:e+=";margin-top:"+-t/2+"px";break;case 2:e+=";top:auto;bottom:0"}return e},zh=function(){function t(e){fo(this,t),e&&_.extend(this,e),this.$$barHeight=Lh&&!Fh?20:0;var i=No.proportion;this.$$propHeight="horizontal"==No.layoutMode?i.width:i.height;var n=No.data.iconHeight;this.$$iconHeight=Lh?n:Math.round(this.$$propHeight*n),this.$$appName=No.data.shortName,this.$$setTable=No.data.settings,this._initState(),this._initToolbar()}return vo(t,[{key:"_$$getArrowOption",value:function(){return{style:Gh(),state:this.barStatus?"":"hide",height:No.data.iconHeight}}},{key:"_$$createIcon",value:function(){var t=Gh(),e=this.toolBarStatus?"":"hide";return'<div name="prevArrow"\n                 class="xut-flip-control xut-flip-control-left '+e+'"\n                 style="'+t+";background-image:url(images/icons/pageforward_"+No.data.appId+'.svg);background-size:cover">\n           </div>\n           <div name="nextArrow"\n                class="xut-flip-control xut-flip-control-right '+e+'"\n                style="'+t+";background-image:url(images/icons/pageback_"+No.data.appId+'.svg);background-size:cover">\n           </div>'}},{key:"_$$createArrow",value:function(){var t=this._$$getArrowOption();return'<div class="si-icon xut-flip-control xut-flip-control-left icon-angle-left '+t.state+'"\n                 style="'+t.style+";text-align:center;line-height:"+t.height+'px;font-size:4vh;">\n            </div>\n            <div class="si-icon xut-flip-control xut-flip-control-right icon-angle-right '+t.state+'"\n                 style="'+t.style+";text-align:center;line-height:"+t.height+'px;">\n            </div>'}},{key:"_$$bindArrow",value:function(t,e){return t.on("mouseup touchend",function(t){return e(),!1}),function(){t.off(),t=null}}},{key:"_$$showToolBar",value:function(t){switch(t){case"controlBar":this._showTopBar();break;case"button":this._$$showArrow(),this.Lock=!1;break;default:this._showTopBar(),this._$$showArrow()}}},{key:"_$$hideToolBar",value:function(t){switch(t){case"controlBar":this._hideTopBar();break;case"button":this._$$hideArrow(),this.Lock=!1;break;default:this._hideTopBar(),this._$$hideArrow()}}},{key:"_$$toggleArrow",value:function(t,e){if(this.arrows){var i=this.arrows[t];i&&(i.able=e,this.hasTopBar&&!this.toolBarStatus&&e||i.el[e?"show":"hide"]())}}},{key:"_$$showSystemBar",value:function(){Lh&&Xut.plat.hasPlugin&&Xut.Plugin.statusbarPlugin.setStatus(null,null,0)}},{key:"_$$hideSystemBar",value:function(){Lh&&Xut.plat.hasPlugin&&Xut.Plugin.statusbarPlugin.setStatus(null,null,1)}},{key:"_$$createArrows",value:function(){this.arrows=v();var t=void 0;t=this.$$setTable.customButton?$(String.styleFormat(this._$$createIcon())):$(String.styleFormat(this._$$createArrow()));var e=t.eq(0),i=t.eq(t.length-1);this.arrows={prev:{off:this._$$bindArrow(e,function(){Xut.View.GotoPrevSlide()}),el:e,able:!0},next:{off:this._$$bindArrow(i,function(){Xut.View.GotoNextSlide()}),el:i,able:!0}},this.$sceneNode.append(t)}},{key:"_$$showArrow",value:function(){var t=this.arrows;for(var e in t){var i=t[e];i.able&&i.el.show()}}},{key:"_$$hideArrow",value:function(){var t=this.arrows;for(var e in t)t[e].el.hide()}},{key:"hideNext",value:function(){this._$$toggleArrow("next",!1)}},{key:"showNext",value:function(){this._$$toggleArrow("next",!0)}},{key:"hidePrev",value:function(){this._$$toggleArrow("prev",!1)}},{key:"showPrev",value:function(){this._$$toggleArrow("prev",!0)}},{key:"toggle",value:function(t,e){if(!this.Lock)switch(this.Lock=!0,t){case"show":this._$$showToolBar(e);break;case"hide":this._$$hideToolBar(e);break;default:this.toolBarStatus?this._$$hideToolBar(e):this._$$showToolBar(e)}}},{key:"destroy",value:function(){this._destroy(),this.arrows&&(this.arrows.prev.off(),this.arrows.next.off(),this.arrows=null)}}]),t}(),Wh=Math.round,jh=Xut.plat.isIOS,Vh=jh?20:0,Yh=function(){var t=No.data.iconHeight,e=No.proportion,i=No.visualSize,n="horizontal"==No.layoutMode;e=n?e.width:e.height,t=jh?t:Wh(e*t);var a=void 0,o=void 0,r=i.width,s=i.height;return n?a=Wh(s/6):(o=Math.min(r,s)/(jh?8:3),a=Wh(.96*(s-t-Vh))),{sWidth:r,sHeight:s,navHeight:a,navWidth:o,proportion:e}},Uh=function(t){var e=void 0,i=void 0,n=void 0,a=void 0,o=void 0,r=void 0,s=void 0,c=void 0,l=Yh(),u=Wh(2*l.proportion),d=l.navWidth,h=l.navHeight,p=l.sWidth,f=l.sHeight;return"horizontal"==No.layoutMode?(i=Wh(.9*h),e=Wh(i*p/f),n=Wh(.05*h),a="width:"+t*(e+n)+"px>",o="float:left;width:"+e+"px;height:"+i+"px;margin-left:"+n+"px",r="width:96%;height:"+i+"px;margin:"+n+"px auto;font-size:"+u+"em",s=e*t+t*n):(e=Wh(.9*d),i=Wh(1.1*d),n=Wh(.05*d),o="width:"+e+"px;height:"+i+"px;margin:"+n+"px auto;border-bottom:1px solid rgba(0,0,0,0.3)",r="height:"+(h-4)+"px;overflow:hidden;margin:2px auto;font-size:"+u+"em",c=i*t+t*n),{contentstyle:o,containerstyle:r,overwidth:s,overHeigth:c,scroller:a}},qh=function(){function t(e){fo(this,t),this._isHorizontal="horizontal"===No.layoutMode,this._pagedata=e,this._$section=$("#xut-nav-section-list"),this._$list=this._$section.find("li")}return vo(t,[{key:"userIscroll",value:function(t){var e=this,i=this._isHorizontal;this.hBox?i?this.hBox.goToPage(t,0,0):this.hBox.goToPage(0,t,0):(this.hBox=Ii("#xut-nav-wrapper",{snap:"li",tap:!0,scrollX:i,scrollY:!i,scrollbars:"custom",fadeScrollbars:!0,stopPropagation:!0}),this.hBox.on("scrollEnd",function(t){e.createThumb(),e._removeThumb()}),this._$section.on("tap",this._toJump))}},{key:"_toJump",value:function(t){var e=t.target;if(e){var i=e.getAttribute("data-xxtlink");i&&(i=i.split("-"),Xut.View.GotoSlide(i[0],i[1]))}}},{key:"createThumb",value:function(){var t=this._getPageIndex(),e=this._getViewLen(),i=this.createBak||[],n=[],a=this._pagedata,o=a.length;e=e>o?o:e,t=t+e>o?o-e:t;var r=0,s=void 0,c=void 0;for(r=0;r<e;r++)s=t+r,c=a[s],n.push(s),_.contains(i,s)||(i.push(s),c.iconImage?this._$list.eq(s).css({"background-image":"url("+tt(c.iconImage,"navbar-bg")+")"}):this._$list.eq(s).css({"background-image":"url("+tt(c.md5,"navbar-bg")+")","background-color":"white"}));this.createNew=n,this.createBak=i}},{key:"_removeThumb",value:function(){var t=this._$list,e=this.createNew,i=this.createBak;_.each(i,function(n,a){_.contains(e,n)||(i[a]=-1,t.eq(n).css({background:""}))}),this.createBak=_.without(i,-1)}},{key:"_getPageIndex",value:function(){return this.hBox.options.scrollX?this.hBox.currentPage.pageX:this.hBox.currentPage.pageY}},{key:"_getViewLen",value:function(){var t=this.hBox,e=1,i=1,n=this._pagedata.length;return this._isHorizontal?(e=t.scrollerWidth/n,i=t.wrapperWidth/e):(e=t.scrollerHeight/n,i=t.wrapperHeight/e),Math.ceil(i)+1}},{key:"scrollTo",value:function(t){this.userIscroll(t)}},{key:"refresh",value:function(){this.hBox&&this.hBox.refresh()}},{key:"destroy",value:function(){this.hBox&&(this._$section.off(),this._$section=null,this._$list=null,this.hBox.destroy(),this.hBox=null),this._pagedata=null}}]),t}(),Kh=function(){function t(e){fo(this,t),this.pageIndex=e,this.isRunning=!1,this.$container=$(".xut-nav-bar"),this.$button=$(".xut-control-navbar"),this._initialize()}return vo(t,[{key:"toggle",value:function(t){this.pageIndex=t,this._navControl()}},{key:"hide",value:function(){this.isRunning&&this._navControl()}},{key:"destroy",value:function(){this.sectionObj&&(this.sectionObj.destroy(),this.sectionObj=null),this.$container=null,this.$button=null}}]),vo(t,[{key:"_initialize",value:function(){var t=this,e=[];Xut.data.query("Chapter",Xut.data.novelId,"seasonId",function(t){return e.push(t)}),Xut.nextTick({container:this.$container,content:Ma(e)},function(){t.sectionObj=new qh(e),t.sectionObj.userIscroll(t.pageIndex),t.sectionObj.createThumb(),t._navControl()})}},{key:"_navControl",value:function(){var t=this.$button.attr("fly")||"in",e="in"===t;e&&this.$container.css({"z-index":0,opacity:0,display:"block"}),this.$button.css("opacity",e?.5:1),e?(this.sectionObj.refresh(),this.sectionObj.scrollTo(this.pageIndex),this.$container.css({"z-index":Xut.zIndexlevel(),opacity:1}),this.$button.attr("fly","out"),this.isRunning=!0):(this.$button.attr("fly","in"),this.$container.hide(),this.isRunning=!1)}}]),t}(),Qh=function(t){function e(t){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return mo(e,t),vo(e,[{key:"_initState",value:function(){this.Lock=!1,this.delay=50,this.hasTopBar=!0,this.currPageNode=null,this.$controlNode=this.$sceneNode.find(".xut-control-bar"),this.eventElement=this.$controlNode[0]}},{key:"_initToolbar",value:function(){_.some(this.toolType)&&this._initTopBar(),this.arrowButton&&this._$$createArrows()}},{key:"_barPostion",value:function(t,e){1==e?t.css({bottom:0,height:this.$$iconHeight+"px"}):t.css({top:0,height:this.$$iconHeight+"px",paddingTop:""+this.$$barHeight})}},{key:"_initTopBar",value:function(){var t=this.$controlNode;this.toolBarStatus="none"!==t.css("display"),this._barPostion(t,this.$$setTable.ToolbarPos);var e="";this.$$setTable.HomeBut&&(e+=Xa(this.$$iconHeight)),this.$$setTable.ContentBut&&(e+=Na(this.$$iconHeight)),e+=Ba(this.$$iconHeight,this.$$appName),e+=Aa(this.$$iconHeight),this.$$setTable.CloseBut&&(e+=Ea(this.$$iconHeight)),this.$$setTable.PageBut&&(e+=Da(this.$$iconHeight,this.currentPage,this.pageTotal)),Xut.nextTick(t.append(String.styleFormat(e))),this.currPageNode=t.find(".control-current-page"),T(this.eventElement,{start:this})}},{key:"_toggleNavBar",value:function(){var t=Xut.Presentation.GetPageIndex();this.navbarObj?this.navbarObj.toggle(t):this.navbarObj=new Kh(t)}},{key:"handleEvent",value:function(t){C({start:function(t){switch(M(t).className){case"xut-control-backhome":e.goHomePage();break;case"xut-control-navbar":this._toggleNavBar();break;case"xut-control-hidebar":this._hideTopBar()}}},this,t)}},{key:"_showTopBar",value:function(){var t=this;if(this.toolBarStatus)return void(this.Lock=!1);this.$controlNode.css({display:"block",opacity:0}),t.$controlNode&&t.$controlNode.transition({opacity:1},t.delay,"in",function(){t.hideNavbar(),t._$$showSystemBar(),t.toolBarStatus=!0,t.Lock=!1})}},{key:"_hideTopBar",value:function(){var t=this;if(!this.toolBarStatus)return void(this.Lock=!1);this.$controlNode&&this.$controlNode.transition({opacity:0},t.delay,"in",function(){t.hideNavbar(),t.$controlNode.hide(),t._$$hideSystemBar(),t.toolBarStatus=!1,t.Lock=!1})}},{key:"_destroy",value:function(){this.navbarObj&&this.navbarObj.destroy(),S(this.eventElement),this.currPageNode=null,this.toolBarStatus=!1,this.$controlNode=null,this.eventElement=null}},{key:"resetArrow",value:function(){this.toolBarStatus?this._$$showArrow():this._$$hideArrow()}},{key:"hideNavbar",value:function(){this.navbarObj&&this.navbarObj.hide("hide")}},{key:"updatePointer",value:function(t){var e=t.parentIndex;this.currPageNode&&this.currPageNode.html(e+1)}}],[{key:"goHomePage",value:function(){if(window.DUKUCONFIG)return void Xut.Application.Suspend({processed:function(){Xut.Application.DropApp()}});Xut.Application.Suspend({processed:function(){Xut.View.GotoSlide(1)}})}}]),e}(zh),Zh=Xut.plat.isIOS,Jh=function(){Xut.View.CloseScenario()},tp=function(t){function e(t){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return mo(e,t),vo(e,[{key:"_initState",value:function(){this.pageTips=null,this.currTip=null,this.tipsMode=0,this.top=this.$$barHeight,this.Lock=!1,this.delay=50,this.hasTopBar=!1,this.barStatus=!0}},{key:"_initToolbar",value:function(){var t=void 0;for(this.$sceneNode.hide(),this.controlBar=[];t=this.toolType.shift();)switch(t){case 1:this._createSystemBar();break;case 2:this._createCloseIcon();break;case 3:this._createBackIcon();break;case 4:this._createPageTips();break;default:this.barStatus=!1,this.hasTopBar=!1}this.arrowButton&&this._$$createArrows(),this.$sceneNode.show()}},{key:"_createSystemBar",value:function(){var t='<div class="xut-control-bar"\n                         style="top:0;height:'+this.$$iconHeight+"px;padding-top:"+this.top+'px">\n                    </div>';t=$(String.styleFormat(t)),this._$$showSystemBar(),this._createBackIcon(t),this._createTitle(t),this._createPageNum(t),this.controlBar=t,this.$sceneNode.append(t),this.hasTopBar=!0}},{key:"_createPageTips",value:function(){var t=this,e=this.pageTotal,i=this.$$iconHeight,n="",a="";if(e<2)return n;for(var o=Zh?7:Math.max(8,Math.round(8*this.$$propHeight)),r=2.5*o,s=e*r,c=(i-o)/2,l=(No.visualSize.width-s)/2,u=1;u<=e;u++)a+='<li class="xut-scenario-dark"\n                      style="float:left;width:'+r+"px;height:"+i+'px;"\n                      data-index="'+u+'">\n                    <div class="xut-scenario-radius"\n                          style="width:'+o+"px;height:"+o+"px;margin:"+c+'px auto">\n                    </div>\n                </li>';n='<ul class="xut-scenario-tips"\n                    style="top:'+this.top+"px;left:"+l+"px;width:"+s+'px;opacity:0.6">\n                    '+a+"\n                </ul>",n=$(String.styleFormat(n)),this.$tipsNode=n,this.$tipsNode.on("click",function(e){var i=e.target;switch(i.className){case"xut-control-nav-hide":t.hideTopBar();break;case"xut-scenario-dark":if(t.arrowButton){var n=i.getAttribute("data-index")||1;Xut.View.GotoSlide(Number(n))}}}),this.pageTips=n.children(),this.tipsMode=1,this.controlBar.push(n),this.$sceneNode.append(n)}},{key:"_onBackClose",value:function(t){return t.on("mouseup touchend",function(t){return Jh(),!1}),function(){t.off(),t=null}}},{key:"_createCloseIcon",value:function(){var t=this.$$iconHeight,e=$('<div class="si-icon xut-scenario-close icon-close2"\n                style="top:'+this.top+"px;width:"+t+"px;height:"+t+"px;line-height:"+t+'px;text-align:center;font-size:3vh;">\n            </div>');this.$closeIcon=e,this._onBackClose(this.$closeIcon),this.controlBar.push(e),this.$sceneNode.append(e)}},{key:"_createBackIcon",value:function(){var t=this.$$iconHeight,e=$('<div class="si-icon xut-scenario-back icon-arrow-left"\n                  style="top:'+this.top+"px;width:"+t+"px;height:"+t+"px;line-height:"+t+'px;">\n            </div>');this.$backIcon=e,this._onBackClose(this.$backIcon),this.controlBar.push(e),this.$sceneNode.append(e)}},{key:"_createPageNum",value:function(t){var e,i=this.pageTotal,n=this.top,a=this.$$iconHeight,o=this.currentPage;e='<div class="xut-control-pageindex"\n                  style="position:absolute;\n                         right:4px;\n                         top:'+(.25*a+n)+"px;\n                         padding:0 0.25em;\n                         height:"+.5*a+"px;\n                         line-height:"+.5*a+'px;\n                         border-radius:0.5em">\n                <span class="currentPage">'+o+"</span>/<span>"+i+"</span>\n            </div>",e=$(String.styleFormat(e)),this.tipsMode=2,this.currTip=e.children().first(),t.append(e)}},{key:"_createTitle",value:function(t){var e='<div class="xut-control-title"\n                  style="line-height:'+this.$$iconHeight+'px">\n                '+this.$$appName+"\n            </div>";t.append(String.styleFormat(e))}},{key:"_showTopBar",value:function(){var t=this,e=this.delay,i=this.controlBar;if(this.barStatus)return void(this.Lock=!1);this.hasTopBar?(i.css({display:"block",opacity:0}),setTimeout(function(){i.transition({opacity:1},e,"linear",function(){t.__showSystemBar(),t.barStatus=!0,t.Lock=!1})})):i.forEach(function(e){e.show(),t.Lock=!1,t.barStatus=!0})}},{key:"_hideTopBar",value:function(){var t=this,e=this.delay,i=this.controlBar;if(!this.barStatus)return void(this.Lock=!1);this.hasTopBar?i.transition({opacity:0},e,"linear",function(){t.controlBar.hide(),t.__hideSystemBar(),t.barStatus=!1,t.Lock=!1}):i.forEach(function(i){i.hide(e,function(){t.Lock=!1,t.barStatus=!1})})}},{key:"_destroy",value:function(){this.$sceneNode=null,this.controlBar=null,this.pageTips=null,this.currTip=null,this.prevTip=null,this.$tipsNode&&(this.$tipsNode.off(),this.$tipsNode=null),this.$closeIcon&&(this.$closeIcon.off(),this.$closeIcon=null),this.$backIcon&&(this.$backIcon.off(),this.$backIcon=null)}},{key:"updatePointer",value:function(t){var e=t.parentIndex;switch(this.tipsMode){case 1:this.prevTip&&(this.prevTip.className="xut-scenario-dark"),this.currTip=this.pageTips[e],this.currTip.className="xut-scenario-light",this.prevTip=this.currTip;break;case 2:this.currTip.html(e+1)}}}]),e}(zh),ep=function(){function t(e,i){fo(this,t),this.pageBar=e;for(var n in i)this[n]=i[n];this._$$template()}return vo(t,[{key:"_$$template",value:function(){var t=this;this._init&&this._init(),this._parseBar&&this._parseBar();var e=this._createHTML();e&&(this.$container=$(String.styleFormat(e)),this._getContextNode(),this.status=!0,Xut.nextTick(function(){t._render()}))}},{key:"_$$showlBar",value:function(){this.status=!0,this.$container.show()}},{key:"_$$hideBar",value:function(){this.status=!1,this.$container.hide()}},{key:"_$$update",value:function(t,e,i){this._visualIndex!=e&&this._updateSingle(t,e,i),this._visualIndex=e}},{key:"destroy",value:function(){this._destroy&&this._destroy(),this.$sceneNode=null,this.$container=null}},{key:"toggle",value:function(t,e){if("pageNumber"===e)switch(t){case"show":this._$$showlBar();break;case"hide":this._$$hideBar();break;default:this.status?this._$$showlBar():this._$$hideBar()}}},{key:"updatePointer",value:function(t){var e=t.time,i=void 0===e?600:e,n=t.action,a=t.direction,o=t.parentIndex,r=t.hasSon,s=void 0!==r&&r,c=t.sonIndex,l=void 0===c?0:c,u=Xut.Presentation.GetPageData("page",o);if(++o,!Nt())return void this._$$update(n,o,i);var d=Dt(u.seasonId,u._id),h=o+d+l;"prev"===a&&(h=s?o+d+l-2:o+Bt(u.seasonId,u._id)),this._$$update(n,h,i)}}]),t}(),ip=function(t){function e(t,i){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return mo(e,t),vo(e,[{key:"_createHTML",value:function(){var t=0;return No.visualSize.overflowWidth&&(t=Math.abs(2*No.visualSize.left)+"px"),'<div class="xut-page-number"style="right:'+t+';bottom:0;">\n                  <div>1</div>\n                  <strong>/</strong>\n                  <div>'+this.pageTotal+"</div>\n            </div>"}},{key:"_getContextNode",value:function(){this.$currtNode=this.$container.find("div:first"),this.$allNode=this.$container.find("div:last")}},{key:"_render",value:function(){this.$sceneNode.append(this.$container)}},{key:"_updateSingle",value:function(t,e){var i=this;Xut.nextTick(function(){i.$currtNode.text(e),"init"===t&&i.$container.show()})}},{key:"_destroy",value:function(){this.$currtNode=null,this.$allNode=null}},{key:"updateTotal",value:function(t){t>this.pageTotal&&(this.pageTotal=t,this.$allNode.text(t))}}]),e}(ep),np=["dotIcon-brightness_1","dotIcon-circle-full","dotIcon-cd","dotIcon-adjust","dotIcon-stop","dotIcon-record"],ap=function(t){function e(t,i){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return mo(e,t),vo(e,[{key:"_parseBar",value:function(){var t=this.pageBar;if(this.dotStyle=Number(t.mode)||1,this.dotStyleClass=np[this.dotStyle-1],t.position){var e=t.position.left,i=t.position.top,n="width:100%;";_.isUndefined(e)?e="width:100%;text-align:center;":(n="width:"+(100-parseInt(e))+"%;",e="left:"+e+";"),i=_.isUndefined(i)?"bottom:0;":"top:"+i+";",this.position=""+n+e+i}else this.position="width:100%;text-align:center;bottom:0;margin-bottom:0.3rem"}},{key:"_createHTML",value:function(){for(var t="",e=this.pageTotal;e--;)t+='<span class="slider-pager-page"><i class= '+this.dotStyleClass+"></i></span>";return'<div class="xut-page-number"style="'+this.position+';">'+t+"</div>"}},{key:"_getContextNode",value:function(){this.$currtNode=this.$container.find("span:first")}},{key:"_render",value:function(){this.$sceneNode.append(this.$container)}},{key:"_updateSingle",value:function(t,e){var i=this;Xut.nextTick(function(){i.$container.find("span.slider-pager-page.active").removeClass("active"),$(i.$container.find("span.slider-pager-page")[e-1]).addClass("active"),"init"===t&&i.$container.show()})}},{key:"_destroy",value:function(){this.$currtNode=null}},{key:"updateTotal",value:function(t){if(t>this.pageTotal){var e,i,n=0;_.each(this.$container.find("span.slider-pager-page"),function(t,e){"slider-pager-page"!=t.className&&(n=e)}),this.$container.empty();for(var a=0;a<t;a++)e=document.createElement("span"),e.className=a==n?"slider-pager-page active":"slider-pager-page",i=document.createElement("i"),i.className=this.dotStyleClass,e.appendChild(i),this.$container.append(e)}}}]),e}(ep),op=function(t){function e(t,i){return fo(this,e),yo(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i))}return mo(e,t),vo(e,[{key:"_init",value:function(){this.visualHeight=No.visualSize.height,this.visualWidth=No.visualSize.width}},{key:"_parseBar",value:function(){this.direction=this.pageBar.direction||No.launch.scrollMode}},{key:"_createHTML",value:function(){return"h"==this.direction?(this.ratio=this.visualWidth/this.pageTotal,'<div class="xut-iscroll-bar"\n                   style="height:.3rem;left: 2px; right: 2px; bottom: 1px; overflow: hidden;">\n                <div class="xut-iscroll-indicator" style="height: 100%;width: '+this.ratio+'px; "></div>\n             </div>'):(this.ratio=this.visualHeight/this.pageTotal,'<div class="xut-iscroll-bar"\n                   style="width:.3rem;bottom: 2px; top: 2px; right: 1px; overflow: hidden;">\n                <div class="xut-iscroll-indicator" style="width: 100%;height: '+this.ratio+'px;"></div>\n             </div>')}},{key:"_getContextNode",value:function(){this.$indicatorNode=this.$container.find("div:first"),this.indicatorNode=this.$indicatorNode[0]}},{key:"_render",value:function(){this.$sceneNode.append(this.$container)}},{key:"_setTranslate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Xut.style.setTranslate({x:t,y:e,speed:i,node:this.indicatorNode})}},{key:"_updateTranslate",value:function(t,e){if(this.indicatorNode){var i=void 0;"h"==this.direction?(i=this.visualWidth*(t-1)/this.pageTotal,this._setTranslate(i,0,e)):(i=this.visualHeight*(t-1)/this.pageTotal,this._setTranslate(0,i,e)),this.baesTranslateY=this.initTranslateY=i}}},{key:"_clearTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"_updateSingle",value:function(t,e,i){var n=this;"hide"===this.barState&&this.showBar(),this.timer||(this.timer=setTimeout(function(){n.hideBar()},1500)),"init"===t?(this._updateTranslate(e,0),this.$container.show()):this._updateTranslate(e,i)}},{key:"_destroy",value:function(){this._clearTimer(),this.$indicatorNode=null,this.indicatorNode=null}},{key:"updatePosition",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments[2],n=void 0;"down"===i&&(n=t+this.initTranslateY,this.preTranslateY=n,this.baesTranslateY=null),"up"===i&&(this.baesTranslateY||(this.baesTranslateY=this.preTranslateY),n=this.baesTranslateY-t,this.preTranslateY=n),this._setTranslate(0,n,e)}},{key:"showBar",value:function(){"hide"===this.barState&&(this.$indicatorNode.css("opacity",1),this.barState="show")}},{key:"hideBar",value:function(){this.barState="hide",this.$indicatorNode.transition({opacity:0,duration:1500,easing:"in"}),this._clearTimer()}},{key:"updateTotal",value:function(t){t>this.pageTotal&&(this.pageTotal=t,"h"==this.direction?(this.ratio=this.visualWidth/this.pageTotal,this.$indicatorNode.css("width",this.ratio)):(this.ratio=this.visualHeight/this.pageTotal,this.$indicatorNode.css("height",this.ratio)))}}]),e}(ep),rp={Digital:ip,Circular:ap,Scrollbar:op},sp=function(t,e,i){return t=h(t),i.type=t,rp[t]?new rp[t](e,i):new ip(e,i)},cp=Math.round,lp=6,up=Xut.plat.isIOS,dp=up?20:0,hp=function(t,e,i){if(t=m(t)){var n=Number(t.pageMode);i=_.isFinite(n)?n:i,_.isString(t.tbType)&&(e=_.map(t.tbType.split(","),function(t){return Number(t)}))}return{toolType:e,pageMode:i}},pp=function(t,e,i){return function(n,a){var o;return o=i?"#"+n:"#"+a+e,t.find(o)[0]}},fp=function(t){if(No.debug.deBugHistory)return Xut.View.LoadScenario(No.debug.deBugHistory),!0;if(t){var e=Wu.seqReverse(t);return!!e&&(e=e.split("-"),Xut.View.LoadScenario({seasonId:e[0],chapterId:e[1],pageIndex:e[2]}),!0)}},vp=function(){function t(e){var i=this;fo(this,t);var n=_.extend(this,e);this._createHTML(n,function(){Xut.IBooks.Enabled||i._initToolBar(),i._createMediator(),Wu.add(e.seasonId,e.chapterId,i)})}return vo(t,[{key:"_createHTML",value:function(t,e){if(Xut.IBooks.runMode())return this.$sceneNode=$("#xut-main-scene"),void e();this.$sceneNode=$(t.isMain?Ha():Ra(this.seasonId)),Xut.nextTick({container:$(".xut-scene-container"),content:this.$sceneNode},e)}},{key:"_initToolBar",value:function(){var t=this.seasonId,e=this.pageTotal,i=this.pageIndex,n=this.$sceneNode;_.extend(this,this._initDefaultBar(i,e,n,t)),this._initMiniBar(i,e,n)}},{key:"_initDefaultBar",value:function(t,e,i,n){var a={};return this.isMain?(a=La(n),_.some(a.toolType)&&(this.mainToolbar=new Qh({$sceneNode:i,pageTotal:e,currentPage:t+1,toolType:a.toolType,arrowButton:2===a.pageMode}))):(a=Fa(this.barInfo,e),_.some(a.toolType)&&(this.deputyToolbar=new tp({$sceneNode:i,toolType:a.toolType,pageTotal:e,currentPage:t,arrowButton:2===a.pageMode}))),a}},{key:"_initMiniBar",value:function(t,e,i){var n=this,a=Et(this.seasonId);if("mini"===No.launch.platform||No.debug.toolType.number!==!1&&a){var o=function(t){t&&(a=Et(n.seasonId));var i=0;return a&&(i=At(n.seasonId)),a?e+a-i:e};this.miniBar=Oa(No.launch.pageBar,{$sceneNode:i,visualIndex:t,pageTotal:o()}),No.launch.columnCheck&&Xut.Application.Watch("change:number:total",function(){n._eachMiniBar(function(){this.updateTotal(o(!0))})})}}},{key:"_eachMiniBar",value:function(t){this.miniBar&&this.miniBar.forEach(function(e){t.call(e)})}},{key:"_createMediator",value:function(){var t=this,e=this.isMain,i=this.$sceneNode,n=this.seasonId,a=this.pageTotal,o=this.pageIndex,r=pp(i,n,e),s=r("xut-page-container","scenarioPage-"),c=r("xut-master-container","scenarioMaster-"),l=this.$$mediator=new Rh({scenePageNode:s,sceneMasterNode:c,pageMode:this.pageMode,sceneNode:this.$sceneNode[0],hasMultiScene:!e,initIndex:o,pageTotal:a,sectionRang:this.sectionRang,seasonId:n,chapterId:this.chapterId,isInApp:this.isInApp});l.miniBar=this.miniBar;var u=this.pptBar=this.deputyToolbar?this.deputyToolbar:this.mainToolbar;l.$bind("updatePage",function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];u&&u.updatePointer.apply(u,i),t._eachMiniBar(function(){this.updatePointer.apply(this,i)})}),l.$bind("showNext",function(){u&&u.showNext()}),l.$bind("hideNext",function(){u&&u.hideNext()}),l.$bind("showPrev",function(){u&&u.showPrev()}),l.$bind("hidePrev",function(){u&&u.hidePrev()}),l.$bind("toggleToolbar",function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];u&&u.toggle.apply(u,i),t._eachMiniBar(function(){this.toggle.apply(this,i)})}),l.$bind("resetToolbar",function(){t.mainToolbar&&(t.mainToolbar.resetArrow(),t.mainToolbar.hideNavbar())}),l.$bind("createComplete",function(i){t.complete&&setTimeout(function(){e?t.complete(function(){Xut.View.HideBusy(),fp(t.history)||i&&i()}):t.complete(i)},200)}),l.$bind("getMiniBar",function(){return t.miniBar}),window.DUKUCONFIG&&e&&window.DUKUCONFIG.success?(window.DUKUCONFIG.success(),l.$init()):window.CLIENTCONFIGT&&e&&window.CLIENTCONFIGT.success?(window.CLIENTCONFIGT.success(),l.$init()):l.$init()}},{key:"getSceneNode",value:function(){return this.$sceneNode}},{key:"destroy",value:function(){No.launch.columnCheck&&Xut.Application.unWatch("change:number:total"),this.pptBar&&(this.pptBar.destroy(),this.pptBar=null),this._eachMiniBar(function(){this.destroy()}),this.$$mediator.miniBar=null,this.$$mediator.$destroy(),this.$sceneNode.off(),this.$sceneNode.remove(),this.$sceneNode=null,Wu.remove(this.seasonId)}}]),t}(),gp=function(t){Xut[t]||(Xut[t]={})};!function(){Pc()}(),function(){Wc()}(),function(){gp("U3d"),gp("View"),gp("Assist"),gp("Contents"),gp("Application"),gp("Presentation"),gp("Camera"),window.XXTAPI={},qa(),za(),Ga(),Wa(),Ua()}(),Xut.Version=887.9;var mp=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];ni(function(){Za(),ti();var t=Ue.apply(void 0,e),i=t.$rootNode,n=t.$contentNode;Br({container:i,content:n},Pe)})},yp=function(t){t&&Xut.mixin(No.golbal,t)},bp=void 0,xp=null,wp=Xut.plat.isBrowser&&No.orientateMode?function(){$(window).on("orientationchange",function(t){function e(t){xp||(xp=setTimeout(function(){Xut.Application.Refresh(),clearTimeout(xp),xp=null,t()},1e3))}if(!Xut.Application.PlayHTML5Video){var i=bp;e(i&&i.length?function(){Xut.Application.Launch(i.pop()),i=null}:function(){mp()})}})}:function(){};Xut.Application.Launch=function(t){if(!No.launch){var e=Xut.Application.setConfig;e&&1===e.lauchMode&&(yp(e),bp=[t],No.launch=$.extend(!0,{launchTime:+new Date},t),t.path&&(_.each(t.path,function(t,e){No.launch[e]="resource"===e?Y(t):t}),delete No.launch.path),wp(),mp(t.el,t.cursor))}};var kp=function(){for(var t=document.querySelectorAll("script"),e=0;e<t.length;e++){if("mini"===t[e].getAttribute("data-plat"))return!0}};setTimeout(function(){var t=Xut.Application.setConfig;if(!t||t&&1!==t.lauchMode){if(kp())return;yp(t),No.launch={},mp()}},100)});